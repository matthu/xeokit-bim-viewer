!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=215)}([function(e,t,i){"use strict";i.r(t),i.d(t,"math",(function(){return a}));const r=Float64Array,n=new r(16),o=new r(16),s=new r(4),a={MIN_DOUBLE:-Number.MAX_SAFE_INTEGER,MAX_DOUBLE:Number.MAX_SAFE_INTEGER,DEGTORAD:.0174532925,RADTODEG:57.295779513,unglobalizeObjectId(e,t){const i=t.indexOf("#");return i===e.length&&t.startsWith(e)?t.substring(i+1):t},globalizeObjectId:(e,t)=>e+"#"+t,vec2:e=>new r(e||2),vec3:e=>new r(e||3),vec4:e=>new r(e||4),mat3:e=>new r(e||9),mat3ToMat4:(e,t=new r(16))=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t),mat4:e=>new r(e||16),mat4ToMat3(e,t){},doublesToFloats(e,t,i){const r=new Float32Array(2);for(let n=0,o=e.length;n<o;n++)a.splitDouble(e[n],r),t[n]=r[0],i[n]=r[1]},splitDouble(e,t){const i=Float32Array.from([e])[0],r=e-i;t[0]=i,t[1]=r},createUUID:(()=>{const e=[];for(let t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return()=>{const t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return`${e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]}-${e[255&i]}${e[i>>8&255]}-${e[i>>16&15|64]}${e[i>>24&255]}-${e[63&r|128]}${e[r>>8&255]}-${e[r>>16&255]}${e[r>>24&255]}${e[255&n]}${e[n>>8&255]}${e[n>>16&255]}${e[n>>24&255]}`}})(),clamp:(e,t,i)=>Math.max(t,Math.min(i,e)),fmod(e,t){if(e<t)return console.error("math.fmod : Attempting to find modulus within negative range - would be infinite loop - ignoring"),e;for(;t<=e;)e-=t;return e},compareVec3:(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2],negateVec3:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t),negateVec4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t),addVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i),addVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i[3]=e[3]+t,i),addVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i),addVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i),subVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i),subVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i),subVec2:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i),geometricMeanVec2(...e){const t=new r(e[0]);for(let i=1;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1];return t[0]/=e.length,t[1]/=e.length,t},subVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]-t,i[1]=e[1]-t,i[2]=e[2]-t,i[3]=e[3]-t,i),subScalarVec4:(e,t,i)=>(i||(i=e),i[0]=t-e[0],i[1]=t-e[1],i[2]=t-e[2],i[3]=t-e[3],i),mulVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i),mulVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i),mulVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i),mulVec2Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i),divVec3:(e,t,i)=>(i||(i=e),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i),divVec4:(e,t,i)=>(i||(i=e),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i),divScalarVec3:(e,t,i)=>(i||(i=t),i[0]=e/t[0],i[1]=e/t[1],i[2]=e/t[2],i),divVec3Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]/t,i[1]=e[1]/t,i[2]=e[2]/t,i),divVec4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]/t,i[1]=e[1]/t,i[2]=e[2]/t,i[3]=e[3]/t,i),divScalarVec4:(e,t,i)=>(i||(i=t),i[0]=e/t[0],i[1]=e/t[1],i[2]=e/t[2],i[3]=e/t[3],i),dotVec4:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],cross3Vec4(e,t){const i=e[0],r=e[1],n=e[2],o=t[0],s=t[1],a=t[2];return[r*a-n*s,n*o-i*a,i*s-r*o,0]},cross3Vec3(e,t,i){i||(i=e);const r=e[0],n=e[1],o=e[2],s=t[0],a=t[1],l=t[2];return i[0]=n*l-o*a,i[1]=o*s-r*l,i[2]=r*a-n*s,i},sqLenVec4:e=>a.dotVec4(e,e),lenVec4:e=>Math.sqrt(a.sqLenVec4(e)),dotVec3:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2],dotVec2:(e,t)=>e[0]*t[0]+e[1]*t[1],sqLenVec3:e=>a.dotVec3(e,e),sqLenVec2:e=>a.dotVec2(e,e),lenVec3:e=>Math.sqrt(a.sqLenVec3(e)),distVec3:(()=>{const e=new r(3);return(t,i)=>a.lenVec3(a.subVec3(t,i,e))})(),lenVec2:e=>Math.sqrt(a.sqLenVec2(e)),distVec2:(()=>{const e=new r(2);return(t,i)=>a.lenVec2(a.subVec2(t,i,e))})(),rcpVec3:(e,t)=>a.divScalarVec3(1,e,t),normalizeVec4(e,t){const i=1/a.lenVec4(e);return a.mulVec4Scalar(e,i,t)},normalizeVec3(e,t){const i=1/a.lenVec3(e);return a.mulVec3Scalar(e,i,t)},normalizeVec2(e,t){const i=1/a.lenVec2(e);return a.mulVec2Scalar(e,i,t)},angleVec3(e,t){let i=a.dotVec3(e,t)/Math.sqrt(a.sqLenVec3(e)*a.sqLenVec3(t));return i=i<-1?-1:i>1?1:i,Math.acos(i)},vec3FromMat4Scale:(()=>{const e=new r(3);return(t,i)=>(e[0]=t[0],e[1]=t[1],e[2]=t[2],i[0]=a.lenVec3(e),e[0]=t[4],e[1]=t[5],e[2]=t[6],i[1]=a.lenVec3(e),e[0]=t[8],e[1]=t[9],e[2]=t[10],i[2]=a.lenVec3(e),i)})(),vecToArray:(()=>{function e(e){return Math.round(1e5*e)/1e5}return t=>{for(let i=0,r=(t=Array.prototype.slice.call(t)).length;i<r;i++)t[i]=e(t[i]);return t}})(),xyzArrayToObject:e=>({x:e[0],y:e[1],z:e[2]}),xyzObjectToArray:(e,t)=>((t=t||new r(3))[0]=e.x,t[1]=e.y,t[2]=e.z,t),dupMat4:e=>e.slice(0,16),mat4To3:e=>[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]],m4s:e=>[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],setMat4ToZeroes:()=>a.m4s(0),setMat4ToOnes:()=>a.m4s(1),diagonalMat4v:e=>new r([e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,e[3]]),diagonalMat4c:(e,t,i,r)=>a.diagonalMat4v([e,t,i,r]),diagonalMat4s:e=>a.diagonalMat4c(e,e,e,e),identityMat4:(e=new r(16))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e),identityMat3:(e=new r(9))=>(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e),isIdentityMat4:e=>1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15],negateMat4:(e,t)=>(t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t),addMat4:(e,t,i)=>(i||(i=e),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i),addMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t,i[3]=e[3]+t,i[4]=e[4]+t,i[5]=e[5]+t,i[6]=e[6]+t,i[7]=e[7]+t,i[8]=e[8]+t,i[9]=e[9]+t,i[10]=e[10]+t,i[11]=e[11]+t,i[12]=e[12]+t,i[13]=e[13]+t,i[14]=e[14]+t,i[15]=e[15]+t,i),addScalarMat4:(e,t,i)=>a.addMat4Scalar(t,e,i),subMat4:(e,t,i)=>(i||(i=e),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i),subMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]-t,i[1]=e[1]-t,i[2]=e[2]-t,i[3]=e[3]-t,i[4]=e[4]-t,i[5]=e[5]-t,i[6]=e[6]-t,i[7]=e[7]-t,i[8]=e[8]-t,i[9]=e[9]-t,i[10]=e[10]-t,i[11]=e[11]-t,i[12]=e[12]-t,i[13]=e[13]-t,i[14]=e[14]-t,i[15]=e[15]-t,i),subScalarMat4:(e,t,i)=>(i||(i=t),i[0]=e-t[0],i[1]=e-t[1],i[2]=e-t[2],i[3]=e-t[3],i[4]=e-t[4],i[5]=e-t[5],i[6]=e-t[6],i[7]=e-t[7],i[8]=e-t[8],i[9]=e-t[9],i[10]=e-t[10],i[11]=e-t[11],i[12]=e-t[12],i[13]=e-t[13],i[14]=e-t[14],i[15]=e-t[15],i),mulMat4(e,t,i){i||(i=e);const r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],b=e[15],_=t[0],y=t[1],x=t[2],w=t[3],M=t[4],P=t[5],E=t[6],S=t[7],C=t[8],k=t[9],O=t[10],A=t[11],T=t[12],D=t[13],R=t[14],L=t[15];return i[0]=_*r+y*a+x*h+w*m,i[1]=_*n+y*l+x*d+w*g,i[2]=_*o+y*c+x*p+w*v,i[3]=_*s+y*u+x*f+w*b,i[4]=M*r+P*a+E*h+S*m,i[5]=M*n+P*l+E*d+S*g,i[6]=M*o+P*c+E*p+S*v,i[7]=M*s+P*u+E*f+S*b,i[8]=C*r+k*a+O*h+A*m,i[9]=C*n+k*l+O*d+A*g,i[10]=C*o+k*c+O*p+A*v,i[11]=C*s+k*u+O*f+A*b,i[12]=T*r+D*a+R*h+L*m,i[13]=T*n+D*l+R*d+L*g,i[14]=T*o+D*c+R*p+L*v,i[15]=T*s+D*u+R*f+L*b,i},mulMat3(e,t,i){i||(i=new r(9));const n=e[0],o=e[3],s=e[6],a=e[1],l=e[4],c=e[7],u=e[2],h=e[5],d=e[8],p=t[0],f=t[3],m=t[6],g=t[1],v=t[4],b=t[7],_=t[2],y=t[5],x=t[8];return i[0]=n*p+o*g+s*_,i[3]=n*f+o*v+s*y,i[6]=n*m+o*b+s*x,i[1]=a*p+l*g+c*_,i[4]=a*f+l*v+c*y,i[7]=a*m+l*b+c*x,i[2]=u*p+h*g+d*_,i[5]=u*f+h*v+d*y,i[8]=u*m+h*b+d*x,i},mulMat4Scalar:(e,t,i)=>(i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i),mulMat4v4(e,t,i=a.vec4()){const r=t[0],n=t[1],o=t[2],s=t[3];return i[0]=e[0]*r+e[4]*n+e[8]*o+e[12]*s,i[1]=e[1]*r+e[5]*n+e[9]*o+e[13]*s,i[2]=e[2]*r+e[6]*n+e[10]*o+e[14]*s,i[3]=e[3]*r+e[7]*n+e[11]*o+e[15]*s,i},transposeMat4(e,t){const i=e[4],r=e[14],n=e[8],o=e[13],s=e[12],a=e[9];if(!t||e===t){const t=e[1],l=e[2],c=e[3],u=e[6],h=e[7],d=e[11];return e[1]=i,e[2]=n,e[3]=s,e[4]=t,e[6]=a,e[7]=o,e[8]=l,e[9]=u,e[11]=r,e[12]=c,e[13]=h,e[14]=d,e}return t[0]=e[0],t[1]=i,t[2]=n,t[3]=s,t[4]=e[1],t[5]=e[5],t[6]=a,t[7]=o,t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=r,t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},transposeMat3(e,t){if(t===e){const i=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},determinantMat4(e){const t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15];return p*u*a*n-c*f*a*n-p*s*h*n+o*f*h*n+c*s*m*n-o*u*m*n-p*u*r*l+c*f*r*l+p*i*h*l-t*f*h*l-c*i*m*l+t*u*m*l+p*s*r*d-o*f*r*d-p*i*a*d+t*f*a*d+o*i*m*d-t*s*m*d-c*s*r*g+o*u*r*g+c*i*a*g-t*u*a*g-o*i*h*g+t*s*h*g},inverseMat4(e,t){t||(t=e);const i=e[0],r=e[1],n=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=e[15],b=i*a-r*s,_=i*l-n*s,y=i*c-o*s,x=r*l-n*a,w=r*c-o*a,M=n*c-o*l,P=u*m-h*f,E=u*g-d*f,S=u*v-p*f,C=h*g-d*m,k=h*v-p*m,O=d*v-p*g,A=1/(b*O-_*k+y*C+x*S-w*E+M*P);return t[0]=(a*O-l*k+c*C)*A,t[1]=(-r*O+n*k-o*C)*A,t[2]=(m*M-g*w+v*x)*A,t[3]=(-h*M+d*w-p*x)*A,t[4]=(-s*O+l*S-c*E)*A,t[5]=(i*O-n*S+o*E)*A,t[6]=(-f*M+g*y-v*_)*A,t[7]=(u*M-d*y+p*_)*A,t[8]=(s*k-a*S+c*P)*A,t[9]=(-i*k+r*S-o*P)*A,t[10]=(f*w-m*y+v*b)*A,t[11]=(-u*w+h*y-p*b)*A,t[12]=(-s*C+a*E-l*P)*A,t[13]=(i*C-r*E+n*P)*A,t[14]=(-f*x+m*_-g*b)*A,t[15]=(u*x-h*_+d*b)*A,t},traceMat4:e=>e[0]+e[5]+e[10]+e[15],translationMat4v(e,t){const i=t||a.identityMat4();return i[12]=e[0],i[13]=e[1],i[14]=e[2],i},translationMat3v(e,t){const i=t||a.identityMat3();return i[6]=e[0],i[7]=e[1],i},translationMat4c:(()=>{const e=new r(3);return(t,i,r,n)=>(e[0]=t,e[1]=i,e[2]=r,a.translationMat4v(e,n))})(),translationMat4s:(e,t)=>a.translationMat4c(e,e,e,t),translateMat4v:(e,t)=>a.translateMat4c(e[0],e[1],e[2],t),OLDtranslateMat4c(e,t,i,r){const n=r[12];r[0]+=n*e,r[4]+=n*t,r[8]+=n*i;const o=r[13];r[1]+=o*e,r[5]+=o*t,r[9]+=o*i;const s=r[14];r[2]+=s*e,r[6]+=s*t,r[10]+=s*i;const a=r[15];return r[3]+=a*e,r[7]+=a*t,r[11]+=a*i,r},translateMat4c(e,t,i,r){const n=r[3];r[0]+=n*e,r[1]+=n*t,r[2]+=n*i;const o=r[7];r[4]+=o*e,r[5]+=o*t,r[6]+=o*i;const s=r[11];r[8]+=s*e,r[9]+=s*t,r[10]+=s*i;const a=r[15];return r[12]+=a*e,r[13]+=a*t,r[14]+=a*i,r},setMat4Translation:(e,t,i)=>(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=e[15],i),rotationMat4v(e,t,i){const r=a.normalizeVec4([t[0],t[1],t[2],0],[]),n=Math.sin(e),o=Math.cos(e),s=1-o,l=r[0],c=r[1],u=r[2];let h,d,p,f,m,g;return h=l*c,d=c*u,p=u*l,f=l*n,m=c*n,g=u*n,(i=i||a.mat4())[0]=s*l*l+o,i[1]=s*h+g,i[2]=s*p-m,i[3]=0,i[4]=s*h-g,i[5]=s*c*c+o,i[6]=s*d+f,i[7]=0,i[8]=s*p+m,i[9]=s*d-f,i[10]=s*u*u+o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},rotationMat4c:(e,t,i,r,n)=>a.rotationMat4v(e,[t,i,r],n),scalingMat4v:(e,t=a.identityMat4())=>(t[0]=e[0],t[5]=e[1],t[10]=e[2],t),scalingMat3v:(e,t=a.identityMat3())=>(t[0]=e[0],t[4]=e[1],t),scalingMat4c:(()=>{const e=new r(3);return(t,i,r,n)=>(e[0]=t,e[1]=i,e[2]=r,a.scalingMat4v(e,n))})(),scaleMat4c:(e,t,i,r)=>(r[0]*=e,r[4]*=t,r[8]*=i,r[1]*=e,r[5]*=t,r[9]*=i,r[2]*=e,r[6]*=t,r[10]*=i,r[3]*=e,r[7]*=t,r[11]*=i,r),scaleMat4v(e,t){const i=e[0],r=e[1],n=e[2];return t[0]*=i,t[4]*=r,t[8]*=n,t[1]*=i,t[5]*=r,t[9]*=n,t[2]*=i,t[6]*=r,t[10]*=n,t[3]*=i,t[7]*=r,t[11]*=n,t},scalingMat4s:e=>a.scalingMat4c(e,e,e),rotationTranslationMat4(e,t,i=a.mat4()){const r=e[0],n=e[1],o=e[2],s=e[3],l=r+r,c=n+n,u=o+o,h=r*l,d=r*c,p=r*u,f=n*c,m=n*u,g=o*u,v=s*l,b=s*c,_=s*u;return i[0]=1-(f+g),i[1]=d+_,i[2]=p-b,i[3]=0,i[4]=d-_,i[5]=1-(h+g),i[6]=m+v,i[7]=0,i[8]=p+b,i[9]=m-v,i[10]=1-(h+f),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i},mat4ToEuler(e,t,i=a.vec4()){const r=a.clamp,n=e[0],o=e[4],s=e[8],l=e[1],c=e[5],u=e[9],h=e[2],d=e[6],p=e[10];return"XYZ"===t?(i[1]=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(i[0]=Math.atan2(-u,p),i[2]=Math.atan2(-o,n)):(i[0]=Math.atan2(d,c),i[2]=0)):"YXZ"===t?(i[0]=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(i[1]=Math.atan2(s,p),i[2]=Math.atan2(l,c)):(i[1]=Math.atan2(-h,n),i[2]=0)):"ZXY"===t?(i[0]=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(i[1]=Math.atan2(-h,p),i[2]=Math.atan2(-o,c)):(i[1]=0,i[2]=Math.atan2(l,n))):"ZYX"===t?(i[1]=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(i[0]=Math.atan2(d,p),i[2]=Math.atan2(l,n)):(i[0]=0,i[2]=Math.atan2(-o,c))):"YZX"===t?(i[2]=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(i[0]=Math.atan2(-u,c),i[1]=Math.atan2(-h,n)):(i[0]=0,i[1]=Math.atan2(s,p))):"XZY"===t&&(i[2]=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(i[0]=Math.atan2(d,c),i[1]=Math.atan2(s,n)):(i[0]=Math.atan2(-u,p),i[1]=0)),i},composeMat4:(e,t,i,r=a.mat4())=>(a.quaternionToRotationMat4(t,r),a.scaleMat4v(i,r),a.translateMat4v(e,r),r),decomposeMat4:(()=>{const e=new r(3),t=new r(16);return function(i,r,n,o){e[0]=i[0],e[1]=i[1],e[2]=i[2];let s=a.lenVec3(e);e[0]=i[4],e[1]=i[5],e[2]=i[6];const l=a.lenVec3(e);e[8]=i[8],e[9]=i[9],e[10]=i[10];const c=a.lenVec3(e);a.determinantMat4(i)<0&&(s=-s),r[0]=i[12],r[1]=i[13],r[2]=i[14],t.set(i);const u=1/s,h=1/l,d=1/c;return t[0]*=u,t[1]*=u,t[2]*=u,t[4]*=h,t[5]*=h,t[6]*=h,t[8]*=d,t[9]*=d,t[10]*=d,a.mat4ToQuaternion(t,n),o[0]=s,o[1]=l,o[2]=c,this}})(),getColMat4(e,t){const i=4*t;return[e[i],e[i+1],e[i+2],e[i+3]]},setRowMat4(e,t,i){e[t]=i[0],e[t+4]=i[1],e[t+8]=i[2],e[t+12]=i[3]},lookAtMat4v(e,t,i,r){r||(r=a.mat4());const n=e[0],o=e[1],s=e[2],l=i[0],c=i[1],u=i[2],h=t[0],d=t[1],p=t[2];if(n===h&&o===d&&s===p)return a.identityMat4();let f,m,g,v,b,_,y,x,w,M;return f=n-h,m=o-d,g=s-p,v=c*(g*=M=1/Math.sqrt(f*f+m*m+g*g))-u*(m*=M),b=u*(f*=M)-l*g,_=l*m-c*f,(M=Math.sqrt(v*v+b*b+_*_))?(v*=M=1/M,b*=M,_*=M):(v=0,b=0,_=0),y=m*_-g*b,x=g*v-f*_,w=f*b-m*v,(M=Math.sqrt(y*y+x*x+w*w))?(y*=M=1/M,x*=M,w*=M):(y=0,x=0,w=0),r[0]=v,r[1]=y,r[2]=f,r[3]=0,r[4]=b,r[5]=x,r[6]=m,r[7]=0,r[8]=_,r[9]=w,r[10]=g,r[11]=0,r[12]=-(v*n+b*o+_*s),r[13]=-(y*n+x*o+w*s),r[14]=-(f*n+m*o+g*s),r[15]=1,r},lookAtMat4c:(e,t,i,r,n,o,s,l,c)=>a.lookAtMat4v([e,t,i],[r,n,o],[s,l,c],[]),orthoMat4c(e,t,i,r,n,o,s){s||(s=a.mat4());const l=t-e,c=r-i,u=o-n;return s[0]=2/l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/u,s[11]=0,s[12]=-(e+t)/l,s[13]=-(r+i)/c,s[14]=-(o+n)/u,s[15]=1,s},frustumMat4v(e,t,i){i||(i=a.mat4());const r=[e[0],e[1],e[2],0],s=[t[0],t[1],t[2],0];a.addVec4(s,r,n),a.subVec4(s,r,o);const l=2*r[2],c=o[0],u=o[1],h=o[2];return i[0]=l/c,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=l/u,i[6]=0,i[7]=0,i[8]=n[0]/c,i[9]=n[1]/u,i[10]=-n[2]/h,i[11]=-1,i[12]=0,i[13]=0,i[14]=-l*s[2]/h,i[15]=0,i},frustumMat4(e,t,i,r,n,o,s){s||(s=a.mat4());const l=t-e,c=r-i,u=o-n;return s[0]=2*n/l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*n/c,s[6]=0,s[7]=0,s[8]=(t+e)/l,s[9]=(r+i)/c,s[10]=-(o+n)/u,s[11]=-1,s[12]=0,s[13]=0,s[14]=-o*n*2/u,s[15]=0,s},perspectiveMat4(e,t,i,r,n){const o=[],s=[];return o[2]=i,s[2]=r,s[1]=o[2]*Math.tan(e/2),o[1]=-s[1],s[0]=s[1]*t,o[0]=-s[0],a.frustumMat4v(o,s,n)},compareMat4:(e,t)=>e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15],transformPoint3(e,t,i=a.vec3()){const r=t[0],n=t[1],o=t[2];return i[0]=e[0]*r+e[4]*n+e[8]*o+e[12],i[1]=e[1]*r+e[5]*n+e[9]*o+e[13],i[2]=e[2]*r+e[6]*n+e[10]*o+e[14],i},transformPoint4:(e,t,i=a.vec4())=>(i[0]=e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],i[1]=e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],i[2]=e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],i[3]=e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],i),transformPoints3(e,t,i){const r=i||[],n=t.length;let o,s,a,l;const c=e[0],u=e[1],h=e[2],d=e[3],p=e[4],f=e[5],m=e[6],g=e[7],v=e[8],b=e[9],_=e[10],y=e[11],x=e[12],w=e[13],M=e[14],P=e[15];let E;for(let e=0;e<n;++e)o=(l=t[e])[0],s=l[1],a=l[2],(E=r[e]||(r[e]=[0,0,0]))[0]=c*o+p*s+v*a+x,E[1]=u*o+f*s+b*a+w,E[2]=h*o+m*s+_*a+M,E[3]=d*o+g*s+y*a+P;return r.length=n,r},transformPositions3(e,t,i=t){let r;const n=t.length;let o,s,a;const l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],p=e[5],f=e[6],m=e[7],g=e[8],v=e[9],b=e[10],_=e[11],y=e[12],x=e[13],w=e[14],M=e[15];for(r=0;r<n;r+=3)o=t[r+0],s=t[r+1],a=t[r+2],i[r+0]=l*o+d*s+g*a+y,i[r+1]=c*o+p*s+v*a+x,i[r+2]=u*o+f*s+b*a+w,i[r+3]=h*o+m*s+_*a+M;return i},transformPositions4(e,t,i=t){let r;const n=t.length;let o,s,a;const l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],p=e[5],f=e[6],m=e[7],g=e[8],v=e[9],b=e[10],_=e[11],y=e[12],x=e[13],w=e[14],M=e[15];for(r=0;r<n;r+=4)o=t[r+0],s=t[r+1],a=t[r+2],i[r+0]=l*o+d*s+g*a+y,i[r+1]=c*o+p*s+v*a+x,i[r+2]=u*o+f*s+b*a+w,i[r+3]=h*o+m*s+_*a+M;return i},transformVec3(e,t,i){const r=t[0],n=t[1],o=t[2];return(i=i||this.vec3())[0]=e[0]*r+e[4]*n+e[8]*o,i[1]=e[1]*r+e[5]*n+e[9]*o,i[2]=e[2]*r+e[6]*n+e[10]*o,i},transformVec4(e,t,i){const r=t[0],n=t[1],o=t[2],s=t[3];return(i=i||a.vec4())[0]=e[0]*r+e[4]*n+e[8]*o+e[12]*s,i[1]=e[1]*r+e[5]*n+e[9]*o+e[13]*s,i[2]=e[2]*r+e[6]*n+e[10]*o+e[14]*s,i[3]=e[3]*r+e[7]*n+e[11]*o+e[15]*s,i},rotateVec3X(e,t,i,r){const n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[0],o[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),o[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},rotateVec3Y(e,t,i,r){const n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},rotateVec3Z(e,t,i,r){const n=[],o=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],o[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),o[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),o[2]=n[2],r[0]=o[0]+t[0],r[1]=o[1]+t[1],r[2]=o[2]+t[2],r},projectVec4(e,t){const i=1/e[3];return(t=t||a.vec2())[0]=e[0]*i,t[1]=e[1]*i,t},unprojectVec3:(()=>{const e=new r(16),t=new r(16),i=new r(16);return function(r,n,o,s){return this.transformVec3(this.mulMat4(this.inverseMat4(n,e),this.inverseMat4(o,t),i),r,s)}})(),lerpVec3(e,t,i,r,n,o){const s=o||a.vec3(),l=(e-t)/(i-t);return s[0]=r[0]+l*(n[0]-r[0]),s[1]=r[1]+l*(n[1]-r[1]),s[2]=r[2]+l*(n[2]-r[2]),s},lerpMat4(e,t,i,r,n,o){const s=o||a.mat4(),l=(e-t)/(i-t);return s[0]=r[0]+l*(n[0]-r[0]),s[1]=r[1]+l*(n[1]-r[1]),s[2]=r[2]+l*(n[2]-r[2]),s[3]=r[3]+l*(n[3]-r[3]),s[4]=r[4]+l*(n[4]-r[4]),s[5]=r[5]+l*(n[5]-r[5]),s[6]=r[6]+l*(n[6]-r[6]),s[7]=r[7]+l*(n[7]-r[7]),s[8]=r[8]+l*(n[8]-r[8]),s[9]=r[9]+l*(n[9]-r[9]),s[10]=r[10]+l*(n[10]-r[10]),s[11]=r[11]+l*(n[11]-r[11]),s[12]=r[12]+l*(n[12]-r[12]),s[13]=r[13]+l*(n[13]-r[13]),s[14]=r[14]+l*(n[14]-r[14]),s[15]=r[15]+l*(n[15]-r[15]),s},flatten(e){const t=[];let i,r,n,o,s;for(i=0,r=e.length;i<r;i++)for(n=0,o=(s=e[i]).length;n<o;n++)t.push(s[n]);return t},identityQuaternion:(e=a.vec4())=>(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e),eulerToQuaternion(e,t,i=a.vec4()){const r=e[0]*a.DEGTORAD/2,n=e[1]*a.DEGTORAD/2,o=e[2]*a.DEGTORAD/2,s=Math.cos(r),l=Math.cos(n),c=Math.cos(o),u=Math.sin(r),h=Math.sin(n),d=Math.sin(o);return"XYZ"===t?(i[0]=u*l*c+s*h*d,i[1]=s*h*c-u*l*d,i[2]=s*l*d+u*h*c,i[3]=s*l*c-u*h*d):"YXZ"===t?(i[0]=u*l*c+s*h*d,i[1]=s*h*c-u*l*d,i[2]=s*l*d-u*h*c,i[3]=s*l*c+u*h*d):"ZXY"===t?(i[0]=u*l*c-s*h*d,i[1]=s*h*c+u*l*d,i[2]=s*l*d+u*h*c,i[3]=s*l*c-u*h*d):"ZYX"===t?(i[0]=u*l*c-s*h*d,i[1]=s*h*c+u*l*d,i[2]=s*l*d-u*h*c,i[3]=s*l*c+u*h*d):"YZX"===t?(i[0]=u*l*c+s*h*d,i[1]=s*h*c+u*l*d,i[2]=s*l*d-u*h*c,i[3]=s*l*c-u*h*d):"XZY"===t&&(i[0]=u*l*c-s*h*d,i[1]=s*h*c-u*l*d,i[2]=s*l*d+u*h*c,i[3]=s*l*c+u*h*d),i},mat4ToQuaternion(e,t=a.vec4()){const i=e[0],r=e[4],n=e[8],o=e[1],s=e[5],l=e[9],c=e[2],u=e[6],h=e[10];let d;const p=i+s+h;return p>0?(d=.5/Math.sqrt(p+1),t[3]=.25/d,t[0]=(u-l)*d,t[1]=(n-c)*d,t[2]=(o-r)*d):i>s&&i>h?(d=2*Math.sqrt(1+i-s-h),t[3]=(u-l)/d,t[0]=.25*d,t[1]=(r+o)/d,t[2]=(n+c)/d):s>h?(d=2*Math.sqrt(1+s-i-h),t[3]=(n-c)/d,t[0]=(r+o)/d,t[1]=.25*d,t[2]=(l+u)/d):(d=2*Math.sqrt(1+h-i-s),t[3]=(o-r)/d,t[0]=(n+c)/d,t[1]=(l+u)/d,t[2]=.25*d),t},vec3PairToQuaternion(e,t,i=a.vec4()){const r=Math.sqrt(a.dotVec3(e,e)*a.dotVec3(t,t));let n=r+a.dotVec3(e,t);return n<1e-8*r?(n=0,Math.abs(e[0])>Math.abs(e[2])?(i[0]=-e[1],i[1]=e[0],i[2]=0):(i[0]=0,i[1]=-e[2],i[2]=e[1])):a.cross3Vec3(e,t,i),i[3]=n,a.normalizeQuaternion(i)},angleAxisToQuaternion(e,t=a.vec4()){const i=e[3]/2,r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t},quaternionToEuler:(()=>{const e=new r(16);return(t,i,r)=>(r=r||a.vec3(),a.quaternionToRotationMat4(t,e),a.mat4ToEuler(e,i,r),r)})(),mulQuaternions(e,t,i=a.vec4()){const r=e[0],n=e[1],o=e[2],s=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return i[0]=s*l+r*h+n*u-o*c,i[1]=s*c+n*h+o*l-r*u,i[2]=s*u+o*h+r*c-n*l,i[3]=s*h-r*l-n*c-o*u,i},vec3ApplyQuaternion(e,t,i=a.vec3()){const r=t[0],n=t[1],o=t[2],s=e[0],l=e[1],c=e[2],u=e[3],h=u*r+l*o-c*n,d=u*n+c*r-s*o,p=u*o+s*n-l*r,f=-s*r-l*n-c*o;return i[0]=h*u+f*-s+d*-c-p*-l,i[1]=d*u+f*-l+p*-s-h*-c,i[2]=p*u+f*-c+h*-l-d*-s,i},quaternionToMat4(e,t){t=a.identityMat4(t);const i=e[0],r=e[1],n=e[2],o=e[3],s=2*i,l=2*r,c=2*n,u=s*o,h=l*o,d=c*o,p=s*i,f=l*i,m=c*i,g=l*r,v=c*r,b=c*n;return t[0]=1-(g+b),t[1]=f+d,t[2]=m-h,t[4]=f-d,t[5]=1-(p+b),t[6]=v+u,t[8]=m+h,t[9]=v-u,t[10]=1-(p+g),t},quaternionToRotationMat4(e,t){const i=e[0],r=e[1],n=e[2],o=e[3],s=i+i,a=r+r,l=n+n,c=i*s,u=i*a,h=i*l,d=r*a,p=r*l,f=n*l,m=o*s,g=o*a,v=o*l;return t[0]=1-(d+f),t[4]=u-v,t[8]=h+g,t[1]=u+v,t[5]=1-(c+f),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},normalizeQuaternion(e,t=e){const i=a.lenVec4([e[0],e[1],e[2],e[3]]);return t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i,t[3]=e[3]/i,t},conjugateQuaternion:(e,t=e)=>(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t),inverseQuaternion:(e,t)=>a.normalizeQuaternion(a.conjugateQuaternion(e,t)),quaternionToAngleAxis(e,t=a.vec4()){const i=(e=a.normalizeQuaternion(e,s))[3],r=2*Math.acos(i),n=Math.sqrt(1-i*i);return n<.001?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n),t[3]=r,t},AABB3:e=>new r(e||6),AABB2:e=>new r(e||4),OBB3:e=>new r(e||32),OBB2:e=>new r(e||16),Sphere3:(e,t,i,n)=>new r([e,t,i,n]),transformOBB3(e,t,i=t){let r;const n=t.length;let o,s,a;const l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],p=e[5],f=e[6],m=e[7],g=e[8],v=e[9],b=e[10],_=e[11],y=e[12],x=e[13],w=e[14],M=e[15];for(r=0;r<n;r+=4)o=t[r+0],s=t[r+1],a=t[r+2],i[r+0]=l*o+d*s+g*a+y,i[r+1]=c*o+p*s+v*a+x,i[r+2]=u*o+f*s+b*a+w,i[r+3]=h*o+m*s+_*a+M;return i},containsAABB3:function(e,t){return e[0]<=t[0]&&t[3]<=e[3]&&e[1]<=t[1]&&t[4]<=e[4]&&e[2]<=t[2]&&t[5]<=e[5]},getAABB3Diag:(()=>{const e=new r(3),t=new r(3),i=new r(3);return r=>(e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5],a.subVec3(t,e,i),Math.abs(a.lenVec3(i)))})(),getAABB3DiagPoint:(()=>{const e=new r(3),t=new r(3),i=new r(3);return(r,n)=>{e[0]=r[0],e[1]=r[1],e[2]=r[2],t[0]=r[3],t[1]=r[4],t[2]=r[5];const o=a.subVec3(t,e,i),s=n[0]-r[0],l=r[3]-n[0],c=n[1]-r[1],u=r[4]-n[1],h=n[2]-r[2],d=r[5]-n[2];return o[0]+=s>l?s:l,o[1]+=c>u?c:u,o[2]+=h>d?h:d,Math.abs(a.lenVec3(o))}})(),getAABB3Area:e=>(e[3]-e[0])*(e[4]-e[1])*(e[5]-e[2]),getAABB3Center(e,t){const i=t||a.vec3();return i[0]=(e[0]+e[3])/2,i[1]=(e[1]+e[4])/2,i[2]=(e[2]+e[5])/2,i},getAABB2Center(e,t){const i=t||a.vec2();return i[0]=(e[2]+e[0])/2,i[1]=(e[3]+e[1])/2,i},collapseAABB3:(e=a.AABB3())=>(e[0]=a.MAX_DOUBLE,e[1]=a.MAX_DOUBLE,e[2]=a.MAX_DOUBLE,e[3]=a.MIN_DOUBLE,e[4]=a.MIN_DOUBLE,e[5]=a.MIN_DOUBLE,e),AABB3ToOBB3:(e,t=a.OBB3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=1,t[4]=e[3],t[5]=e[1],t[6]=e[2],t[7]=1,t[8]=e[3],t[9]=e[4],t[10]=e[2],t[11]=1,t[12]=e[0],t[13]=e[4],t[14]=e[2],t[15]=1,t[16]=e[0],t[17]=e[1],t[18]=e[5],t[19]=1,t[20]=e[3],t[21]=e[1],t[22]=e[5],t[23]=1,t[24]=e[3],t[25]=e[4],t[26]=e[5],t[27]=1,t[28]=e[0],t[29]=e[4],t[30]=e[5],t[31]=1,t),positions3ToAABB3:(()=>{const e=new Float32Array(3);return(t,i,r)=>{i=i||a.AABB3();let n,o,s,l=a.MAX_DOUBLE,c=a.MAX_DOUBLE,u=a.MAX_DOUBLE,h=a.MIN_DOUBLE,d=a.MIN_DOUBLE,p=a.MIN_DOUBLE;for(let i=0,f=t.length;i<f;i+=3)r?(e[0]=t[i+0],e[1]=t[i+1],e[2]=t[i+2],a.decompressPosition(e,r,e),n=e[0],o=e[1],s=e[2]):(n=t[i+0],o=t[i+1],s=t[i+2]),n<l&&(l=n),o<c&&(c=o),s<u&&(u=s),n>h&&(h=n),o>d&&(d=o),s>p&&(p=s);return i[0]=l,i[1]=c,i[2]=u,i[3]=h,i[4]=d,i[5]=p,i}})(),OBB3ToAABB3(e,t=a.AABB3()){let i,r,n,o=a.MAX_DOUBLE,s=a.MAX_DOUBLE,l=a.MAX_DOUBLE,c=a.MIN_DOUBLE,u=a.MIN_DOUBLE,h=a.MIN_DOUBLE;for(let t=0,a=e.length;t<a;t+=4)i=e[t+0],r=e[t+1],n=e[t+2],i<o&&(o=i),r<s&&(s=r),n<l&&(l=n),i>c&&(c=i),r>u&&(u=r),n>h&&(h=n);return t[0]=o,t[1]=s,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t},points3ToAABB3(e,t=a.AABB3()){let i,r,n,o=a.MAX_DOUBLE,s=a.MAX_DOUBLE,l=a.MAX_DOUBLE,c=a.MIN_DOUBLE,u=a.MIN_DOUBLE,h=a.MIN_DOUBLE;for(let t=0,a=e.length;t<a;t++)i=e[t][0],r=e[t][1],n=e[t][2],i<o&&(o=i),r<s&&(s=r),n<l&&(l=n),i>c&&(c=i),r>u&&(u=r),n>h&&(h=n);return t[0]=o,t[1]=s,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t},points3ToSphere3:(()=>{const e=new Float32Array(3);return(t,i)=>{i=i||a.vec4();let r,n=0,o=0,s=0;const l=t.length;for(r=0;r<l;r++)n+=t[r][0],o+=t[r][1],s+=t[r][2];i[0]=n/l,i[1]=o/l,i[2]=s/l;let c,u=0;for(r=0;r<l;r++)(c=Math.abs(a.lenVec3(a.subVec3(t[r],i,e))))>u&&(u=c);return i[3]=u,i}})(),positions3ToSphere3:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r)=>{r=r||a.vec4();let n,o=0,s=0,l=0;const c=i.length;let u=0;for(n=0;n<c;n+=3)o+=i[n],s+=i[n+1],l+=i[n+2];const h=c/3;let d;for(r[0]=o/h,r[1]=s/h,r[2]=l/h,n=0;n<c;n+=3)e[0]=i[n],e[1]=i[n+1],e[2]=i[n+2],(d=Math.abs(a.lenVec3(a.subVec3(e,r,t))))>u&&(u=d);return r[3]=u,r}})(),OBB3ToSphere3:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r)=>{r=r||a.vec4();let n,o=0,s=0,l=0;const c=i.length,u=c/4;for(n=0;n<c;n+=4)o+=i[n+0],s+=i[n+1],l+=i[n+2];r[0]=o/u,r[1]=s/u,r[2]=l/u;let h,d=0;for(n=0;n<c;n+=4)e[0]=i[n+0],e[1]=i[n+1],e[2]=i[n+2],(h=Math.abs(a.lenVec3(a.subVec3(e,r,t))))>d&&(d=h);return r[3]=d,r}})(),getSphere3Center:(e,t=a.vec3())=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t),expandAABB3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5]),e),expandAABB3Point3:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[0]&&(e[3]=t[0]),e[4]<t[1]&&(e[4]=t[1]),e[5]<t[2]&&(e[5]=t[2]),e),expandAABB3Points3(e,t){for(var i,r,n,o=0,s=t.length;o<s;o+=3)i=t[o],r=t[o+1],n=t[o+2],e[0]>i&&(e[0]=i),e[1]>r&&(e[1]=r),e[2]>n&&(e[2]=n),e[3]<i&&(e[3]=i),e[4]<r&&(e[4]=r),e[5]<n&&(e[5]=n);return e},collapseAABB2:(e=a.AABB2())=>(e[0]=a.MAX_DOUBLE,e[1]=a.MAX_DOUBLE,e[2]=a.MIN_DOUBLE,e[3]=a.MIN_DOUBLE,e),point3AABB3Intersect:(e,t)=>e[0]>t[0]||e[3]<t[0]||e[1]>t[1]||e[4]<t[1]||e[2]>t[2]||e[5]<t[2],planeAABB3Intersect(e,t,i){let r,n;return e[0]>0?(r=e[0]*i[0],n=e[0]*i[3]):(r=e[0]*i[3],n=e[0]*i[0]),e[1]>0?(r+=e[1]*i[1],n+=e[1]*i[4]):(r+=e[1]*i[4],n+=e[1]*i[1]),e[2]>0?(r+=e[2]*i[2],n+=e[2]*i[5]):(r+=e[2]*i[5],n+=e[2]*i[2]),r<=-t&&n<=-t?-1:r>=-t&&n>=-t?1:0},OBB3ToAABB2(e,t=a.AABB2()){let i,r,n,o,s=a.MAX_DOUBLE,l=a.MAX_DOUBLE,c=a.MIN_DOUBLE,u=a.MIN_DOUBLE;for(let t=0,a=e.length;t<a;t+=4)i=e[t+0],r=e[t+1],r*=o=1/(n=e[t+3]||1),(i*=o)<s&&(s=i),r<l&&(l=r),i>c&&(c=i),r>u&&(u=r);return t[0]=s,t[1]=l,t[2]=c,t[3]=u,t},expandAABB2:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e),expandAABB2Point2:(e,t)=>(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1]),e),AABB2ToCanvas(e,t,i,r=e){const n=.5*(e[0]+1),o=.5*(e[1]+1),s=.5*(e[2]+1),a=.5*(e[3]+1);return r[0]=Math.floor(n*t),r[1]=i-Math.floor(a*i),r[2]=Math.floor(s*t),r[3]=i-Math.floor(o*i),r},tangentQuadraticBezier:(e,t,i,r)=>2*(1-e)*(i-t)+2*e*(r-i),tangentQuadraticBezier3:(e,t,i,r,n)=>-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*n,tangentSpline:e=>6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e),catmullRomInterpolate(e,t,i,r,n){const o=.5*(i-e),s=.5*(r-t),a=n*n;return(2*t-2*i+o+s)*(n*a)+(-3*t+3*i-2*o-s)*a+o*n+t},b2p0(e,t){const i=1-e;return i*i*t},b2p1:(e,t)=>2*(1-e)*e*t,b2p2:(e,t)=>e*e*t,b2(e,t,i,r){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,r)},b3p0(e,t){const i=1-e;return i*i*i*t},b3p1(e,t){const i=1-e;return 3*i*i*e*t},b3p2:(e,t)=>3*(1-e)*e*e*t,b3p3:(e,t)=>e*e*e*t,b3(e,t,i,r,n){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,r)+this.b3p3(e,n)},triangleNormal(e,t,i,r=a.vec3()){const n=t[0]-e[0],o=t[1]-e[1],s=t[2]-e[2],l=i[0]-e[0],c=i[1]-e[1],u=i[2]-e[2],h=o*u-s*c,d=s*l-n*u,p=n*c-o*l,f=Math.sqrt(h*h+d*d+p*p);return 0===f?(r[0]=0,r[1]=0,r[2]=0):(r[0]=h/f,r[1]=d/f,r[2]=p/f),r},rayTriangleIntersect:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),n=new Float32Array(3);return(o,s,l,c,u,h)=>{h=h||a.vec3();const d=a.subVec3(c,l,e),p=a.subVec3(u,l,t),f=a.cross3Vec3(s,p,i),m=a.dotVec3(d,f);if(m<1e-6)return null;const g=a.subVec3(o,l,r),v=a.dotVec3(g,f);if(v<0||v>m)return null;const b=a.cross3Vec3(g,d,n),_=a.dotVec3(s,b);if(_<0||v+_>m)return null;const y=a.dotVec3(p,b)/m;return h[0]=o[0]+y*s[0],h[1]=o[1]+y*s[1],h[2]=o[2]+y*s[2],h}})(),rayPlaneIntersect:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3);return(n,o,s,l,c,u)=>{u=u||a.vec3(),o=a.normalizeVec3(o,e);const h=a.subVec3(l,s,t),d=a.subVec3(c,s,i),p=a.cross3Vec3(h,d,r);a.normalizeVec3(p,p);const f=-a.dotVec3(s,p),m=-(a.dotVec3(n,p)+f)/a.dotVec3(o,p);return u[0]=n[0]+m*o[0],u[1]=n[1]+m*o[1],u[2]=n[2]+m*o[2],u}})(),cartesianToBarycentric:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3);return(r,n,o,s,l)=>{const c=a.subVec3(s,n,e),u=a.subVec3(o,n,t),h=a.subVec3(r,n,i),d=a.dotVec3(c,c),p=a.dotVec3(c,u),f=a.dotVec3(c,h),m=a.dotVec3(u,u),g=a.dotVec3(u,h),v=d*m-p*p;if(0===v)return null;const b=1/v,_=(m*f-p*g)*b,y=(d*g-p*f)*b;return l[0]=1-_-y,l[1]=y,l[2]=_,l}})(),barycentricInsideTriangle(e){const t=e[1],i=e[2];return i>=0&&t>=0&&i+t<1},barycentricToCartesian(e,t,i,r,n=a.vec3()){const o=e[0],s=e[1],l=e[2];return n[0]=t[0]*o+i[0]*s+r[0]*l,n[1]=t[1]*o+i[1]*s+r[1]*l,n[2]=t[2]*o+i[2]*s+r[2]*l,n},mergeVertices(e,t,i,r){const n={},o=[],s=[],a=t?[]:null,l=i?[]:null,c=[];let u,h,d,p,f,m,g=0;for(f=0,m=e.length;f<m;f+=3)u=e[f],h=e[f+1],d=e[f+2],void 0===n[p=`${Math.round(1e4*u)}_${Math.round(1e4*h)}_${Math.round(1e4*d)}`]&&(n[p]=s.length/3,s.push(u),s.push(h),s.push(d),t&&(a.push(t[f]),a.push(t[f+1]),a.push(t[f+2])),i&&(l.push(i[g]),l.push(i[g+1]))),o[f/3]=n[p],g+=2;for(f=0,m=r.length;f<m;f++)c[f]=o[r[f]];const v={positions:s,indices:c};return a&&(v.normals=a),l&&(v.uv=l),v},buildNormals:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),n=new Float32Array(3),o=new Float32Array(3);return(s,l,c)=>{let u,h;const d=new Array(s.length/3);let p,f,m,g,v,b,_;for(u=0,h=l.length;u<h;u+=3){p=l[u],f=l[u+1],m=l[u+2],e[0]=s[3*p],e[1]=s[3*p+1],e[2]=s[3*p+2],t[0]=s[3*f],t[1]=s[3*f+1],t[2]=s[3*f+2],i[0]=s[3*m],i[1]=s[3*m+1],i[2]=s[3*m+2],a.subVec3(t,e,r),a.subVec3(i,e,n);const c=new Float32Array(3);a.normalizeVec3(a.cross3Vec3(r,n,o),c),d[p]||(d[p]=[]),d[f]||(d[f]=[]),d[m]||(d[m]=[]),d[p].push(c),d[f].push(c),d[m].push(c)}for(c=c&&c.length===s.length?c:new Float32Array(s.length),u=0,h=d.length;u<h;u++){g=d[u].length,v=0,b=0,_=0;for(let e=0;e<g;e++)v+=d[u][e][0],b+=d[u][e][1],_+=d[u][e][2];c[3*u]=v/g,c[3*u+1]=b/g,c[3*u+2]=_/g}return c}})(),buildTangents:(()=>{const e=new Float32Array(3),t=new Float32Array(3),i=new Float32Array(3),r=new Float32Array(3),n=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3);return(l,c,u)=>{const h=new Float32Array(l.length);for(let d=0;d<c.length;d+=3){let p=c[d];const f=l.subarray(3*p,3*p+3),m=u.subarray(2*p,2*p+2);p=c[d+1];const g=l.subarray(3*p,3*p+3),v=u.subarray(2*p,2*p+2);p=c[d+2];const b=l.subarray(3*p,3*p+3),_=u.subarray(2*p,2*p+2),y=a.subVec3(g,f,e),x=a.subVec3(b,f,t),w=a.subVec2(v,m,i),M=a.subVec2(_,m,r),P=1/(w[0]*M[1]-w[1]*M[0]),E=a.mulVec3Scalar(a.subVec3(a.mulVec3Scalar(y,M[1],n),a.mulVec3Scalar(x,w[1],o),s),P,o);let S;for(let e=0;e<3;e++)h[S=3*c[d+e]]+=E[0],h[S+1]+=E[1],h[S+2]+=E[2]}return h}})(),buildPickTriangles(e,t,i){const r=t.length,n=i?new Uint16Array(9*r):new Float32Array(9*r),o=new Uint8Array(12*r);let s,a,l,c,u,h,d=0,p=0,f=0;for(let i=0;i<r;i+=3)h=d>>24&255,u=d>>16&255,c=d>>8&255,l=255&d,s=3*(a=t[i]),n[p++]=e[s],n[p++]=e[s+1],n[p++]=e[s+2],o[f++]=l,o[f++]=c,o[f++]=u,o[f++]=h,s=3*(a=t[i+1]),n[p++]=e[s],n[p++]=e[s+1],n[p++]=e[s+2],o[f++]=l,o[f++]=c,o[f++]=u,o[f++]=h,s=3*(a=t[i+2]),n[p++]=e[s],n[p++]=e[s+1],n[p++]=e[s+2],o[f++]=l,o[f++]=c,o[f++]=u,o[f++]=h,d++;return{positions:n,colors:o}},faceToVertexNormals(e,t,i={}){const r=i.smoothNormalsAngleThreshold||20,n={},o=[],s={};let l,c,u,h,d,p,f,m,g,v,b;for(f=0,g=e.length;f<g;f+=3){p=f/3,c=e[f],u=e[f+1],h=e[f+2],void 0===n[d=`${Math.round(1e4*c)}_${Math.round(1e4*u)}_${Math.round(1e4*h)}`]?n[d]=[p]:n[d].push(p);const i=a.normalizeVec3([t[f],t[f+1],t[f+2]]);o[p]=i,l=a.vec4([i[0],i[1],i[2],1]),s[p]=l}for(d in n)if(n.hasOwnProperty(d)){const e=n[d],t=e.length;for(f=0;f<t;f++){const i=e[f];for(l=s[i],m=0;m<t;m++){if(f===m)continue;const t=e[m];v=o[i],b=o[t],Math.abs(a.angleVec3(v,b)/a.DEGTORAD)<r&&(l[0]+=b[0],l[1]+=b[1],l[2]+=b[2],l[3]+=1)}}}for(f=0,g=t.length;f<g;f+=3)l=s[f/3],t[f+0]=l[0]/l[3],t[f+1]=l[1]/l[3],t[f+2]=l[2]/l[3]},canvasPosToWorldRay:(()=>{const e=new Float32Array(16),t=new Float32Array(16),i=new Float32Array(4),r=new Float32Array(4),n=new Float32Array(4),o=new Float32Array(4);return(s,l,c,u,h,d)=>{const p=a.mulMat4(c,l,e),f=a.inverseMat4(p,t),m=s.width,g=s.height,v=(u[0]-m/2)/(m/2),b=-(u[1]-g/2)/(g/2);i[0]=v,i[1]=b,i[2]=-1,i[3]=1,a.transformVec4(f,i,r),a.mulVec4Scalar(r,1/r[3]),n[0]=v,n[1]=b,n[2]=1,n[3]=1,a.transformVec4(f,n,o),a.mulVec4Scalar(o,1/o[3]),h[0]=o[0],h[1]=o[1],h[2]=o[2],a.subVec3(o,r,d),a.normalizeVec3(d)}})(),canvasPosToLocalRay:(()=>{const e=new Float32Array(3),t=new Float32Array(3);return(i,r,n,o,s,l,c)=>{a.canvasPosToWorldRay(i,r,n,s,e,t),a.worldRayToLocalRay(o,e,t,l,c)}})(),worldRayToLocalRay:(()=>{const e=new Float32Array(16),t=new Float32Array(4),i=new Float32Array(4);return(r,n,o,s,l)=>{const c=a.inverseMat4(r,e);t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=1,a.transformVec4(c,t,i),s[0]=i[0],s[1]=i[1],s[2]=i[2],a.transformVec3(c,o,l)}})(),buildKDTree:(()=>{const e=new Float32Array;return(t,i)=>{const r=t.length/3,n=new Array(r);for(let e=0;e<r;++e)n[e]=e;return function t(i,r,n,o){const s=new Float32Array(6),a={triangles:null,left:null,right:null,leaf:!1,splitDim:0,aabb:s};let l,c;for(s[0]=s[1]=s[2]=Number.POSITIVE_INFINITY,s[3]=s[4]=s[5]=Number.NEGATIVE_INFINITY,l=0,c=i.length;l<c;++l){var u=3*i[l];for(let e=0;e<3;++e){const t=3*r[u+e];n[t]<s[0]&&(s[0]=n[t]),n[t]>s[3]&&(s[3]=n[t]),n[t+1]<s[1]&&(s[1]=n[t+1]),n[t+1]>s[4]&&(s[4]=n[t+1]),n[t+2]<s[2]&&(s[2]=n[t+2]),n[t+2]>s[5]&&(s[5]=n[t+2])}}if(i.length<20||o>10)return a.triangles=i,a.leaf=!0,a;e[0]=s[3]-s[0],e[1]=s[4]-s[1],e[2]=s[5]-s[2];let h=0;e[1]>e[h]&&(h=1),e[2]>e[h]&&(h=2),a.splitDim=h;const d=(s[h]+s[h+3])/2,p=new Array(i.length);let f=0;const m=new Array(i.length);let g=0;for(l=0,c=i.length;l<c;++l){const e=r[u=3*i[l]],t=3*r[u+1],o=3*r[u+2];n[3*e+h]<=d||n[t+h]<=d||n[o+h]<=d?p[f++]=i[l]:m[g++]=i[l]}return p.length=f,m.length=g,a.left=t(p,r,n,o+1),a.right=t(m,r,n,o+1),a}(n,t,i,0)}})(),decompressPosition(e,t,i){i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14]},decompressPositions(e,t,i=new Float32Array(e.length)){for(let r=0,n=e.length;r<n;r+=3)i[r+0]=e[r+0]*t[0]+t[12],i[r+1]=e[r+1]*t[5]+t[13],i[r+2]=e[r+2]*t[10]+t[14];return i},decompressUV(e,t,i){i[0]=e[0]*t[0]+t[6],i[1]=e[1]*t[4]+t[7]},decompressUVs(e,t,i=new Float32Array(e.length)){for(let r=0,n=e.length;r<n;r+=3)i[r+0]=e[r+0]*t[0]+t[6],i[r+1]=e[r+1]*t[4]+t[7];return i},octDecodeVec2(e,t){let i=e[0],r=e[1];i=(2*i+1)/255,r=(2*r+1)/255;const n=1-Math.abs(i)-Math.abs(r);n<0&&(i=(1-Math.abs(r))*(i>=0?1:-1),r=(1-Math.abs(i))*(r>=0?1:-1));const o=Math.sqrt(i*i+r*r+n*n);return t[0]=i/o,t[1]=r/o,t[2]=n/o,t},octDecodeVec2s(e,t){for(let i=0,r=0,n=e.length;i<n;i+=2){let n=e[i+0],o=e[i+1];n=(2*n+1)/255,o=(2*o+1)/255;const s=1-Math.abs(n)-Math.abs(o);s<0&&(n=(1-Math.abs(o))*(n>=0?1:-1),o=(1-Math.abs(n))*(o>=0?1:-1));const a=Math.sqrt(n*n+o*o+s*s);t[r+0]=n/a,t[r+1]=o/a,t[r+2]=s/a,r+=3}return t}};a.buildEdgeIndices=function(){const e=[],t=[],i=[],r=[],n=[];let o=0;const s=new Uint16Array(3),l=new Uint16Array(3),c=new Uint16Array(3),u=a.vec3(),h=a.vec3(),d=a.vec3(),p=a.vec3(),f=a.vec3(),m=a.vec3(),g=a.vec3();return function(v,b,_,y){!function(n,o){const s={};let a,l,c,u;const h=Math.pow(10,4);let d,p,f=0;for(d=0,p=n.length;d<p;d+=3)a=n[d],l=n[d+1],c=n[d+2],void 0===s[u=Math.round(a*h)+"_"+Math.round(l*h)+"_"+Math.round(c*h)]&&(s[u]=f/3,e[f++]=a,e[f++]=l,e[f++]=c),t[d/3]=s[u];for(d=0,p=o.length;d<p;d++)r[d]=t[o[d]],i[r[d]]=o[d]}(v,b),function(t,i){o=0;for(let v=0,b=t;v<b;v+=3){const t=3*r[v],b=3*r[v+1],_=3*r[v+2];i?(s[0]=e[t],s[1]=e[t+1],s[2]=e[t+2],l[0]=e[b],l[1]=e[b+1],l[2]=e[b+2],c[0]=e[_],c[1]=e[_+1],c[2]=e[_+2],a.decompressPosition(s,i,u),a.decompressPosition(l,i,h),a.decompressPosition(c,i,d)):(u[0]=e[t],u[1]=e[t+1],u[2]=e[t+2],h[0]=e[b],h[1]=e[b+1],h[2]=e[b+2],d[0]=e[_],d[1]=e[_+1],d[2]=e[_+2]),a.subVec3(d,h,p),a.subVec3(u,h,f),a.cross3Vec3(p,f,m),a.normalizeVec3(m,g);const y=n[o]||(n[o]={normal:a.vec3()});y.normal[0]=g[0],y.normal[1]=g[1],y.normal[2]=g[2],o++}}(b.length,_);const x=[],w=Math.cos(a.DEGTORAD*y),M={};let P,E,S,C,k,O,A,T,D,R,L,B=!1;for(let e=0,t=b.length;e<t;e+=3){const t=e/3;for(let i=0;i<3;i++)P=r[e+i],E=r[e+(i+1)%3],void 0===M[k=(S=Math.min(P,E))+","+(C=Math.max(P,E))]?M[k]={index1:S,index2:C,face1:t,face2:void 0}:M[k].face2=t}for(k in M)void 0!==(O=M[k]).face2&&(A=n[O.face1].normal,T=n[O.face2].normal,(D=a.dotVec3(A,T))>w)||(R=i[O.index1],L=i[O.index2],(!B&&R>65535||L>65535)&&(B=!0),x.push(R),x.push(L));return B?new Uint32Array(x):new Uint16Array(x)}}()},function(e,t,i){"use strict";e.exports=i(216)},function(e,t,i){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";function r(e){var t,i,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(i=r(e[t]))&&(n&&(n+=" "),n+=i);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}t.a=function(){for(var e,t,i=0,n="";i<arguments.length;)(e=arguments[i++])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(46);function n(e,t){if(null==e)return{};var i,n,o=Object(r.a)(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}},function(e,t,i){"use strict";var r=i(2),n=i(4),o=i(1),s=i.n(o),a=(i(6),i(48)),l=i.n(a),c=i(270),u=i(269),h=i(260),d=i(41);t.a=function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(i){var o=t.defaultTheme,a=t.withTheme,d=void 0!==a&&a,p=t.name,f=Object(n.a)(t,["defaultTheme","withTheme","name"]),m=p,g=Object(c.a)(e,Object(r.a)({defaultTheme:o,Component:i,name:p||i.displayName,classNamePrefix:m},f)),v=s.a.forwardRef((function(e,t){e.classes;var a,l=e.innerRef,c=Object(n.a)(e,["classes","innerRef"]),f=g(Object(r.a)({},i.defaultProps,e)),m=c;return("string"==typeof p||d)&&(a=Object(h.a)()||o,p&&(m=Object(u.a)({theme:a,name:p,props:c})),d&&!m.theme&&(m.theme=a)),s.a.createElement(i,Object(r.a)({ref:l||t,classes:f},m))}));return l()(v,i),v}}(e,Object(r.a)({defaultTheme:d.a},t))}},function(e,t,i){e.exports=i(221)()},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const r={WEBGL:!1,SUPPORTED_EXTENSIONS:{}},n=document.createElement("canvas");if(n){const e=n.getContext("webgl",{antialias:!0})||n.getContext("experimental-webgl",{antialias:!0});r.WEBGL=!!e,r.WEBGL&&(r.ANTIALIAS=e.getContextAttributes().antialias,e.getShaderPrecisionFormat?e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?r.FS_MAX_FLOAT_PRECISION="highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?r.FS_MAX_FLOAT_PRECISION="mediump":r.FS_MAX_FLOAT_PRECISION="lowp":r.FS_MAX_FLOAT_PRECISION="mediump",r.DEPTH_BUFFER_BITS=e.getParameter(e.DEPTH_BITS),r.MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),r.MAX_CUBE_MAP_SIZE=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),r.MAX_RENDERBUFFER_SIZE=e.getParameter(e.MAX_RENDERBUFFER_SIZE),r.MAX_TEXTURE_UNITS=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),r.MAX_TEXTURE_IMAGE_UNITS=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r.MAX_VERTEX_ATTRIBS=e.getParameter(e.MAX_VERTEX_ATTRIBS),r.MAX_VERTEX_UNIFORM_VECTORS=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),r.MAX_FRAGMENT_UNIFORM_VECTORS=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),r.MAX_VARYING_VECTORS=e.getParameter(e.MAX_VARYING_VECTORS),e.getSupportedExtensions().forEach((function(e){r.SUPPORTED_EXTENSIONS[e]=!0})),r.depthTexturesSupported=r.SUPPORTED_EXTENSIONS.WEBGL_depth_texture)}},function(e,t,i){"use strict";i.r(t),i.d(t,"utils",(function(){return o}));var r=[["0",10],["A",26],["a",26],["_",1],["$",1]].map((function(e){for(var t=[],i=e[0].charCodeAt(0),r=i+e[1],n=i;n<r;++n)t.push(n);return String.fromCharCode.apply(null,t)})).join("");function n(e,t){return(t&&4!==t?[0,6]:[0,6,12,18]).map((function(t){return r.substr(parseInt(e/(1<<t))%64,1)})).reverse().join("")}const o={xmlToJson:function e(t,i){if(t.nodeType===t.TEXT_NODE){var r=t.nodeValue;if(null===r.match(/^\s+$/))return r}else if(t.nodeType===t.ELEMENT_NODE||t.nodeType===t.DOCUMENT_NODE){var n={type:t.nodeName,children:[]};if(t.nodeType===t.ELEMENT_NODE)for(var o=0;o<t.attributes.length;o++){var s=t.attributes[o];n[i[s.nodeName]||s.nodeName]=s.nodeValue}for(var a=0;a<t.childNodes.length;a++)(o=e(t.childNodes[a],i))&&n.children.push(o);return n}},clone:function(e){return JSON.parse(JSON.stringify(e))},compressGuid:function(e){var t=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30].map((function(t){return parseInt(e.substr(t,2),16)}));return n(t[0],2)+[1,4,7,10,13].map((function(e){return n((t[e]<<16)+(t[e+1]<<8)+t[e+2])})).join("")},findNodeOfType:function(e,t){var i=[],r=function(e){e.type===t&&i.push(e),(e.children||[]).forEach((function(e){r(e)}))};return r(e),i},timeout:function(e){return new Promise((function(t,i){setTimeout(t,e)}))},httpRequest:function(e){return new Promise((function(t,i){var r=new XMLHttpRequest;r.open(e.method||"GET",e.url,!0),r.onload=function(n){console.log(e.url,r.readyState,r.status),4===r.readyState&&(200===r.status?t(r.responseXML):i(r.statusText))},r.send(null)}))},loadJSON:function(e,t,i){var r=e=>{};t=t||r,i=i||r;var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",e,!0),n.addEventListener("load",(function(e){var r=e.target.response;if(200===this.status){var n;try{n=JSON.parse(r)}catch(e){i("utils.loadJSON(): Failed to parse JSON response - "+e)}t(n)}else if(0===this.status){console.warn("loadFile: HTTP Status 0 received.");try{t(JSON.parse(r))}catch(e){i("utils.loadJSON(): Failed to parse JSON response - "+e)}}else i(e)}),!1),n.addEventListener("error",(function(e){i(e)}),!1),n.send(null)},loadArraybuffer:function(e,t,i){var r=e=>{};t=t||r,i=i||r;const n=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(n){const r=!!n[2];var o=n[3];o=window.decodeURIComponent(o),r&&(o=window.atob(o));try{const e=new ArrayBuffer(o.length),i=new Uint8Array(e);for(var s=0;s<o.length;s++)i[s]=o.charCodeAt(s);window.setTimeout((function(){t(e)}),0)}catch(e){window.setTimeout((function(){i(e)}),0)}}else{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.response):i("loadArrayBuffer error : "+r.response))},r.send(null)}},queryString:function(){for(var e={},t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++){var r=t[i].split("=");if(void 0===e[r[0]])e[r[0]]=decodeURIComponent(r[1]);else if("string"==typeof e[r[0]]){var n=[e[r[0]],decodeURIComponent(r[1])];e[r[0]]=n}else e[r[0]].push(decodeURIComponent(r[1]))}return e}(),isArray:function(e){return e&&!e.propertyIsEnumerable("length")&&"object"==typeof e&&"number"==typeof e.length},isString:function(e){return"string"==typeof e||e instanceof String},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isID:function(e){return o.isString(e)||o.isNumeric(e)},isSameComponent:function(e,t){return!(!e||!t)&&(o.isNumeric(e)||o.isString(e)?""+e:e.id)===(o.isNumeric(t)||o.isString(t)?""+t:t.id)},isFunction:function(e){return"function"==typeof e},isObject:function(e){const t={}.constructor;return!!e&&e.constructor===t},copy:function(e){return o.apply(e,{})},apply:function(e,t){for(const i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},apply2:function(e,t){for(const i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&null!==e[i]&&(t[i]=e[i]);return t},applyIf:function(e,t){for(const i in e)e.hasOwnProperty(i)&&(void 0!==t[i]&&null!==t[i]||(t[i]=e[i]));return t},isEmptyObject:function(e){for(const t in e)if(e.hasOwnProperty(t))return!1;return!0},inQuotes:function(e){return o.isNumeric(e)?""+e:`'${e}'`},concat:function(e,t){const i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i},flattenParentChildHierarchy:function(e){var t=[];return function e(i){i.id=i.uuid,delete i.oid,t.push(i);var r=i.children;if(r)for(var n=0,o=r.length;n<o;n++)r[n].parent=i.id,e(r[n]);i.children=[]}(e),t}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return a}));var r=i(0);const n=r.math.vec3(),o=function(){const e=new Float32Array(16),t=new Float64Array(4),i=new Float64Array(4);return function(n,o,s=e){return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=1,r.math.transformVec4(n,t,i),r.math.setMat4Translation(n,i,s),s}}();function s(e,t,i){const r=Float32Array.from([e[0]])[0],n=e[0]-r,o=Float32Array.from([e[1]])[0],s=e[1]-o,a=Float32Array.from([e[2]])[0],l=e[2]-a;t[0]=r,t[1]=o,t[2]=a,i[0]=n,i[1]=s,i[2]=l}function a(e,t,i,o){const s=r.math.dotVec3(t,i)+e,a=r.math.normalizeVec3(t,n);return r.math.mulVec3Scalar(a,-s,o),o}},function(e,t,i){"use strict";i.d(t,"g",(function(){return o})),i.d(t,"k",(function(){return s})),i.d(t,"h",(function(){return a})),i.d(t,"b",(function(){return l})),i.d(t,"j",(function(){return c})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return h})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"a",(function(){return f})),i.d(t,"i",(function(){return m}));var r=i(258);function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),i)}function o(e){e=e.substr(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),i=e.match(t);return i&&1===i[0].length&&(i=i.map((function(e){return e+e}))),i?"rgb".concat(4===i.length?"a":"","(").concat(i.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}function s(e){if(0===e.indexOf("#"))return e;var t=l(e).values;return"#".concat(t.map((function(e){return function(e){var t=e.toString(16);return 1===t.length?"0".concat(t):t}(e)})).join(""))}function a(e){var t=(e=l(e)).values,i=t[0],r=t[1]/100,n=t[2]/100,o=r*Math.min(n,1-n),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+i/30)%12;return n-o*Math.max(Math.min(t-3,9-t,1),-1)},a="rgb",u=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(a+="a",u.push(t[3])),c({type:a,values:u})}function l(e){if(e.type)return e;if("#"===e.charAt(0))return l(o(e));var t=e.indexOf("("),i=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla"].indexOf(i))throw new Error(Object(r.a)(3,e));var n=e.substring(t+1,e.length-1).split(",");return{type:i,values:n=n.map((function(e){return parseFloat(e)}))}}function c(e){var t=e.type,i=e.values;return-1!==t.indexOf("rgb")?i=i.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(i[1]="".concat(i[1],"%"),i[2]="".concat(i[2],"%")),"".concat(t,"(").concat(i.join(", "),")")}function u(e,t){var i=h(e),r=h(t);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)}function h(e){var t="hsl"===(e=l(e)).type?l(a(e)).values:e.values;return t=t.map((function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return h(e)>.5?f(e,t):m(e,t)}function p(e,t){return e=l(e),t=n(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),e.values[3]=t,c(e)}function f(e,t){if(e=l(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb"))for(var i=0;i<3;i+=1)e.values[i]*=1-t;return c(e)}function m(e,t){if(e=l(e),t=n(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;return c(e)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(24);class n{constructor(e,t,i){if(this.allocated=!1,this.compiled=!1,this.handle=e.createShader(t),this.handle){if(this.allocated=!0,e.shaderSource(this.handle,i),e.compileShader(this.handle),this.compiled=e.getShaderParameter(this.handle,e.COMPILE_STATUS),!this.compiled&&!e.isContextLost()){const t=i.split("\n"),r=[];for(let e=0;e<t.length;e++)r.push(e+1+": "+t[e]+"\n");this.errors=[],this.errors.push(""),this.errors.push(e.getShaderInfoLog(this.handle)),this.errors=this.errors.concat(r.join(""))}}else this.errors=["Failed to allocate"]}destroy(){}}class o{constructor(e,t){this.bindTexture=function(i,r){return!!i.bind(r)&&(e.uniform1i(t,r),!0)}}}class s{constructor(e,t){this._gl=e,this.location=t}bindArrayBuffer(e){e&&(e.bind(),this._gl.enableVertexAttribArray(this.location),this._gl.vertexAttribPointer(this.location,e.itemSize,e.itemType,e.normalized,e.stride,e.offset))}}const a=new r.Map({});function l(e){const t=[];let i,r;for(let n=0,o=e.length;n<o;n++)(r=(i=e[n]).indexOf("/"))>0&&"/"===i.charAt(r+1)&&(i=i.substring(0,r)),t.push(i);return t.join("\n")}function c(e){console.error(e.join("\n"))}class u{constructor(e,t){this.id=a.addItem({}),this.source=t,this.init(e)}init(e){if(this.gl=e,this.allocated=!1,this.compiled=!1,this.linked=!1,this.validated=!1,this.errors=null,this.uniforms={},this.samplers={},this.attributes={},this._vertexShader=new n(e,e.VERTEX_SHADER,l(this.source.vertex)),this._fragmentShader=new n(e,e.FRAGMENT_SHADER,l(this.source.fragment)),!this._vertexShader.allocated)return this.errors=["Vertex shader failed to allocate"].concat(this._vertexShader.errors),void c(this.errors);if(!this._fragmentShader.allocated)return this.errors=["Fragment shader failed to allocate"].concat(this._fragmentShader.errors),void c(this.errors);if(this.allocated=!0,!this._vertexShader.compiled)return this.errors=["Vertex shader failed to compile"].concat(this._vertexShader.errors),void c(this.errors);if(!this._fragmentShader.compiled)return this.errors=["Fragment shader failed to compile"].concat(this._fragmentShader.errors),void c(this.errors);let t,i,r,a,u;if(this.compiled=!0,this.handle=e.createProgram(),!this.handle)return void(this.errors=["Failed to allocate program"]);if(e.attachShader(this.handle,this._vertexShader.handle),e.attachShader(this.handle,this._fragmentShader.handle),e.linkProgram(this.handle),this.linked=e.getProgramParameter(this.handle,e.LINK_STATUS),this.validated=!0,!this.linked||!this.validated)return this.errors=[],this.errors.push(""),this.errors.push(e.getProgramInfoLog(this.handle)),this.errors.push("\nVertex shader:\n"),this.errors=this.errors.concat(this.source.vertex),this.errors.push("\nFragment shader:\n"),this.errors=this.errors.concat(this.source.fragment),void c(this.errors);const h=e.getProgramParameter(this.handle,e.ACTIVE_UNIFORMS);for(i=0;i<h;++i)(r=e.getActiveUniform(this.handle,i))&&("\0"===(a=r.name)[a.length-1]&&(a=a.substr(0,a.length-1)),u=e.getUniformLocation(this.handle,a),r.type===e.SAMPLER_2D||r.type===e.SAMPLER_CUBE||35682===r.type?this.samplers[a]=new o(e,u):this.uniforms[a]=u);const d=e.getProgramParameter(this.handle,e.ACTIVE_ATTRIBUTES);for(i=0;i<d;i++)(t=e.getActiveAttrib(this.handle,i))&&(u=e.getAttribLocation(this.handle,t.name),this.attributes[t.name]=new s(e,u));this.allocated=!0}bind(){this.allocated&&this.gl.useProgram(this.handle)}getLocation(e){if(this.allocated)return this.uniforms[e]}getAttribute(e){if(this.allocated)return this.attributes[e]}bindTexture(e,t,i){if(!this.allocated)return!1;const r=this.samplers[e];return!!r&&r.bindTexture(t,i)}destroy(){this.allocated&&(a.removeItem(this.id),this.gl.deleteProgram(this.handle),this.gl.deleteShader(this._vertexShader.handle),this.gl.deleteShader(this._fragmentShader.handle),this.handle=null,this.attributes=null,this.uniforms=null,this.samplers=null,this.allocated=!1)}}},function(e,t,i){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return r}))},,function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(e,t,i,r,n,o,s,a,l){switch(this._gl=e,this.type=t,this.allocated=!1,i.constructor){case Uint8Array:this.itemType=e.UNSIGNED_BYTE,this.itemByteSize=1;break;case Int8Array:this.itemType=e.BYTE,this.itemByteSize=1;break;case Uint16Array:this.itemType=e.UNSIGNED_SHORT,this.itemByteSize=2;break;case Int16Array:this.itemType=e.SHORT,this.itemByteSize=2;break;case Uint32Array:this.itemType=e.UNSIGNED_INT,this.itemByteSize=4;break;case Int32Array:this.itemType=e.INT,this.itemByteSize=4;break;default:this.itemType=e.FLOAT,this.itemByteSize=4}this.usage=o,this.length=0,this.dataLength=r,this.numItems=0,this.itemSize=n,this.normalized=!!s,this.stride=a||0,this.offset=l||0,this._allocate(i)}_allocate(e){if(this.allocated=!1,this._handle=this._gl.createBuffer(),!this._handle)throw"Failed to allocate WebGL ArrayBuffer";this._handle&&(this._gl.bindBuffer(this.type,this._handle),this._gl.bufferData(this.type,e.length>this.dataLength?e.slice(0,this.dataLength):e,this.usage),this._gl.bindBuffer(this.type,null),this.length=e.length,this.numItems=this.length/this.itemSize,this.allocated=!0)}setData(e,t){this.allocated&&(e.length+(t||0)>this.length?(this.destroy(),this._allocate(e)):(this._gl.bindBuffer(this.type,this._handle),t||0===t?this._gl.bufferSubData(this.type,t*this.itemByteSize,e):this._gl.bufferData(this.type,e,this.usage),this._gl.bindBuffer(this.type,null)))}bind(){this.allocated&&this._gl.bindBuffer(this.type,this._handle)}unbind(){this.allocated&&this._gl.bindBuffer(this.type,null)}destroy(){this.allocated&&(this._gl.deleteBuffer(this._handle),this._handle=null,this.allocated=!1)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const r={build:{version:"0.8"},client:{browser:navigator&&navigator.userAgent?navigator.userAgent:"n/a"},components:{scenes:0,models:0,meshes:0,objects:0},memory:{meshes:0,positions:0,colors:0,normals:0,uvs:0,indices:0,textures:0,transforms:0,materials:0,programs:0},frame:{frameCount:0,fps:0,useProgram:0,bindTexture:0,bindArray:0,drawElements:0,drawArrays:0,tasksRun:0,tasksScheduled:0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(36),n=i(8),o=i(24);class s{get type(){return"Component"}get isComponent(){return!0}constructor(e=null,t={}){if(this.scene=null,"Scene"===this.type)this.scene=this,this.viewer=t.viewer;else{if("Scene"===e.type)this.scene=e;else{if(!(e instanceof s))throw"Invalid param: owner must be a Component";this.scene=e.scene}this._owner=e,this._renderer=this.scene._renderer}this._dontClear=!!t.dontClear,this._renderer=this.scene._renderer,this.meta=t.meta||{},this.id=t.id,this.destroyed=!1,this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._eventSubsNum=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this!==this.scene&&this.scene._addComponent(this),this._updateScheduled=!1,e&&e._own(this)}glRedraw(){this._renderer.imageDirty(),this.castsShadow&&this._renderer.shadowsDirty()}glResort(){this._renderer.needStateSort()}get owner(){return this._owner}isType(e){return this.type===e}fire(e,t,i){this._events||(this._events={}),this._eventSubs||(this._eventSubs={},this._eventSubsNum={}),!0!==i&&(this._events[e]=t||!0);const r=this._eventSubs[e];let n;if(r)for(const i in r)r.hasOwnProperty(i)&&(n=r[i],this._eventCallDepth++,this._eventCallDepth<300?n.callback.call(n.scope,t):this.error("fire: potential stack overflow from recursive event '"+e+"' - dropping this event"),this._eventCallDepth--)}on(e,t,i){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new o.Map),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={}),this._eventSubsNum||(this._eventSubsNum={});let r=this._eventSubs[e];r?this._eventSubsNum[e]++:(r={},this._eventSubs[e]=r,this._eventSubsNum[e]=1);const n=this._subIdMap.addItem();r[n]={callback:t,scope:i||this},this._subIdEvents[n]=e;const s=this._events[e];return void 0!==s&&t.call(i||this,s),n}off(e){if(null==e)return;if(!this._subIdEvents)return;const t=this._subIdEvents[e];if(t){delete this._subIdEvents[e];const i=this._eventSubs[t];i&&(delete i[e],this._eventSubsNum[t]--),this._subIdMap.removeItem(e)}}once(e,t,i){const r=this,n=this.on(e,(function(e){r.off(n),t.call(i||this,e)}),i)}hasSubs(e){return this._eventSubsNum&&this._eventSubsNum[e]>0}log(e){e="[LOG]"+this._message(e),window.console.log(e),this.scene.fire("log",e)}_message(e){return" ["+this.type+" "+n.utils.inQuotes(this.id)+"]: "+e}warn(e){e="[WARN]"+this._message(e),window.console.warn(e),this.scene.fire("warn",e)}error(e){e="[ERROR]"+this._message(e),window.console.error(e),this.scene.fire("error",e)}_attach(e){const t=e.name;if(!t)return void this.error("Component 'name' expected");let i=e.component;const r=e.sceneDefault,o=e.sceneSingleton,s=e.type,a=e.on,l=!1!==e.recompiles;if(i&&(n.utils.isNumeric(i)||n.utils.isString(i))){const e=i;if(!(i=this.scene.components[e]))return void this.error("Component not found: "+n.utils.inQuotes(e))}if(!i)if(!0===o){const e=this.scene.types[s];for(const t in e)if(e.hasOwnProperty){i=e[t];break}if(!i)return this.error("Scene has no default component for '"+t+"'"),null}else if(!0===r&&!(i=this.scene[t]))return this.error("Scene has no default component for '"+t+"'"),null;if(i){if(i.scene.id!==this.scene.id)return void this.error("Not in same scene: "+i.type+" "+n.utils.inQuotes(i.id));if(s&&!i.isType(s))return void this.error("Expected a "+s+" type or subtype: "+i.type+" "+n.utils.inQuotes(i.id))}this._attachments||(this._attachments={});const c=this._attached[t];let u,h,d;if(c){if(i&&c.id===i.id)return;const e=this._attachments[c.id];for(h=0,d=(u=e.subs).length;h<d;h++)c.off(u[h]);delete this._attached[t],delete this._attachments[c.id];const r=e.params.onDetached;r&&(n.utils.isFunction(r)?r(c):r.scope?r.callback.call(r.scope,c):r.callback(c)),e.managingLifecycle&&c.destroy()}if(i){const r={params:e,component:i,subs:[],managingLifecycle:!1};r.subs.push(i.once("destroyed",(function(){r.params.component=null,this._attach(r.params)}),this)),l&&r.subs.push(i.on("dirty",(function(){this.fire("dirty",this)}),this)),this._attached[t]=i,this._attachments[i.id]=r;const o=e.onAttached;if(o&&(n.utils.isFunction(o)?o(i):o.scope?o.callback.call(o.scope,i):o.callback(i)),a){let e,t,o,s;for(e in a)if(a.hasOwnProperty(e)){if(t=a[e],n.utils.isFunction(t)?(o=t,s=null):(o=t.callback,s=t.scope),!o)continue;r.subs.push(i.on(e,o,s))}}}return l&&this.fire("dirty",this),this.fire(t,i),i}_checkComponent(e,t){if(!t.isComponent){if(!n.utils.isID(t))return void this.error("Expected a Component or ID");{const e=t;if(!(t=this.scene.components[e]))return void this.error("Component not found: "+e)}}if(e===t.type){if(t.scene.id===this.scene.id)return t;this.error("Not in same scene: "+t.type)}else this.error("Expected a "+e+" Component")}_checkComponent2(e,t){if(!t.isComponent){if(!n.utils.isID(t))return void this.error("Expected a Component or ID");{const e=t;if(!(t=this.scene.components[e]))return void this.error("Component not found: "+e)}}if(t.scene.id===this.scene.id){for(var i=0,r=e.length;i<r;i++)if(e[i]===t.type)return t;return this.error("Expected component types: "+e),null}this.error("Not in same scene: "+t.type)}_own(e){this._ownedComponents||(this._ownedComponents={}),this._ownedComponents[e.id]||(this._ownedComponents[e.id]=e),e.once("destroyed",()=>{delete this._ownedComponents[e.id]},this)}_needUpdate(e){this._updateScheduled||(this._updateScheduled=!0,0===e?this._doUpdate():r.a.scheduleTask(this._doUpdate,this))}_doUpdate(){this._updateScheduled&&(this._updateScheduled=!1,this._update&&this._update())}_update(){}clear(){if(this._ownedComponents)for(var e in this._ownedComponents)this._ownedComponents.hasOwnProperty(e)&&(this._ownedComponents[e].destroy(),delete this._ownedComponents[e])}destroy(){if(this.destroyed)return;let e,t,i,r,n,o;if(this.fire("destroyed",this.destroyed=!0),this._attachments)for(e in this._attachments)if(this._attachments.hasOwnProperty(e)){for(i=(t=this._attachments[e]).component,n=0,o=(r=t.subs).length;n<o;n++)i.off(r[n]);t.managingLifecycle&&i.destroy()}if(this._ownedComponents)for(e in this._ownedComponents)this._ownedComponents.hasOwnProperty(e)&&((i=this._ownedComponents[e]).destroy(),delete this._ownedComponents[e]);this.scene._removeComponent(this),this._attached={},this._attachments=null,this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._ownedComponents=null,this._updateScheduled=!1}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return K}));var r=i(0),n=i(16),o=i(20),s=i(24);const a=function(e){"LambertMaterial"===e._material._state.type?(this.vertex=function(e){const t=e.scene,i=e.scene._sectionPlanesState,r=e.scene._lightsState,n=e._geometry._state,o=e._state.billboard,s=e._state.stationary,a=i.sectionPlanes.length>0,l=!!n.compressGeometry,c=[];if(c.push("// Lambertian drawing vertex shader"),t.logarithmicDepthBufferEnabled&&c.push("#extension GL_EXT_frag_depth : enable"),c.push("attribute vec3 position;"),c.push("uniform mat4 modelMatrix;"),c.push("uniform mat4 viewMatrix;"),c.push("uniform mat4 projMatrix;"),c.push("uniform vec4 colorize;"),c.push("uniform vec3 offset;"),l&&c.push("uniform mat4 positionsDecodeMatrix;"),t.logarithmicDepthBufferEnabled&&(c.push("uniform float logDepthBufFC;"),c.push("varying float vFragDepth;")),a&&c.push("varying vec4 vWorldPosition;"),c.push("uniform vec4 lightAmbient;"),c.push("uniform vec4 materialColor;"),c.push("uniform vec3 materialEmissive;"),n.normalsBuf){c.push("attribute vec3 normal;"),c.push("uniform mat4 modelNormalMatrix;"),c.push("uniform mat4 viewNormalMatrix;");for(let e=0,t=r.lights.length;e<t;e++){const t=r.lights[e];"ambient"!==t.type&&(c.push("uniform vec4 lightColor"+e+";"),"dir"===t.type&&c.push("uniform vec3 lightDir"+e+";"),"point"===t.type&&c.push("uniform vec3 lightPos"+e+";"),"spot"===t.type&&(c.push("uniform vec3 lightPos"+e+";"),c.push("uniform vec3 lightDir"+e+";")))}l&&(c.push("vec3 octDecode(vec2 oct) {"),c.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),c.push("    if (v.z < 0.0) {"),c.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),c.push("    }"),c.push("    return normalize(v);"),c.push("}"))}if(c.push("varying vec4 vColor;"),"points"===n.primitiveName&&c.push("uniform float pointSize;"),"spherical"!==o&&"cylindrical"!==o||(c.push("void billboard(inout mat4 mat) {"),c.push("   mat[0][0] = 1.0;"),c.push("   mat[0][1] = 0.0;"),c.push("   mat[0][2] = 0.0;"),"spherical"===o&&(c.push("   mat[1][0] = 0.0;"),c.push("   mat[1][1] = 1.0;"),c.push("   mat[1][2] = 0.0;")),c.push("   mat[2][0] = 0.0;"),c.push("   mat[2][1] = 0.0;"),c.push("   mat[2][2] =1.0;"),c.push("}")),c.push("void main(void) {"),c.push("vec4 localPosition = vec4(position, 1.0); "),c.push("vec4 worldPosition;"),l&&c.push("localPosition = positionsDecodeMatrix * localPosition;"),n.normalsBuf&&(l?c.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):c.push("vec4 localNormal = vec4(normal, 0.0); "),c.push("mat4 modelNormalMatrix2 = modelNormalMatrix;"),c.push("mat4 viewNormalMatrix2 = viewNormalMatrix;")),c.push("mat4 viewMatrix2 = viewMatrix;"),c.push("mat4 modelMatrix2 = modelMatrix;"),s&&c.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"===o||"cylindrical"===o?(c.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),c.push("billboard(modelMatrix2);"),c.push("billboard(viewMatrix2);"),c.push("billboard(modelViewMatrix);"),n.normalsBuf&&(c.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),c.push("billboard(modelNormalMatrix2);"),c.push("billboard(viewNormalMatrix2);"),c.push("billboard(modelViewNormalMatrix);")),c.push("worldPosition = modelMatrix2 * localPosition;"),c.push("worldPosition.xyz = worldPosition.xyz + offset;"),c.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(c.push("worldPosition = modelMatrix2 * localPosition;"),c.push("worldPosition.xyz = worldPosition.xyz + offset;"),c.push("vec4 viewPosition  = viewMatrix2 * worldPosition; ")),n.normalsBuf&&c.push("vec3 viewNormal = normalize((viewNormalMatrix2 * modelNormalMatrix2 * localNormal).xyz);"),c.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),c.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),c.push("float lambertian = 1.0;"),n.normalsBuf)for(let e=0,t=r.lights.length;e<t;e++){const t=r.lights[e];if("ambient"!==t.type){if("dir"===t.type)"view"===t.space?c.push("viewLightDir = normalize(lightDir"+e+");"):c.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+e+", 0.0)).xyz);");else if("point"===t.type)"view"===t.space?c.push("viewLightDir = normalize(lightPos"+e+" - viewPosition.xyz);"):c.push("viewLightDir = normalize((viewMatrix2 * vec4(lightPos"+e+", 0.0)).xyz);");else{if("spot"!==t.type)continue;"view"===t.space?c.push("viewLightDir = normalize(lightDir"+e+");"):c.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+e+", 0.0)).xyz);")}c.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),c.push("reflectedColor += lambertian * (lightColor"+e+".rgb * lightColor"+e+".a);")}}return c.push("vColor = vec4(materialEmissive.rgb + (reflectedColor * materialColor.rgb), materialColor.a) * colorize;"),a&&c.push("vWorldPosition = worldPosition;"),"points"===n.primitiveName&&c.push("gl_PointSize = pointSize;"),c.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&c.push("vFragDepth = 1.0 + clipPos.w;"),c.push("gl_Position = clipPos;"),c.push("}"),c}(e),this.fragment=function(e){const t=e.scene,i=t._sectionPlanesState,r=(e._material._state,e._geometry._state),n=i.sectionPlanes.length>0,o=t.gammaOutput,s=[];if(s.push("// Lambertian drawing fragment shader"),t.logarithmicDepthBufferEnabled&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),s.push("precision highp float;"),s.push("precision highp int;"),s.push("#else"),s.push("precision mediump float;"),s.push("precision mediump int;"),s.push("#endif"),t.logarithmicDepthBufferEnabled&&(s.push("uniform float logDepthBufFC;"),s.push("varying float vFragDepth;")),n){s.push("varying vec4 vWorldPosition;"),s.push("uniform bool clippable;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)s.push("uniform bool sectionPlaneActive"+e+";"),s.push("uniform vec3 sectionPlanePos"+e+";"),s.push("uniform vec3 sectionPlaneDir"+e+";")}if(s.push("varying vec4 vColor;"),o&&(s.push("uniform float gammaFactor;"),s.push("    vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),s.push("    return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),s.push("}")),s.push("void main(void) {"),n){s.push("if (clippable) {"),s.push("  float dist = 0.0;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)s.push("if (sectionPlaneActive"+e+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),s.push("}");s.push("  if (dist > 0.0) { discard; }"),s.push("}")}return"points"===r.primitiveName&&(s.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),s.push("float r = dot(cxy, cxy);"),s.push("if (r > 1.0) {"),s.push("   discard;"),s.push("}")),t.logarithmicDepthBufferEnabled&&s.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),o?s.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):s.push("gl_FragColor = vColor;"),s.push("}"),s}(e)):(this.vertex=function(e){const t=e.scene,i=e._material,r=e._state,n=t._sectionPlanesState,o=e._geometry._state,s=t._lightsState;let a;const l=r.billboard,h=r.stationary,d=function(e){if(!e._geometry._state.uvBuf)return!1;const t=e._material;return!!(t._ambientMap||t._occlusionMap||t._baseColorMap||t._diffuseMap||t._alphaMap||t._specularMap||t._glossinessMap||t._specularGlossinessMap||t._emissiveMap||t._metallicMap||t._roughnessMap||t._metallicRoughnessMap||t._reflectivityMap||t._normalMap)}(e),p=u(e),f=n.sectionPlanes.length>0,m=c(e),g=!!o.compressGeometry,v=[];if(v.push("// Drawing vertex shader"),p&&i._normalMap&&v.push("#extension GL_OES_standard_derivatives : enable"),t.logarithmicDepthBufferEnabled&&v.push("#extension GL_EXT_frag_depth : enable"),v.push("attribute  vec3 position;"),g&&v.push("uniform mat4 positionsDecodeMatrix;"),v.push("uniform  mat4 modelMatrix;"),v.push("uniform  mat4 viewMatrix;"),v.push("uniform  mat4 projMatrix;"),v.push("varying  vec3 vViewPosition;"),v.push("uniform  vec3 offset;"),f&&v.push("varying vec4 vWorldPosition;"),t.logarithmicDepthBufferEnabled&&(v.push("uniform float logDepthBufFC;"),v.push("varying float vFragDepth;")),s.lightMaps.length>0&&v.push("varying    vec3 vWorldNormal;"),p){v.push("attribute  vec3 normal;"),v.push("uniform    mat4 modelNormalMatrix;"),v.push("uniform    mat4 viewNormalMatrix;"),v.push("varying    vec3 vViewNormal;");for(let e=0,t=s.lights.length;e<t;e++)"ambient"!==(a=s.lights[e]).type&&("dir"===a.type&&v.push("uniform vec3 lightDir"+e+";"),"point"===a.type&&v.push("uniform vec3 lightPos"+e+";"),"spot"===a.type&&(v.push("uniform vec3 lightPos"+e+";"),v.push("uniform vec3 lightDir"+e+";")),"dir"===a.type&&"view"===a.space||v.push("varying vec4 vViewLightReverseDirAndDist"+e+";"));g&&(v.push("vec3 octDecode(vec2 oct) {"),v.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),v.push("    if (v.z < 0.0) {"),v.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),v.push("    }"),v.push("    return normalize(v);"),v.push("}"))}if(d&&(v.push("attribute vec2 uv;"),v.push("varying vec2 vUV;"),g&&v.push("uniform mat3 uvDecodeMatrix;")),o.colors&&(v.push("attribute vec4 color;"),v.push("varying vec4 vColor;")),"points"===o.primitiveName&&v.push("uniform float pointSize;"),"spherical"!==l&&"cylindrical"!==l||(v.push("void billboard(inout mat4 mat) {"),v.push("   mat[0][0] = 1.0;"),v.push("   mat[0][1] = 0.0;"),v.push("   mat[0][2] = 0.0;"),"spherical"===l&&(v.push("   mat[1][0] = 0.0;"),v.push("   mat[1][1] = 1.0;"),v.push("   mat[1][2] = 0.0;")),v.push("   mat[2][0] = 0.0;"),v.push("   mat[2][1] = 0.0;"),v.push("   mat[2][2] =1.0;"),v.push("}")),m){v.push("const mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);");for(let e=0,t=s.lights.length;e<t;e++)s.lights[e].castsShadow&&(v.push("uniform mat4 shadowViewMatrix"+e+";"),v.push("uniform mat4 shadowProjMatrix"+e+";"),v.push("varying vec4 vShadowPosFromLight"+e+";"))}if(v.push("void main(void) {"),v.push("vec4 localPosition = vec4(position, 1.0); "),v.push("vec4 worldPosition;"),g&&v.push("localPosition = positionsDecodeMatrix * localPosition;"),p&&(g?v.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):v.push("vec4 localNormal = vec4(normal, 0.0); "),v.push("mat4 modelNormalMatrix2    = modelNormalMatrix;"),v.push("mat4 viewNormalMatrix2     = viewNormalMatrix;")),v.push("mat4 viewMatrix2           = viewMatrix;"),v.push("mat4 modelMatrix2          = modelMatrix;"),h&&v.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"===l||"cylindrical"===l?(v.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),v.push("billboard(modelMatrix2);"),v.push("billboard(viewMatrix2);"),v.push("billboard(modelViewMatrix);"),p&&(v.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),v.push("billboard(modelNormalMatrix2);"),v.push("billboard(viewNormalMatrix2);"),v.push("billboard(modelViewNormalMatrix);")),v.push("worldPosition = modelMatrix2 * localPosition;"),v.push("worldPosition.xyz = worldPosition.xyz + offset;"),v.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(v.push("worldPosition = modelMatrix2 * localPosition;"),v.push("worldPosition.xyz = worldPosition.xyz + offset;"),v.push("vec4 viewPosition  = viewMatrix2 * worldPosition; ")),p){v.push("vec3 worldNormal = (modelNormalMatrix2 * localNormal).xyz; "),s.lightMaps.length>0&&v.push("vWorldNormal = worldNormal;"),v.push("vViewNormal = normalize((viewNormalMatrix2 * vec4(worldNormal, 1.0)).xyz);"),v.push("vec3 tmpVec3;"),v.push("float lightDist;");for(let e=0,t=s.lights.length;e<t;e++)"ambient"!==(a=s.lights[e]).type&&("dir"===a.type&&"world"===a.space&&(v.push("tmpVec3 = vec3(viewMatrix2 * vec4(lightDir"+e+", 0.0) ).xyz;"),v.push("vViewLightReverseDirAndDist"+e+" = vec4(-tmpVec3, 0.0);")),"point"===a.type&&("world"===a.space?(v.push("tmpVec3 = (viewMatrix2 * vec4(lightPos"+e+", 1.0)).xyz - viewPosition.xyz;"),v.push("lightDist = abs(length(tmpVec3));")):(v.push("tmpVec3 = lightPos"+e+".xyz - viewPosition.xyz;"),v.push("lightDist = abs(length(tmpVec3));")),v.push("vViewLightReverseDirAndDist"+e+" = vec4(tmpVec3, lightDist);")))}if(d&&(g?v.push("vUV = (uvDecodeMatrix * vec3(uv, 1.0)).xy;"):v.push("vUV = uv;")),o.colors&&v.push("vColor = color;"),"points"===o.primitiveName&&v.push("gl_PointSize = pointSize;"),f&&v.push("vWorldPosition = worldPosition;"),v.push("   vViewPosition = viewPosition.xyz;"),v.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&v.push("vFragDepth = 1.0 + clipPos.w;"),v.push("gl_Position = clipPos;"),m){v.push("const mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);"),v.push("vec4 tempx; ");for(let e=0,t=s.lights.length;e<t;e++)s.lights[e].castsShadow&&v.push("vShadowPosFromLight"+e+" = texUnitConverter * shadowProjMatrix"+e+" * (shadowViewMatrix"+e+" * worldPosition); ")}return v.push("}"),v}(e),this.fragment=function(e){const t=e.scene,i=(t.canvas.gl,e._material),r=e._geometry._state,n=e.scene._sectionPlanesState,o=e.scene._lightsState,s=e._material._state,a=n.sectionPlanes.length>0,h=u(e),d=r.uvBuf,p="PhongMaterial"===s.type,f="MetallicMaterial"===s.type,m="SpecularMaterial"===s.type,g=c(e),v=(t.gammaInput,t.gammaOutput),b=[];if(b.push("// Drawing fragment shader"),t.logarithmicDepthBufferEnabled&&b.push("#extension GL_EXT_frag_depth : enable"),h&&i._normalMap&&b.push("#extension GL_OES_standard_derivatives : enable"),b.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),b.push("precision highp float;"),b.push("precision highp int;"),b.push("#else"),b.push("precision mediump float;"),b.push("precision mediump int;"),b.push("#endif"),t.logarithmicDepthBufferEnabled&&(b.push("uniform float logDepthBufFC;"),b.push("varying float vFragDepth;")),g&&(b.push("float unpackDepth (vec4 color) {"),b.push("  const vec4 bitShift = vec4(1.0, 1.0/256.0, 1.0/(256.0 * 256.0), 1.0/(256.0*256.0*256.0));"),b.push("  return dot(color, bitShift);"),b.push("}")),b.push("uniform float gammaFactor;"),b.push("vec4 linearToLinear( in vec4 value ) {"),b.push("  return value;"),b.push("}"),b.push("vec4 sRGBToLinear( in vec4 value ) {"),b.push("  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );"),b.push("}"),b.push("vec4 gammaToLinear( in vec4 value) {"),b.push("  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );"),b.push("}"),v&&(b.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),b.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),b.push("}")),a){b.push("varying vec4 vWorldPosition;"),b.push("uniform bool clippable;");for(var _=0;_<n.sectionPlanes.length;_++)b.push("uniform bool sectionPlaneActive"+_+";"),b.push("uniform vec3 sectionPlanePos"+_+";"),b.push("uniform vec3 sectionPlaneDir"+_+";")}if(h&&(o.lightMaps.length>0&&(b.push("uniform samplerCube lightMap;"),b.push("uniform mat4 viewNormalMatrix;")),o.reflectionMaps.length>0&&b.push("uniform samplerCube reflectionMap;"),(o.lightMaps.length>0||o.reflectionMaps.length>0)&&b.push("uniform mat4 viewMatrix;"),b.push("#define PI 3.14159265359"),b.push("#define RECIPROCAL_PI 0.31830988618"),b.push("#define RECIPROCAL_PI2 0.15915494"),b.push("#define EPSILON 1e-6"),b.push("#define saturate(a) clamp( a, 0.0, 1.0 )"),b.push("vec3 inverseTransformDirection(in vec3 dir, in mat4 matrix) {"),b.push("   return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );"),b.push("}"),b.push("struct IncidentLight {"),b.push("   vec3 color;"),b.push("   vec3 direction;"),b.push("};"),b.push("struct ReflectedLight {"),b.push("   vec3 diffuse;"),b.push("   vec3 specular;"),b.push("};"),b.push("struct Geometry {"),b.push("   vec3 position;"),b.push("   vec3 viewNormal;"),b.push("   vec3 worldNormal;"),b.push("   vec3 viewEyeDir;"),b.push("};"),b.push("struct Material {"),b.push("   vec3    diffuseColor;"),b.push("   float   specularRoughness;"),b.push("   vec3    specularColor;"),b.push("   float   shine;"),b.push("};"),p&&((o.lightMaps.length>0||o.reflectionMaps.length>0)&&(b.push("void computePhongLightMapping(const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),o.lightMaps.length>0&&(b.push("   vec3 irradiance = "+l[o.lightMaps[0].encoding]+"(textureCube(lightMap, geometry.worldNormal)).rgb;"),b.push("   irradiance *= PI;"),b.push("   vec3 diffuseBRDFContrib = (RECIPROCAL_PI * material.diffuseColor);"),b.push("   reflectedLight.diffuse += irradiance * diffuseBRDFContrib;")),o.reflectionMaps.length>0&&(b.push("   vec3 reflectVec             = reflect(-geometry.viewEyeDir, geometry.viewNormal);"),b.push("   vec3 radiance               = textureCube(reflectionMap, reflectVec).rgb * 0.2;"),b.push("   reflectedLight.specular     += radiance;")),b.push("}")),b.push("void computePhongLighting(const in IncidentLight directLight, const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),b.push("   float dotNL     = saturate(dot(geometry.viewNormal, directLight.direction));"),b.push("   vec3 irradiance = dotNL * directLight.color * PI;"),b.push("   reflectedLight.diffuse  += irradiance * (RECIPROCAL_PI * material.diffuseColor);"),b.push("   reflectedLight.specular += directLight.color * material.specularColor * pow(max(dot(reflect(-directLight.direction, -geometry.viewNormal), geometry.viewEyeDir), 0.0), material.shine);"),b.push("}")),(f||m)&&(b.push("float GGXRoughnessToBlinnExponent(const in float ggxRoughness) {"),b.push("   float r = ggxRoughness + 0.0001;"),b.push("   return (2.0 / (r * r) - 2.0);"),b.push("}"),b.push("float getSpecularMIPLevel(const in float blinnShininessExponent, const in int maxMIPLevel) {"),b.push("   float maxMIPLevelScalar = float( maxMIPLevel );"),b.push("   float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( ( blinnShininessExponent * blinnShininessExponent ) + 1.0 );"),b.push("   return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );"),b.push("}"),o.reflectionMaps.length>0&&(b.push("vec3 getLightProbeIndirectRadiance(const in vec3 reflectVec, const in float blinnShininessExponent, const in int maxMIPLevel) {"),b.push("   float mipLevel = 0.5 * getSpecularMIPLevel(blinnShininessExponent, maxMIPLevel);"),b.push("   vec3 envMapColor = "+l[o.reflectionMaps[0].encoding]+"(textureCube(reflectionMap, reflectVec, mipLevel)).rgb;"),b.push("  return envMapColor;"),b.push("}")),b.push("vec3 F_Schlick(const in vec3 specularColor, const in float dotLH) {"),b.push("   float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );"),b.push("   return ( 1.0 - specularColor ) * fresnel + specularColor;"),b.push("}"),b.push("float G_GGX_Smith(const in float alpha, const in float dotNL, const in float dotNV) {"),b.push("   float a2 = ( alpha * alpha );"),b.push("   float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * ( dotNL * dotNL ) );"),b.push("   float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * ( dotNV * dotNV ) );"),b.push("   return 1.0 / ( gl * gv );"),b.push("}"),b.push("float G_GGX_SmithCorrelated(const in float alpha, const in float dotNL, const in float dotNV) {"),b.push("   float a2 = ( alpha * alpha );"),b.push("   float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * ( dotNV * dotNV ) );"),b.push("   float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * ( dotNL * dotNL ) );"),b.push("   return 0.5 / max( gv + gl, EPSILON );"),b.push("}"),b.push("float D_GGX(const in float alpha, const in float dotNH) {"),b.push("   float a2 = ( alpha * alpha );"),b.push("   float denom = ( dotNH * dotNH) * ( a2 - 1.0 ) + 1.0;"),b.push("   return RECIPROCAL_PI * a2 / ( denom * denom);"),b.push("}"),b.push("vec3 BRDF_Specular_GGX(const in IncidentLight incidentLight, const in Geometry geometry, const in vec3 specularColor, const in float roughness) {"),b.push("   float alpha = ( roughness * roughness );"),b.push("   vec3 halfDir = normalize( incidentLight.direction + geometry.viewEyeDir );"),b.push("   float dotNL = saturate( dot( geometry.viewNormal, incidentLight.direction ) );"),b.push("   float dotNV = saturate( dot( geometry.viewNormal, geometry.viewEyeDir ) );"),b.push("   float dotNH = saturate( dot( geometry.viewNormal, halfDir ) );"),b.push("   float dotLH = saturate( dot( incidentLight.direction, halfDir ) );"),b.push("   vec3  F = F_Schlick( specularColor, dotLH );"),b.push("   float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );"),b.push("   float D = D_GGX( alpha, dotNH );"),b.push("   return F * (G * D);"),b.push("}"),b.push("vec3 BRDF_Specular_GGX_Environment(const in Geometry geometry, const in vec3 specularColor, const in float roughness) {"),b.push("   float dotNV = saturate(dot(geometry.viewNormal, geometry.viewEyeDir));"),b.push("   const vec4 c0 = vec4( -1, -0.0275, -0.572,  0.022);"),b.push("   const vec4 c1 = vec4(  1,  0.0425,   1.04, -0.04);"),b.push("   vec4 r = roughness * c0 + c1;"),b.push("   float a004 = min(r.x * r.x, exp2(-9.28 * dotNV)) * r.x + r.y;"),b.push("   vec2 AB    = vec2(-1.04, 1.04) * a004 + r.zw;"),b.push("   return specularColor * AB.x + AB.y;"),b.push("}"),(o.lightMaps.length>0||o.reflectionMaps.length>0)&&(b.push("void computePBRLightMapping(const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),o.lightMaps.length>0&&(b.push("   vec3 irradiance = sRGBToLinear(textureCube(lightMap, geometry.worldNormal)).rgb;"),b.push("   irradiance *= PI;"),b.push("   vec3 diffuseBRDFContrib = (RECIPROCAL_PI * material.diffuseColor);"),b.push("   reflectedLight.diffuse += irradiance * diffuseBRDFContrib;")),o.reflectionMaps.length>0&&(b.push("   vec3 reflectVec             = reflect(-geometry.viewEyeDir, geometry.viewNormal);"),b.push("   reflectVec                  = inverseTransformDirection(reflectVec, viewMatrix);"),b.push("   float blinnExpFromRoughness = GGXRoughnessToBlinnExponent(material.specularRoughness);"),b.push("   vec3 radiance               = getLightProbeIndirectRadiance(reflectVec, blinnExpFromRoughness, 8);"),b.push("   vec3 specularBRDFContrib    = BRDF_Specular_GGX_Environment(geometry, material.specularColor, material.specularRoughness);"),b.push("   reflectedLight.specular     += radiance * specularBRDFContrib;")),b.push("}")),b.push("void computePBRLighting(const in IncidentLight incidentLight, const in Geometry geometry, const in Material material, inout ReflectedLight reflectedLight) {"),b.push("   float dotNL     = saturate(dot(geometry.viewNormal, incidentLight.direction));"),b.push("   vec3 irradiance = dotNL * incidentLight.color * PI;"),b.push("   reflectedLight.diffuse  += irradiance * (RECIPROCAL_PI * material.diffuseColor);"),b.push("   reflectedLight.specular += irradiance * BRDF_Specular_GGX(incidentLight, geometry, material.specularColor, material.specularRoughness);"),b.push("}"))),b.push("varying vec3 vViewPosition;"),r.colors&&b.push("varying vec4 vColor;"),d&&(h&&i._normalMap||i._ambientMap||i._baseColorMap||i._diffuseMap||i._emissiveMap||i._metallicMap||i._roughnessMap||i._metallicRoughnessMap||i._specularMap||i._glossinessMap||i._specularGlossinessMap||i._occlusionMap||i._alphaMap)&&b.push("varying vec2 vUV;"),h&&(o.lightMaps.length>0&&b.push("varying vec3 vWorldNormal;"),b.push("varying vec3 vViewNormal;")),s.ambient&&b.push("uniform vec3 materialAmbient;"),s.baseColor&&b.push("uniform vec3 materialBaseColor;"),void 0!==s.alpha&&null!==s.alpha&&b.push("uniform vec4 materialAlphaModeCutoff;"),s.emissive&&b.push("uniform vec3 materialEmissive;"),s.diffuse&&b.push("uniform vec3 materialDiffuse;"),void 0!==s.glossiness&&null!==s.glossiness&&b.push("uniform float materialGlossiness;"),void 0!==s.shininess&&null!==s.shininess&&b.push("uniform float materialShininess;"),s.specular&&b.push("uniform vec3 materialSpecular;"),void 0!==s.metallic&&null!==s.metallic&&b.push("uniform float materialMetallic;"),void 0!==s.roughness&&null!==s.roughness&&b.push("uniform float materialRoughness;"),void 0!==s.specularF0&&null!==s.specularF0&&b.push("uniform float materialSpecularF0;"),d&&i._ambientMap&&(b.push("uniform sampler2D ambientMap;"),i._ambientMap._state.matrix&&b.push("uniform mat4 ambientMapMatrix;")),d&&i._baseColorMap&&(b.push("uniform sampler2D baseColorMap;"),i._baseColorMap._state.matrix&&b.push("uniform mat4 baseColorMapMatrix;")),d&&i._diffuseMap&&(b.push("uniform sampler2D diffuseMap;"),i._diffuseMap._state.matrix&&b.push("uniform mat4 diffuseMapMatrix;")),d&&i._emissiveMap&&(b.push("uniform sampler2D emissiveMap;"),i._emissiveMap._state.matrix&&b.push("uniform mat4 emissiveMapMatrix;")),h&&d&&i._metallicMap&&(b.push("uniform sampler2D metallicMap;"),i._metallicMap._state.matrix&&b.push("uniform mat4 metallicMapMatrix;")),h&&d&&i._roughnessMap&&(b.push("uniform sampler2D roughnessMap;"),i._roughnessMap._state.matrix&&b.push("uniform mat4 roughnessMapMatrix;")),h&&d&&i._metallicRoughnessMap&&(b.push("uniform sampler2D metallicRoughnessMap;"),i._metallicRoughnessMap._state.matrix&&b.push("uniform mat4 metallicRoughnessMapMatrix;")),h&&i._normalMap&&(b.push("uniform sampler2D normalMap;"),i._normalMap._state.matrix&&b.push("uniform mat4 normalMapMatrix;"),b.push("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {"),b.push("      vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );"),b.push("      vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );"),b.push("      vec2 st0 = dFdx( uv.st );"),b.push("      vec2 st1 = dFdy( uv.st );"),b.push("      vec3 S = normalize( q0 * st1.t - q1 * st0.t );"),b.push("      vec3 T = normalize( -q0 * st1.s + q1 * st0.s );"),b.push("      vec3 N = normalize( surf_norm );"),b.push("      vec3 mapN = texture2D( normalMap, uv ).xyz * 2.0 - 1.0;"),b.push("      mat3 tsn = mat3( S, T, N );"),b.push("      return normalize( tsn * mapN );"),b.push("}")),d&&i._occlusionMap&&(b.push("uniform sampler2D occlusionMap;"),i._occlusionMap._state.matrix&&b.push("uniform mat4 occlusionMapMatrix;")),d&&i._alphaMap&&(b.push("uniform sampler2D alphaMap;"),i._alphaMap._state.matrix&&b.push("uniform mat4 alphaMapMatrix;")),h&&d&&i._specularMap&&(b.push("uniform sampler2D specularMap;"),i._specularMap._state.matrix&&b.push("uniform mat4 specularMapMatrix;")),h&&d&&i._glossinessMap&&(b.push("uniform sampler2D glossinessMap;"),i._glossinessMap._state.matrix&&b.push("uniform mat4 glossinessMapMatrix;")),h&&d&&i._specularGlossinessMap&&(b.push("uniform sampler2D materialSpecularGlossinessMap;"),i._specularGlossinessMap._state.matrix&&b.push("uniform mat4 materialSpecularGlossinessMapMatrix;")),h&&(i._diffuseFresnel||i._specularFresnel||i._alphaFresnel||i._emissiveFresnel||i._reflectivityFresnel)&&(b.push("float fresnel(vec3 eyeDir, vec3 normal, float edgeBias, float centerBias, float power) {"),b.push("    float fr = abs(dot(eyeDir, normal));"),b.push("    float finalFr = clamp((fr - edgeBias) / (centerBias - edgeBias), 0.0, 1.0);"),b.push("    return pow(finalFr, power);"),b.push("}"),i._diffuseFresnel&&(b.push("uniform float  diffuseFresnelCenterBias;"),b.push("uniform float  diffuseFresnelEdgeBias;"),b.push("uniform float  diffuseFresnelPower;"),b.push("uniform vec3   diffuseFresnelCenterColor;"),b.push("uniform vec3   diffuseFresnelEdgeColor;")),i._specularFresnel&&(b.push("uniform float  specularFresnelCenterBias;"),b.push("uniform float  specularFresnelEdgeBias;"),b.push("uniform float  specularFresnelPower;"),b.push("uniform vec3   specularFresnelCenterColor;"),b.push("uniform vec3   specularFresnelEdgeColor;")),i._alphaFresnel&&(b.push("uniform float  alphaFresnelCenterBias;"),b.push("uniform float  alphaFresnelEdgeBias;"),b.push("uniform float  alphaFresnelPower;"),b.push("uniform vec3   alphaFresnelCenterColor;"),b.push("uniform vec3   alphaFresnelEdgeColor;")),i._reflectivityFresnel&&(b.push("uniform float  materialSpecularF0FresnelCenterBias;"),b.push("uniform float  materialSpecularF0FresnelEdgeBias;"),b.push("uniform float  materialSpecularF0FresnelPower;"),b.push("uniform vec3   materialSpecularF0FresnelCenterColor;"),b.push("uniform vec3   materialSpecularF0FresnelEdgeColor;")),i._emissiveFresnel&&(b.push("uniform float  emissiveFresnelCenterBias;"),b.push("uniform float  emissiveFresnelEdgeBias;"),b.push("uniform float  emissiveFresnelPower;"),b.push("uniform vec3   emissiveFresnelCenterColor;"),b.push("uniform vec3   emissiveFresnelEdgeColor;"))),b.push("uniform vec4   lightAmbient;"),h)for(let e=0,t=o.lights.length;e<t;e++){const t=o.lights[e];"ambient"!==t.type&&(b.push("uniform vec4 lightColor"+e+";"),"point"===t.type&&b.push("uniform vec3 lightAttenuation"+e+";"),"dir"===t.type&&"view"===t.space&&b.push("uniform vec3 lightDir"+e+";"),"point"===t.type&&"view"===t.space?b.push("uniform vec3 lightPos"+e+";"):b.push("varying vec4 vViewLightReverseDirAndDist"+e+";"))}if(g)for(let e=0,t=o.lights.length;e<t;e++)o.lights[e].castsShadow&&(b.push("varying vec4 vShadowPosFromLight"+e+";"),b.push("uniform sampler2D shadowMap"+e+";"));if(b.push("uniform vec4 colorize;"),b.push("void main(void) {"),a){b.push("if (clippable) {"),b.push("  float dist = 0.0;");for(_=0;_<n.sectionPlanes.length;_++)b.push("if (sectionPlaneActive"+_+") {"),b.push("   dist += clamp(dot(-sectionPlaneDir"+_+".xyz, vWorldPosition.xyz - sectionPlanePos"+_+".xyz), 0.0, 1000.0);"),b.push("}");b.push("  if (dist > 0.0) { discard; }"),b.push("}")}if("points"===r.primitiveName&&(b.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),b.push("float r = dot(cxy, cxy);"),b.push("if (r > 1.0) {"),b.push("   discard;"),b.push("}")),b.push("float occlusion = 1.0;"),s.ambient?b.push("vec3 ambientColor = materialAmbient;"):b.push("vec3 ambientColor = vec3(1.0, 1.0, 1.0);"),s.diffuse?b.push("vec3 diffuseColor = materialDiffuse;"):s.baseColor?b.push("vec3 diffuseColor = materialBaseColor;"):b.push("vec3 diffuseColor = vec3(1.0, 1.0, 1.0);"),r.colors&&b.push("diffuseColor *= vColor.rgb;"),s.emissive?b.push("vec3 emissiveColor = materialEmissive;"):b.push("vec3  emissiveColor = vec3(0.0, 0.0, 0.0);"),s.specular?b.push("vec3 specular = materialSpecular;"):b.push("vec3 specular = vec3(1.0, 1.0, 1.0);"),void 0!==s.alpha?b.push("float alpha = materialAlphaModeCutoff[0];"):b.push("float alpha = 1.0;"),r.colors&&b.push("alpha *= vColor.a;"),void 0!==s.glossiness?b.push("float glossiness = materialGlossiness;"):b.push("float glossiness = 1.0;"),void 0!==s.metallic?b.push("float metallic = materialMetallic;"):b.push("float metallic = 1.0;"),void 0!==s.roughness?b.push("float roughness = materialRoughness;"):b.push("float roughness = 1.0;"),void 0!==s.specularF0?b.push("float specularF0 = materialSpecularF0;"):b.push("float specularF0 = 1.0;"),d&&(h&&i._normalMap||i._ambientMap||i._baseColorMap||i._diffuseMap||i._occlusionMap||i._emissiveMap||i._metallicMap||i._roughnessMap||i._metallicRoughnessMap||i._specularMap||i._glossinessMap||i._specularGlossinessMap||i._alphaMap)&&(b.push("vec4 texturePos = vec4(vUV.s, vUV.t, 1.0, 1.0);"),b.push("vec2 textureCoord;")),d&&i._ambientMap&&(i._ambientMap._state.matrix?b.push("textureCoord = (ambientMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec4 ambientTexel = texture2D(ambientMap, textureCoord).rgb;"),b.push("ambientTexel = "+l[i._ambientMap._state.encoding]+"(ambientTexel);"),b.push("ambientColor *= ambientTexel.rgb;")),d&&i._diffuseMap&&(i._diffuseMap._state.matrix?b.push("textureCoord = (diffuseMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec4 diffuseTexel = texture2D(diffuseMap, textureCoord);"),b.push("diffuseTexel = "+l[i._diffuseMap._state.encoding]+"(diffuseTexel);"),b.push("diffuseColor *= diffuseTexel.rgb;"),b.push("alpha *= diffuseTexel.a;")),d&&i._baseColorMap&&(i._baseColorMap._state.matrix?b.push("textureCoord = (baseColorMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec4 baseColorTexel = texture2D(baseColorMap, textureCoord);"),b.push("baseColorTexel = "+l[i._baseColorMap._state.encoding]+"(baseColorTexel);"),b.push("diffuseColor *= baseColorTexel.rgb;"),b.push("alpha *= baseColorTexel.a;")),d&&i._emissiveMap&&(i._emissiveMap._state.matrix?b.push("textureCoord = (emissiveMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec4 emissiveTexel = texture2D(emissiveMap, textureCoord);"),b.push("emissiveTexel = "+l[i._emissiveMap._state.encoding]+"(emissiveTexel);"),b.push("emissiveColor = emissiveTexel.rgb;")),d&&i._alphaMap&&(i._alphaMap._state.matrix?b.push("textureCoord = (alphaMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("alpha *= texture2D(alphaMap, textureCoord).r;")),d&&i._occlusionMap&&(i._occlusionMap._state.matrix?b.push("textureCoord = (occlusionMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("occlusion *= texture2D(occlusionMap, textureCoord).r;")),h&&(o.lights.length>0||o.lightMaps.length>0||o.reflectionMaps.length>0)){d&&i._normalMap?(i._normalMap._state.matrix?b.push("textureCoord = (normalMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec3 viewNormal = perturbNormal2Arb( vViewPosition, normalize(vViewNormal), textureCoord );")):b.push("vec3 viewNormal = normalize(vViewNormal);"),d&&i._specularMap&&(i._specularMap._state.matrix?b.push("textureCoord = (specularMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("specular *= texture2D(specularMap, textureCoord).rgb;")),d&&i._glossinessMap&&(i._glossinessMap._state.matrix?b.push("textureCoord = (glossinessMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("glossiness *= texture2D(glossinessMap, textureCoord).r;")),d&&i._specularGlossinessMap&&(i._specularGlossinessMap._state.matrix?b.push("textureCoord = (materialSpecularGlossinessMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec4 specGlossRGB = texture2D(materialSpecularGlossinessMap, textureCoord).rgba;"),b.push("specular *= specGlossRGB.rgb;"),b.push("glossiness *= specGlossRGB.a;")),d&&i._metallicMap&&(i._metallicMap._state.matrix?b.push("textureCoord = (metallicMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("metallic *= texture2D(metallicMap, textureCoord).r;")),d&&i._roughnessMap&&(i._roughnessMap._state.matrix?b.push("textureCoord = (roughnessMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("roughness *= texture2D(roughnessMap, textureCoord).r;")),d&&i._metallicRoughnessMap&&(i._metallicRoughnessMap._state.matrix?b.push("textureCoord = (metallicRoughnessMapMatrix * texturePos).xy;"):b.push("textureCoord = texturePos.xy;"),b.push("vec3 metalRoughRGB = texture2D(metallicRoughnessMap, textureCoord).rgb;"),b.push("metallic *= metalRoughRGB.b;"),b.push("roughness *= metalRoughRGB.g;")),b.push("vec3 viewEyeDir = normalize(-vViewPosition);"),i._diffuseFresnel&&(b.push("float diffuseFresnel = fresnel(viewEyeDir, viewNormal, diffuseFresnelEdgeBias, diffuseFresnelCenterBias, diffuseFresnelPower);"),b.push("diffuseColor *= mix(diffuseFresnelEdgeColor, diffuseFresnelCenterColor, diffuseFresnel);")),i._specularFresnel&&(b.push("float specularFresnel = fresnel(viewEyeDir, viewNormal, specularFresnelEdgeBias, specularFresnelCenterBias, specularFresnelPower);"),b.push("specular *= mix(specularFresnelEdgeColor, specularFresnelCenterColor, specularFresnel);")),i._alphaFresnel&&(b.push("float alphaFresnel = fresnel(viewEyeDir, viewNormal, alphaFresnelEdgeBias, alphaFresnelCenterBias, alphaFresnelPower);"),b.push("alpha *= mix(alphaFresnelEdgeColor.r, alphaFresnelCenterColor.r, alphaFresnel);")),i._emissiveFresnel&&(b.push("float emissiveFresnel = fresnel(viewEyeDir, viewNormal, emissiveFresnelEdgeBias, emissiveFresnelCenterBias, emissiveFresnelPower);"),b.push("emissiveColor *= mix(emissiveFresnelEdgeColor, emissiveFresnelCenterColor, emissiveFresnel);")),b.push("if (materialAlphaModeCutoff[1] == 1.0 && alpha < materialAlphaModeCutoff[2]) {"),b.push("   discard;"),b.push("}"),b.push("IncidentLight  light;"),b.push("Material       material;"),b.push("Geometry       geometry;"),b.push("ReflectedLight reflectedLight = ReflectedLight(vec3(0.0,0.0,0.0), vec3(0.0,0.0,0.0));"),b.push("vec3           viewLightDir;"),p&&(b.push("material.diffuseColor      = diffuseColor;"),b.push("material.specularColor     = specular;"),b.push("material.shine             = materialShininess;")),m&&(b.push("float oneMinusSpecularStrength = 1.0 - max(max(specular.r, specular.g ),specular.b);"),b.push("material.diffuseColor      = diffuseColor * oneMinusSpecularStrength;"),b.push("material.specularRoughness = clamp( 1.0 - glossiness, 0.04, 1.0 );"),b.push("material.specularColor     = specular;")),f&&(b.push("float dielectricSpecular = 0.16 * specularF0 * specularF0;"),b.push("material.diffuseColor      = diffuseColor * (1.0 - dielectricSpecular) * (1.0 - metallic);"),b.push("material.specularRoughness = clamp(roughness, 0.04, 1.0);"),b.push("material.specularColor     = mix(vec3(dielectricSpecular), diffuseColor, metallic);")),b.push("geometry.position      = vViewPosition;"),o.lightMaps.length>0&&b.push("geometry.worldNormal   = normalize(vWorldNormal);"),b.push("geometry.viewNormal    = viewNormal;"),b.push("geometry.viewEyeDir    = viewEyeDir;"),p&&(o.lightMaps.length>0||o.reflectionMaps.length>0)&&b.push("computePhongLightMapping(geometry, material, reflectedLight);"),(m||f)&&(o.lightMaps.length>0||o.reflectionMaps.length>0)&&b.push("computePBRLightMapping(geometry, material, reflectedLight);"),b.push("float shadow = 1.0;"),b.push("float shadowAcneRemover = 0.007;"),b.push("vec3 fragmentDepth;"),b.push("float texelSize = 1.0 / 1024.0;"),b.push("float amountInLight = 0.0;"),b.push("vec3 shadowCoord;"),b.push("vec4 rgbaDepth;"),b.push("float depth;");for(let e=0,t=o.lights.length;e<t;e++){const t=o.lights[e];"ambient"!==t.type&&("dir"===t.type&&"view"===t.space?b.push("viewLightDir = -normalize(lightDir"+e+");"):"point"===t.type&&"view"===t.space?b.push("viewLightDir = normalize(lightPos"+e+" - vViewPosition);"):b.push("viewLightDir = normalize(vViewLightReverseDirAndDist"+e+".xyz);"),g&&t.castsShadow?(b.push("shadow = 0.0;"),b.push("fragmentDepth = vShadowPosFromLight"+e+".xyz;"),b.push("fragmentDepth.z -= shadowAcneRemover;"),b.push("for (int x = -3; x <= 3; x++) {"),b.push("  for (int y = -3; y <= 3; y++) {"),b.push("      float texelDepth = unpackDepth(texture2D(shadowMap"+e+", fragmentDepth.xy + vec2(x, y) * texelSize));"),b.push("      if (fragmentDepth.z < texelDepth) {"),b.push("          shadow += 1.0;"),b.push("      }"),b.push("  }"),b.push("}"),b.push("shadow = shadow / 9.0;"),b.push("light.color =  lightColor"+e+".rgb * (lightColor"+e+".a * shadow);")):b.push("light.color =  lightColor"+e+".rgb * (lightColor"+e+".a );"),b.push("light.direction = viewLightDir;"),p&&b.push("computePhongLighting(light, geometry, material, reflectedLight);"),(m||f)&&b.push("computePBRLighting(light, geometry, material, reflectedLight);"))}p?(b.push("ambientColor *= (lightAmbient.rgb * lightAmbient.a);"),b.push("vec3 outgoingLight =  ((occlusion * (( reflectedLight.diffuse + reflectedLight.specular)))) + emissiveColor;")):b.push("vec3 outgoingLight = (occlusion * (reflectedLight.diffuse)) + (occlusion * reflectedLight.specular) + emissiveColor;")}else b.push("ambientColor *= (lightAmbient.rgb * lightAmbient.a);"),b.push("vec3 outgoingLight = emissiveColor + ambientColor;");return b.push("gl_FragColor = vec4(outgoingLight, alpha) * colorize;"),v&&b.push("gl_FragColor = linearToGamma(gl_FragColor, gammaFactor);"),t.logarithmicDepthBufferEnabled&&b.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),b.push("}"),b}(e))},l={linear:"linearToLinear",sRGB:"sRGBToLinear",gamma:"gammaToLinear"};function c(e){if(!e.receivesShadow)return!1;const t=e.scene._lightsState.lights;if(!t||0===t.length)return!1;for(let e=0,i=t.length;e<i;e++)if(t[e].castsShadow)return!0;return!1}function u(e){const t=e._geometry._state.primitiveName;return!(!e._geometry._state.autoVertexNormals&&!e._geometry._state.normalsBuf||"triangles"!==t&&"triangle-strip"!==t&&"triangle-fan"!==t)}var h=i(11),d=i(15),p=i(7),f=i(9);const m=r.math.vec3(),g=new s.Map({}),v=function(e,t){this.id=g.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new a(t),this._allocate(t)},b={};v.get=function(e){const t=e.scene,i=[t.canvas.canvas.id,(t.gammaInput?"gi;":";")+(t.gammaOutput?"go":""),t._lightsState.getHash(),t._sectionPlanesState.getHash(),e._geometry._state.hash,e._material._state.hash,e._state.drawHash].join(";");let r=b[i];if(!r){if((r=new v(i,e)).errors)return console.log(r.errors.join("\n")),null;b[i]=r,d.a.memory.programs++}return r._useCount++,r},v.prototype.put=function(){0==--this._useCount&&(g.removeItem(this.id),this._program&&this._program.destroy(),delete b[this._hash],d.a.memory.programs--)},v.prototype.webglContextRestored=function(){this._program=null},v.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=p.a.MAX_TEXTURE_UNITS,r=t.scene,n=t._material,o=r.canvas.gl,s=this._program,a=t._state,l=t._material._state,c=t._geometry._state,u=r.camera,h=t.rtcCenter;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),o.uniformMatrix4fv(this._uViewMatrix,!1,h?e.getRTCViewMatrix(a.rtcCenterHash,h):u.viewMatrix),o.uniformMatrix4fv(this._uViewNormalMatrix,!1,u.viewNormalMatrix),a.clippable){const e=r._sectionPlanesState.sectionPlanes.length;if(e>0){const i=r._sectionPlanesState.sectionPlanes,n=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],r=n.sectionPlanesActivePerLayer[t];if(o.uniform1i(e.active,r?1:0),r){const r=i[t];o.uniform3fv(e.pos,h?Object(f.b)(r.dist,r.dir,h,m):r.pos),o.uniform3fv(e.dir,r.dir)}}}}if(l.id!==this._lastMaterialId){e.textureUnit=this._baseTextureUnit;const t=l.backfaces;e.backfaces!==t&&(t?o.disable(o.CULL_FACE):o.enable(o.CULL_FACE),e.backfaces=t);const r=l.frontface;switch(e.frontface!==r&&(r?o.frontFace(o.CCW):o.frontFace(o.CW),e.frontface=r),e.lineWidth!==l.lineWidth&&(o.lineWidth(l.lineWidth),e.lineWidth=l.lineWidth),this._uPointSize&&o.uniform1f(this._uPointSize,l.pointSize),l.type){case"LambertMaterial":this._uMaterialAmbient&&o.uniform3fv(this._uMaterialAmbient,l.ambient),this._uMaterialColor&&o.uniform4f(this._uMaterialColor,l.color[0],l.color[1],l.color[2],l.alpha),this._uMaterialEmissive&&o.uniform3fv(this._uMaterialEmissive,l.emissive);break;case"PhongMaterial":this._uMaterialShininess&&o.uniform1f(this._uMaterialShininess,l.shininess),this._uMaterialAmbient&&o.uniform3fv(this._uMaterialAmbient,l.ambient),this._uMaterialDiffuse&&o.uniform3fv(this._uMaterialDiffuse,l.diffuse),this._uMaterialSpecular&&o.uniform3fv(this._uMaterialSpecular,l.specular),this._uMaterialEmissive&&o.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&o.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0),n._ambientMap&&n._ambientMap._state.texture&&this._uMaterialAmbientMap&&(s.bindTexture(this._uMaterialAmbientMap,n._ambientMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMaterialAmbientMapMatrix&&o.uniformMatrix4fv(this._uMaterialAmbientMapMatrix,!1,n._ambientMap._state.matrix)),n._diffuseMap&&n._diffuseMap._state.texture&&this._uDiffuseMap&&(s.bindTexture(this._uDiffuseMap,n._diffuseMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uDiffuseMapMatrix&&o.uniformMatrix4fv(this._uDiffuseMapMatrix,!1,n._diffuseMap._state.matrix)),n._specularMap&&n._specularMap._state.texture&&this._uSpecularMap&&(s.bindTexture(this._uSpecularMap,n._specularMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularMapMatrix&&o.uniformMatrix4fv(this._uSpecularMapMatrix,!1,n._specularMap._state.matrix)),n._emissiveMap&&n._emissiveMap._state.texture&&this._uEmissiveMap&&(s.bindTexture(this._uEmissiveMap,n._emissiveMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&o.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,n._emissiveMap._state.matrix)),n._alphaMap&&n._alphaMap._state.texture&&this._uAlphaMap&&(s.bindTexture(this._uAlphaMap,n._alphaMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&o.uniformMatrix4fv(this._uAlphaMapMatrix,!1,n._alphaMap._state.matrix)),n._reflectivityMap&&n._reflectivityMap._state.texture&&this._uReflectivityMap&&(s.bindTexture(this._uReflectivityMap,n._reflectivityMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,this._uReflectivityMapMatrix&&o.uniformMatrix4fv(this._uReflectivityMapMatrix,!1,n._reflectivityMap._state.matrix)),n._normalMap&&n._normalMap._state.texture&&this._uNormalMap&&(s.bindTexture(this._uNormalMap,n._normalMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&o.uniformMatrix4fv(this._uNormalMapMatrix,!1,n._normalMap._state.matrix)),n._occlusionMap&&n._occlusionMap._state.texture&&this._uOcclusionMap&&(s.bindTexture(this._uOcclusionMap,n._occlusionMap._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&o.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,n._occlusionMap._state.matrix)),n._diffuseFresnel&&(this._uDiffuseFresnelEdgeBias&&o.uniform1f(this._uDiffuseFresnelEdgeBias,n._diffuseFresnel.edgeBias),this._uDiffuseFresnelCenterBias&&o.uniform1f(this._uDiffuseFresnelCenterBias,n._diffuseFresnel.centerBias),this._uDiffuseFresnelEdgeColor&&o.uniform3fv(this._uDiffuseFresnelEdgeColor,n._diffuseFresnel.edgeColor),this._uDiffuseFresnelCenterColor&&o.uniform3fv(this._uDiffuseFresnelCenterColor,n._diffuseFresnel.centerColor),this._uDiffuseFresnelPower&&o.uniform1f(this._uDiffuseFresnelPower,n._diffuseFresnel.power)),n._specularFresnel&&(this._uSpecularFresnelEdgeBias&&o.uniform1f(this._uSpecularFresnelEdgeBias,n._specularFresnel.edgeBias),this._uSpecularFresnelCenterBias&&o.uniform1f(this._uSpecularFresnelCenterBias,n._specularFresnel.centerBias),this._uSpecularFresnelEdgeColor&&o.uniform3fv(this._uSpecularFresnelEdgeColor,n._specularFresnel.edgeColor),this._uSpecularFresnelCenterColor&&o.uniform3fv(this._uSpecularFresnelCenterColor,n._specularFresnel.centerColor),this._uSpecularFresnelPower&&o.uniform1f(this._uSpecularFresnelPower,n._specularFresnel.power)),n._alphaFresnel&&(this._uAlphaFresnelEdgeBias&&o.uniform1f(this._uAlphaFresnelEdgeBias,n._alphaFresnel.edgeBias),this._uAlphaFresnelCenterBias&&o.uniform1f(this._uAlphaFresnelCenterBias,n._alphaFresnel.centerBias),this._uAlphaFresnelEdgeColor&&o.uniform3fv(this._uAlphaFresnelEdgeColor,n._alphaFresnel.edgeColor),this._uAlphaFresnelCenterColor&&o.uniform3fv(this._uAlphaFresnelCenterColor,n._alphaFresnel.centerColor),this._uAlphaFresnelPower&&o.uniform1f(this._uAlphaFresnelPower,n._alphaFresnel.power)),n._reflectivityFresnel&&(this._uReflectivityFresnelEdgeBias&&o.uniform1f(this._uReflectivityFresnelEdgeBias,n._reflectivityFresnel.edgeBias),this._uReflectivityFresnelCenterBias&&o.uniform1f(this._uReflectivityFresnelCenterBias,n._reflectivityFresnel.centerBias),this._uReflectivityFresnelEdgeColor&&o.uniform3fv(this._uReflectivityFresnelEdgeColor,n._reflectivityFresnel.edgeColor),this._uReflectivityFresnelCenterColor&&o.uniform3fv(this._uReflectivityFresnelCenterColor,n._reflectivityFresnel.centerColor),this._uReflectivityFresnelPower&&o.uniform1f(this._uReflectivityFresnelPower,n._reflectivityFresnel.power)),n._emissiveFresnel&&(this._uEmissiveFresnelEdgeBias&&o.uniform1f(this._uEmissiveFresnelEdgeBias,n._emissiveFresnel.edgeBias),this._uEmissiveFresnelCenterBias&&o.uniform1f(this._uEmissiveFresnelCenterBias,n._emissiveFresnel.centerBias),this._uEmissiveFresnelEdgeColor&&o.uniform3fv(this._uEmissiveFresnelEdgeColor,n._emissiveFresnel.edgeColor),this._uEmissiveFresnelCenterColor&&o.uniform3fv(this._uEmissiveFresnelCenterColor,n._emissiveFresnel.centerColor),this._uEmissiveFresnelPower&&o.uniform1f(this._uEmissiveFresnelPower,n._emissiveFresnel.power));break;case"MetallicMaterial":this._uBaseColor&&o.uniform3fv(this._uBaseColor,l.baseColor),this._uMaterialMetallic&&o.uniform1f(this._uMaterialMetallic,l.metallic),this._uMaterialRoughness&&o.uniform1f(this._uMaterialRoughness,l.roughness),this._uMaterialSpecularF0&&o.uniform1f(this._uMaterialSpecularF0,l.specularF0),this._uMaterialEmissive&&o.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&o.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0);const t=n._baseColorMap;t&&t._state.texture&&this._uBaseColorMap&&(s.bindTexture(this._uBaseColorMap,t._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uBaseColorMapMatrix&&o.uniformMatrix4fv(this._uBaseColorMapMatrix,!1,t._state.matrix));const r=n._metallicMap;r&&r._state.texture&&this._uMetallicMap&&(s.bindTexture(this._uMetallicMap,r._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMetallicMapMatrix&&o.uniformMatrix4fv(this._uMetallicMapMatrix,!1,r._state.matrix));const a=n._roughnessMap;a&&a._state.texture&&this._uRoughnessMap&&(s.bindTexture(this._uRoughnessMap,a._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uRoughnessMapMatrix&&o.uniformMatrix4fv(this._uRoughnessMapMatrix,!1,a._state.matrix));const c=n._metallicRoughnessMap;c&&c._state.texture&&this._uMetallicRoughnessMap&&(s.bindTexture(this._uMetallicRoughnessMap,c._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uMetallicRoughnessMapMatrix&&o.uniformMatrix4fv(this._uMetallicRoughnessMapMatrix,!1,c._state.matrix)),(d=n._emissiveMap)&&d._state.texture&&this._uEmissiveMap&&(s.bindTexture(this._uEmissiveMap,d._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&o.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,d._state.matrix)),(g=n._occlusionMap)&&n._occlusionMap._state.texture&&this._uOcclusionMap&&(s.bindTexture(this._uOcclusionMap,g._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&o.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,g._state.matrix)),(v=n._alphaMap)&&v._state.texture&&this._uAlphaMap&&(s.bindTexture(this._uAlphaMap,v._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&o.uniformMatrix4fv(this._uAlphaMapMatrix,!1,v._state.matrix)),(b=n._normalMap)&&b._state.texture&&this._uNormalMap&&(s.bindTexture(this._uNormalMap,b._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&o.uniformMatrix4fv(this._uNormalMapMatrix,!1,b._state.matrix));break;case"SpecularMaterial":this._uMaterialDiffuse&&o.uniform3fv(this._uMaterialDiffuse,l.diffuse),this._uMaterialSpecular&&o.uniform3fv(this._uMaterialSpecular,l.specular),this._uMaterialGlossiness&&o.uniform1f(this._uMaterialGlossiness,l.glossiness),this._uMaterialReflectivity&&o.uniform1f(this._uMaterialReflectivity,l.reflectivity),this._uMaterialEmissive&&o.uniform3fv(this._uMaterialEmissive,l.emissive),this._uAlphaModeCutoff&&o.uniform4f(this._uAlphaModeCutoff,1*l.alpha,1===l.alphaMode?1:0,l.alphaCutoff,0);const u=n._diffuseMap;u&&u._state.texture&&this._uDiffuseMap&&(s.bindTexture(this._uDiffuseMap,u._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uDiffuseMapMatrix&&o.uniformMatrix4fv(this._uDiffuseMapMatrix,!1,u._state.matrix));const h=n._specularMap;h&&h._state.texture&&this._uSpecularMap&&(s.bindTexture(this._uSpecularMap,h._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularMapMatrix&&o.uniformMatrix4fv(this._uSpecularMapMatrix,!1,h._state.matrix));const p=n._glossinessMap;p&&p._state.texture&&this._uGlossinessMap&&(s.bindTexture(this._uGlossinessMap,p._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uGlossinessMapMatrix&&o.uniformMatrix4fv(this._uGlossinessMapMatrix,!1,p._state.matrix));const f=n._specularGlossinessMap;var d,g,v,b;f&&f._state.texture&&this._uSpecularGlossinessMap&&(s.bindTexture(this._uSpecularGlossinessMap,f._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uSpecularGlossinessMapMatrix&&o.uniformMatrix4fv(this._uSpecularGlossinessMapMatrix,!1,f._state.matrix)),(d=n._emissiveMap)&&d._state.texture&&this._uEmissiveMap&&(s.bindTexture(this._uEmissiveMap,d._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uEmissiveMapMatrix&&o.uniformMatrix4fv(this._uEmissiveMapMatrix,!1,d._state.matrix)),(g=n._occlusionMap)&&g._state.texture&&this._uOcclusionMap&&(s.bindTexture(this._uOcclusionMap,g._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uOcclusionMapMatrix&&o.uniformMatrix4fv(this._uOcclusionMapMatrix,!1,g._state.matrix)),(v=n._alphaMap)&&v._state.texture&&this._uAlphaMap&&(s.bindTexture(this._uAlphaMap,v._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uAlphaMapMatrix&&o.uniformMatrix4fv(this._uAlphaMapMatrix,!1,v._state.matrix)),(b=n._normalMap)&&b._state.texture&&this._uNormalMap&&(s.bindTexture(this._uNormalMap,b._state.texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%i,e.bindTexture++,this._uNormalMapMatrix&&o.uniformMatrix4fv(this._uNormalMapMatrix,!1,b._state.matrix))}this._lastMaterialId=l.id}if(o.uniformMatrix4fv(this._uModelMatrix,o.FALSE,t.worldMatrix),this._uModelNormalMatrix&&o.uniformMatrix4fv(this._uModelNormalMatrix,o.FALSE,t.worldNormalMatrix),this._uClippable&&o.uniform1i(this._uClippable,a.clippable),this._uColorize){const e=a.colorize,t=this._lastColorize;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(o.uniform4fv(this._uColorize,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3])}o.uniform3fv(this._uOffset,a.offset),c.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,c.positionsDecodeMatrix),this._uUVDecodeMatrix&&o.uniformMatrix3fv(this._uUVDecodeMatrix,!1,c.uvDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(c.positionsBuf),e.bindArray++),this._aNormal&&(this._aNormal.bindArrayBuffer(c.normalsBuf),e.bindArray++),this._aUV&&(this._aUV.bindArrayBuffer(c.uvBuf),e.bindArray++),this._aColor&&(this._aColor.bindArrayBuffer(c.colorsBuf),e.bindArray++),this._aFlags&&(this._aFlags.bindArrayBuffer(c.flagsBuf),e.bindArray++),c.indicesBuf&&(c.indicesBuf.bind(),e.bindArray++),this._lastGeometryId=c.id),c.indicesBuf?(o.drawElements(c.primitive,c.indicesBuf.numItems,c.indicesBuf.itemType,0),e.drawElements++):c.positions&&(o.drawArrays(o.TRIANGLES,0,c.positions.numItems),e.drawArrays++)},v.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl,r=e._material,n=t._lightsState,o=t._sectionPlanesState,s=e._material._state;if(this._program=new h.a(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const a=this._program;this._uPositionsDecodeMatrix=a.getLocation("positionsDecodeMatrix"),this._uUVDecodeMatrix=a.getLocation("uvDecodeMatrix"),this._uModelMatrix=a.getLocation("modelMatrix"),this._uModelNormalMatrix=a.getLocation("modelNormalMatrix"),this._uViewMatrix=a.getLocation("viewMatrix"),this._uViewNormalMatrix=a.getLocation("viewNormalMatrix"),this._uProjMatrix=a.getLocation("projMatrix"),this._uGammaFactor=a.getLocation("gammaFactor"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[],this._uShadowViewMatrix=[],this._uShadowProjMatrix=[],t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=a.getLocation("logDepthBufFC"));const l=n.lights;let c;for(var u=0,d=l.length;u<d;u++){switch((c=l[u]).type){case"ambient":this._uLightAmbient[u]=a.getLocation("lightAmbient");break;case"dir":this._uLightColor[u]=a.getLocation("lightColor"+u),this._uLightPos[u]=null,this._uLightDir[u]=a.getLocation("lightDir"+u);break;case"point":this._uLightColor[u]=a.getLocation("lightColor"+u),this._uLightPos[u]=a.getLocation("lightPos"+u),this._uLightDir[u]=null,this._uLightAttenuation[u]=a.getLocation("lightAttenuation"+u);break;case"spot":this._uLightColor[u]=a.getLocation("lightColor"+u),this._uLightPos[u]=a.getLocation("lightPos"+u),this._uLightDir[u]=a.getLocation("lightDir"+u),this._uLightAttenuation[u]=a.getLocation("lightAttenuation"+u)}c.castsShadow&&(this._uShadowViewMatrix[u]=a.getLocation("shadowViewMatrix"+u),this._uShadowProjMatrix[u]=a.getLocation("shadowProjMatrix"+u))}for(n.lightMaps.length>0&&(this._uLightMap="lightMap"),n.reflectionMaps.length>0&&(this._uReflectionMap="reflectionMap"),this._uSectionPlanes=[],u=0,d=o.sectionPlanes.length;u<d;u++)this._uSectionPlanes.push({active:a.getLocation("sectionPlaneActive"+u),pos:a.getLocation("sectionPlanePos"+u),dir:a.getLocation("sectionPlaneDir"+u)});switch(this._uPointSize=a.getLocation("pointSize"),s.type){case"LambertMaterial":this._uMaterialColor=a.getLocation("materialColor"),this._uMaterialEmissive=a.getLocation("materialEmissive"),this._uAlphaModeCutoff=a.getLocation("materialAlphaModeCutoff");break;case"PhongMaterial":this._uMaterialAmbient=a.getLocation("materialAmbient"),this._uMaterialDiffuse=a.getLocation("materialDiffuse"),this._uMaterialSpecular=a.getLocation("materialSpecular"),this._uMaterialEmissive=a.getLocation("materialEmissive"),this._uAlphaModeCutoff=a.getLocation("materialAlphaModeCutoff"),this._uMaterialShininess=a.getLocation("materialShininess"),r._ambientMap&&(this._uMaterialAmbientMap="ambientMap",this._uMaterialAmbientMapMatrix=a.getLocation("ambientMapMatrix")),r._diffuseMap&&(this._uDiffuseMap="diffuseMap",this._uDiffuseMapMatrix=a.getLocation("diffuseMapMatrix")),r._specularMap&&(this._uSpecularMap="specularMap",this._uSpecularMapMatrix=a.getLocation("specularMapMatrix")),r._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=a.getLocation("emissiveMapMatrix")),r._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=a.getLocation("alphaMapMatrix")),r._reflectivityMap&&(this._uReflectivityMap="reflectivityMap",this._uReflectivityMapMatrix=a.getLocation("reflectivityMapMatrix")),r._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=a.getLocation("normalMapMatrix")),r._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=a.getLocation("occlusionMapMatrix")),r._diffuseFresnel&&(this._uDiffuseFresnelEdgeBias=a.getLocation("diffuseFresnelEdgeBias"),this._uDiffuseFresnelCenterBias=a.getLocation("diffuseFresnelCenterBias"),this._uDiffuseFresnelEdgeColor=a.getLocation("diffuseFresnelEdgeColor"),this._uDiffuseFresnelCenterColor=a.getLocation("diffuseFresnelCenterColor"),this._uDiffuseFresnelPower=a.getLocation("diffuseFresnelPower")),r._specularFresnel&&(this._uSpecularFresnelEdgeBias=a.getLocation("specularFresnelEdgeBias"),this._uSpecularFresnelCenterBias=a.getLocation("specularFresnelCenterBias"),this._uSpecularFresnelEdgeColor=a.getLocation("specularFresnelEdgeColor"),this._uSpecularFresnelCenterColor=a.getLocation("specularFresnelCenterColor"),this._uSpecularFresnelPower=a.getLocation("specularFresnelPower")),r._alphaFresnel&&(this._uAlphaFresnelEdgeBias=a.getLocation("alphaFresnelEdgeBias"),this._uAlphaFresnelCenterBias=a.getLocation("alphaFresnelCenterBias"),this._uAlphaFresnelEdgeColor=a.getLocation("alphaFresnelEdgeColor"),this._uAlphaFresnelCenterColor=a.getLocation("alphaFresnelCenterColor"),this._uAlphaFresnelPower=a.getLocation("alphaFresnelPower")),r._reflectivityFresnel&&(this._uReflectivityFresnelEdgeBias=a.getLocation("reflectivityFresnelEdgeBias"),this._uReflectivityFresnelCenterBias=a.getLocation("reflectivityFresnelCenterBias"),this._uReflectivityFresnelEdgeColor=a.getLocation("reflectivityFresnelEdgeColor"),this._uReflectivityFresnelCenterColor=a.getLocation("reflectivityFresnelCenterColor"),this._uReflectivityFresnelPower=a.getLocation("reflectivityFresnelPower")),r._emissiveFresnel&&(this._uEmissiveFresnelEdgeBias=a.getLocation("emissiveFresnelEdgeBias"),this._uEmissiveFresnelCenterBias=a.getLocation("emissiveFresnelCenterBias"),this._uEmissiveFresnelEdgeColor=a.getLocation("emissiveFresnelEdgeColor"),this._uEmissiveFresnelCenterColor=a.getLocation("emissiveFresnelCenterColor"),this._uEmissiveFresnelPower=a.getLocation("emissiveFresnelPower"));break;case"MetallicMaterial":this._uBaseColor=a.getLocation("materialBaseColor"),this._uMaterialMetallic=a.getLocation("materialMetallic"),this._uMaterialRoughness=a.getLocation("materialRoughness"),this._uMaterialSpecularF0=a.getLocation("materialSpecularF0"),this._uMaterialEmissive=a.getLocation("materialEmissive"),this._uAlphaModeCutoff=a.getLocation("materialAlphaModeCutoff"),r._baseColorMap&&(this._uBaseColorMap="baseColorMap",this._uBaseColorMapMatrix=a.getLocation("baseColorMapMatrix")),r._metallicMap&&(this._uMetallicMap="metallicMap",this._uMetallicMapMatrix=a.getLocation("metallicMapMatrix")),r._roughnessMap&&(this._uRoughnessMap="roughnessMap",this._uRoughnessMapMatrix=a.getLocation("roughnessMapMatrix")),r._metallicRoughnessMap&&(this._uMetallicRoughnessMap="metallicRoughnessMap",this._uMetallicRoughnessMapMatrix=a.getLocation("metallicRoughnessMapMatrix")),r._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=a.getLocation("emissiveMapMatrix")),r._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=a.getLocation("occlusionMapMatrix")),r._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=a.getLocation("alphaMapMatrix")),r._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=a.getLocation("normalMapMatrix"));break;case"SpecularMaterial":this._uMaterialDiffuse=a.getLocation("materialDiffuse"),this._uMaterialSpecular=a.getLocation("materialSpecular"),this._uMaterialGlossiness=a.getLocation("materialGlossiness"),this._uMaterialReflectivity=a.getLocation("reflectivityFresnel"),this._uMaterialEmissive=a.getLocation("materialEmissive"),this._uAlphaModeCutoff=a.getLocation("materialAlphaModeCutoff"),r._diffuseMap&&(this._uDiffuseMap="diffuseMap",this._uDiffuseMapMatrix=a.getLocation("diffuseMapMatrix")),r._specularMap&&(this._uSpecularMap="specularMap",this._uSpecularMapMatrix=a.getLocation("specularMapMatrix")),r._glossinessMap&&(this._uGlossinessMap="glossinessMap",this._uGlossinessMapMatrix=a.getLocation("glossinessMapMatrix")),r._specularGlossinessMap&&(this._uSpecularGlossinessMap="materialSpecularGlossinessMap",this._uSpecularGlossinessMapMatrix=a.getLocation("materialSpecularGlossinessMapMatrix")),r._emissiveMap&&(this._uEmissiveMap="emissiveMap",this._uEmissiveMapMatrix=a.getLocation("emissiveMapMatrix")),r._occlusionMap&&(this._uOcclusionMap="occlusionMap",this._uOcclusionMapMatrix=a.getLocation("occlusionMapMatrix")),r._alphaMap&&(this._uAlphaMap="alphaMap",this._uAlphaMapMatrix=a.getLocation("alphaMapMatrix")),r._normalMap&&(this._uNormalMap="normalMap",this._uNormalMapMatrix=a.getLocation("normalMapMatrix"))}this._aPosition=a.getAttribute("position"),this._aNormal=a.getAttribute("normal"),this._aUV=a.getAttribute("uv"),this._aColor=a.getAttribute("color"),this._aFlags=a.getAttribute("flags"),this._uClippable=a.getLocation("clippable"),this._uColorize=a.getLocation("colorize"),this._uOffset=a.getLocation("offset"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastColorize=new Float32Array(4),this._baseTextureUnit=0},v.prototype._bindProgram=function(e){const t=p.a.MAX_TEXTURE_UNITS,i=this._scene,r=i.canvas.gl,n=i._lightsState,o=i.camera.project;let s;const a=this._program;if(a.bind(),e.useProgram++,e.textureUnit=0,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastColorize[0]=-1,this._lastColorize[1]=-1,this._lastColorize[2]=-1,this._lastColorize[3]=-1,r.uniformMatrix4fv(this._uProjMatrix,!1,o.matrix),i.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.far+1)/Math.LN2);r.uniform1f(this._uLogDepthBufFC,e)}for(var l=0,c=n.lights.length;l<c;l++)if(s=n.lights[l],this._uLightAmbient[l])r.uniform4f(this._uLightAmbient[l],s.color[0],s.color[1],s.color[2],s.intensity);else if(this._uLightColor[l]&&r.uniform4f(this._uLightColor[l],s.color[0],s.color[1],s.color[2],s.intensity),this._uLightPos[l]&&(r.uniform3fv(this._uLightPos[l],s.pos),this._uLightAttenuation[l]&&r.uniform1f(this._uLightAttenuation[l],s.attenuation)),this._uLightDir[l]&&r.uniform3fv(this._uLightDir[l],s.dir),s.castsShadow){this._uShadowViewMatrix[l]&&r.uniformMatrix4fv(this._uShadowViewMatrix[l],!1,s.getShadowViewMatrix()),this._uShadowProjMatrix[l]&&r.uniformMatrix4fv(this._uShadowProjMatrix[l],!1,s.getShadowProjMatrix());const i=s.getShadowRenderBuf();i&&(a.bindTexture("shadowMap"+l,i.getTexture(),e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++)}n.lightMaps.length>0&&n.lightMaps[0].texture&&this._uLightMap&&(a.bindTexture(this._uLightMap,n.lightMaps[0].texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++),n.reflectionMaps.length>0&&n.reflectionMaps[0].texture&&this._uReflectionMap&&(a.bindTexture(this._uReflectionMap,n.reflectionMaps[0].texture,e.textureUnit),e.textureUnit=(e.textureUnit+1)%t,e.bindTexture++),this._uGammaFactor&&r.uniform1f(this._uGammaFactor,i.gammaFactor),this._baseTextureUnit=e.textureUnit};const _=new s.Map({}),y=r.math.vec3(),x=function(e,t){this.id=_.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene,i=t._lightsState,r=function(e){const t=e._geometry._state.primitiveName;return!(!e._geometry._state.autoVertexNormals&&!e._geometry._state.normalsBuf||"triangles"!==t&&"triangle-strip"!==t&&"triangle-fan"!==t)}(e),n=t._sectionPlanesState.sectionPlanes.length>0,o=!!e._geometry._state.compressGeometry,s=e._state.billboard,a=e._state.stationary,l=[];if(l.push("// EmphasisFillShaderSource vertex shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("#extension GL_EXT_frag_depth : enable"),l.push("attribute vec3 position;"),l.push("uniform mat4 modelMatrix;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform vec4 colorize;"),l.push("uniform vec3 offset;"),o&&l.push("uniform mat4 positionsDecodeMatrix;"),t.logarithmicDepthBufferEnabled&&(l.push("uniform float logDepthBufFC;"),p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("varying float vFragDepth;")),n&&l.push("varying vec4 vWorldPosition;"),l.push("uniform vec4   lightAmbient;"),l.push("uniform vec4   fillColor;"),r){l.push("attribute vec3 normal;"),l.push("uniform mat4 modelNormalMatrix;"),l.push("uniform mat4 viewNormalMatrix;");for(let e=0,t=i.lights.length;e<t;e++){const t=i.lights[e];"ambient"!==t.type&&(l.push("uniform vec4 lightColor"+e+";"),"dir"===t.type&&l.push("uniform vec3 lightDir"+e+";"),"point"===t.type&&l.push("uniform vec3 lightPos"+e+";"),"spot"===t.type&&l.push("uniform vec3 lightPos"+e+";"))}o&&(l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"))}if(l.push("varying vec4 vColor;"),("spherical"===s||"cylindrical"===s)&&(l.push("void billboard(inout mat4 mat) {"),l.push("   mat[0][0] = 1.0;"),l.push("   mat[0][1] = 0.0;"),l.push("   mat[0][2] = 0.0;"),"spherical"===s&&(l.push("   mat[1][0] = 0.0;"),l.push("   mat[1][1] = 1.0;"),l.push("   mat[1][2] = 0.0;")),l.push("   mat[2][0] = 0.0;"),l.push("   mat[2][1] = 0.0;"),l.push("   mat[2][2] =1.0;"),l.push("}")),l.push("void main(void) {"),l.push("vec4 localPosition = vec4(position, 1.0); "),l.push("vec4 worldPosition;"),o&&l.push("localPosition = positionsDecodeMatrix * localPosition;"),r&&(o?l.push("vec4 localNormal = vec4(octDecode(normal.xy), 0.0); "):l.push("vec4 localNormal = vec4(normal, 0.0); "),l.push("mat4 modelNormalMatrix2 = modelNormalMatrix;"),l.push("mat4 viewNormalMatrix2 = viewNormalMatrix;")),l.push("mat4 viewMatrix2 = viewMatrix;"),l.push("mat4 modelMatrix2 = modelMatrix;"),a&&l.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"===s||"cylindrical"===s?(l.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),l.push("billboard(modelMatrix2);"),l.push("billboard(viewMatrix2);"),l.push("billboard(modelViewMatrix);"),r&&(l.push("mat4 modelViewNormalMatrix =  viewNormalMatrix2 * modelNormalMatrix2;"),l.push("billboard(modelNormalMatrix2);"),l.push("billboard(viewNormalMatrix2);"),l.push("billboard(modelViewNormalMatrix);")),l.push("worldPosition = modelMatrix2 * localPosition;"),l.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(l.push("worldPosition = modelMatrix2 * localPosition;"),l.push("worldPosition.xyz = worldPosition.xyz + offset;"),l.push("vec4 viewPosition  = viewMatrix2 * worldPosition; ")),r&&l.push("vec3 viewNormal = normalize((viewNormalMatrix2 * modelNormalMatrix2 * localNormal).xyz);"),l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),r)for(let e=0,t=i.lights.length;e<t;e++){const t=i.lights[e];if("ambient"!==t.type){if("dir"===t.type)"view"===t.space?l.push("viewLightDir = normalize(lightDir"+e+");"):l.push("viewLightDir = normalize((viewMatrix2 * vec4(lightDir"+e+", 0.0)).xyz);");else{if("point"!==t.type)continue;"view"===t.space?l.push("viewLightDir = normalize(lightPos"+e+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix2 * vec4(lightPos"+e+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+e+".rgb * lightColor"+e+".a);")}}return l.push("vColor = vec4(reflectedColor * fillColor.rgb, fillColor.a);"),n&&l.push("vWorldPosition = worldPosition;"),"points"===e._geometry._state.primitiveName&&l.push("gl_PointSize = pointSize;"),l.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&(p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?l.push("vFragDepth = 1.0 + clipPos.w;"):(l.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),l.push("clipPos.z *= clipPos.w;"))),l.push("gl_Position = clipPos;"),l.push("}"),l}(e),this.fragment=function(e){const t=e.scene,i=e.scene._sectionPlanesState,r=e.scene.gammaOutput,n=i.sectionPlanes.length>0,o=[];if(o.push("// Lambertian drawing fragment shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("#extension GL_EXT_frag_depth : enable"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(o.push("uniform float logDepthBufFC;"),o.push("varying float vFragDepth;")),r&&(o.push("uniform float gammaFactor;"),o.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),o.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),o.push("}")),n){o.push("varying vec4 vWorldPosition;"),o.push("uniform bool clippable;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)o.push("uniform bool sectionPlaneActive"+e+";"),o.push("uniform vec3 sectionPlanePos"+e+";"),o.push("uniform vec3 sectionPlaneDir"+e+";")}if(o.push("varying vec4 vColor;"),o.push("void main(void) {"),n){o.push("if (clippable) {"),o.push("  float dist = 0.0;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)o.push("if (sectionPlaneActive"+e+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),o.push("}");o.push("  if (dist > 0.0) { discard; }"),o.push("}")}return"points"===e._geometry._state.primitiveName&&(o.push("vec2 cxy = 2.0 * gl_PointCoord - 1.0;"),o.push("float r = dot(cxy, cxy);"),o.push("if (r > 1.0) {"),o.push("   discard;"),o.push("}")),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r?o.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):o.push("gl_FragColor = vColor;"),o.push("}"),o}(e)}}(t),this._allocate(t)},w={};x.get=function(e){const t=[e.scene.id,e.scene.gammaOutput?"go":"",e.scene._sectionPlanesState.getHash(),e._geometry._state.normalsBuf?"n":"",e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=w[t];return i||(i=new x(t,e),w[t]=i,d.a.memory.programs++),i._useCount++,i},x.prototype.put=function(){0==--this._useCount&&(_.removeItem(this.id),this._program&&this._program.destroy(),delete w[this._hash],d.a.memory.programs--)},x.prototype.webglContextRestored=function(){this._program=null},x.prototype.drawMesh=function(e,t,i){this._program||this._allocate(t);const r=this._scene,n=r.camera,o=r.canvas.gl,s=0===i?t._xrayMaterial._state:1===i?t._highlightMaterial._state:t._selectedMaterial._state,a=t._state,l=t._geometry._state,c=t.rtcCenter;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),o.uniformMatrix4fv(this._uViewMatrix,!1,c?e.getRTCViewMatrix(a.rtcCenterHash,c):n.viewMatrix),o.uniformMatrix4fv(this._uViewNormalMatrix,!1,n.viewNormalMatrix),a.clippable){const e=r._sectionPlanesState.sectionPlanes.length;if(e>0){const i=r._sectionPlanesState.sectionPlanes,n=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],r=n.sectionPlanesActivePerLayer[t];if(o.uniform1i(e.active,r?1:0),r){const r=i[t];o.uniform3fv(e.pos,c?Object(f.b)(r.dist,r.dir,c,y):r.pos),o.uniform3fv(e.dir,r.dir)}}}}if(s.id!==this._lastMaterialId){const t=s.fillColor,i=s.backfaces;e.backfaces!==i&&(i?o.disable(o.CULL_FACE):o.enable(o.CULL_FACE),e.backfaces=i),o.uniform4f(this._uFillColor,t[0],t[1],t[2],s.fillAlpha),this._lastMaterialId=s.id}o.uniformMatrix4fv(this._uModelMatrix,o.FALSE,t.worldMatrix),this._uModelNormalMatrix&&o.uniformMatrix4fv(this._uModelNormalMatrix,o.FALSE,t.worldNormalMatrix),this._uClippable&&o.uniform1i(this._uClippable,a.clippable),o.uniform3fv(this._uOffset,a.offset),l.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,l.positionsDecodeMatrix),this._uUVDecodeMatrix&&o.uniformMatrix3fv(this._uUVDecodeMatrix,!1,l.uvDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(l.positionsBuf),e.bindArray++),this._aNormal&&(this._aNormal.bindArrayBuffer(l.normalsBuf),e.bindArray++),l.indicesBuf?(l.indicesBuf.bind(),e.bindArray++):l.positionsBuf,this._lastGeometryId=l.id),l.indicesBuf?(o.drawElements(l.primitive,l.indicesBuf.numItems,l.indicesBuf.itemType,0),e.drawElements++):l.positionsBuf&&(o.drawArrays(o.TRIANGLES,0,l.positionsBuf.numItems),e.drawArrays++)},x.prototype._allocate=function(e){const t=e.scene,i=t._lightsState,r=t._sectionPlanesState,n=t.canvas.gl;if(this._program=new h.a(n,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const o=this._program;this._uPositionsDecodeMatrix=o.getLocation("positionsDecodeMatrix"),this._uModelMatrix=o.getLocation("modelMatrix"),this._uModelNormalMatrix=o.getLocation("modelNormalMatrix"),this._uViewMatrix=o.getLocation("viewMatrix"),this._uViewNormalMatrix=o.getLocation("viewNormalMatrix"),this._uProjMatrix=o.getLocation("projMatrix"),this._uLightAmbient=[],this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];for(let e=0,t=i.lights.length;e<t;e++)switch(i.lights[e].type){case"ambient":this._uLightAmbient[e]=o.getLocation("lightAmbient");break;case"dir":this._uLightColor[e]=o.getLocation("lightColor"+e),this._uLightPos[e]=null,this._uLightDir[e]=o.getLocation("lightDir"+e);break;case"point":this._uLightColor[e]=o.getLocation("lightColor"+e),this._uLightPos[e]=o.getLocation("lightPos"+e),this._uLightDir[e]=null,this._uLightAttenuation[e]=o.getLocation("lightAttenuation"+e)}this._uSectionPlanes=[];for(let e=0,t=r.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:o.getLocation("sectionPlaneActive"+e),pos:o.getLocation("sectionPlanePos"+e),dir:o.getLocation("sectionPlaneDir"+e)});this._uFillColor=o.getLocation("fillColor"),this._aPosition=o.getAttribute("position"),this._aNormal=o.getAttribute("normal"),this._uClippable=o.getLocation("clippable"),this._uGammaFactor=o.getLocation("gammaFactor"),this._uOffset=o.getLocation("offset"),t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=o.getLocation("logDepthBufFC")),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},x.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=t._lightsState,n=t.camera,o=n.project;if(this._program.bind(),e.useProgram++,e.textureUnit=0,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,this._lastIndicesBufId=null,i.uniformMatrix4fv(this._uViewNormalMatrix,!1,n.normalMatrix),i.uniformMatrix4fv(this._uProjMatrix,!1,o.matrix),t.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.far+1)/Math.LN2);i.uniform1f(this._uLogDepthBufFC,e)}for(let e=0,t=r.lights.length;e<t;e++){const t=r.lights[e];this._uLightAmbient[e]?i.uniform4f(this._uLightAmbient[e],t.color[0],t.color[1],t.color[2],t.intensity):(this._uLightColor[e]&&i.uniform4f(this._uLightColor[e],t.color[0],t.color[1],t.color[2],t.intensity),this._uLightPos[e]&&(i.uniform3fv(this._uLightPos[e],t.pos),this._uLightAttenuation[e]&&i.uniform1f(this._uLightAttenuation[e],t.attenuation)),this._uLightDir[e]&&i.uniform3fv(this._uLightDir[e],t.dir))}this._uGammaFactor&&i.uniform1f(this._uGammaFactor,t.gammaFactor)};const M=new s.Map({}),P=r.math.vec3(),E=function(e,t){this.id=M.addItem({}),this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene,i=t._sectionPlanesState.sectionPlanes.length>0,r=!!e._geometry._state.compressGeometry,n=e._state.billboard,o=e._state.stationary,s=[];return s.push("// Edges drawing vertex shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),s.push("uniform vec4 edgeColor;"),s.push("uniform vec3 offset;"),r&&s.push("uniform mat4 positionsDecodeMatrix;"),t.logarithmicDepthBufferEnabled&&(s.push("uniform float logDepthBufFC;"),p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("varying float vFragDepth;")),i&&s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vColor;"),("spherical"===n||"cylindrical"===n)&&(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===n&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}")),s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),s.push("vec4 worldPosition;"),r&&s.push("localPosition = positionsDecodeMatrix * localPosition;"),s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"===n||"cylindrical"===n?(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);"),s.push("billboard(modelViewMatrix);"),s.push("worldPosition = modelMatrix2 * localPosition;"),s.push("worldPosition.xyz = worldPosition.xyz + offset;"),s.push("vec4 viewPosition = modelViewMatrix * localPosition;")):(s.push("worldPosition = modelMatrix2 * localPosition;"),s.push("worldPosition.xyz = worldPosition.xyz + offset;"),s.push("vec4 viewPosition  = viewMatrix2 * worldPosition; ")),s.push("vColor = edgeColor;"),i&&s.push("vWorldPosition = worldPosition;"),s.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&(p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?s.push("vFragDepth = 1.0 + clipPos.w;"):(s.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),s.push("clipPos.z *= clipPos.w;"))),s.push("gl_Position = clipPos;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene,i=e.scene._sectionPlanesState,r=e.scene.gammaOutput,n=i.sectionPlanes.length>0,o=[];if(o.push("// Edges drawing fragment shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("#extension GL_EXT_frag_depth : enable"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(o.push("uniform float logDepthBufFC;"),o.push("varying float vFragDepth;")),r&&(o.push("uniform float gammaFactor;"),o.push("vec4 linearToGamma( in vec4 value, in float gammaFactor ) {"),o.push("  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );"),o.push("}")),n){o.push("varying vec4 vWorldPosition;"),o.push("uniform bool clippable;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)o.push("uniform bool sectionPlaneActive"+e+";"),o.push("uniform vec3 sectionPlanePos"+e+";"),o.push("uniform vec3 sectionPlaneDir"+e+";")}if(o.push("varying vec4 vColor;"),o.push("void main(void) {"),n){o.push("if (clippable) {"),o.push("  float dist = 0.0;");for(let e=0,t=i.sectionPlanes.length;e<t;e++)o.push("if (sectionPlaneActive"+e+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),o.push("}");o.push("  if (dist > 0.0) { discard; }"),o.push("}")}return t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r?o.push("gl_FragColor = linearToGamma(vColor, gammaFactor);"):o.push("gl_FragColor = vColor;"),o.push("}"),o}(e)}}(t),this._allocate(t)},S={};E.get=function(e){const t=[e.scene.id,e.scene.gammaOutput?"go":"",e.scene._sectionPlanesState.getHash(),e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=S[t];return i||(i=new E(t,e),S[t]=i,d.a.memory.programs++),i._useCount++,i},E.prototype.put=function(){0==--this._useCount&&(M.removeItem(this.id),this._program&&this._program.destroy(),delete S[this._hash],d.a.memory.programs--)},E.prototype.webglContextRestored=function(){this._program=null},E.prototype.drawMesh=function(e,t,i){this._program||this._allocate(t);const r=this._scene,n=r.camera,o=r.canvas.gl;let s;const a=t._state,l=t._geometry,c=l._state,u=t.rtcCenter;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),o.uniformMatrix4fv(this._uViewMatrix,!1,u?e.getRTCViewMatrix(a.rtcCenterHash,u):n.viewMatrix),a.clippable){const e=r._sectionPlanesState.sectionPlanes.length;if(e>0){const i=r._sectionPlanesState.sectionPlanes,n=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],r=n.sectionPlanesActivePerLayer[t];if(o.uniform1i(e.active,r?1:0),r){const r=i[t];o.uniform3fv(e.pos,u?Object(f.b)(r.dist,r.dir,u,P):r.pos),o.uniform3fv(e.dir,r.dir)}}}}switch(i){case 0:s=t._xrayMaterial._state;break;case 1:s=t._highlightMaterial._state;break;case 2:s=t._selectedMaterial._state;break;case 3:default:s=t._edgeMaterial._state}if(s.id!==this._lastMaterialId){const t=s.backfaces;if(e.backfaces!==t&&(t?o.disable(o.CULL_FACE):o.enable(o.CULL_FACE),e.backfaces=t),e.lineWidth!==s.edgeWidth&&(o.lineWidth(s.edgeWidth),e.lineWidth=s.edgeWidth),this._uEdgeColor){const e=s.edgeColor,t=s.edgeAlpha;o.uniform4f(this._uEdgeColor,e[0],e[1],e[2],t)}this._lastMaterialId=s.id}let h;o.uniformMatrix4fv(this._uModelMatrix,o.FALSE,t.worldMatrix),this._uClippable&&o.uniform1i(this._uClippable,a.clippable),o.uniform3fv(this._uOffset,a.offset),c.primitive===o.TRIANGLES?h=l._getEdgeIndices():c.primitive===o.LINES&&(h=c.indicesBuf),h&&(c.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,c.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(c.positionsBuf,c.compressGeometry?o.UNSIGNED_SHORT:o.FLOAT),e.bindArray++),h.bind(),e.bindArray++,this._lastGeometryId=c.id),o.drawElements(o.LINES,h.numItems,h.itemType,0),e.drawElements++)},E.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl,r=t._sectionPlanesState;if(this._program=new h.a(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const n=this._program;this._uPositionsDecodeMatrix=n.getLocation("positionsDecodeMatrix"),this._uModelMatrix=n.getLocation("modelMatrix"),this._uViewMatrix=n.getLocation("viewMatrix"),this._uProjMatrix=n.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=r.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:n.getLocation("sectionPlaneActive"+e),pos:n.getLocation("sectionPlanePos"+e),dir:n.getLocation("sectionPlaneDir"+e)});this._uEdgeColor=n.getLocation("edgeColor"),this._aPosition=n.getAttribute("position"),this._uClippable=n.getLocation("clippable"),this._uGammaFactor=n.getLocation("gammaFactor"),this._uOffset=n.getLocation("offset"),t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=n.getLocation("logDepthBufFC")),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},E.prototype._bindProgram=function(e){const t=this._program,i=this._scene,r=i.canvas.gl,n=i.camera.project;if(t.bind(),e.useProgram++,this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,r.uniformMatrix4fv(this._uProjMatrix,!1,n.matrix),i.logarithmicDepthBufferEnabled){const e=2/(Math.log(n.far+1)/Math.LN2);r.uniform1f(this._uLogDepthBufFC,e)}this._uGammaFactor&&r.uniform1f(this._uGammaFactor,i.gammaFactor)};const C=r.math.vec3(),k=function(e,t){this._hash=e,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene,i=t._sectionPlanesState.sectionPlanes.length>0,r=!!e._geometry._state.compressGeometry,n=e._state.billboard,o=e._state.stationary,s=[];return s.push("// Mesh picking vertex shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),s.push("varying vec4 vViewPosition;"),s.push("uniform vec3 offset;"),r&&s.push("uniform mat4 positionsDecodeMatrix;"),i&&s.push("varying vec4 vWorldPosition;"),t.logarithmicDepthBufferEnabled&&(s.push("uniform float logDepthBufFC;"),p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("varying float vFragDepth;")),"spherical"!==n&&"cylindrical"!==n||(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===n&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}")),s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),r&&s.push("localPosition = positionsDecodeMatrix * localPosition;"),s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"!==n&&"cylindrical"!==n||(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);")),s.push("   vec4 worldPosition = modelMatrix2 * localPosition;"),s.push("   worldPosition.xyz = worldPosition.xyz + offset;"),s.push("   vec4 viewPosition = viewMatrix2 * worldPosition;"),i&&s.push("   vWorldPosition = worldPosition;"),s.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&(p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?s.push("vFragDepth = 1.0 + clipPos.w;"):(s.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),s.push("clipPos.z *= clipPos.w;"))),s.push("gl_Position = clipPos;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene,i=t._sectionPlanesState,r=i.sectionPlanes.length>0,n=[];if(n.push("// Mesh picking fragment shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("#extension GL_EXT_frag_depth : enable"),n.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),n.push("precision highp float;"),n.push("precision highp int;"),n.push("#else"),n.push("precision mediump float;"),n.push("precision mediump int;"),n.push("#endif"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(n.push("uniform float logDepthBufFC;"),n.push("varying float vFragDepth;")),n.push("uniform vec4 pickColor;"),r){n.push("uniform bool clippable;"),n.push("varying vec4 vWorldPosition;");for(var o=0;o<i.sectionPlanes.length;o++)n.push("uniform bool sectionPlaneActive"+o+";"),n.push("uniform vec3 sectionPlanePos"+o+";"),n.push("uniform vec3 sectionPlaneDir"+o+";")}if(n.push("void main(void) {"),r){n.push("if (clippable) {"),n.push("  float dist = 0.0;");for(o=0;o<i.sectionPlanes.length;o++)n.push("if (sectionPlaneActive"+o+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}return t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),n.push("   gl_FragColor = pickColor; "),n.push("}"),n}(e)}}(t),this._scene=t.scene,this._useCount=0,this._allocate(t)},O={};k.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.hash,e._state.hash].join(";");let i=O[t];if(!i){if((i=new k(t,e)).errors)return console.log(i.errors.join("\n")),null;O[t]=i,d.a.memory.programs++}return i._useCount++,i},k.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete O[this._hash],d.a.memory.programs--)},k.prototype.webglContextRestored=function(){this._program=null},k.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene,r=i.canvas.gl,n=t._state,o=t._material._state,s=t._geometry._state,a=t.rtcCenter;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),r.uniformMatrix4fv(this._uViewMatrix,!1,a?e.getRTCPickViewMatrix(n.rtcCenterHash,a):e.pickViewMatrix),n.clippable){const e=i._sectionPlanesState.sectionPlanes.length;if(e>0){const n=i._sectionPlanesState.sectionPlanes,o=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],i=o.sectionPlanesActivePerLayer[t];if(r.uniform1i(e.active,i?1:0),i){const i=n[t];r.uniform3fv(e.pos,a?Object(f.b)(i.dist,i.dir,a,C):i.pos),r.uniform3fv(e.dir,i.dir)}}}}if(o.id!==this._lastMaterialId){const t=o.backfaces;e.backfaces!==t&&(t?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=t);const i=o.frontface;e.frontface!==i&&(i?r.frontFace(r.CCW):r.frontFace(r.CW),e.frontface=i),this._lastMaterialId=o.id}r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),r.uniformMatrix4fv(this._uModelMatrix,!1,t.worldMatrix),this._uClippable&&r.uniform1i(this._uClippable,t._state.clippable),r.uniform3fv(this._uOffset,t._state.offset),s.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,s.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(s.positionsBuf,s.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT),e.bindArray++),s.indicesBuf&&(s.indicesBuf.bind(),e.bindArray++),this._lastGeometryId=s.id);var l=t._state.pickID;const c=l>>24&255,u=l>>16&255,h=l>>8&255,d=255&l;r.uniform4f(this._uPickColor,d/255,h/255,u/255,c/255),s.indicesBuf?(r.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0),e.drawElements++):s.positions&&r.drawArrays(r.TRIANGLES,0,s.positions.numItems)},k.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl;if(this._program=new h.a(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uModelMatrix=r.getLocation("modelMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,i=t._sectionPlanesState.sectionPlanes.length;e<i;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._uClippable=r.getLocation("clippable"),this._uPickColor=r.getLocation("pickColor"),this._uOffset=r.getLocation("offset"),t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC")),this._lastMaterialId=null,this._lastGeometryId=null},k.prototype._bindProgram=function(e){const t=this._scene,i=t.canvas.gl,r=t.camera.project;if(this._program.bind(),e.useProgram++,t.logarithmicDepthBufferEnabled){const e=2/(Math.log(r.far+1)/Math.LN2);i.uniform1f(this._uLogDepthBufFC,e)}this._lastMaterialId=null,this._lastGeometryId=null};const A=r.math.vec3(),T=function(e,t){this._hash=e,this._scene=t.scene,this._useCount=0,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene,i=t._sectionPlanesState.sectionPlanes.length>0,r=!!e._geometry._state.compressGeometry,n=(e._state.billboard,e._state.stationary,[]);return n.push("// Surface picking vertex shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("#extension GL_EXT_frag_depth : enable"),n.push("attribute vec3 position;"),n.push("attribute vec4 color;"),n.push("uniform mat4 modelMatrix;"),n.push("uniform mat4 viewMatrix;"),n.push("uniform mat4 projMatrix;"),n.push("uniform vec3 offset;"),i&&(n.push("uniform bool clippable;"),n.push("varying vec4 vWorldPosition;")),t.logarithmicDepthBufferEnabled&&(n.push("uniform float logDepthBufFC;"),p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("varying float vFragDepth;")),n.push("varying vec4 vColor;"),r&&n.push("uniform mat4 positionsDecodeMatrix;"),n.push("void main(void) {"),n.push("vec4 localPosition = vec4(position, 1.0); "),r&&n.push("localPosition = positionsDecodeMatrix * localPosition;"),n.push("   vec4 worldPosition = modelMatrix * localPosition; "),n.push("   worldPosition.xyz = worldPosition.xyz + offset;"),n.push("   vec4 viewPosition = viewMatrix * worldPosition;"),i&&n.push("   vWorldPosition = worldPosition;"),n.push("   vColor = color;"),n.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&(p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?n.push("vFragDepth = 1.0 + clipPos.w;"):(n.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),n.push("clipPos.z *= clipPos.w;"))),n.push("gl_Position = clipPos;"),n.push("}"),n}(e),this.fragment=function(e){const t=e.scene,i=t._sectionPlanesState,r=i.sectionPlanes.length>0,n=[];if(n.push("// Surface picking fragment shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("#extension GL_EXT_frag_depth : enable"),n.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),n.push("precision highp float;"),n.push("precision highp int;"),n.push("#else"),n.push("precision mediump float;"),n.push("precision mediump int;"),n.push("#endif"),n.push("varying vec4 vColor;"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(n.push("uniform float logDepthBufFC;"),n.push("varying float vFragDepth;")),r){n.push("uniform bool clippable;"),n.push("varying vec4 vWorldPosition;");for(let e=0;e<i.sectionPlanes.length;e++)n.push("uniform bool sectionPlaneActive"+e+";"),n.push("uniform vec3 sectionPlanePos"+e+";"),n.push("uniform vec3 sectionPlaneDir"+e+";")}if(n.push("void main(void) {"),r){n.push("if (clippable) {"),n.push("  float dist = 0.0;");for(let e=0;e<i.sectionPlanes.length;e++)n.push("if (sectionPlaneActive"+e+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}return t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),n.push("   gl_FragColor = vColor;"),n.push("}"),n}(e)}}(t),this._allocate(t)},D={};T.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.compressGeometry?"cp":"",e._state.hash].join(";");let i=D[t];if(!i){if((i=new T(t,e)).errors)return console.log(i.errors.join("\n")),null;D[t]=i,d.a.memory.programs++}return i._useCount++,i},T.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete D[this._hash],d.a.memory.programs--)},T.prototype.webglContextRestored=function(){this._program=null},T.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene,r=i.canvas.gl,n=t._state,o=t._material._state,s=t._geometry,a=t._geometry._state,l=t.rtcCenter,c=o.backfaces,u=o.frontface,h=i.camera.project,d=s._getPickTrianglePositions(),p=s._getPickTriangleColors();if(this._program.bind(),e.useProgram++,i.logarithmicDepthBufferEnabled){const e=2/(Math.log(h.far+1)/Math.LN2);r.uniform1f(this._uLogDepthBufFC,e)}if(r.uniformMatrix4fv(this._uViewMatrix,!1,l?e.getRTCPickViewMatrix(n.rtcCenterHash,l):e.pickViewMatrix),n.clippable){const e=i._sectionPlanesState.sectionPlanes.length;if(e>0){const n=i._sectionPlanesState.sectionPlanes,o=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],i=o.sectionPlanesActivePerLayer[t];if(r.uniform1i(e.active,i?1:0),i){const i=n[t];r.uniform3fv(e.pos,l?Object(f.b)(i.dist,i.dir,l,A):i.pos),r.uniform3fv(e.dir,i.dir)}}}}r.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),i.logarithmicDepthBufferEnabled&&r.uniform1f(this._uZFar,i.camera.project.far),e.backfaces!==c&&(c?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=c),e.frontface!==u&&(u?r.frontFace(r.CCW):r.frontFace(r.CW),e.frontface=u),r.uniformMatrix4fv(this._uModelMatrix,!1,t.worldMatrix),this._uClippable&&r.uniform1i(this._uClippable,t._state.clippable),r.uniform3fv(this._uOffset,t._state.offset),this._uPositionsDecodeMatrix?(r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,a.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(d,a.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT)):this._aPosition.bindArrayBuffer(d),p.bind(),r.enableVertexAttribArray(this._aColor.location),r.vertexAttribPointer(this._aColor.location,p.itemSize,p.itemType,!0,0,0),r.drawArrays(a.primitive,0,d.numItems/3)},T.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl;if(this._program=new h.a(i,this._shaderSource),this._useCount=0,this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uModelMatrix=r.getLocation("modelMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,i=t._sectionPlanesState.sectionPlanes.length;e<i;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aColor=r.getAttribute("color"),this._uClippable=r.getLocation("clippable"),this._uOffset=r.getLocation("offset"),t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))};const R=r.math.vec3(),L=function(e,t){this._hash=e,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene,i=t._sectionPlanesState.sectionPlanes.length>0,r=!!e._geometry._state.compressGeometry,n=e._state.billboard,o=e._state.stationary,s=[];return s.push("// Mesh occlusion vertex shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("attribute vec3 position;"),s.push("uniform mat4 modelMatrix;"),s.push("uniform mat4 viewMatrix;"),s.push("uniform mat4 projMatrix;"),s.push("uniform vec3 offset;"),r&&s.push("uniform mat4 positionsDecodeMatrix;"),i&&s.push("varying vec4 vWorldPosition;"),t.logarithmicDepthBufferEnabled&&(s.push("uniform float logDepthBufFC;"),p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("varying float vFragDepth;")),"spherical"!==n&&"cylindrical"!==n||(s.push("void billboard(inout mat4 mat) {"),s.push("   mat[0][0] = 1.0;"),s.push("   mat[0][1] = 0.0;"),s.push("   mat[0][2] = 0.0;"),"spherical"===n&&(s.push("   mat[1][0] = 0.0;"),s.push("   mat[1][1] = 1.0;"),s.push("   mat[1][2] = 0.0;")),s.push("   mat[2][0] = 0.0;"),s.push("   mat[2][1] = 0.0;"),s.push("   mat[2][2] =1.0;"),s.push("}")),s.push("void main(void) {"),s.push("vec4 localPosition = vec4(position, 1.0); "),r&&s.push("localPosition = positionsDecodeMatrix * localPosition;"),s.push("mat4 viewMatrix2 = viewMatrix;"),s.push("mat4 modelMatrix2 = modelMatrix;"),o&&s.push("viewMatrix2[3][0] = viewMatrix2[3][1] = viewMatrix2[3][2] = 0.0;"),"spherical"!==n&&"cylindrical"!==n||(s.push("mat4 modelViewMatrix = viewMatrix2 * modelMatrix2;"),s.push("billboard(modelMatrix2);"),s.push("billboard(viewMatrix2);")),s.push("   vec4 worldPosition = modelMatrix2 * localPosition;"),s.push("   worldPosition.xyz = worldPosition.xyz + offset;"),s.push("   vec4 viewPosition = viewMatrix2 * worldPosition;"),i&&s.push("   vWorldPosition = worldPosition;"),s.push("vec4 clipPos = projMatrix * viewPosition;"),t.logarithmicDepthBufferEnabled&&(p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?s.push("vFragDepth = 1.0 + clipPos.w;"):(s.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),s.push("clipPos.z *= clipPos.w;"))),s.push("gl_Position = clipPos;"),s.push("}"),s}(e),this.fragment=function(e){const t=e.scene,i=t._sectionPlanesState,r=i.sectionPlanes.length>0,n=[];if(n.push("// Mesh occlusion fragment shader"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("#extension GL_EXT_frag_depth : enable"),n.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),n.push("precision highp float;"),n.push("precision highp int;"),n.push("#else"),n.push("precision mediump float;"),n.push("precision mediump int;"),n.push("#endif"),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(n.push("uniform float logDepthBufFC;"),n.push("varying float vFragDepth;")),r){n.push("uniform bool clippable;"),n.push("varying vec4 vWorldPosition;");for(var o=0;o<i.sectionPlanes.length;o++)n.push("uniform bool sectionPlaneActive"+o+";"),n.push("uniform vec3 sectionPlanePos"+o+";"),n.push("uniform vec3 sectionPlaneDir"+o+";")}if(n.push("void main(void) {"),r){n.push("if (clippable) {"),n.push("  float dist = 0.0;");for(o=0;o<i.sectionPlanes.length;o++)n.push("if (sectionPlaneActive"+o+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}return n.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),t.logarithmicDepthBufferEnabled&&p.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),n.push("}"),n}(e)}}(t),this._scene=t.scene,this._useCount=0,this._allocate(t)},B={};L.get=function(e){const t=[e.scene.canvas.canvas.id,e.scene._sectionPlanesState.getHash(),e._geometry._state.hash,e._state.hash].join(";");let i=B[t];if(!i){if((i=new L(t,e)).errors)return console.log(i.errors.join("\n")),null;B[t]=i,d.a.memory.programs++}return i._useCount++,i},L.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete B[this._hash],d.a.memory.programs--)},L.prototype.webglContextRestored=function(){this._program=null},L.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene,r=i.canvas.gl,n=t._material._state,o=t._state,s=t._geometry._state,a=t.rtcCenter;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),n.id!==this._lastMaterialId){const t=n.backfaces;e.backfaces!==t&&(t?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),e.backfaces=t);const i=n.frontface;e.frontface!==i&&(i?r.frontFace(r.CCW):r.frontFace(r.CW),e.frontface=i),this._lastMaterialId=n.id}const l=i.camera;if(r.uniformMatrix4fv(this._uViewMatrix,!1,a?e.getRTCViewMatrix(o.rtcCenterHash,a):l.viewMatrix),o.clippable){const e=i._sectionPlanesState.sectionPlanes.length;if(e>0){const n=i._sectionPlanesState.sectionPlanes,o=t.renderFlags;for(let t=0;t<e;t++){const e=this._uSectionPlanes[t],i=o.sectionPlanesActivePerLayer[t];if(r.uniform1i(e.active,i?1:0),i){const i=n[t];r.uniform3fv(e.pos,a?Object(f.b)(i.dist,i.dir,a,R):i.pos),r.uniform3fv(e.dir,i.dir)}}}}r.uniformMatrix4fv(this._uProjMatrix,!1,l._project._state.matrix),r.uniformMatrix4fv(this._uModelMatrix,r.FALSE,t.worldMatrix),this._uClippable&&r.uniform1i(this._uClippable,t._state.clippable),r.uniform3fv(this._uOffset,t._state.offset),s.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,s.positionsDecodeMatrix),this._aPosition&&(this._aPosition.bindArrayBuffer(s.positionsBuf,s.compressGeometry?r.UNSIGNED_SHORT:r.FLOAT),e.bindArray++),s.indicesBuf&&(s.indicesBuf.bind(),e.bindArray++),this._lastGeometryId=s.id),s.indicesBuf?(r.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0),e.drawElements++):s.positions&&r.drawArrays(r.TRIANGLES,0,s.positions.numItems)},L.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl;if(this._program=new h.a(i,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uModelMatrix=r.getLocation("modelMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,i=t._sectionPlanesState.sectionPlanes.length;e<i;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._uClippable=r.getLocation("clippable"),this._uOffset=r.getLocation("offset"),t.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC")),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},L.prototype._bindProgram=function(e){const t=this._scene,i=t.camera.project,r=t.canvas.gl;if(this._program.bind(),e.useProgram++,r.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),t.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);r.uniform1f(this._uLogDepthBufFC,e)}this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null};const I=function(e,t){this._hash=e,this._shaderSource=new class{constructor(e){this.vertex=function(e){const t=e.scene._sectionPlanesState.sectionPlanes.length>0,i=!!e._geometry._state.compressGeometry,r=[];return r.push("// Mesh shadow vertex shader"),r.push("attribute vec3 position;"),r.push("uniform mat4 modelMatrix;"),r.push("uniform mat4 shadowViewMatrix;"),r.push("uniform mat4 shadowProjMatrix;"),r.push("uniform vec3 offset;"),i&&r.push("uniform mat4 positionsDecodeMatrix;"),t&&r.push("varying vec4 vWorldPosition;"),r.push("void main(void) {"),r.push("vec4 localPosition = vec4(position, 1.0); "),r.push("vec4 worldPosition;"),i&&r.push("localPosition = positionsDecodeMatrix * localPosition;"),r.push("worldPosition = modelMatrix * localPosition;"),r.push("worldPosition.xyz = worldPosition.xyz + offset;"),r.push("vec4 viewPosition  = shadowViewMatrix * worldPosition; "),t&&r.push("vWorldPosition = worldPosition;"),r.push("   gl_Position = shadowProjMatrix * viewPosition;"),r.push("}"),r}(e),this.fragment=function(e){const t=e.scene,i=(t.canvas.gl,t._sectionPlanesState),r=i.sectionPlanes.length>0,n=[];if(n.push("// Mesh shadow fragment shader"),n.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),n.push("precision highp float;"),n.push("precision highp int;"),n.push("#else"),n.push("precision mediump float;"),n.push("precision mediump int;"),n.push("#endif"),r){n.push("uniform bool clippable;"),n.push("varying vec4 vWorldPosition;");for(var o=0;o<i.sectionPlanes.length;o++)n.push("uniform bool sectionPlaneActive"+o+";"),n.push("uniform vec3 sectionPlanePos"+o+";"),n.push("uniform vec3 sectionPlaneDir"+o+";")}if(n.push("vec4 encodeFloat( const in float depth ) {"),n.push("  const vec4 bitShift = vec4(256 * 256 * 256, 256 * 256, 256, 1.0);"),n.push("  const vec4 bitMask = vec4(0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);"),n.push("  vec4 comp = fract(depth * bitShift);"),n.push("  comp -= comp.xxyz * bitMask;"),n.push("  return comp;"),n.push("}"),n.push("void main(void) {"),r){n.push("if (clippable) {"),n.push("  float dist = 0.0;");for(o=0;o<i.sectionPlanes.length;o++)n.push("if (sectionPlaneActive"+o+") {"),n.push("   dist += clamp(dot(-sectionPlaneDir"+o+".xyz, vWorldPosition.xyz - sectionPlanePos"+o+".xyz), 0.0, 1000.0);"),n.push("}");n.push("  if (dist > 0.0) { discard; }"),n.push("}")}return n.push("gl_FragColor = encodeFloat(gl_FragCoord.z);"),n.push("}"),n}(e)}}(t),this._scene=t.scene,this._useCount=0,this._allocate(t)},N={};I.get=function(e){const t=e.scene,i=[t.canvas.canvas.id,t._sectionPlanesState.getHash(),e._geometry._state.hash,e._state.hash].join(";");let r=N[i];if(!r){if((r=new I(i,e)).errors)return console.log(r.errors.join("\n")),null;N[i]=r,d.a.memory.programs++}return r._useCount++,r},I.prototype.put=function(){0==--this._useCount&&(this._program&&this._program.destroy(),delete N[this._hash],d.a.memory.programs--)},I.prototype.webglContextRestored=function(){this._program=null},I.prototype.drawMesh=function(e,t){this._program||this._allocate(t);const i=this._scene.canvas.gl,r=t._material._state,n=t._geometry._state;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),r.id!==this._lastMaterialId){const t=r.backfaces;e.backfaces!==t&&(t?i.disable(i.CULL_FACE):i.enable(i.CULL_FACE),e.backfaces=t);const n=r.frontface;e.frontface!==n&&(n?i.frontFace(i.CCW):i.frontFace(i.CW),e.frontface=n),e.lineWidth!==r.lineWidth&&(i.lineWidth(r.lineWidth),e.lineWidth=r.lineWidth),this._uPointSize&&i.uniform1i(this._uPointSize,r.pointSize),this._lastMaterialId=r.id}if(i.uniformMatrix4fv(this._uModelMatrix,i.FALSE,t.worldMatrix),n.combineGeometry){const r=t.vertexBufs;r.id!==this._lastVertexBufsId&&(r.positionsBuf&&this._aPosition&&(this._aPosition.bindArrayBuffer(r.positionsBuf,r.compressGeometry?i.UNSIGNED_SHORT:i.FLOAT),e.bindArray++),this._lastVertexBufsId=r.id)}this._uClippable&&i.uniform1i(this._uClippable,t._state.clippable),i.uniform3fv(this._uOffset,t._state.offset),n.id!==this._lastGeometryId&&(this._uPositionsDecodeMatrix&&i.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,n.positionsDecodeMatrix),n.combineGeometry?n.indicesBufCombined&&(n.indicesBufCombined.bind(),e.bindArray++):(this._aPosition&&(this._aPosition.bindArrayBuffer(n.positionsBuf,n.compressGeometry?i.UNSIGNED_SHORT:i.FLOAT),e.bindArray++),n.indicesBuf&&(n.indicesBuf.bind(),e.bindArray++)),this._lastGeometryId=n.id),n.combineGeometry?n.indicesBufCombined&&(i.drawElements(n.primitive,n.indicesBufCombined.numItems,n.indicesBufCombined.itemType,0),e.drawElements++):n.indicesBuf?(i.drawElements(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0),e.drawElements++):n.positions&&(i.drawArrays(i.TRIANGLES,0,n.positions.numItems),e.drawArrays++)},I.prototype._allocate=function(e){const t=e.scene,i=t.canvas.gl;if(this._program=new h.a(i,this._shaderSource),this._scene=t,this._useCount=0,this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uModelMatrix=r.getLocation("modelMatrix"),this._uShadowViewMatrix=r.getLocation("shadowViewMatrix"),this._uShadowProjMatrix=r.getLocation("shadowProjMatrix"),this._uSectionPlanes={};for(let e=0,i=t._sectionPlanesState.sectionPlanes.length;e<i;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._uClippable=r.getLocation("clippable"),this._uOffset=r.getLocation("offset"),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null},I.prototype._bindProgram=function(e){this._program||this._allocate(mesh);const t=this._scene,i=t.canvas.gl,r=t._sectionPlanesState;if(this._program.bind(),e.useProgram++,i.uniformMatrix4fv(this._uShadowViewMatrix,!1,e.shadowViewMatrix),i.uniformMatrix4fv(this._uShadowProjMatrix,!1,e.shadowProjMatrix),this._lastMaterialId=null,this._lastVertexBufsId=null,this._lastGeometryId=null,r.sectionPlanes.length>0){let e,t,n,o,s;for(let a=0,l=this._uSectionPlanes.length;a<l;a++)t=(e=this._uSectionPlanes[a]).active,n=r.sectionPlanes[a],t&&i.uniform1i(t,n.active),(o=e.pos)&&i.uniform3fv(e.pos,n.pos),(s=e.dir)&&i.uniform3fv(e.dir,n.dir)}};var j=i(21),F=i(97);const z=r.math.OBB3(),V=r.math.vec4(),U=r.math.vec4(),W=r.math.vec4(),H=r.math.vec3([1,0,0]),G=r.math.vec3([0,1,0]),X=r.math.vec3([0,0,1]),Y=r.math.vec3(3),$=r.math.vec3(3),q=r.math.identityMat4();class K extends n.a{get type(){return"Mesh"}constructor(e,t={}){if(super(e,t),this.originalSystemId=t.originalSystemId||this.id,this.renderFlags=new F.a,this._state=new o.a({visible:!0,culled:!1,pickable:null,clippable:null,collidable:null,castsShadow:null,receivesShadow:null,xrayed:!1,highlighted:!1,selected:!1,edges:!1,stationary:!!t.stationary,billboard:this._checkBillboard(t.billboard),layer:null,colorize:null,pickID:this.scene._renderer.getPickID(this),drawHash:"",pickHash:"",offset:r.math.vec3(),rtcCenter:null,rtcCenterHash:null}),this._drawRenderer=null,this._shadowRenderer=null,this._emphasisFillRenderer=null,this._emphasisEdgesRenderer=null,this._pickMeshRenderer=null,this._pickTriangleRenderer=null,this._occlusionRenderer=null,this._geometry=t.geometry?this._checkComponent2(["ReadableGeometry","VBOGeometry"],t.geometry):this.scene.geometry,this._material=t.material?this._checkComponent2(["PhongMaterial","MetallicMaterial","SpecularMaterial","LambertMaterial"],t.material):this.scene.material,this._xrayMaterial=t.xrayMaterial?this._checkComponent("EmphasisMaterial",t.xrayMaterial):this.scene.xrayMaterial,this._highlightMaterial=t.highlightMaterial?this._checkComponent("EmphasisMaterial",t.highlightMaterial):this.scene.highlightMaterial,this._selectedMaterial=t.selectedMaterial?this._checkComponent("EmphasisMaterial",t.selectedMaterial):this.scene.selectedMaterial,this._edgeMaterial=t.edgeMaterial?this._checkComponent("EdgeMaterial",t.edgeMaterial):this.scene.edgeMaterial,this._parentNode=null,this._aabb=null,this._aabbDirty=!0,this._numTriangles=this._geometry?this._geometry.numTriangles:0,this.scene._aabbDirty=!0,this._scale=r.math.vec3(),this._quaternion=r.math.identityQuaternion(),this._rotation=r.math.vec3(),this._position=r.math.vec3(),this._worldMatrix=r.math.identityMat4(),this._worldNormalMatrix=r.math.identityMat4(),this._localMatrixDirty=!0,this._worldMatrixDirty=!0,this._worldNormalMatrixDirty=!0,t.rtcCenter&&(this._state.rtcCenter=r.math.vec3(t.rtcCenter),this._state.rtcCenterHash=t.rtcCenter.join()),t.matrix?this.matrix=t.matrix:(this.scale=t.scale,this.position=t.position,t.quaternion||(this.rotation=t.rotation)),this._isObject=t.isObject,this._isObject&&this.scene._registerObject(this),this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.layer=t.layer,this.colorize=t.colorize,this.opacity=t.opacity,this.offset=t.offset,t.parentId){const e=this.scene.components[t.parentId];e?e.isNode?e.addChild(this):this.error("Parent is not a Node: '"+t.parentId+"'"):this.error("Parent not found: '"+t.parentId+"'"),this._parentNode=e}else t.parent&&(t.parent.isNode||this.error("Parent is not a Node"),t.parent.addChild(this),this._parentNode=t.parent);this.compile()}get isMesh(){return!0}get parent(){return this._parentNode}_checkBillboard(e){return"spherical"!==(e=e||"none")&&"cylindrical"!==e&&"none"!==e&&(this.error("Unsupported value for 'billboard': "+e+" - accepted values are 'spherical', 'cylindrical' and 'none' - defaulting to 'none'."),e="none"),e}compile(){const e=this._makeDrawHash();this._state.drawHash!==e&&(this._state.drawHash=e,this._putDrawRenderers(),this._drawRenderer=v.get(this),this._emphasisFillRenderer=x.get(this),this._emphasisEdgesRenderer=E.get(this));const t=this._makePickHash();this._state.pickHash!==t&&(this._state.pickHash=t,this._putPickRenderers(),this._pickMeshRenderer=k.get(this));const i=this._makeOcclusionHash();this._state.occlusionHash!==i&&(this._state.occlusionHash=i,this._putOcclusionRenderer(),this._occlusionRenderer=L.get(this))}_setLocalMatrixDirty(){this._localMatrixDirty=!0,this._setWorldMatrixDirty()}_setWorldMatrixDirty(){this._worldMatrixDirty=!0,this._worldNormalMatrixDirty=!0}_buildWorldMatrix(){const e=this.matrix;if(this._parentNode)r.math.mulMat4(this._parentNode.worldMatrix,e,this._worldMatrix);else for(let t=0,i=e.length;t<i;t++)this._worldMatrix[t]=e[t];this._worldMatrixDirty=!1}_buildWorldNormalMatrix(){this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldNormalMatrix||(this._worldNormalMatrix=r.math.mat4()),r.math.transposeMat4(this._worldMatrix,this._worldNormalMatrix),r.math.inverseMat4(this._worldNormalMatrix),this._worldNormalMatrixDirty=!1}_setAABBDirty(){if(this.collidable)for(let e=this;e;e=e._parentNode)e._aabbDirty=!0}_updateAABB(){this.scene._aabbDirty=!0,this._aabb||(this._aabb=r.math.AABB3()),this._buildAABB(this.worldMatrix,this._aabb),this._aabbDirty=!1}_webglContextRestored(){this._drawRenderer&&this._drawRenderer.webglContextRestored(),this._shadowRenderer&&this._shadowRenderer.webglContextRestored(),this._emphasisFillRenderer&&this._emphasisFillRenderer.webglContextRestored(),this._emphasisEdgesRenderer&&this._emphasisEdgesRenderer.webglContextRestored(),this._pickMeshRenderer&&this._pickMeshRenderer.webglContextRestored(),this._pickTriangleRenderer&&this._pickMeshRenderer.webglContextRestored(),this._occlusionRenderer&&this._occlusionRenderer.webglContextRestored()}_makeDrawHash(){const e=this.scene,t=[e.canvas.canvas.id,(e.gammaInput?"gi;":";")+(e.gammaOutput?"go":""),e._lightsState.getHash(),e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),i.receivesShadow&&t.push("/rs"),t.push(";"),t.join("")}_makePickHash(){const e=this.scene,t=[e.canvas.canvas.id,e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),t.push(";"),t.join("")}_makeOcclusionHash(){const e=this.scene,t=[e.canvas.canvas.id,e._sectionPlanesState.getHash()],i=this._state;return i.stationary&&t.push("/s"),"none"===i.billboard?t.push("/n"):"spherical"===i.billboard?t.push("/s"):"cylindrical"===i.billboard&&t.push("/c"),t.push(";"),t.join("")}_buildAABB(e,t){r.math.transformOBB3(e,this._geometry.obb,z),r.math.OBB3ToAABB3(z,t);const i=this._state.offset;if(t[0]+=i[0],t[1]+=i[1],t[2]+=i[2],t[3]+=i[0],t[4]+=i[1],t[5]+=i[2],this._state.rtcCenter){const e=this._state.rtcCenter;t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[0],t[4]+=e[1],t[5]+=e[2]}}get geometry(){return this._geometry}get material(){return this._material}set position(e){this._position.set(e||[0,0,0]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get position(){return this._position}set rotation(e){this._rotation.set(e||[0,0,0]),r.math.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get rotation(){return this._rotation}set quaternion(e){this._quaternion.set(e||[0,0,0,1]),r.math.quaternionToEuler(this._quaternion,"XYZ",this._rotation),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get quaternion(){return this._quaternion}set scale(e){this._scale.set(e||[1,1,1]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get scale(){return this._scale}set matrix(e){this.__localMatrix||(this.__localMatrix=r.math.identityMat4()),this.__localMatrix.set(e||q),r.math.decomposeMat4(this.__localMatrix,this._position,this._quaternion,this._scale),this._localMatrixDirty=!1,this._setWorldMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get matrix(){return this._localMatrixDirty&&(this.__localMatrix||(this.__localMatrix=r.math.identityMat4()),r.math.composeMat4(this._position,this._quaternion,this._scale,this.__localMatrix),this._localMatrixDirty=!1),this.__localMatrix}get worldMatrix(){return this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldMatrix}get worldNormalMatrix(){return this._worldNormalMatrixDirty&&this._buildWorldNormalMatrix(),this._worldNormalMatrix}rotate(e,t){return V[0]=e[0],V[1]=e[1],V[2]=e[2],V[3]=t*r.math.DEGTORAD,r.math.angleAxisToQuaternion(V,U),r.math.mulQuaternions(this.quaternion,U,W),this.quaternion=W,this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}rotateOnWorldAxis(e,t){return V[0]=e[0],V[1]=e[1],V[2]=e[2],V[3]=t*r.math.DEGTORAD,r.math.angleAxisToQuaternion(V,U),r.math.mulQuaternions(U,this.quaternion,U),this}rotateX(e){return this.rotate(H,e)}rotateY(e){return this.rotate(G,e)}rotateZ(e){return this.rotate(X,e)}translate(e,t){return r.math.vec3ApplyQuaternion(this.quaternion,e,Y),r.math.mulVec3Scalar(Y,t,$),r.math.addVec3(this.position,$,this.position),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}translateX(e){return this.translate(H,e)}translateY(e){return this.translate(G,e)}translateZ(e){return this.translate(X,e)}_putDrawRenderers(){this._drawRenderer&&(this._drawRenderer.put(),this._drawRenderer=null),this._shadowRenderer&&(this._shadowRenderer.put(),this._shadowRenderer=null),this._emphasisFillRenderer&&(this._emphasisFillRenderer.put(),this._emphasisFillRenderer=null),this._emphasisEdgesRenderer&&(this._emphasisEdgesRenderer.put(),this._emphasisEdgesRenderer=null)}_putPickRenderers(){this._pickMeshRenderer&&(this._pickMeshRenderer.put(),this._pickMeshRenderer=null),this._pickTriangleRenderer&&(this._pickTriangleRenderer.put(),this._pickTriangleRenderer=null)}_putOcclusionRenderer(){this._occlusionRenderer&&(this._occlusionRenderer.put(),this._occlusionRenderer=null)}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return this._isObject}get aabb(){return this._aabbDirty&&this._updateAABB(),this._aabb}set rtcCenter(e){e?(this._state.rtcCenter||(this._state.rtcCenter=r.math.vec3()),this._state.rtcCenter.set(e),this._state.rtcCenterHash=e.join(),this._setAABBDirty(),this.scene._aabbDirty=!0):this._state.rtcCenter&&(this._state.rtcCenter=null,this._state.rtcCenterHash=null,this._setAABBDirty(),this.scene._aabbDirty=!0)}get rtcCenter(){return this._state.rtcCenter}get numTriangles(){return this._numTriangles}set visible(e){e=!1!==e,this._state.visible=e,this._isObject&&this.scene._objectVisibilityUpdated(this),this.glRedraw()}get visible(){return this._state.visible}set xrayed(e){e=!!e,this._state.xrayed!==e&&(this._state.xrayed=e,this._isObject&&this.scene._objectXRayedUpdated(this),this.glRedraw())}get xrayed(){return this._state.xrayed}set highlighted(e){(e=!!e)!==this._state.highlighted&&(this._state.highlighted=e,this._isObject&&this.scene._objectHighlightedUpdated(this),this.glRedraw())}get highlighted(){return this._state.highlighted}set selected(e){(e=!!e)!==this._state.selected&&(this._state.selected=e,this._isObject&&this.scene._objectSelectedUpdated(this),this.glRedraw())}get selected(){return this._state.selected}set edges(e){(e=!!e)!==this._state.edges&&(this._state.edges=e,this.glRedraw())}get edges(){return this._state.edges}set culled(e){this._state.culled=!!e,this.glRedraw()}get culled(){return this._state.culled}set clippable(e){e=!1!==e,this._state.clippable!==e&&(this._state.clippable=e,this.glRedraw())}get clippable(){return this._state.clippable}set collidable(e){(e=!1!==e)!==this._state.collidable&&(this._state.collidable=e,this._setAABBDirty(),this.scene._aabbDirty=!0)}get collidable(){return this._state.collidable}set pickable(e){e=!1!==e,this._state.pickable!==e&&(this._state.pickable=e)}get pickable(){return this._state.pickable}set castsShadow(e){(e=!1!==e)!==this._state.castsShadow&&(this._state.castsShadow=e,this.glRedraw())}get castsShadow(){return this._state.castsShadow}set receivesShadow(e){(e=!1!==e)!==this._state.receivesShadow&&(this._state.receivesShadow=e,this._state.hash=e?"/mod/rs;":"/mod;",this.fire("dirty",this))}get receivesShadow(){return this._state.receivesShadow}get saoEnabled(){return!1}set colorize(e){let t=this._state.colorize;t||((t=this._state.colorize=new Float32Array(4))[3]=1),e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1);const i=!!e;this.scene._objectColorizeUpdated(this,i),this.glRedraw()}get colorize(){return this._state.colorize}set opacity(e){let t=this._state.colorize;t||((t=this._state.colorize=new Float32Array(4))[0]=1,t[1]=1,t[2]=1);const i=null!=e;t[3]=i?e:1,this.scene._objectOpacityUpdated(this,i),this.glRedraw()}get opacity(){return this._state.colorize[3]}get transparent(){return 2===this._material.alphaMode||this._state.colorize[3]<1}set layer(e){e=e||0,(e=Math.round(e))!==this._state.layer&&(this._state.layer=e,this._renderer.needStateSort())}get layer(){return this._state.layer}get stationary(){return this._state.stationary}get billboard(){return this._state.billboard}set offset(e){this._state.offset.set(e||[0,0,0]),this._setAABBDirty(),this.glRedraw()}get offset(){return this._state.offset}get isDrawable(){return!0}get isStateSortable(){return!0}stateSortCompare(e,t){return e._state.layer-t._state.layer||e._drawRenderer.id-t._drawRenderer.id||e._material._state.id-t._material._state.id||e._geometry._state.id-t._geometry._state.id}rebuildRenderFlags(){this.renderFlags.reset(),this._getActiveSectionPlanes()?(this.renderFlags.numLayers=1,this.renderFlags.numVisibleLayers=1,this.renderFlags.visibleLayers[0]=0,this._updateRenderFlags()):this.renderFlags.culled=!0}_updateRenderFlags(){const e=this.renderFlags,t=this._state;if(t.xrayed){const t=this._xrayMaterial._state;t.fill&&(t.fillAlpha<1?e.xrayedFillTransparent=!0:e.xrayedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.xrayedEdgesTransparent=!0:e.xrayedEdgesOpaque=!0)}else if(this._material._state.alpha<1||t.colorize[3]<1?e.normalFillTransparent=!0:e.normalFillOpaque=!0,t.edges&&(this._edgeMaterial._state.alpha<1?e.normalEdgesTransparent=!0:e.normalEdgesOpaque=!0),t.selected){const t=this._selectedMaterial._state;t.fill&&(t.fillAlpha<1?e.selectedFillTransparent=!0:e.selectedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.selectedEdgesTransparent=!0:e.selectedEdgesOpaque=!0)}else if(t.highlighted){const t=this._highlightMaterial._state;t.fill&&(t.fillAlpha<1?e.highlightedFillTransparent=!0:e.highlightedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.highlightedEdgesTransparent=!0:e.highlightedEdgesOpaque=!0)}}_getActiveSectionPlanes(){if(this._state.clippable){const e=this.scene._sectionPlanesState.sectionPlanes,t=e.length;if(t>0)for(let i=0;i<t;i++){const t=e[i],n=this.renderFlags;if(t.active)if(this._state.rtcCenter){const e=r.math.planeAABB3Intersect(t.dir,t.dist,this.aabb);if(-1===e)return!1;const o=0===e;n.sectionPlanesActivePerLayer[i]=o}else n.sectionPlanesActivePerLayer[i]=!0;else n.sectionPlanesActivePerLayer[i]=!1}}return!0}get xrayMaterial(){return this._xrayMaterial}get highlightMaterial(){return this._highlightMaterial}get selectedMaterial(){return this._selectedMaterial}get edgeMaterial(){return this._edgeMaterial}drawNormalOpaqueFill(e){(this._drawRenderer||(this._drawRenderer=v.get(this)))&&this._drawRenderer.drawMesh(e,this)}drawNormalTransparentFill(e){(this._drawRenderer||(this._drawRenderer=v.get(this)))&&this._drawRenderer.drawMesh(e,this)}drawXRayedFill(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=x.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,0)}drawHighlightedFill(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=x.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,1)}drawSelectedFill(e){(this._emphasisFillRenderer||(this._emphasisFillRenderer=x.get(this)))&&this._emphasisFillRenderer.drawMesh(e,this,2)}drawNormalOpaqueEdges(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=E.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,3)}drawNormalTransparentEdges(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=E.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,3)}drawXRayedEdges(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=E.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,0)}drawHighlightedEdges(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=E.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,1)}drawSelectedEdges(e){(this._emphasisEdgesRenderer||(this._emphasisEdgesRenderer=E.get(this)))&&this._emphasisEdgesRenderer.drawMesh(e,this,2)}drawOcclusion(e){(this._occlusionRenderer||(this._occlusionRenderer=L.get(this)))&&this._occlusionRenderer.drawMesh(e,this)}drawShadow(e){(this._shadowRenderer||(this._shadowRenderer=I.get(this)))&&this._shadowRenderer.drawMesh(e,this)}drawPickMesh(e){(this._pickMeshRenderer||(this._pickMeshRenderer=k.get(this)))&&this._pickMeshRenderer.drawMesh(e,this)}canPickTriangle(){return this._geometry.isReadableGeometry}drawPickTriangles(e){(this._pickTriangleRenderer||(this._pickTriangleRenderer=T.get(this)))&&this._pickTriangleRenderer.drawMesh(e,this)}pickTriangleSurface(e,t,i){Z(this,e,t,i)}drawPickVertices(e){}delegatePickedEntity(){return this}destroy(){super.destroy(),this._putDrawRenderers(),this._putPickRenderers(),this._putOcclusionRenderer(),this.scene._renderer.putPickID(this._state.pickID),this._isObject&&(this.scene._deregisterObject(this),this._visible&&this.scene._objectVisibilityUpdated(this,!1),this._xrayed&&this.scene._objectXRayedUpdated(this,!1),this._selected&&this.scene._objectSelectedUpdated(this,!1),this._highlighted&&this.scene._objectHighlightedUpdated(this,!1),this.scene._objectColorizeUpdated(this,!1),this.scene._objectOpacityUpdated(this,!1),this.scene._objectOffsetUpdated(this,!1)),this._isModel&&this.scene._deregisterModel(this),this.glRedraw()}}const Z=function(){const e=r.math.vec3(),t=r.math.vec3(),i=r.math.vec3(),n=r.math.vec3(),o=r.math.vec3(),s=r.math.vec3(),a=r.math.vec4(),l=r.math.vec3(),c=r.math.vec3(),u=r.math.vec3(),h=r.math.vec3(),d=r.math.vec3(),p=r.math.vec3(),f=r.math.vec3(),m=r.math.vec3(),g=r.math.vec3(),v=r.math.vec4(),b=r.math.vec4(),_=r.math.vec4(),y=r.math.vec3(),x=r.math.vec3(),w=r.math.vec3(),M=r.math.vec3(),P=r.math.vec3(),E=r.math.vec3(),S=r.math.vec3(),C=r.math.vec3(),k=r.math.vec3(),O=r.math.vec3(),A=r.math.vec3();return function(T,D,R,L){var B=L.primIndex;if(null!=B&&B>-1){const z=T.geometry._state,V=T.scene,U=V.camera,W=V.canvas;if("triangles"===z.primitiveName){L.primitive="triangle";const V=B,H=z.indices,G=z.positions;let X,Y,$,q;if(H){var I=H[V+0],N=H[V+1],F=H[V+2];s[0]=I,s[1]=N,s[2]=F,L.indices=s,X=3*I,Y=3*N,$=3*F}else $=3+(Y=3+(X=3*V));if(i[0]=G[X+0],i[1]=G[X+1],i[2]=G[X+2],n[0]=G[Y+0],n[1]=G[Y+1],n[2]=G[Y+2],o[0]=G[$+0],o[1]=G[$+1],o[2]=G[$+2],z.compressGeometry){const e=z.positionsDecodeMatrix;e&&(j.a.decompressPosition(i,e,i),j.a.decompressPosition(n,e,n),j.a.decompressPosition(o,e,o))}L.canvasPos?(q=L.canvasPos,r.math.canvasPosToLocalRay(W.canvas,D,R,T.worldMatrix,q,e,t)):L.origin&&L.direction&&r.math.worldRayToLocalRay(T.worldMatrix,L.origin,L.direction,e,t),r.math.normalizeVec3(t),r.math.rayPlaneIntersect(e,t,i,n,o,a),L.localPos=a,L.position=a,v[0]=a[0],v[1]=a[1],v[2]=a[2],v[3]=1,r.math.transformVec4(T.worldMatrix,v,b),l[0]=b[0],l[1]=b[1],l[2]=b[2],L.worldPos=l,r.math.transformVec4(U.matrix,b,_),c[0]=_[0],c[1]=_[1],c[2]=_[2],L.viewPos=c,r.math.cartesianToBarycentric(a,i,n,o,u),L.bary=u;const K=z.normals;if(K){if(z.compressGeometry){const e=3*I,t=3*N,i=3*F;j.a.decompressNormal(K.subarray(e,e+2),h),j.a.decompressNormal(K.subarray(t,t+2),d),j.a.decompressNormal(K.subarray(i,i+2),p)}else h[0]=K[X],h[1]=K[X+1],h[2]=K[X+2],d[0]=K[Y],d[1]=K[Y+1],d[2]=K[Y+2],p[0]=K[$],p[1]=K[$+1],p[2]=K[$+2];const e=r.math.addVec3(r.math.addVec3(r.math.mulVec3Scalar(h,u[0],y),r.math.mulVec3Scalar(d,u[1],x),w),r.math.mulVec3Scalar(p,u[2],M),P);L.worldNormal=r.math.normalizeVec3(r.math.transformVec3(T.worldNormalMatrix,e,E))}const Z=z.uv;if(Z){if(f[0]=Z[2*I],f[1]=Z[2*I+1],m[0]=Z[2*N],m[1]=Z[2*N+1],g[0]=Z[2*F],g[1]=Z[2*F+1],z.compressGeometry){const e=z.uvDecodeMatrix;e&&(j.a.decompressUV(f,e,f),j.a.decompressUV(m,e,m),j.a.decompressUV(g,e,g))}L.uv=r.math.addVec3(r.math.addVec3(r.math.mulVec2Scalar(f,u[0],S),r.math.mulVec2Scalar(m,u[1],C),k),r.math.mulVec2Scalar(g,u[2],O),A)}}}}}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(260),n=(i(1),i(41));function o(){return Object(r.a)()||n.a}},function(e,t,i){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=i(217)},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const r=new(i(24).Map)({});class n{constructor(e){this.id=r.addItem({});for(const t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}destroy(){r.removeItem(this.id)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(0);function n(e,t,i,r){let n=e[t]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2])),o=e[t+1]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2]));if(e[t+2]<0){let e=(1-Math.abs(o))*(n>=0?1:-1),t=(1-Math.abs(n))*(o>=0?1:-1);n=e,o=t}return new Int8Array([Math[i](127.5*n+(n<0?-1:0)),Math[r](127.5*o+(o<0?-1:0))])}function o(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const n=Math.sqrt(t*t+i*i+r*r);return[t/n,i/n,r/n]}function s(e,t,i){return e[t]*i[0]+e[t+1]*i[1]+e[t+2]*i[2]}const a={getPositionsBounds:function(e){const t=new Float32Array(3),i=new Float32Array(3);let r,n;for(r=0;r<3;r++)t[r]=Number.MAX_VALUE,i[r]=-Number.MAX_VALUE;for(r=0;r<e.length;r+=3)for(n=0;n<3;n++)t[n]=Math.min(t[n],e[r+n]),i[n]=Math.max(i[n],e[r+n]);return{min:t,max:i}},createPositionsDecodeMatrix:function(){const e=r.math.mat4(),t=r.math.mat4();return function(i,n){n=n||r.math.mat4();const o=i[0],s=i[1],a=i[2],l=i[3]-o,c=i[4]-s,u=i[5]-a;return r.math.identityMat4(e),r.math.translationMat4v(i,e),r.math.identityMat4(t),r.math.scalingMat4v([l/65535,c/65535,u/65535],t),r.math.mulMat4(e,t,n),n}}(),compressPositions:function(){const e=r.math.mat4(),t=r.math.mat4();return function(i,n,o){const s=new Uint16Array(i.length);var a=new Float32Array([o[0]!==n[0]?65535/(o[0]-n[0]):0,o[1]!==n[1]?65535/(o[1]-n[1]):0,o[2]!==n[2]?65535/(o[2]-n[2]):0]);let l;for(l=0;l<i.length;l+=3)s[l+0]=Math.floor((i[l+0]-n[0])*a[0]),s[l+1]=Math.floor((i[l+1]-n[1])*a[1]),s[l+2]=Math.floor((i[l+2]-n[2])*a[2]);return r.math.identityMat4(e),r.math.translationMat4v(n,e),r.math.identityMat4(t),r.math.scalingMat4v([(o[0]-n[0])/65535,(o[1]-n[1])/65535,(o[2]-n[2])/65535],t),{quantized:s,decodeMatrix:r.math.mulMat4(e,t,r.math.identityMat4())}}}(),decompressPositions:function(e,t,i=new Float32Array(e.length)){for(let r=0,n=e.length;r<n;r+=3)i[r+0]=e[r+0]*t[0]+t[12],i[r+1]=e[r+1]*t[5]+t[13],i[r+2]=e[r+2]*t[10]+t[14];return i},decompressPosition:function(e,t,i){return i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14],i},decompressAABB:function(e,t,i=e){return i[0]=e[0]*t[0]+t[12],i[1]=e[1]*t[5]+t[13],i[2]=e[2]*t[10]+t[14],i[3]=e[3]*t[0]+t[12],i[4]=e[4]*t[5]+t[13],i[5]=e[5]*t[10]+t[14],i},getUVBounds:function(e){const t=new Float32Array(2),i=new Float32Array(2);let r,n;for(r=0;r<2;r++)t[r]=Number.MAX_VALUE,i[r]=-Number.MAX_VALUE;for(r=0;r<e.length;r+=2)for(n=0;n<2;n++)t[n]=Math.min(t[n],e[r+n]),i[n]=Math.max(i[n],e[r+n]);return{min:t,max:i}},compressUVs:function(){const e=r.math.mat3(),t=r.math.mat3();return function(i,n,o){const s=new Uint16Array(i.length),a=new Float32Array([65535/(o[0]-n[0]),65535/(o[1]-n[1])]);let l;for(l=0;l<i.length;l+=2)s[l+0]=Math.floor((i[l+0]-n[0])*a[0]),s[l+1]=Math.floor((i[l+1]-n[1])*a[1]);return r.math.identityMat3(e),r.math.translationMat3v(n,e),r.math.identityMat3(t),r.math.scalingMat3v([(o[0]-n[0])/65535,(o[1]-n[1])/65535],t),{quantized:s,decodeMatrix:r.math.mulMat3(e,t,r.math.identityMat3())}}}(),decompressUVs:function(e,t,i=new Float32Array(e.length)){for(let r=0,n=e.length;r<n;r+=3)i[r+0]=e[r+0]*t[0]+t[6],i[r+1]=e[r+1]*t[4]+t[7];return i},decompressUV:function(e,t,i){i[0]=e[0]*t[0]+t[6],i[1]=e[1]*t[4]+t[7]},compressNormals:function(e){const t=new Int8Array(e.length);let i,r,a,l,c;for(let u=0;u<e.length;u+=3)a=i=n(e,u,"floor","floor"),l=c=s(e,u,r=o(i)),(l=s(e,u,r=o(i=n(e,u,"ceil","floor"))))>c&&(a=i,c=l),(l=s(e,u,r=o(i=n(e,u,"floor","ceil"))))>c&&(a=i,c=l),(l=s(e,u,r=o(i=n(e,u,"ceil","ceil"))))>c&&(a=i,c=l),t[u]=a[0],t[u+1]=a[1];return t},decompressNormals:function(e,t){for(let i=0,r=0,n=e.length;i<n;i+=2){let n=e[i+0],o=e[i+1];n=(2*n+1)/255,o=(2*o+1)/255;const s=1-Math.abs(n)-Math.abs(o);s<0&&(n=(1-Math.abs(o))*(n>=0?1:-1),o=(1-Math.abs(n))*(o>=0?1:-1));const a=Math.sqrt(n*n+o*o+s*s);t[r+0]=n/a,t[r+1]=o/a,t[r+2]=s/a,r+=3}return t},decompressNormal:function(e,t){let i=e[0],r=e[1];i=(2*i+1)/255,r=(2*r+1)/255;const n=1-Math.abs(i)-Math.abs(r);n<0&&(i=(1-Math.abs(r))*(i>=0?1:-1),r=(1-Math.abs(i))*(r>=0?1:-1));const o=Math.sqrt(i*i+r*r+n*n);return t[0]=i/o,t[1]=r/o,t[2]=n/o,t}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i(4),n={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},o={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function s(e){return"".concat(Math.round(e),"ms")}t.a={easing:n,duration:o,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.duration,a=void 0===i?o.standard:i,l=t.easing,c=void 0===l?n.easeInOut:l,u=t.delay,h=void 0===u?0:u;return Object(r.a)(t,["duration","easing","delay"]),(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"==typeof a?a:s(a)," ").concat(c," ").concat("string"==typeof h?h:s(h))})).join(",")},getAutoHeightDuration:function(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(86),n=i(65),o=i(87);function s(e,t){return Object(r.a)(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return i}}(e,t)||Object(n.a)(e,t)||Object(o.a)()}},function(e,t,i){"use strict";i.r(t),i.d(t,"Map",(function(){return r}));class r{constructor(e,t){this.items=e||[],this._lastUniqueId=(t||0)+1}addItem(){let e;if(2===arguments.length){const t=arguments[0];if(e=arguments[1],this.items[t])throw"ID clash: '"+t+"'";return this.items[t]=e,t}for(e=arguments[0]||{};;){const t=this._lastUniqueId++;if(!this.items[t])return this.items[t]=e,t}}removeItem(e){const t=this.items[e];return delete this.items[e],t}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(77),n=i(89),o=i(65);function s(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(n.a)(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var r=i(16),n=i(15);class o extends r.a{get type(){return"Geometry"}get isGeometry(){return!0}constructor(e,t={}){super(e,t),n.a.memory.meshes++}destroy(){super.destroy(),n.a.memory.meshes--}}var s=i(20),a=i(14),l=i(0),c=i(7),u=i(67),h=i(21);const d=n.a.memory,p=c.a.SUPPORTED_EXTENSIONS.OES_element_index_uint,f=p?Uint32Array:Uint16Array,m=l.math.AABB3();class g extends o{get type(){return"ReadableGeometry"}get isReadableGeometry(){return!0}constructor(e,t={}){super(e,t),this._state=new s.a({compressGeometry:!!t.compressGeometry,primitive:null,primitiveName:null,positions:null,normals:null,colors:null,uv:null,indices:null,positionsDecodeMatrix:null,uvDecodeMatrix:null,positionsBuf:null,normalsBuf:null,colorsbuf:null,uvBuf:null,indicesBuf:null,hash:""}),this._numTriangles=0,this._edgeThreshold=t.edgeThreshold||10,this._edgeIndicesBuf=null,this._pickTrianglePositionsBuf=null,this._pickTriangleColorsBuf=null,this._aabbDirty=!0,this._boundingSphere=!0,this._aabb=null,this._aabbDirty=!0,this._obb=null,this._obbDirty=!0;const i=this._state,r=this.scene.canvas.gl;switch(t.primitive=t.primitive||"triangles",t.primitive){case"points":i.primitive=r.POINTS,i.primitiveName=t.primitive;break;case"lines":i.primitive=r.LINES,i.primitiveName=t.primitive;break;case"line-loop":i.primitive=r.LINE_LOOP,i.primitiveName=t.primitive;break;case"line-strip":i.primitive=r.LINE_STRIP,i.primitiveName=t.primitive;break;case"triangles":i.primitive=r.TRIANGLES,i.primitiveName=t.primitive;break;case"triangle-strip":i.primitive=r.TRIANGLE_STRIP,i.primitiveName=t.primitive;break;case"triangle-fan":i.primitive=r.TRIANGLE_FAN,i.primitiveName=t.primitive;break;default:this.error("Unsupported value for 'primitive': '"+t.primitive+"' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'."),i.primitive=r.TRIANGLES,i.primitiveName=t.primitive}if(t.positions)if(this._state.compressGeometry){const e=h.a.getPositionsBounds(t.positions),r=h.a.compressPositions(t.positions,e.min,e.max);i.positions=r.quantized,i.positionsDecodeMatrix=r.decodeMatrix}else i.positions=t.positions.constructor===Float32Array?t.positions:new Float32Array(t.positions);if(t.colors&&(i.colors=t.colors.constructor===Float32Array?t.colors:new Float32Array(t.colors)),t.uv)if(this._state.compressGeometry){const e=h.a.getUVBounds(t.uv),r=h.a.compressUVs(t.uv,e.min,e.max);i.uv=r.quantized,i.uvDecodeMatrix=r.decodeMatrix}else i.uv=t.uv.constructor===Float32Array?t.uv:new Float32Array(t.uv);if(t.normals&&(this._state.compressGeometry?i.normals=h.a.compressNormals(t.normals):i.normals=t.normals.constructor===Float32Array?t.normals:new Float32Array(t.normals)),t.indices){if(!p&&t.indices.constructor===Uint32Array)return void this.error("This WebGL implementation does not support Uint32Array");i.indices=t.indices.constructor===Uint32Array||t.indices.constructor===Uint16Array?t.indices:new f(t.indices),"triangles"===this._state.primitiveName&&(this._numTriangles=t.indices.length/3)}this._buildHash(),d.meshes++,this._buildVBOs()}_buildVBOs(){const e=this._state,t=this.scene.canvas.gl;if(e.indices&&(e.indicesBuf=new a.a(t,t.ELEMENT_ARRAY_BUFFER,e.indices,e.indices.length,1,t.STATIC_DRAW),d.indices+=e.indicesBuf.numItems),e.positions&&(e.positionsBuf=new a.a(t,t.ARRAY_BUFFER,e.positions,e.positions.length,3,t.STATIC_DRAW),d.positions+=e.positionsBuf.numItems),e.normals){let i=e.compressGeometry;e.normalsBuf=new a.a(t,t.ARRAY_BUFFER,e.normals,e.normals.length,3,t.STATIC_DRAW,i),d.normals+=e.normalsBuf.numItems}e.colors&&(e.colorsBuf=new a.a(t,t.ARRAY_BUFFER,e.colors,e.colors.length,4,t.STATIC_DRAW),d.colors+=e.colorsBuf.numItems),e.uv&&(e.uvBuf=new a.a(t,t.ARRAY_BUFFER,e.uv,e.uv.length,2,t.STATIC_DRAW),d.uvs+=e.uvBuf.numItems)}_buildHash(){const e=this._state,t=["/g"];t.push("/"+e.primitive+";"),e.positions&&t.push("p"),e.colors&&t.push("c"),(e.normals||e.autoVertexNormals)&&t.push("n"),e.uv&&t.push("u"),e.compressGeometry&&t.push("cp"),t.push(";"),e.hash=t.join("")}_getEdgeIndices(){return this._edgeIndicesBuf||this._buildEdgeIndices(),this._edgeIndicesBuf}_getPickTrianglePositions(){return this._pickTrianglePositionsBuf||this._buildPickTriangleVBOs(),this._pickTrianglePositionsBuf}_getPickTriangleColors(){return this._pickTriangleColorsBuf||this._buildPickTriangleVBOs(),this._pickTriangleColorsBuf}_buildEdgeIndices(){const e=this._state;if(!e.positions||!e.indices)return;const t=this.scene.canvas.gl,i=Object(u.a)(e.positions,e.indices,e.positionsDecodeMatrix,this._edgeThreshold);this._edgeIndicesBuf=new a.a(t,t.ELEMENT_ARRAY_BUFFER,i,i.length,1,t.STATIC_DRAW),d.indices+=this._edgeIndicesBuf.numItems}_buildPickTriangleVBOs(){const e=this._state;if(!e.positions||!e.indices)return;const t=this.scene.canvas.gl,i=l.math.buildPickTriangles(e.positions,e.indices,e.compressGeometry),r=i.positions,n=i.colors;this._pickTrianglePositionsBuf=new a.a(t,t.ARRAY_BUFFER,r,r.length,3,t.STATIC_DRAW),this._pickTriangleColorsBuf=new a.a(t,t.ARRAY_BUFFER,n,n.length,4,t.STATIC_DRAW,!0),d.positions+=this._pickTrianglePositionsBuf.numItems,d.colors+=this._pickTriangleColorsBuf.numItems}_buildPickVertexVBOs(){}_webglContextLost(){this._sceneVertexBufs&&this._sceneVertexBufs.webglContextLost()}_webglContextRestored(){this._sceneVertexBufs&&this._sceneVertexBufs.webglContextRestored(),this._buildVBOs(),this._edgeIndicesBuf=null,this._pickVertexPositionsBuf=null,this._pickTrianglePositionsBuf=null,this._pickTriangleColorsBuf=null,this._pickVertexPositionsBuf=null,this._pickVertexColorsBuf=null}get primitive(){return this._state.primitiveName}get compressGeometry(){return this._state.compressGeometry}get positions(){return this._state.positions?this._state.compressGeometry?(this._decompressedPositions||(this._decompressedPositions=new Float32Array(this._state.positions.length),h.a.decompressPositions(this._state.positions,this._state.positionsDecodeMatrix,this._decompressedPositions)),this._decompressedPositions):this._state.positions:null}set positions(e){const t=this._state,i=t.positions;if(i)if(i.length===e.length){if(this._state.compressGeometry){const i=h.a.getPositionsBounds(e),r=h.a.compressPositions(e,i.min,i.max);e=r.quantized,t.positionsDecodeMatrix=r.decodeMatrix}i.set(e),t.positionsBuf&&t.positionsBuf.setData(i),this._setAABBDirty(),this.glRedraw()}else this.error("can't update geometry positions - new positions are wrong length");else this.error("can't update geometry positions - geometry has no positions")}get normals(){if(this._state.normals){if(!this._state.compressGeometry)return this._state.normals;if(!this._decompressedNormals){const e=this._state.normals.length,t=e+e/2;this._decompressedNormals=new Float32Array(t),h.a.decompressNormals(this._state.normals,this._decompressedNormals)}return this._decompressedNormals}}set normals(e){if(this._state.compressGeometry)return void this.error("can't update geometry normals - quantized geometry is immutable");const t=this._state,i=t.normals;i?i.length===e.length?(i.set(e),t.normalsBuf&&t.normalsBuf.setData(i),this.glRedraw()):this.error("can't update geometry normals - new normals are wrong length"):this.error("can't update geometry normals - geometry has no normals")}get uv(){return this._state.uv?this._state.compressGeometry?(this._decompressedUV||(this._decompressedUV=new Float32Array(this._state.uv.length),h.a.decompressUVs(this._state.uv,this._state.uvDecodeMatrix,this._decompressedUV)),this._decompressedUV):this._state.uv:null}set uv(e){if(this._state.compressGeometry)return void this.error("can't update geometry UVs - quantized geometry is immutable");const t=this._state,i=t.uv;i?i.length===e.length?(i.set(e),t.uvBuf&&t.uvBuf.setData(i),this.glRedraw()):this.error("can't update geometry UVs - new UVs are wrong length"):this.error("can't update geometry UVs - geometry has no UVs")}get colors(){return this._state.colors}set colors(e){if(this._state.compressGeometry)return void this.error("can't update geometry colors - quantized geometry is immutable");const t=this._state,i=t.colors;i?i.length===e.length?(i.set(e),t.colorsBuf&&t.colorsBuf.setData(i),this.glRedraw()):this.error("can't update geometry colors - new colors are wrong length"):this.error("can't update geometry colors - geometry has no colors")}get indices(){return this._state.indices}get aabb(){return this._aabbDirty&&(this._aabb||(this._aabb=l.math.AABB3()),l.math.positions3ToAABB3(this._state.positions,this._aabb,this._state.positionsDecodeMatrix),this._aabbDirty=!1),this._aabb}get obb(){return this._obbDirty&&(this._obb||(this._obb=l.math.OBB3()),l.math.positions3ToAABB3(this._state.positions,m,this._state.positionsDecodeMatrix),l.math.AABB3ToOBB3(m,this._obb),this._obbDirty=!1),this._obb}get numTriangles(){return this._numTriangles}_setAABBDirty(){this._aabbDirty||(this._aabbDirty=!0,this._aabbDirty=!0,this._obbDirty=!0)}_getState(){return this._state}destroy(){super.destroy();const e=this._state;e.indicesBuf&&e.indicesBuf.destroy(),e.positionsBuf&&e.positionsBuf.destroy(),e.normalsBuf&&e.normalsBuf.destroy(),e.uvBuf&&e.uvBuf.destroy(),e.colorsBuf&&e.colorsBuf.destroy(),this._edgeIndicesBuf&&this._edgeIndicesBuf.destroy(),this._pickTrianglePositionsBuf&&this._pickTrianglePositionsBuf.destroy(),this._pickTriangleColorsBuf&&this._pickTriangleColorsBuf.destroy(),this._pickVertexPositionsBuf&&this._pickVertexPositionsBuf.destroy(),this._pickVertexColorsBuf&&this._pickVertexColorsBuf.destroy(),e.destroy(),d.meshes--}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return Y})),i.d(t,"b",(function(){return K})),i.d(t,"c",(function(){return ge})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return fe})),i.d(t,"f",(function(){return me})),i.d(t,"g",(function(){return p}));var r=i(2),n=i(54),o=(i(76),i(42)),s=i(52),a=i(53),l=i(46),c={}.constructor;function u(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(u);if(e.constructor!==c)return e;var t={};for(var i in e)t[i]=u(e[i]);return t}function h(e,t,i){void 0===e&&(e="unnamed");var r=i.jss,n=u(t);return r.plugins.onCreateRule(e,n,i)||(e[0],null)}var d=function(e,t){for(var i="",r=0;r<e.length&&"!important"!==e[r];r++)i&&(i+=t),i+=e[r];return i},p=function(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))return e;var i="";if(Array.isArray(e[0]))for(var r=0;r<e.length&&"!important"!==e[r];r++)i&&(i+=", "),i+=d(e[r]," ");else i=d(e,", ");return t||"!important"!==e[e.length-1]||(i+=" !important"),i};function f(e,t){for(var i="",r=0;r<t;r++)i+="  ";return i+e}function m(e,t,i){void 0===i&&(i={});var r="";if(!t)return r;var n=i.indent,o=void 0===n?0:n,s=t.fallbacks;if(e&&o++,s)if(Array.isArray(s))for(var a=0;a<s.length;a++){var l=s[a];for(var c in l){var u=l[c];null!=u&&(r&&(r+="\n"),r+=""+f(c+": "+p(u)+";",o))}}else for(var h in s){var d=s[h];null!=d&&(r&&(r+="\n"),r+=""+f(h+": "+p(d)+";",o))}for(var m in t){var g=t[m];null!=g&&"fallbacks"!==m&&(r&&(r+="\n"),r+=""+f(m+": "+p(g)+";",o))}return(r||i.allowEmpty)&&e?(r&&(r="\n"+r+"\n"),f(e+" {"+r,--o)+f("}",o)):r}var g=/([[\].#*$><+~=|^:(),"'`\s])/g,v="undefined"!=typeof CSS&&CSS.escape,b=function(e){return v?v(e):e.replace(g,"\\$1")},_=function(){function e(e,t,i){this.type="style",this.key=void 0,this.isProcessed=!1,this.style=void 0,this.renderer=void 0,this.renderable=void 0,this.options=void 0;var r=i.sheet,n=i.Renderer;this.key=e,this.options=i,this.style=t,r?this.renderer=r.renderer:n&&(this.renderer=new n)}return e.prototype.prop=function(e,t,i){if(void 0===t)return this.style[e];var r=!!i&&i.force;if(!r&&this.style[e]===t)return this;var n=t;i&&!1===i.process||(n=this.options.jss.plugins.onChangeValue(t,e,this));var o=null==n||!1===n,s=e in this.style;if(o&&!s&&!r)return this;var a=o&&s;if(a?delete this.style[e]:this.style[e]=n,this.renderable&&this.renderer)return a?this.renderer.removeProperty(this.renderable,e):this.renderer.setProperty(this.renderable,e,n),this;var l=this.options.sheet;return l&&l.attached,this},e}(),y=function(e){function t(t,i,r){var n;(n=e.call(this,t,i,r)||this).selectorText=void 0,n.id=void 0,n.renderable=void 0;var o=r.selector,s=r.scoped,l=r.sheet,c=r.generateId;return o?n.selectorText=o:!1!==s&&(n.id=c(Object(a.a)(Object(a.a)(n)),l),n.selectorText="."+b(n.id)),n}Object(s.a)(t,e);var i=t.prototype;return i.applyTo=function(e){var t=this.renderer;if(t){var i=this.toJSON();for(var r in i)t.setProperty(e,r,i[r])}return this},i.toJSON=function(){var e={};for(var t in this.style){var i=this.style[t];"object"!=typeof i?e[t]=i:Array.isArray(i)&&(e[t]=p(i))}return e},i.toString=function(e){var t=this.options.sheet,i=t&&t.options.link?Object(r.a)({},e,{allowEmpty:!0}):e;return m(this.selectorText,this.style,i)},Object(o.a)(t,[{key:"selector",set:function(e){if(e!==this.selectorText){this.selectorText=e;var t=this.renderer,i=this.renderable;i&&t&&(t.setSelector(i,e)||t.replaceRule(i,this))}},get:function(){return this.selectorText}}]),t}(_),x={onCreateRule:function(e,t,i){return"@"===e[0]||i.parent&&"keyframes"===i.parent.type?null:new y(e,t,i)}},w={indent:1,children:!0},M=/@([\w-]+)/,P=function(){function e(e,t,i){this.type="conditional",this.at=void 0,this.key=void 0,this.query=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e;var n=e.match(M);for(var o in this.at=n?n[1]:"unknown",this.query=i.name||"@"+this.at,this.options=i,this.rules=new Y(Object(r.a)({},i,{parent:this})),t)this.rules.add(o,t[o]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.indexOf=function(e){return this.rules.indexOf(e)},t.addRule=function(e,t,i){var r=this.rules.add(e,t,i);return r?(this.options.jss.plugins.onProcessRule(r),r):null},t.toString=function(e){if(void 0===e&&(e=w),null==e.indent&&(e.indent=w.indent),null==e.children&&(e.children=w.children),!1===e.children)return this.query+" {}";var t=this.rules.toString(e);return t?this.query+" {\n"+t+"\n}":""},e}(),E=/@media|@supports\s+/,S={onCreateRule:function(e,t,i){return E.test(e)?new P(e,t,i):null}},C={indent:1,children:!0},k=/@keyframes\s+([\w-]+)/,O=function(){function e(e,t,i){this.type="keyframes",this.at="@keyframes",this.key=void 0,this.name=void 0,this.id=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0;var n=e.match(k);n&&n[1]?this.name=n[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=i;var o=i.scoped,s=i.sheet,a=i.generateId;for(var l in this.id=!1===o?this.name:b(a(this,s)),this.rules=new Y(Object(r.a)({},i,{parent:this})),t)this.rules.add(l,t[l],Object(r.a)({},i,{parent:this}));this.rules.process()}return e.prototype.toString=function(e){if(void 0===e&&(e=C),null==e.indent&&(e.indent=C.indent),null==e.children&&(e.children=C.children),!1===e.children)return this.at+" "+this.id+" {}";var t=this.rules.toString(e);return t&&(t="\n"+t+"\n"),this.at+" "+this.id+" {"+t+"}"},e}(),A=/@keyframes\s+/,T=/\$([\w-]+)/g,D=function(e,t){return"string"==typeof e?e.replace(T,(function(e,i){return i in t?t[i]:e})):e},R=function(e,t,i){var r=e[t],n=D(r,i);n!==r&&(e[t]=n)},L={onCreateRule:function(e,t,i){return"string"==typeof e&&A.test(e)?new O(e,t,i):null},onProcessStyle:function(e,t,i){return"style"===t.type&&i?("animation-name"in e&&R(e,"animation-name",i.keyframes),"animation"in e&&R(e,"animation",i.keyframes),e):e},onChangeValue:function(e,t,i){var r=i.options.sheet;if(!r)return e;switch(t){case"animation":case"animation-name":return D(e,r.keyframes);default:return e}}},B=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).renderable=void 0,t}return Object(s.a)(t,e),t.prototype.toString=function(e){var t=this.options.sheet,i=t&&t.options.link?Object(r.a)({},e,{allowEmpty:!0}):e;return m(this.key,this.style,i)},t}(_),I={onCreateRule:function(e,t,i){return i.parent&&"keyframes"===i.parent.type?new B(e,t,i):null}},N=function(){function e(e,t,i){this.type="font-face",this.at="@font-face",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=i}return e.prototype.toString=function(e){if(Array.isArray(this.style)){for(var t="",i=0;i<this.style.length;i++)t+=m(this.at,this.style[i]),this.style[i+1]&&(t+="\n");return t}return m(this.at,this.style,e)},e}(),j=/@font-face/,F={onCreateRule:function(e,t,i){return j.test(e)?new N(e,t,i):null}},z=function(){function e(e,t,i){this.type="viewport",this.at="@viewport",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=i}return e.prototype.toString=function(e){return m(this.key,this.style,e)},e}(),V={onCreateRule:function(e,t,i){return"@viewport"===e||"@-ms-viewport"===e?new z(e,t,i):null}},U=function(){function e(e,t,i){this.type="simple",this.key=void 0,this.value=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.value=t,this.options=i}return e.prototype.toString=function(e){if(Array.isArray(this.value)){for(var t="",i=0;i<this.value.length;i++)t+=this.key+" "+this.value[i]+";",this.value[i+1]&&(t+="\n");return t}return this.key+" "+this.value+";"},e}(),W={"@charset":!0,"@import":!0,"@namespace":!0},H=[x,S,L,I,F,V,{onCreateRule:function(e,t,i){return e in W?new U(e,t,i):null}}],G={process:!0},X={force:!0,process:!0},Y=function(){function e(e){this.map={},this.raw={},this.index=[],this.counter=0,this.options=void 0,this.classes=void 0,this.keyframes=void 0,this.options=e,this.classes=e.classes,this.keyframes=e.keyframes}var t=e.prototype;return t.add=function(e,t,i){var n=this.options,o=n.parent,s=n.sheet,a=n.jss,l=n.Renderer,c=n.generateId,u=n.scoped,d=Object(r.a)({classes:this.classes,parent:o,sheet:s,jss:a,Renderer:l,generateId:c,scoped:u,name:e,keyframes:this.keyframes,selector:void 0},i),p=e;e in this.raw&&(p=e+"-d"+this.counter++),this.raw[p]=t,p in this.classes&&(d.selector="."+b(this.classes[p]));var f=h(p,t,d);if(!f)return null;this.register(f);var m=void 0===d.index?this.index.length:d.index;return this.index.splice(m,0,f),f},t.get=function(e){return this.map[e]},t.remove=function(e){this.unregister(e),delete this.raw[e.key],this.index.splice(this.index.indexOf(e),1)},t.indexOf=function(e){return this.index.indexOf(e)},t.process=function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)},t.register=function(e){this.map[e.key]=e,e instanceof y?(this.map[e.selector]=e,e.id&&(this.classes[e.key]=e.id)):e instanceof O&&this.keyframes&&(this.keyframes[e.name]=e.id)},t.unregister=function(e){delete this.map[e.key],e instanceof y?(delete this.map[e.selector],delete this.classes[e.key]):e instanceof O&&delete this.keyframes[e.name]},t.update=function(){var e,t,i;if("string"==typeof(arguments.length<=0?void 0:arguments[0])?(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2]):(t=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1],e=null),e)this.updateOne(this.map[e],t,i);else for(var r=0;r<this.index.length;r++)this.updateOne(this.index[r],t,i)},t.updateOne=function(t,i,r){void 0===r&&(r=G);var n=this.options,o=n.jss.plugins,s=n.sheet;if(t.rules instanceof e)t.rules.update(i,r);else{var a=t,l=a.style;if(o.onUpdate(i,t,s,r),r.process&&l&&l!==a.style){for(var c in o.onProcessStyle(a.style,a,s),a.style){var u=a.style[c];u!==l[c]&&a.prop(c,u,X)}for(var h in l){var d=a.style[h],p=l[h];null==d&&d!==p&&a.prop(h,null,X)}}}},t.toString=function(e){for(var t="",i=this.options.sheet,r=!!i&&i.options.link,n=0;n<this.index.length;n++){var o=this.index[n].toString(e);(o||r)&&(t&&(t+="\n"),t+=o)}return t},e}(),$=function(){function e(e,t){for(var i in this.options=void 0,this.deployed=void 0,this.attached=void 0,this.rules=void 0,this.renderer=void 0,this.classes=void 0,this.keyframes=void 0,this.queue=void 0,this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=Object(r.a)({},t,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),t.Renderer&&(this.renderer=new t.Renderer(this)),this.rules=new Y(this.options),e)this.rules.add(i,e[i]);this.rules.process()}var t=e.prototype;return t.attach=function(){return this.attached||(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy()),this},t.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},t.addRule=function(e,t,i){var r=this.queue;this.attached&&!r&&(this.queue=[]);var n=this.rules.add(e,t,i);return n?(this.options.jss.plugins.onProcessRule(n),this.attached?this.deployed?(r?r.push(n):(this.insertRule(n),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0)),n):n:(this.deployed=!1,n)):null},t.insertRule=function(e){this.renderer&&this.renderer.insertRule(e)},t.addRules=function(e,t){var i=[];for(var r in e){var n=this.addRule(r,e[r],t);n&&i.push(n)}return i},t.getRule=function(e){return this.rules.get(e)},t.deleteRule=function(e){var t="object"==typeof e?e:this.rules.get(e);return!(!t||this.attached&&!t.renderable)&&(this.rules.remove(t),!(this.attached&&t.renderable&&this.renderer)||this.renderer.deleteRule(t.renderable))},t.indexOf=function(e){return this.rules.indexOf(e)},t.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},t.update=function(){var e;return(e=this.rules).update.apply(e,arguments),this},t.updateOne=function(e,t,i){return this.rules.updateOne(e,t,i),this},t.toString=function(e){return this.rules.toString(e)},e}(),q=function(){function e(){this.plugins={internal:[],external:[]},this.registry=void 0}var t=e.prototype;return t.onCreateRule=function(e,t,i){for(var r=0;r<this.registry.onCreateRule.length;r++){var n=this.registry.onCreateRule[r](e,t,i);if(n)return n}return null},t.onProcessRule=function(e){if(!e.isProcessed){for(var t=e.options.sheet,i=0;i<this.registry.onProcessRule.length;i++)this.registry.onProcessRule[i](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}},t.onProcessStyle=function(e,t,i){for(var r=0;r<this.registry.onProcessStyle.length;r++)t.style=this.registry.onProcessStyle[r](t.style,t,i)},t.onProcessSheet=function(e){for(var t=0;t<this.registry.onProcessSheet.length;t++)this.registry.onProcessSheet[t](e)},t.onUpdate=function(e,t,i,r){for(var n=0;n<this.registry.onUpdate.length;n++)this.registry.onUpdate[n](e,t,i,r)},t.onChangeValue=function(e,t,i){for(var r=e,n=0;n<this.registry.onChangeValue.length;n++)r=this.registry.onChangeValue[n](r,t,i);return r},t.use=function(e,t){void 0===t&&(t={queue:"external"});var i=this.plugins[t.queue];-1===i.indexOf(e)&&(i.push(e),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce((function(e,t){for(var i in t)i in e&&e[i].push(t[i]);return e}),{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},e}(),K=function(){function e(){this.registry=[]}var t=e.prototype;return t.add=function(e){var t=this.registry,i=e.options.index;if(-1===t.indexOf(e))if(0===t.length||i>=this.index)t.push(e);else for(var r=0;r<t.length;r++)if(t[r].options.index>i)return void t.splice(r,0,e)},t.reset=function(){this.registry=[]},t.remove=function(e){var t=this.registry.indexOf(e);this.registry.splice(t,1)},t.toString=function(e){for(var t=void 0===e?{}:e,i=t.attached,r=Object(l.a)(t,["attached"]),n="",o=0;o<this.registry.length;o++){var s=this.registry[o];null!=i&&s.attached!==i||(n&&(n+="\n"),n+=s.toString(r))}return n},Object(o.a)(e,[{key:"index",get:function(){return 0===this.registry.length?0:this.registry[this.registry.length-1].options.index}}]),e}(),Z=new K,Q="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),J="2f1acc6c3a606b082e5eef5e54414ffb";null==Q[J]&&(Q[J]=0);var ee=Q[J]++,te=function(e){void 0===e&&(e={});var t=0;return function(i,r){t+=1;var n="",o="";return r&&(r.options.classNamePrefix&&(o=r.options.classNamePrefix),null!=r.options.jss.id&&(n=String(r.options.jss.id))),e.minify?""+(o||"c")+ee+n+t:o+i.key+"-"+ee+(n?"-"+n:"")+"-"+t}},ie=function(e){var t;return function(){return t||(t=e()),t}},re=function(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch(e){return""}},ne=function(e,t,i){try{var r=i;if(Array.isArray(i)&&(r=p(i,!0),"!important"===i[i.length-1]))return e.style.setProperty(t,r,"important"),!0;e.attributeStyleMap?e.attributeStyleMap.set(t,r):e.style.setProperty(t,r)}catch(e){return!1}return!0},oe=function(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch(e){}},se=function(e,t){return e.selectorText=t,e.selectorText===t},ae=ie((function(){return document.querySelector("head")}));var le=ie((function(){var e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null})),ce=function(e,t,i){try{"insertRule"in e?e.insertRule(t,i):"appendRule"in e&&e.appendRule(t)}catch(e){return!1}return e.cssRules[i]},ue=function(e,t){var i=e.cssRules.length;return void 0===t||t>i?i:t},he=function(){function e(e){this.getPropertyValue=re,this.setProperty=ne,this.removeProperty=oe,this.setSelector=se,this.element=void 0,this.sheet=void 0,this.hasInsertedRules=!1,this.cssRules=[],e&&Z.add(e),this.sheet=e;var t=this.sheet?this.sheet.options:{},i=t.media,r=t.meta,n=t.element;this.element=n||function(){var e=document.createElement("style");return e.textContent="\n",e}(),this.element.setAttribute("data-jss",""),i&&this.element.setAttribute("media",i),r&&this.element.setAttribute("data-meta",r);var o=le();o&&this.element.setAttribute("nonce",o)}var t=e.prototype;return t.attach=function(){if(!this.element.parentNode&&this.sheet){!function(e,t){var i=t.insertionPoint,r=function(e){var t=Z.registry;if(t.length>0){var i=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.attached&&r.options.index>t.index&&r.options.insertionPoint===t.insertionPoint)return r}return null}(t,e);if(i&&i.renderer)return{parent:i.renderer.element.parentNode,node:i.renderer.element};if((i=function(e,t){for(var i=e.length-1;i>=0;i--){var r=e[i];if(r.attached&&r.options.insertionPoint===t.insertionPoint)return r}return null}(t,e))&&i.renderer)return{parent:i.renderer.element.parentNode,node:i.renderer.element.nextSibling}}var r=e.insertionPoint;if(r&&"string"==typeof r){var n=function(e){for(var t=ae(),i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];if(8===r.nodeType&&r.nodeValue.trim()===e)return r}return null}(r);if(n)return{parent:n.parentNode,node:n.nextSibling}}return!1}(t);if(!1!==r&&r.parent)r.parent.insertBefore(e,r.node);else if(i&&"number"==typeof i.nodeType){var n=i,o=n.parentNode;o&&o.insertBefore(e,n.nextSibling)}else ae().appendChild(e)}(this.element,this.sheet.options);var e=Boolean(this.sheet&&this.sheet.deployed);this.hasInsertedRules&&e&&(this.hasInsertedRules=!1,this.deploy())}},t.detach=function(){if(this.sheet){var e=this.element.parentNode;e&&e.removeChild(this.element),this.sheet.options.link&&(this.cssRules=[],this.element.textContent="\n")}},t.deploy=function(){var e=this.sheet;e&&(e.options.link?this.insertRules(e.rules):this.element.textContent="\n"+e.toString()+"\n")},t.insertRules=function(e,t){for(var i=0;i<e.index.length;i++)this.insertRule(e.index[i],i,t)},t.insertRule=function(e,t,i){if(void 0===i&&(i=this.element.sheet),e.rules){var r=e,n=i;if("conditional"===e.type||"keyframes"===e.type){var o=ue(i,t);if(!1===(n=ce(i,r.toString({children:!1}),o)))return!1;this.refCssRule(e,o,n)}return this.insertRules(r.rules,n),n}var s=e.toString();if(!s)return!1;var a=ue(i,t),l=ce(i,s,a);return!1!==l&&(this.hasInsertedRules=!0,this.refCssRule(e,a,l),l)},t.refCssRule=function(e,t,i){e.renderable=i,e.options.parent instanceof $&&(this.cssRules[t]=i)},t.deleteRule=function(e){var t=this.element.sheet,i=this.indexOf(e);return-1!==i&&(t.deleteRule(i),this.cssRules.splice(i,1),!0)},t.indexOf=function(e){return this.cssRules.indexOf(e)},t.replaceRule=function(e,t){var i=this.indexOf(e);return-1!==i&&(this.element.sheet.deleteRule(i),this.cssRules.splice(i,1),this.insertRule(t,i))},t.getRules=function(){return this.element.sheet.cssRules},e}(),de=0,pe=function(){function e(e){this.id=de++,this.version="10.5.1",this.plugins=new q,this.options={id:{minify:!1},createGenerateId:te,Renderer:n.a?he:null,plugins:[]},this.generateId=te({minify:!1});for(var t=0;t<H.length;t++)this.plugins.use(H[t],{queue:"internal"});this.setup(e)}var t=e.prototype;return t.setup=function(e){return void 0===e&&(e={}),e.createGenerateId&&(this.options.createGenerateId=e.createGenerateId),e.id&&(this.options.id=Object(r.a)({},this.options.id,e.id)),(e.createGenerateId||e.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),null!=e.insertionPoint&&(this.options.insertionPoint=e.insertionPoint),"Renderer"in e&&(this.options.Renderer=e.Renderer),e.plugins&&this.use.apply(this,e.plugins),this},t.createStyleSheet=function(e,t){void 0===t&&(t={});var i=t.index;"number"!=typeof i&&(i=0===Z.index?0:Z.index+1);var n=new $(e,Object(r.a)({},t,{jss:this,generateId:t.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:i}));return this.plugins.onProcessSheet(n),n},t.removeStyleSheet=function(e){return e.detach(),Z.remove(e),this},t.createRule=function(e,t,i){if(void 0===t&&(t={}),void 0===i&&(i={}),"object"==typeof e)return this.createRule(void 0,e,t);var n=Object(r.a)({},i,{name:e,jss:this,Renderer:this.options.Renderer});n.generateId||(n.generateId=this.generateId),n.classes||(n.classes={}),n.keyframes||(n.keyframes={});var o=h(e,t,n);return o&&this.plugins.onProcessRule(o),o},t.use=function(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach((function(t){e.plugins.use(t)})),this},e}();function fe(e){var t=null;for(var i in e){var r=e[i],n=typeof r;if("function"===n)t||(t={}),t[i]=r;else if("object"===n&&null!==r&&!Array.isArray(r)){var o=fe(r);o&&(t||(t={}),t[i]=o)}}return t}var me="object"==typeof CSS&&null!=CSS&&"number"in CSS,ge=function(e){return new pe(e)};
/**
 * A better abstraction over CSS.
 *
 * @copyright Oleg Isonen (Slobodskoi) / Isonen 2014-present
 * @website https://github.com/cssinjs/jss
 * @license MIT
 */ge()},,function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(68),n=i(20),o=i(0);const s={opaque:0,mask:1,blend:2},a=["opaque","mask","blend"];class l extends r.a{get type(){return"PhongMaterial"}constructor(e,t={}){super(e,t),this._state=new n.a({type:"PhongMaterial",ambient:o.math.vec3([1,1,1]),diffuse:o.math.vec3([1,1,1]),specular:o.math.vec3([1,1,1]),emissive:o.math.vec3([0,0,0]),alpha:null,shininess:null,reflectivity:null,alphaMode:null,alphaCutoff:null,lineWidth:null,pointSize:null,backfaces:null,frontface:null,hash:null}),this.ambient=t.ambient,this.diffuse=t.diffuse,this.specular=t.specular,this.emissive=t.emissive,this.alpha=t.alpha,this.shininess=t.shininess,this.reflectivity=t.reflectivity,this.lineWidth=t.lineWidth,this.pointSize=t.pointSize,t.ambientMap&&(this._ambientMap=this._checkComponent("Texture",t.ambientMap)),t.diffuseMap&&(this._diffuseMap=this._checkComponent("Texture",t.diffuseMap)),t.specularMap&&(this._specularMap=this._checkComponent("Texture",t.specularMap)),t.emissiveMap&&(this._emissiveMap=this._checkComponent("Texture",t.emissiveMap)),t.alphaMap&&(this._alphaMap=this._checkComponent("Texture",t.alphaMap)),t.reflectivityMap&&(this._reflectivityMap=this._checkComponent("Texture",t.reflectivityMap)),t.normalMap&&(this._normalMap=this._checkComponent("Texture",t.normalMap)),t.occlusionMap&&(this._occlusionMap=this._checkComponent("Texture",t.occlusionMap)),t.diffuseFresnel&&(this._diffuseFresnel=this._checkComponent("Fresnel",t.diffuseFresnel)),t.specularFresnel&&(this._specularFresnel=this._checkComponent("Fresnel",t.specularFresnel)),t.emissiveFresnel&&(this._emissiveFresnel=this._checkComponent("Fresnel",t.emissiveFresnel)),t.alphaFresnel&&(this._alphaFresnel=this._checkComponent("Fresnel",t.alphaFresnel)),t.reflectivityFresnel&&(this._reflectivityFresnel=this._checkComponent("Fresnel",t.reflectivityFresnel)),this.alphaMode=t.alphaMode,this.alphaCutoff=t.alphaCutoff,this.backfaces=t.backfaces,this.frontface=t.frontface,this._makeHash()}_makeHash(){const e=this._state,t=["/p"];this._normalMap&&(t.push("/nm"),this._normalMap.hasMatrix&&t.push("/mat")),this._ambientMap&&(t.push("/am"),this._ambientMap.hasMatrix&&t.push("/mat"),t.push("/"+this._ambientMap.encoding)),this._diffuseMap&&(t.push("/dm"),this._diffuseMap.hasMatrix&&t.push("/mat"),t.push("/"+this._diffuseMap.encoding)),this._specularMap&&(t.push("/sm"),this._specularMap.hasMatrix&&t.push("/mat")),this._emissiveMap&&(t.push("/em"),this._emissiveMap.hasMatrix&&t.push("/mat"),t.push("/"+this._emissiveMap.encoding)),this._alphaMap&&(t.push("/opm"),this._alphaMap.hasMatrix&&t.push("/mat")),this._reflectivityMap&&(t.push("/rm"),this._reflectivityMap.hasMatrix&&t.push("/mat")),this._occlusionMap&&(t.push("/ocm"),this._occlusionMap.hasMatrix&&t.push("/mat")),this._diffuseFresnel&&t.push("/df"),this._specularFresnel&&t.push("/sf"),this._emissiveFresnel&&t.push("/ef"),this._alphaFresnel&&t.push("/of"),this._reflectivityFresnel&&t.push("/rf"),t.push(";"),e.hash=t.join("")}set ambient(e){let t=this._state.ambient;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.ambient=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get ambient(){return this._state.ambient}set diffuse(e){let t=this._state.diffuse;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.diffuse=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.glRedraw()}get diffuse(){return this._state.diffuse}set specular(e){let t=this._state.specular;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.specular=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1),this.glRedraw()}get specular(){return this._state.specular}set emissive(e){let t=this._state.emissive;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.emissive=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=0,t[1]=0,t[2]=0),this.glRedraw()}get emissive(){return this._state.emissive}set alpha(e){e=null!=e?e:1,this._state.alpha!==e&&(this._state.alpha=e,this.glRedraw())}get alpha(){return this._state.alpha}set shininess(e){this._state.shininess=void 0!==e?e:80,this.glRedraw()}get shininess(){return this._state.shininess}set lineWidth(e){this._state.lineWidth=e||1,this.glRedraw()}get lineWidth(){return this._state.lineWidth}set pointSize(e){this._state.pointSize=e||1,this.glRedraw()}get pointSize(){return this._state.pointSize}set reflectivity(e){this._state.reflectivity=void 0!==e?e:1,this.glRedraw()}get reflectivity(){return this._state.reflectivity}get normalMap(){return this._normalMap}get ambientMap(){return this._ambientMap}get diffuseMap(){return this._diffuseMap}get specularMap(){return this._specularMap}get emissiveMap(){return this._emissiveMap}get alphaMap(){return this._alphaMap}get reflectivityMap(){return this._reflectivityMap}get occlusionMap(){return this._occlusionMap}get diffuseFresnel(){return this._diffuseFresnel}get specularFresnel(){return this._specularFresnel}get emissiveFresnel(){return this._emissiveFresnel}get alphaFresnel(){return this._alphaFresnel}get reflectivityFresnel(){return this._reflectivityFresnel}set alphaMode(e){let t=s[e=e||"opaque"];void 0===t&&(this.error("Unsupported value for 'alphaMode': "+e+" - defaulting to 'opaque'"),t="opaque"),this._state.alphaMode!==t&&(this._state.alphaMode=t,this.glRedraw())}get alphaMode(){return a[this._state.alphaMode]}set alphaCutoff(e){null!=e||(e=.5),this._state.alphaCutoff!==e&&(this._state.alphaCutoff=e)}get alphaCutoff(){return this._state.alphaCutoff}set backfaces(e){e=!!e,this._state.backfaces!==e&&(this._state.backfaces=e,this.glRedraw())}get backfaces(){return this._state.backfaces}set frontface(e){e="cw"!==e,this._state.frontface!==e&&(this._state.frontface=e,this.glRedraw())}get frontface(){return this._state.frontface?"ccw":"cw"}destroy(){super.destroy(),this._state.destroy()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(68),n=i(20);const o={default:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.2,.2,.2],edgeAlpha:.5,edgeWidth:1},defaultWhiteBG:{fill:!0,fillColor:[1,1,1],fillAlpha:.6,edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultLightBG:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.2,.2,.2],edgeAlpha:.5,edgeWidth:1},defaultDarkBG:{fill:!0,fillColor:[.4,.4,.4],fillAlpha:.2,edges:!0,edgeColor:[.5,.5,.5],edgeAlpha:.5,edgeWidth:1},phosphorous:{fill:!0,fillColor:[0,0,0],fillAlpha:.4,edges:!0,edgeColor:[.9,.9,.9],edgeAlpha:.5,edgeWidth:2},sunset:{fill:!0,fillColor:[.9,.9,.6],fillAlpha:.2,edges:!0,edgeColor:[.9,.9,.9],edgeAlpha:.5,edgeWidth:1},vectorscope:{fill:!0,fillColor:[0,0,0],fillAlpha:.7,edges:!0,edgeColor:[.2,1,.2],edgeAlpha:1,edgeWidth:2},battlezone:{fill:!0,fillColor:[0,0,0],fillAlpha:1,edges:!0,edgeColor:[.2,1,.2],edgeAlpha:1,edgeWidth:3},sepia:{fill:!0,fillColor:[.970588207244873,.7965892553329468,.6660899519920349],fillAlpha:.4,edges:!0,edgeColor:[.529411792755127,.4577854573726654,.4100345969200134],edgeAlpha:1,edgeWidth:1},yellowHighlight:{fill:!0,fillColor:[1,1,0],fillAlpha:.5,edges:!0,edgeColor:[.529411792755127,.4577854573726654,.4100345969200134],edgeAlpha:1,edgeWidth:1},greenSelected:{fill:!0,fillColor:[0,1,0],fillAlpha:.5,edges:!0,edgeColor:[.4577854573726654,.529411792755127,.4100345969200134],edgeAlpha:1,edgeWidth:1},gamegrid:{fill:!0,fillColor:[.2,.2,.7],fillAlpha:.9,edges:!0,edgeColor:[.4,.4,1.6],edgeAlpha:.8,edgeWidth:3}};class s extends r.a{get type(){return"EmphasisMaterial"}get presets(){return o}constructor(e,t={}){super(e,t),this._state=new n.a({type:"EmphasisMaterial",fill:null,fillColor:null,fillAlpha:null,edges:null,edgeColor:null,edgeAlpha:null,edgeWidth:null,backfaces:!0}),this._preset="default",t.preset?(this.preset=t.preset,void 0!==t.fill&&(this.fill=t.fill),t.fillColor&&(this.fillColor=t.fillColor),void 0!==t.fillAlpha&&(this.fillAlpha=t.fillAlpha),void 0!==t.edges&&(this.edges=t.edges),t.edgeColor&&(this.edgeColor=t.edgeColor),void 0!==t.edgeAlpha&&(this.edgeAlpha=t.edgeAlpha),void 0!==t.edgeWidth&&(this.edgeWidth=t.edgeWidth),void 0!==t.backfaces&&(this.backfaces=t.backfaces)):(this.fill=t.fill,this.fillColor=t.fillColor,this.fillAlpha=t.fillAlpha,this.edges=t.edges,this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this.backfaces=t.backfaces)}set fill(e){e=!1!==e,this._state.fill!==e&&(this._state.fill=e,this.glRedraw())}get fill(){return this._state.fill}set fillColor(e){let t=this._state.fillColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.fillColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.4,t[1]=.4,t[2]=.4),this.glRedraw()}get fillColor(){return this._state.fillColor}set fillAlpha(e){e=null!=e?e:.2,this._state.fillAlpha!==e&&(this._state.fillAlpha=e,this.glRedraw())}get fillAlpha(){return this._state.fillAlpha}set edges(e){e=!1!==e,this._state.edges!==e&&(this._state.edges=e,this.glRedraw())}get edges(){return this._state.edges}set edgeColor(e){let t=this._state.edgeColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.edgeColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get edgeColor(){return this._state.edgeColor}set edgeAlpha(e){e=null!=e?e:.5,this._state.edgeAlpha!==e&&(this._state.edgeAlpha=e,this.glRedraw())}get edgeAlpha(){return this._state.edgeAlpha}set edgeWidth(e){this._state.edgeWidth=e||1,this.glRedraw()}get edgeWidth(){return this._state.edgeWidth}set backfaces(e){e=!!e,this._state.backfaces!==e&&(this._state.backfaces=e,this.glRedraw())}get backfaces(){return this._state.backfaces}set preset(e){if(e=e||"default",this._preset===e)return;const t=o[e];t?(this.fill=t.fill,this.fillColor=t.fillColor,this.fillAlpha=t.fillAlpha,this.edges=t.edges,this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this._preset=e):this.error("unsupported preset: '"+e+"' - supported values are "+Object.keys(o).join(", "))}get preset(){return this._preset}destroy(){super.destroy(),this._state.destroy()}}},,,,function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(e,t,i){this.id=i&&i.id?i.id:e,this.viewer=t,this._eventSubs={},t.addPlugin(this)}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}log(e){console.log(`[xeokit plugin ${this.id}]: ${e}`)}warn(e){console.warn(`[xeokit plugin ${this.id}]: ${e}`)}error(e){console.error(`[xeokit plugin ${this.id}]: ${e}`)}send(e,t){}destroy(){this.viewer.removePlugin(this)}}},function(e,t,i){e.exports=function e(t,i,r){function n(s,a){if(!i[s]){if(!t[s]){if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};t[s][0].call(c.exports,(function(e){return n(t[s][1][e]||e)}),c,c.exports,e,t,i,r)}return i[s].exports}for(var o=!1,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(e,t,i){"use strict";var r=e("./zlib/deflate"),n=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==i)throw new Error(s[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(i=r.deflateSetDictionary(this.strm,u)))throw new Error(s[i]);this._dict_set=!0}}function u(e,t){var i=new c(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}c.prototype.push=function(e,t){var i,s,a=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new n.Buf8(c),a.next_out=0,a.avail_out=c),1!==(i=r.deflate(a,s))&&0!==i)return this.onEnd(i),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(n.shrinkBuf(a.output,a.next_out))):this.onData(n.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==i);return 4===s?(i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==s||(this.onEnd(0),a.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=c,i.deflate=u,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(e,t,i){"use strict";var r=e("./zlib/inflate"),n=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,t.windowBits);if(i!==s.Z_OK)throw new Error(a[i]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=r.inflateSetDictionary(this.strm,t.dictionary))!==s.Z_OK))throw new Error(a[i])}function d(e,t){var i=new h(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}h.prototype.push=function(e,t){var i,a,l,c,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new n.Buf8(p),d.next_out=0,d.avail_out=p),(i=r.inflate(d,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&f&&(i=r.inflateSetDictionary(this.strm,f)),i===s.Z_BUF_ERROR&&!0===m&&(i=s.Z_OK,m=!1),i!==s.Z_STREAM_END&&i!==s.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==s.Z_STREAM_END&&(0!==d.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),c=d.next_out-l,h=o.buf2string(d.output,l),d.next_out=c,d.avail_out=p-c,c&&n.arraySet(d.output,d.output,l,c,0),this.onData(h)):this.onData(n.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==s.Z_STREAM_END);return i===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=h,i.inflate=d,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},i.ungzip=d},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(e,t,i){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)n(i,r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,i,r,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+r),n);else for(var o=0;o<r;o++)e[n+o]=t[i+o]},flattenChunks:function(e){var t,i,r,n,o,s;for(r=0,t=0,i=e.length;t<i;t++)r+=e[t].length;for(s=new Uint8Array(r),n=0,t=0,i=e.length;t<i;t++)o=e[t],s.set(o,n),n+=o.length;return s}},s={arraySet:function(e,t,i,r,n){for(var o=0;o<r;o++)e[n+o]=t[i+o]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(r)},{}],4:[function(e,t,i){"use strict";var r=e("./common"),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var s=new r.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",s=0;s<t;s++)i+=String.fromCharCode(e[s]);return i}s[254]=s[254]=1,i.string2buf=function(e){var t,i,n,o,s,a=e.length,l=0;for(o=0;o<a;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(l),s=0,o=0;s<l;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),i<128?t[s++]=i:i<2048?(t[s++]=192|i>>>6,t[s++]=128|63&i):i<65536?(t[s++]=224|i>>>12,t[s++]=128|i>>>6&63,t[s++]=128|63&i):(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63,t[s++]=128|i>>>6&63,t[s++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,n,o,a=t||e.length,c=new Array(2*a);for(r=0,i=0;i<a;)if((n=e[i++])<128)c[r++]=n;else if((o=s[n])>4)c[r++]=65533,i+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&i<a;)n=n<<6|63&e[i++],o--;o>1?c[r++]=65533:n<65536?c[r++]=n:(n-=65536,c[r++]=55296|n>>10&1023,c[r++]=56320|1023&n)}return l(c,r)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+s[e[i]]>t?i:t}},{"./common":3}],5:[function(e,t,i){"use strict";t.exports=function(e,t,i,r){for(var n=65535&e|0,o=e>>>16&65535|0,s=0;0!==i;){i-=s=i>2e3?2e3:i;do{o=o+(n=n+t[r++]|0)|0}while(--s);n%=65521,o%=65521}return n|o<<16|0}},{}],6:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(e,t,i){"use strict";var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,n){var o=r,s=n+i;e^=-1;for(var a=n;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}},{}],8:[function(e,t,i){"use strict";var r,n=e("../utils/common"),o=e("./trees"),s=e("./adler32"),a=e("./crc32"),l=e("./messages"),c=-2,u=258,h=262,d=103,p=113,f=666;function m(e,t){return e.msg=l[t],t}function g(e){return(e<<1)-(e>4?9:0)}function v(e){for(var t=e.length;--t>=0;)e[t]=0}function b(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(n.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function _(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,b(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function x(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t,i,r){var o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,n.arraySet(t,e.input,e.next_in,o,i),1===e.state.wrap?e.adler=s(e.adler,t,o,i):2===e.state.wrap&&(e.adler=a(e.adler,t,o,i)),e.next_in+=o,e.total_in+=o,o)}function M(e,t){var i,r,n=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,p=e.prev,f=e.strstart+u,m=c[o+s-1],g=c[o+s];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(i=t)+s]===g&&c[i+s-1]===m&&c[i]===c[o]&&c[++i]===c[o+1]){o+=2,i++;do{}while(c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&o<f);if(r=u-(f-o),o=f-u,r>s){if(e.match_start=t,s=r,r>=a)break;m=c[o+s-1],g=c[o+s]}}}while((t=p[t&d])>l&&0!=--n);return s<=e.lookahead?s:e.lookahead}function P(e){var t,i,r,o,s,a=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-h)){n.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=i=e.hash_size;do{r=e.head[--t],e.head[t]=r>=a?r-a:0}while(--i);t=i=a;do{r=e.prev[--t],e.prev[t]=r>=a?r-a:0}while(--i);o+=a}if(0===e.strm.avail_in)break;if(i=w(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=i,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+3-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function E(e,t){for(var i,r;;){if(e.lookahead<h){if(P(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-h&&(e.match_length=M(e,i)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var i,r,n;;){if(e.lookahead<h){if(P(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-h&&(e.match_length=M(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(_(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&_(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}function C(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}function k(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:p,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):m(e,c)}function O(e){var t=k(e);return 0===t&&function(e){e.window_size=2*e.w_size,v(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function A(e,t,i,r,o,s){if(!e)return c;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||8!==i||r<8||r>15||t<0||t>9||s<0||s>4)return m(e,c);8===r&&(r=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=i,O(e)}r=[new C(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(P(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,_(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(_(e,!1),e.strm.avail_out),1)})),new C(4,4,8,4,E),new C(4,5,16,8,E),new C(4,6,32,32,E),new C(4,4,16,16,S),new C(8,16,32,32,S),new C(8,16,128,128,S),new C(8,32,128,256,S),new C(32,128,258,1024,S),new C(32,258,258,4096,S)],i.deflateInit=function(e,t){return A(e,t,8,15,8,0)},i.deflateInit2=A,i.deflateReset=O,i.deflateResetKeep=k,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},i.deflate=function(e,t){var i,n,s,l;if(!e||!e.state||t>5||t<0)return e?m(e,c):c;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===f&&4!==t)return m(e,0===e.avail_out?-5:c);if(n.strm=e,i=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,y(n,31),y(n,139),y(n,8),n.gzhead?(y(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),y(n,255&n.gzhead.time),y(n,n.gzhead.time>>8&255),y(n,n.gzhead.time>>16&255),y(n,n.gzhead.time>>24&255),y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),y(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(y(n,255&n.gzhead.extra.length),y(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=a(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(y(n,0),y(n,0),y(n,0),y(n,0),y(n,0),y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),y(n,3),n.status=p);else{var h=8+(n.w_bits-8<<4)<<8;h|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(h|=32),h+=31-h%31,n.status=p,x(n,h),0!==n.strstart&&(x(n,e.adler>>>16),x(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),b(e),s=n.pending,n.pending!==n.pending_buf_size));)y(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),b(e),s=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,y(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),b(e),s=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,y(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>s&&(e.adler=a(e.adler,n.pending_buf,n.pending-s,s)),0===l&&(n.status=d)}else n.status=d;if(n.status===d&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&b(e),n.pending+2<=n.pending_buf_size&&(y(n,255&e.adler),y(n,e.adler>>8&255),e.adler=0,n.status=p)):n.status=p),0!==n.pending){if(b(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&g(t)<=g(i)&&4!==t)return m(e,-5);if(n.status===f&&0!==e.avail_in)return m(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&n.status!==f){var w=2===n.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(P(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var i,r,n,s,a=e.window;;){if(e.lookahead<=u){if(P(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&((r=a[n=e.strstart-1])===a[++n]&&r===a[++n]&&r===a[++n])){s=e.strstart+u;do{}while(r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&n<s);e.match_length=u-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(_(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(_(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?1:2}(n,t):r[n.level].func(n,t);if(3!==w&&4!==w||(n.status=f),1===w||3===w)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===w&&(1===t?o._tr_align(n):5!==t&&(o._tr_stored_block(n,0,0,!1),3===t&&(v(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),b(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(y(n,255&e.adler),y(n,e.adler>>8&255),y(n,e.adler>>16&255),y(n,e.adler>>24&255),y(n,255&e.total_in),y(n,e.total_in>>8&255),y(n,e.total_in>>16&255),y(n,e.total_in>>24&255)):(x(n,e.adler>>>16),x(n,65535&e.adler)),b(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},i.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==d&&t!==p&&t!==f?m(e,c):(e.state=null,t===p?m(e,-3):0):c},i.deflateSetDictionary=function(e,t){var i,r,o,a,l,u,h,d,p=t.length;if(!e||!e.state)return c;if(2===(a=(i=e.state).wrap)||1===a&&42!==i.status||i.lookahead)return c;for(1===a&&(e.adler=s(e.adler,t,p,0)),i.wrap=0,p>=i.w_size&&(0===a&&(v(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new n.Buf8(i.w_size),n.arraySet(d,t,p-i.w_size,i.w_size,0),t=d,p=i.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=p,e.next_in=0,e.input=t,P(i);i.lookahead>=3;){r=i.strstart,o=i.lookahead-2;do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+3-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++}while(--o);i.strstart=r,i.lookahead=2,P(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,i.wrap=a,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(e,t,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(e,t,i){"use strict";t.exports=function(e,t){var i,r,n,o,s,a,l,c,u,h,d,p,f,m,g,v,b,_,y,x,w,M,P,E,S;i=e.state,r=e.next_in,E=e.input,n=r+(e.avail_in-5),o=e.next_out,S=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),l=i.dmax,c=i.wsize,u=i.whave,h=i.wnext,d=i.window,p=i.hold,f=i.bits,m=i.lencode,g=i.distcode,v=(1<<i.lenbits)-1,b=(1<<i.distbits)-1;e:do{f<15&&(p+=E[r++]<<f,f+=8,p+=E[r++]<<f,f+=8),_=m[p&v];t:for(;;){if(p>>>=y=_>>>24,f-=y,0==(y=_>>>16&255))S[o++]=65535&_;else{if(!(16&y)){if(0==(64&y)){_=m[(65535&_)+(p&(1<<y)-1)];continue t}if(32&y){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}x=65535&_,(y&=15)&&(f<y&&(p+=E[r++]<<f,f+=8),x+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=E[r++]<<f,f+=8,p+=E[r++]<<f,f+=8),_=g[p&b];i:for(;;){if(p>>>=y=_>>>24,f-=y,!(16&(y=_>>>16&255))){if(0==(64&y)){_=g[(65535&_)+(p&(1<<y)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(w=65535&_,f<(y&=15)&&(p+=E[r++]<<f,(f+=8)<y&&(p+=E[r++]<<f,f+=8)),(w+=p&(1<<y)-1)>l){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=y,f-=y,w>(y=o-s)){if((y=w-y)>u&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(M=0,P=d,0===h){if(M+=c-y,y<x){x-=y;do{S[o++]=d[M++]}while(--y);M=o-w,P=S}}else if(h<y){if(M+=c+h-y,(y-=h)<x){x-=y;do{S[o++]=d[M++]}while(--y);if(M=0,h<x){x-=y=h;do{S[o++]=d[M++]}while(--y);M=o-w,P=S}}}else if(M+=h-y,y<x){x-=y;do{S[o++]=d[M++]}while(--y);M=o-w,P=S}for(;x>2;)S[o++]=P[M++],S[o++]=P[M++],S[o++]=P[M++],x-=3;x&&(S[o++]=P[M++],x>1&&(S[o++]=P[M++]))}else{M=o-w;do{S[o++]=S[M++],S[o++]=S[M++],S[o++]=S[M++],x-=3}while(x>2);x&&(S[o++]=S[M++],x>1&&(S[o++]=S[M++]))}break}}break}}while(r<n&&o<a);r-=x=f>>3,p&=(1<<(f-=x<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=o<a?a-o+257:257-(o-a),i.hold=p,i.bits=f}},{}],11:[function(e,t,i){"use strict";var r=e("../utils/common"),n=e("./adler32"),o=e("./crc32"),s=e("./inffast"),a=e("./inftrees"),l=-2,c=12,u=30;function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):l}function f(e,t){var i,r;return e&&e.state?(r=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,p(e))):l}function m(e,t){var i,n;return e?(n=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=n,n.window=null,0!==(i=f(e,t))&&(e.state=null),i):l}var g,v,b=!0;function _(e){if(b){var t;for(g=new r.Buf32(512),v=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,v,0,e.work,{bits:5}),b=!1}e.lencode=g,e.lenbits=9,e.distcode=v,e.distbits=5}function y(e,t,i,n){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),n>=s.wsize?(r.arraySet(s.window,t,i-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>n&&(o=n),r.arraySet(s.window,t,i-n,o,s.wnext),(n-=o)?(r.arraySet(s.window,t,i-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}i.inflateReset=p,i.inflateReset2=f,i.inflateResetKeep=d,i.inflateInit=function(e){return m(e,15)},i.inflateInit2=m,i.inflate=function(e,t){var i,d,p,f,m,g,v,b,x,w,M,P,E,S,C,k,O,A,T,D,R,L,B,I,N=0,j=new r.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(i=e.state).mode===c&&(i.mode=13),m=e.next_out,p=e.output,v=e.avail_out,f=e.next_in,d=e.input,g=e.avail_in,b=i.hold,x=i.bits,w=g,M=v,L=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;x<16;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(2&i.wrap&&35615===b){i.check=0,j[0]=255&b,j[1]=b>>>8&255,i.check=o(i.check,j,2,0),b=0,x=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",i.mode=u;break}if(8!=(15&b)){e.msg="unknown compression method",i.mode=u;break}if(x-=4,R=8+(15&(b>>>=4)),0===i.wbits)i.wbits=R;else if(R>i.wbits){e.msg="invalid window size",i.mode=u;break}i.dmax=1<<R,e.adler=i.check=1,i.mode=512&b?10:c,b=0,x=0;break;case 2:for(;x<16;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(i.flags=b,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=u;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=u;break}i.head&&(i.head.text=b>>8&1),512&i.flags&&(j[0]=255&b,j[1]=b>>>8&255,i.check=o(i.check,j,2,0)),b=0,x=0,i.mode=3;case 3:for(;x<32;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.head&&(i.head.time=b),512&i.flags&&(j[0]=255&b,j[1]=b>>>8&255,j[2]=b>>>16&255,j[3]=b>>>24&255,i.check=o(i.check,j,4,0)),b=0,x=0,i.mode=4;case 4:for(;x<16;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.head&&(i.head.xflags=255&b,i.head.os=b>>8),512&i.flags&&(j[0]=255&b,j[1]=b>>>8&255,i.check=o(i.check,j,2,0)),b=0,x=0,i.mode=5;case 5:if(1024&i.flags){for(;x<16;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.length=b,i.head&&(i.head.extra_len=b),512&i.flags&&(j[0]=255&b,j[1]=b>>>8&255,i.check=o(i.check,j,2,0)),b=0,x=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((P=i.length)>g&&(P=g),P&&(i.head&&(R=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),r.arraySet(i.head.extra,d,f,P,R)),512&i.flags&&(i.check=o(i.check,d,P,f)),g-=P,f+=P,i.length-=P),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===g)break e;P=0;do{R=d[f+P++],i.head&&R&&i.length<65536&&(i.head.name+=String.fromCharCode(R))}while(R&&P<g);if(512&i.flags&&(i.check=o(i.check,d,P,f)),g-=P,f+=P,R)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===g)break e;P=0;do{R=d[f+P++],i.head&&R&&i.length<65536&&(i.head.comment+=String.fromCharCode(R))}while(R&&P<g);if(512&i.flags&&(i.check=o(i.check,d,P,f)),g-=P,f+=P,R)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;x<16;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(b!==(65535&i.check)){e.msg="header crc mismatch",i.mode=u;break}b=0,x=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=c;break;case 10:for(;x<32;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}e.adler=i.check=h(b),b=0,x=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,i.hold=b,i.bits=x,2;e.adler=i.check=1,i.mode=c;case c:if(5===t||6===t)break e;case 13:if(i.last){b>>>=7&x,x-=7&x,i.mode=27;break}for(;x<3;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}switch(i.last=1&b,x-=1,3&(b>>>=1)){case 0:i.mode=14;break;case 1:if(_(i),i.mode=20,6===t){b>>>=2,x-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=u}b>>>=2,x-=2;break;case 14:for(b>>>=7&x,x-=7&x;x<32;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",i.mode=u;break}if(i.length=65535&b,b=0,x=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(P=i.length){if(P>g&&(P=g),P>v&&(P=v),0===P)break e;r.arraySet(p,d,f,P,m),g-=P,f+=P,v-=P,m+=P,i.length-=P;break}i.mode=c;break;case 17:for(;x<14;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(i.nlen=257+(31&b),b>>>=5,x-=5,i.ndist=1+(31&b),b>>>=5,x-=5,i.ncode=4+(15&b),b>>>=4,x-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=u;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;x<3;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.lens[F[i.have++]]=7&b,b>>>=3,x-=3}for(;i.have<19;)i.lens[F[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,B={bits:i.lenbits},L=a(0,i.lens,0,19,i.lencode,0,i.work,B),i.lenbits=B.bits,L){e.msg="invalid code lengths set",i.mode=u;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;k=(N=i.lencode[b&(1<<i.lenbits)-1])>>>16&255,O=65535&N,!((C=N>>>24)<=x);){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(O<16)b>>>=C,x-=C,i.lens[i.have++]=O;else{if(16===O){for(I=C+2;x<I;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(b>>>=C,x-=C,0===i.have){e.msg="invalid bit length repeat",i.mode=u;break}R=i.lens[i.have-1],P=3+(3&b),b>>>=2,x-=2}else if(17===O){for(I=C+3;x<I;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}x-=C,R=0,P=3+(7&(b>>>=C)),b>>>=3,x-=3}else{for(I=C+7;x<I;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}x-=C,R=0,P=11+(127&(b>>>=C)),b>>>=7,x-=7}if(i.have+P>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=u;break}for(;P--;)i.lens[i.have++]=R}}if(i.mode===u)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=u;break}if(i.lenbits=9,B={bits:i.lenbits},L=a(1,i.lens,0,i.nlen,i.lencode,0,i.work,B),i.lenbits=B.bits,L){e.msg="invalid literal/lengths set",i.mode=u;break}if(i.distbits=6,i.distcode=i.distdyn,B={bits:i.distbits},L=a(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,B),i.distbits=B.bits,L){e.msg="invalid distances set",i.mode=u;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(g>=6&&v>=258){e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,i.hold=b,i.bits=x,s(e,M),m=e.next_out,p=e.output,v=e.avail_out,f=e.next_in,d=e.input,g=e.avail_in,b=i.hold,x=i.bits,i.mode===c&&(i.back=-1);break}for(i.back=0;k=(N=i.lencode[b&(1<<i.lenbits)-1])>>>16&255,O=65535&N,!((C=N>>>24)<=x);){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(k&&0==(240&k)){for(A=C,T=k,D=O;k=(N=i.lencode[D+((b&(1<<A+T)-1)>>A)])>>>16&255,O=65535&N,!(A+(C=N>>>24)<=x);){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}b>>>=A,x-=A,i.back+=A}if(b>>>=C,x-=C,i.back+=C,i.length=O,0===k){i.mode=26;break}if(32&k){i.back=-1,i.mode=c;break}if(64&k){e.msg="invalid literal/length code",i.mode=u;break}i.extra=15&k,i.mode=22;case 22:if(i.extra){for(I=i.extra;x<I;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.length+=b&(1<<i.extra)-1,b>>>=i.extra,x-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;k=(N=i.distcode[b&(1<<i.distbits)-1])>>>16&255,O=65535&N,!((C=N>>>24)<=x);){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(0==(240&k)){for(A=C,T=k,D=O;k=(N=i.distcode[D+((b&(1<<A+T)-1)>>A)])>>>16&255,O=65535&N,!(A+(C=N>>>24)<=x);){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}b>>>=A,x-=A,i.back+=A}if(b>>>=C,x-=C,i.back+=C,64&k){e.msg="invalid distance code",i.mode=u;break}i.offset=O,i.extra=15&k,i.mode=24;case 24:if(i.extra){for(I=i.extra;x<I;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}i.offset+=b&(1<<i.extra)-1,b>>>=i.extra,x-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=u;break}i.mode=25;case 25:if(0===v)break e;if(P=M-v,i.offset>P){if((P=i.offset-P)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=u;break}P>i.wnext?(P-=i.wnext,E=i.wsize-P):E=i.wnext-P,P>i.length&&(P=i.length),S=i.window}else S=p,E=m-i.offset,P=i.length;P>v&&(P=v),v-=P,i.length-=P;do{p[m++]=S[E++]}while(--P);0===i.length&&(i.mode=21);break;case 26:if(0===v)break e;p[m++]=i.length,v--,i.mode=21;break;case 27:if(i.wrap){for(;x<32;){if(0===g)break e;g--,b|=d[f++]<<x,x+=8}if(M-=v,e.total_out+=M,i.total+=M,M&&(e.adler=i.check=i.flags?o(i.check,p,M,m-M):n(i.check,p,M,m-M)),M=v,(i.flags?b:h(b))!==i.check){e.msg="incorrect data check",i.mode=u;break}b=0,x=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;x<32;){if(0===g)break e;g--,b+=d[f++]<<x,x+=8}if(b!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=u;break}b=0,x=0}i.mode=29;case 29:L=1;break e;case u:L=-3;break e;case 31:return-4;case 32:default:return l}return e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,i.hold=b,i.bits=x,(i.wsize||M!==e.avail_out&&i.mode<u&&(i.mode<27||4!==t))&&y(e,e.output,e.next_out,M-e.avail_out)?(i.mode=31,-4):(w-=e.avail_in,M-=e.avail_out,e.total_in+=w,e.total_out+=M,i.total+=M,i.wrap&&M&&(e.adler=i.check=i.flags?o(i.check,p,M,e.next_out-M):n(i.check,p,M,e.next_out-M)),e.data_type=i.bits+(i.last?64:0)+(i.mode===c?128:0)+(20===i.mode||15===i.mode?256:0),(0===w&&0===M||4===t)&&0===L&&(L=-5),L)},i.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?l:(i.head=t,t.done=!1,0):l},i.inflateSetDictionary=function(e,t){var i,r=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?l:11===i.mode&&n(1,t,r,0)!==i.check?-3:y(e,t,r,r)?(i.mode=31,-4):(i.havedict=1,0):l},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(e,t,i){"use strict";var r=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,c,u,h,d){var p,f,m,g,v,b,_,y,x,w=d.bits,M=0,P=0,E=0,S=0,C=0,k=0,O=0,A=0,T=0,D=0,R=null,L=0,B=new r.Buf16(16),I=new r.Buf16(16),N=null,j=0;for(M=0;M<=15;M++)B[M]=0;for(P=0;P<l;P++)B[t[i+P]]++;for(C=w,S=15;S>=1&&0===B[S];S--);if(C>S&&(C=S),0===S)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(E=1;E<S&&0===B[E];E++);for(C<E&&(C=E),A=1,M=1;M<=15;M++)if(A<<=1,(A-=B[M])<0)return-1;if(A>0&&(0===e||1!==S))return-1;for(I[1]=0,M=1;M<15;M++)I[M+1]=I[M]+B[M];for(P=0;P<l;P++)0!==t[i+P]&&(h[I[t[i+P]]++]=P);if(0===e?(R=N=h,b=19):1===e?(R=n,L-=257,N=o,j-=257,b=256):(R=s,N=a,b=-1),D=0,P=0,M=E,v=u,k=C,O=0,m=-1,g=(T=1<<C)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){_=M-O,h[P]<b?(y=0,x=h[P]):h[P]>b?(y=N[j+h[P]],x=R[L+h[P]]):(y=96,x=0),p=1<<M-O,E=f=1<<k;do{c[v+(D>>O)+(f-=p)]=_<<24|y<<16|x|0}while(0!==f);for(p=1<<M-1;D&p;)p>>=1;if(0!==p?(D&=p-1,D+=p):D=0,P++,0==--B[M]){if(M===S)break;M=t[i+h[P]]}if(M>C&&(D&g)!==m){for(0===O&&(O=C),v+=E,A=1<<(k=M-O);k+O<S&&!((A-=B[k+O])<=0);)k++,A<<=1;if(T+=1<<k,1===e&&T>852||2===e&&T>592)return 1;c[m=D&g]=C<<24|k<<16|v-u|0}}return 0!==D&&(c[v+D]=M-O<<24|64<<16|0),d.bits=C,0}},{"../utils/common":3}],13:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(e,t,i){"use strict";var r=e("../utils/common");function n(e){for(var t=e.length;--t>=0;)e[t]=0}var o=256,s=286,a=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);n(p);var f=new Array(60);n(f);var m=new Array(512);n(m);var g=new Array(256);n(g);var v=new Array(29);n(v);var b,_,y,x=new Array(a);function w(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function M(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function P(e){return e<256?m[e]:m[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function C(e,t,i){S(e,i[2*t],i[2*t+1])}function k(e,t){var i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1}function O(e,t,i){var r,n,o=new Array(16),s=0;for(r=1;r<=l;r++)o[r]=s=s+i[r-1]<<1;for(n=0;n<=t;n++){var a=e[2*n+1];0!==a&&(e[2*n]=k(o[a]++,a))}}function A(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<a;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function T(e){e.bi_valid>8?E(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function D(e,t,i,r){var n=2*t,o=2*i;return e[n]<e[o]||e[n]===e[o]&&r[t]<=r[i]}function R(e,t,i){for(var r=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&D(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!D(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r}function L(e,t,i){var r,n,s,a,l=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],n=e.pending_buf[e.l_buf+l],l++,0===r?C(e,n,t):(C(e,(s=g[n])+o+1,t),0!==(a=c[s])&&S(e,n-=v[s],a),C(e,s=P(--r),i),0!==(a=u[s])&&S(e,r-=x[s],a))}while(l<e.last_lit);C(e,256,t)}function B(e,t){var i,r,n,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<c;i++)0!==o[2*i]?(e.heap[++e.heap_len]=u=i,e.depth[i]=0):o[2*i+1]=0;for(;e.heap_len<2;)o[2*(n=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[n]=0,e.opt_len--,a&&(e.static_len-=s[2*n+1]);for(t.max_code=u,i=e.heap_len>>1;i>=1;i--)R(e,o,i);n=c;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,o[2*n]=o[2*i]+o[2*r],e.depth[n]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,o[2*i+1]=o[2*r+1]=n,e.heap[1]=n++,R(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,r,n,o,s,a,c=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)(o=c[2*c[2*(r=e.heap[i])+1]+1]+1)>m&&(o=m,g++),c[2*r+1]=o,r>u||(e.bl_count[o]++,s=0,r>=f&&(s=p[r-f]),a=c[2*r],e.opt_len+=a*(o+s),d&&(e.static_len+=a*(h[2*r+1]+s)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(r=e.bl_count[o];0!==r;)(n=e.heap[--i])>u||(c[2*n+1]!==o&&(e.opt_len+=(o-c[2*n+1])*c[2*n],c[2*n+1]=o),r--)}}(e,t),O(o,u,e.bl_count)}function I(e,t,i){var r,n,o=-1,s=t[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)n=s,s=t[2*(r+1)+1],++a<l&&n===s||(a<c?e.bl_tree[2*n]+=a:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=n,0===s?(l=138,c=3):n===s?(l=6,c=3):(l=7,c=4))}function N(e,t,i){var r,n,o=-1,s=t[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),r=0;r<=i;r++)if(n=s,s=t[2*(r+1)+1],!(++a<l&&n===s)){if(a<c)do{C(e,n,e.bl_tree)}while(0!=--a);else 0!==n?(n!==o&&(C(e,n,e.bl_tree),a--),C(e,16,e.bl_tree),S(e,a-3,2)):a<=10?(C(e,17,e.bl_tree),S(e,a-3,3)):(C(e,18,e.bl_tree),S(e,a-11,7));a=0,o=n,0===s?(l=138,c=3):n===s?(l=6,c=3):(l=7,c=4)}}n(x);var j=!1;function F(e,t,i,n){S(e,0+(n?1:0),3),function(e,t,i,n){T(e),E(e,i),E(e,~i),r.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i)}i._tr_init=function(e){j||(function(){var e,t,i,r,n,o=new Array(16);for(i=0,r=0;r<28;r++)for(v[r]=i,e=0;e<1<<c[r];e++)g[i++]=r;for(g[i-1]=r,n=0,r=0;r<16;r++)for(x[r]=n,e=0;e<1<<u[r];e++)m[n++]=r;for(n>>=7;r<a;r++)for(x[r]=n<<7,e=0;e<1<<u[r]-7;e++)m[256+n++]=r;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)p[2*e+1]=8,e++,o[8]++;for(;e<=255;)p[2*e+1]=9,e++,o[9]++;for(;e<=279;)p[2*e+1]=7,e++,o[7]++;for(;e<=287;)p[2*e+1]=8,e++,o[8]++;for(O(p,287,o),e=0;e<a;e++)f[2*e+1]=5,f[2*e]=k(e,5);b=new w(p,c,257,s,l),_=new w(f,u,0,a,l),y=new w(new Array(0),h,0,19,7)}(),j=!0),e.l_desc=new M(e.dyn_ltree,b),e.d_desc=new M(e.dyn_dtree,_),e.bl_desc=new M(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,A(e)},i._tr_stored_block=F,i._tr_flush_block=function(e,t,i,r){var n,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),B(e,e.l_desc),B(e,e.d_desc),a=function(e){var t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),B(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=i+5,i+4<=n&&-1!==t?F(e,t,i,r):4===e.strategy||s===n?(S(e,2+(r?1:0),3),L(e,p,f)):(S(e,4+(r?1:0),3),function(e,t,i,r){var n;for(S(e,t-257,5),S(e,i-1,5),S(e,r-4,4),n=0;n<r;n++)S(e,e.bl_tree[2*d[n]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),L(e,e.dyn_ltree,e.dyn_dtree)),A(e),r&&T(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(g[i]+o+1)]++,e.dyn_dtree[2*P(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){S(e,2,3),C(e,256,p),function(e){16===e.bi_valid?(E(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":3}],15:[function(e,t,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(e,t,i){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")},function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(24),n=i(15),o=i(8);const s={},a=new r.Map,l=new class{constructor(){this._head=[],this._headLength=0,this._tail=[],this._index=0,this._length=0}get length(){return this._length}shift(){if(this._index>=this._headLength){const e=this._head;if(e.length=0,this._head=this._tail,this._tail=e,this._index=0,this._headLength=this._head.length,!this._headLength)return}const e=this._head[this._index];return this._index<0?delete this._head[this._index++]:this._head[this._index++]=void 0,this._length--,e}push(e){return this._length++,this._tail.push(e),this}unshift(e){return this._head[--this._index]=e,this._length++,this}},c={sceneId:null,time:null,startTime:null,prevTime:null,deltaTime:null},u=[];let h,d=0,p=0;const f=new function(){this.version="1.0.0",this.scenes={},this._superTypes={},this._addScene=function(e){if(e.id){if(f.scenes[e.id])return void console.error(`[ERROR] Scene ${o.utils.inQuotes(e.id)} already exists`)}else e.id=a.addItem({});f.scenes[e.id]=e;const t=e.ticksPerOcclusionTest,i=e.ticksPerRender;s[e.id]={ticksPerOcclusionTest:t,ticksPerRender:i,renderCountdown:i},n.a.components.scenes++,e.once("destroyed",()=>{a.removeItem(e.id),delete f.scenes[e.id],delete s[e.id],n.a.components.scenes--})},this.clear=function(){let e;for(const t in f.scenes)f.scenes.hasOwnProperty(t)&&(e=f.scenes[t],"default.scene"===t?e.clear():(e.destroy(),delete f.scenes[e.id]))},this.scheduleTask=function(e,t){l.push(e),l.push(t)},this.runTasks=function(e=-1){let t,i,r=(new Date).getTime(),n=0;for(;l.length>0&&(e<0||r<e);)t=l.shift(),(i=l.shift())?t.call(i):t(),r=(new Date).getTime(),n++;return n},this.getNumTasks=function(){return l.length}},m=function(){let e=Date.now();if(d>0){var t=1e3/(h=e-d);p+=t,u.push(t),u.length>=30&&(p-=u.shift()),n.a.frame.fps=Math.round(p/u.length)}!function(e){const t=f.runTasks(e+10),i=f.getNumTasks();n.a.frame.tasksRun=t,n.a.frame.tasksScheduled=i,n.a.frame.tasksBudget=10}(e),function(e){for(var t in c.time=e,f.scenes)if(f.scenes.hasOwnProperty(t)){var i=f.scenes[t];c.sceneId=t,c.startTime=i.startTime,c.deltaTime=null!=c.prevTime?c.time-c.prevTime:0,i.fire("tick",c,!0)}c.prevTime=e}(e),function(){const e=f.scenes;let t,i,r,n,o;for(o in e)e.hasOwnProperty(o)&&(t=e[o],(i=s[o])||(i=s[o]={}),r=t.ticksPerOcclusionTest,i.ticksPerOcclusionTest!==r&&(i.ticksPerOcclusionTest=r,i.renderCountdown=r),--t.occlusionTestCountdown<=0&&(t.doOcclusionTest(),t.occlusionTestCountdown=r),n=t.ticksPerRender,i.ticksPerRender!==n&&(i.ticksPerRender=n,i.renderCountdown=n),0==--i.renderCountdown&&(t.render(!1),i.renderCountdown=n))}(),d=e,window.requestAnimationFrame(m)};window.requestAnimationFrame(m)},function(e,t,i){"use strict";e.exports=i(225)},function(e,t,i){"use strict";i.r(t),i.d(t,"DirLight",(function(){return a}));var r=i(94),n=i(20),o=i(43),s=i(0);class a extends r.a{get type(){return"DirLight"}constructor(e,t={}){super(e,t),this._shadowRenderBuf=null,this._shadowViewMatrix=null,this._shadowProjMatrix=null,this._shadowViewMatrixDirty=!0,this._shadowProjMatrixDirty=!0;const i=this.scene.camera,r=this.scene.canvas;this._onCameraViewMatrix=i.on("viewMatrix",()=>{this._shadowViewMatrixDirty=!0}),this._onCameraProjMatrix=i.on("projMatrix",()=>{this._shadowProjMatrixDirty=!0}),this._onCanvasBoundary=r.on("boundary",()=>{this._shadowProjMatrixDirty=!0}),this._state=new n.a({type:"dir",dir:s.math.vec3([1,1,1]),color:s.math.vec3([.7,.7,.8]),intensity:1,space:t.space||"view",castsShadow:!1,getShadowViewMatrix:()=>{if(this._shadowViewMatrixDirty){this._shadowViewMatrix||(this._shadowViewMatrix=s.math.identityMat4());const e=this.scene.camera,t=this._state.dir,i=e.look,r=[i[0]-t[0],i[1]-t[1],i[2]-t[2]],n=[0,1,0];s.math.lookAtMat4v(r,i,n,this._shadowViewMatrix),this._shadowViewMatrixDirty=!1}return this._shadowViewMatrix},getShadowProjMatrix:()=>(this._shadowProjMatrixDirty&&(this._shadowProjMatrix||(this._shadowProjMatrix=s.math.identityMat4()),s.math.orthoMat4c(-40,40,-40,40,-40,80,this._shadowProjMatrix),this._shadowProjMatrixDirty=!1),this._shadowProjMatrix),getShadowRenderBuf:()=>(this._shadowRenderBuf||(this._shadowRenderBuf=new o.a(this.scene.canvas.canvas,this.scene.canvas.gl,{size:[1024,1024]})),this._shadowRenderBuf)}),this.dir=t.dir,this.color=t.color,this.intensity=t.intensity,this.castsShadow=t.castsShadow,this.scene._lightCreated(this)}set dir(e){this._state.dir.set(e||[1,1,1]),this._shadowViewMatrixDirty=!0,this.glRedraw()}get dir(){return this._state.dir}set color(e){this._state.color.set(e||[.7,.7,.8]),this.glRedraw()}get color(){return this._state.color}set intensity(e){e=void 0!==e?e:1,this._state.intensity=e,this.glRedraw()}get intensity(){return this._state.intensity}set castsShadow(e){e=!!e,this._state.castsShadow!==e&&(this._state.castsShadow=e,this._shadowViewMatrixDirty=!0,this.glRedraw())}get castsShadow(){return this._state.castsShadow}destroy(){const e=this.scene.camera,t=this.scene.canvas;e.off(this._onCameraViewMatrix),e.off(this._onCameraProjMatrix),t.off(this._onCanvasBoundary),super.destroy(),this._state.destroy(),this._shadowRenderBuf&&this._shadowRenderBuf.destroy(),this.scene._lightDestroyed(this),this.glRedraw()}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s}));var r=i(2),n=i(4),o=["xs","sm","md","lg","xl"];function s(e){var t=e.values,i=void 0===t?{xs:0,sm:600,md:960,lg:1280,xl:1920}:t,s=e.unit,a=void 0===s?"px":s,l=e.step,c=void 0===l?5:l,u=Object(n.a)(e,["values","unit","step"]);function h(e){var t="number"==typeof i[e]?i[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function d(e,t){var r=o.indexOf(t);return r===o.length-1?h(e):"@media (min-width:".concat("number"==typeof i[e]?i[e]:e).concat(a,") and ")+"(max-width:".concat((-1!==r&&"number"==typeof i[o[r+1]]?i[o[r+1]]:t)-c/100).concat(a,")")}return Object(r.a)({keys:o,values:i,up:h,down:function(e){var t=o.indexOf(e)+1,r=i[o[t]];return t===o.length?h("xs"):"@media (max-width:".concat(("number"==typeof r&&t>0?r:e)-c/100).concat(a,")")},between:d,only:function(e){return d(e,e)},width:function(e){return i[e]}},u)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;const r=i(24);t.Controller=class{constructor(e,t,i,r){this.bimViewer=e?e.bimViewer||e:this,this.server=e?e.server:i,this.viewer=e?e.viewer:r,this._children=[],e&&e._children.push(this),this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._enabled=null,this._active=null}fire(e,t,i=!1){this._events||(this._events={}),this._eventSubs||(this._eventSubs={}),!0!==i&&(this._events[e]=t||!0);const r=this._eventSubs[e];let n;if(r)for(const i in r)r.hasOwnProperty(i)&&(n=r[i],this._eventCallDepth++,this._eventCallDepth<300?n.callback.call(n.scope,t):this.error("fire: potential stack overflow from recursive event '"+e+"' - dropping this event"),this._eventCallDepth--)}on(e,t,i=this){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new r.Map),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={});let n=this._eventSubs[e];n||(n={},this._eventSubs[e]=n);const o=this._subIdMap.addItem();n[o]={callback:t,scope:i||this},this._subIdEvents[o]=e;const s=this._events[e];return void 0!==s&&t.call(i||this,s),o}off(e){if(null==e)return;if(!this._subIdEvents)return;const t=this._subIdEvents[e];if(t){delete this._subIdEvents[e];const i=this._eventSubs[t];i&&delete i[e],this._subIdMap.removeItem(e)}}once(e,t,i=this){const r=this,n=this.on(e,(function(e){r.off(n),t.call(i||this,e)}),i)}log(e){e="[LOG] "+e,window.console.log(e)}warn(e){e="[WARN] "+e,window.console.warn(e)}error(e){e="[ERROR] "+e,window.console.error(e)}_mutexActivation(e){const t=e.length;for(let i=0;i<t;i++)e[i].on("active",function(){const r=i;return function(i){if(i)for(let i=0;i<t;i++)i!==r&&e[i].setActive(!1)}}())}setEnabled(e){this._enabled!==e&&(this._enabled=e,this.fire("enabled",this._enabled))}getEnabled(){return this._enabled}setActive(e){this._active!==e&&(this._active=e,this.fire("active",this._active))}getActive(){return this._active}destroy(){if(!this._destroyed){this.fire("destroyed",this._destroyed=!0),this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0;for(let e=0,t=this._children.length;e<t;e++)this._children[e].destroy();this._children=[]}}}},function(e,t,i){"use strict";var r=i(57),n=Object(r.a)();t.a=n},function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const r=function(){const e=document.createElement("canvas"),t=String.fromCharCode;if(!e.getContext)return{saveAsBMP:function(){},saveAsPNG:function(){},saveAsJPEG:function(){}};const i=!!e.getContext("2d").getImageData,r=!!e.toDataURL,n=!!window.btoa,o=function(e){let i="";const r=e.width,n=e.height;i+="BM";let o=r*n*4+54;i+=t(o%256),o=Math.floor(o/256),i+=t(o%256),o=Math.floor(o/256),i+=t(o%256),o=Math.floor(o/256),i+=t(o%256),i+=t(0,0,0,0,54,0,0,0),i+=t(40,0,0,0);let s=r;i+=t(s%256),s=Math.floor(s/256),i+=t(s%256),s=Math.floor(s/256),i+=t(s%256),s=Math.floor(s/256),i+=t(s%256);let a=n;i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),a=Math.floor(a/256),i+=t(a%256),i+=t(1,0,32,0),i+=t(0,0,0,0);let l=r*n*4;i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),l=Math.floor(l/256),i+=t(l%256),i+=t(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const c=e.data;let u,h,d,p,f="",m=n;do{for(d=r*(m-1)*4,p="",u=0;u<r;u++)p+=t(c[d+(h=4*u)+2],c[d+h+1],c[d+h],c[d+h+3]);f+=p}while(--m);return function(e){let i,r,n="";if("string"==typeof e)n=e;else for(r=e,i=0;i<r.length;i++)n+=t(r[i]);return btoa(n)}(i+f)},s=function(e){window.open(e)||(document.location.href=e)},a=function(e,t){return"data:"+t+";base64,"+e},l=function(e){const t=document.createElement("img");return t.src=e,t},c=function(e,t,i,r){if(t&&i){const n=document.createElement("canvas");n.width=t,n.height=i,n.style.width=t+"px",n.style.height=i+"px";const o=n.getContext("2d");return r?(o.save(),o.scale(1,-1),o.imageSmoothingEnabled=!0,o.drawImage(e,0,0,e.width,e.height,0,0,t,-i),o.restore()):(o.imageSmoothingEnabled=!0,o.drawImage(e,0,0,e.width,e.height,0,0,t,i)),n}return e};return{saveAsPNG:function(e,t,i,n,o){if(!r)return!1;const a=c(e,i,n,o).toDataURL("image/png");return t?l(a):(s(a),!0)},saveAsJPEG:function(e,t,i,n,o){if(!r)return!1;const a=c(e,i,n,o).toDataURL("image/jpeg");return 5==a.indexOf("image/jpeg")&&(t?l(a):(s(a),!0))},saveAsBMP:function(e,t,u,h,d){if(!(r&&i&&n))return!1;const p=function(e){const t=parseInt(e.width),i=parseInt(e.height);return e.getContext("2d").getImageData(0,0,t,i)}(c(e,u,h,d)),f=o(p);return t?l(a(f,"image/bmp")):(s(a(f,"image/bmp")),!0)}}}();class n{constructor(e,t,i){i=i||{},this.gl=t,this.allocated=!1,this.canvas=e,this.buffer=null,this.bound=!1,this.size=i.size}setSize(e){this.size=e}webglContextRestored(e){this.gl=e,this.buffer=null,this.allocated=!1,this.bound=!1}bind(){if(this._touch(),this.bound)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.buffer.framebuf),this.bound=!0}_touch(){let e,t;const i=this.gl;if(this.size?(e=this.size[0],t=this.size[1]):(e=i.drawingBufferWidth,t=i.drawingBufferHeight),this.buffer){if(this.buffer.width===e&&this.buffer.height===t)return;i.deleteTexture(this.buffer.texture),i.deleteFramebuffer(this.buffer.framebuf),i.deleteRenderbuffer(this.buffer.renderbuf)}const r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,t,0,i.RGBA,i.UNSIGNED_BYTE,null);const n=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,n),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,t);const o=i.createFramebuffer();if(i.bindFramebuffer(i.FRAMEBUFFER,o),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,r,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,n),i.bindTexture(i.TEXTURE_2D,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,o),!i.isFramebuffer(o))throw"Invalid framebuffer";i.bindFramebuffer(i.FRAMEBUFFER,null);const s=i.checkFramebufferStatus(i.FRAMEBUFFER);switch(s){case i.FRAMEBUFFER_COMPLETE:break;case i.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case i.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case i.FRAMEBUFFER_UNSUPPORTED:throw"Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED";default:throw"Incomplete framebuffer: "+s}this.buffer={framebuf:o,renderbuf:n,texture:r,width:e,height:t},this.bound=!1}clear(){if(!this.bound)throw"Render buffer not bound";const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}read(e,t){const i=e,r=this.gl.drawingBufferHeight-t,n=new Uint8Array(4),o=this.gl;return o.readPixels(i,r,1,1,o.RGBA,o.UNSIGNED_BYTE,n),n}readImage(e){const t=this.gl,i=this._getImageDataCache(),n=i.pixelData,o=i.canvas,s=i.imageData,a=i.context;t.readPixels(0,0,this.buffer.width,this.buffer.height,t.RGBA,t.UNSIGNED_BYTE,n),s.data.set(n),a.putImageData(s,0,0);const l=e.width||o.width,c=e.height||o.height,u=e.format||"jpeg";let h;switch(u){case"jpeg":h=r.saveAsJPEG(o,!0,l,c,!0);break;case"png":h=r.saveAsPNG(o,!0,l,c,!0);break;case"bmp":h=r.saveAsBMP(o,!0,l,c,!0);break;default:console.error("Unsupported image format: '"+u+"' - supported types are 'jpeg', 'bmp' and 'png' - defaulting to 'jpeg'"),h=r.saveAsJPEG(o,!0,l,c,!0)}return h.src}_getImageDataCache(){const e=this.buffer.width,t=this.buffer.height;let i=this._imageDataCache;if(i&&(i.width===e&&i.height===t||(this._imageDataCache=null,i=null)),!i){const r=document.createElement("canvas");r.width=e,r.height=t;const n=r.getContext("2d"),o=n.createImageData(e,t);i={pixelData:new Uint8Array(e*t*4),canvas:r,context:n,imageData:o,width:e,height:t},this._imageDataCache=i}return i}unbind(){const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),this.bound=!1}getTexture(){const e=this;return this._texture||(this._texture={renderBuffer:this,bind:function(t){return!(!e.buffer||!e.buffer.texture||(e.gl.activeTexture(e.gl["TEXTURE"+t]),e.gl.bindTexture(e.gl.TEXTURE_2D,e.buffer.texture),0))},unbind:function(t){e.buffer&&e.buffer.texture&&(e.gl.activeTexture(e.gl["TEXTURE"+t]),e.gl.bindTexture(e.gl.TEXTURE_2D,null))}})}destroy(){if(this.allocated){const e=this.gl;e.deleteTexture(this.buffer.texture),e.deleteFramebuffer(this.buffer.framebuf),e.deleteRenderbuffer(this.buffer.renderbuf),this.allocated=!1,this.buffer=null,this.bound=!1}this._imageDataCache=null,this._texture=null}}},function(e,t,i){"use strict";i.r(t),i.d(t,"hexToRgb",(function(){return r.g})),i.d(t,"rgbToHex",(function(){return r.k})),i.d(t,"hslToRgb",(function(){return r.h})),i.d(t,"decomposeColor",(function(){return r.b})),i.d(t,"recomposeColor",(function(){return r.j})),i.d(t,"getContrastRatio",(function(){return r.e})),i.d(t,"getLuminance",(function(){return r.f})),i.d(t,"emphasize",(function(){return r.c})),i.d(t,"fade",(function(){return r.d})),i.d(t,"darken",(function(){return r.a})),i.d(t,"lighten",(function(){return r.i})),i.d(t,"createMuiTheme",(function(){return n.a})),i.d(t,"unstable_createMuiStrictModeTheme",(function(){return s})),i.d(t,"createStyles",(function(){return a})),i.d(t,"makeStyles",(function(){return h})),i.d(t,"responsiveFontSizes",(function(){return v})),i.d(t,"styled",(function(){return b.a})),i.d(t,"easing",(function(){return _.c})),i.d(t,"duration",(function(){return _.b})),i.d(t,"useTheme",(function(){return y.a})),i.d(t,"withStyles",(function(){return x.a})),i.d(t,"withTheme",(function(){return O})),i.d(t,"createGenerateClassName",(function(){return A.a})),i.d(t,"jssPreset",(function(){return T.a})),i.d(t,"ServerStyleSheets",(function(){return I})),i.d(t,"StylesProvider",(function(){return B.b})),i.d(t,"MuiThemeProvider",(function(){return F})),i.d(t,"ThemeProvider",(function(){return F}));var r=i(10),n=i(57),o=i(259);function s(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return n.a.apply(void 0,[Object(o.a)({unstable_strictMode:!0},e)].concat(i))}function a(e){return e}var l=i(2),c=i(270),u=i(41),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(c.a)(e,Object(l.a)({defaultTheme:u.a},t))},d=i(258),p=i(12);function f(e){return String(parseFloat(e)).length===String(e).length}function m(e){return parseFloat(e)}function g(e){return function(t,i){var r=function(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}(t);if(r===i)return t;var n=m(t);if("px"!==r)if("em"===r)n=m(t)*m(e);else if("rem"===r)return n=m(t)*m(e),t;var o=n;if("px"!==i)if("em"===i)o=n/m(e);else{if("rem"!==i)return t;o=n/m(e)}return parseFloat(o.toFixed(5))+i}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.breakpoints,r=void 0===i?["sm","md","lg"]:i,n=t.disableAlign,o=void 0!==n&&n,s=t.factor,a=void 0===s?2:s,c=t.variants,u=void 0===c?["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]:c,h=Object(l.a)({},e);h.typography=Object(l.a)({},h.typography);var m=h.typography,v=g(m.htmlFontSize),b=r.map((function(e){return h.breakpoints.values[e]}));return u.forEach((function(e){var t=m[e],i=parseFloat(v(t.fontSize,"rem"));if(!(i<=1)){var r=i,n=1+(r-1)/a,s=t.lineHeight;if(!f(s)&&!o)throw new Error(Object(d.a)(6));f(s)||(s=parseFloat(v(s,"rem"))/parseFloat(i));var c=null;o||(c=function(e){return function(e){var t=e.size,i=e.grid,r=t-t%i,n=r+i;return t-r<n-t?r:n}({size:e,grid:function(e){return e.pixels/(e.lineHeight*e.htmlFontSize)}({pixels:4,lineHeight:s,htmlFontSize:m.htmlFontSize})})}),m[e]=Object(l.a)({},t,function(e){var t=e.cssProperty,i=e.min,r=e.max,n=e.unit,o=void 0===n?"rem":n,s=e.breakpoints,a=void 0===s?[600,960,1280]:s,l=e.transform,c=void 0===l?null:l,u=Object(p.a)({},t,"".concat(i).concat(o)),h=(r-i)/a[a.length-1];return a.forEach((function(e){var r=i+h*e;null!==c&&(r=c(r)),u["@media (min-width:".concat(e,"px)")]=Object(p.a)({},t,"".concat(Math.round(1e4*r)/1e4).concat(o))})),u}({cssProperty:"fontSize",min:n,max:r,unit:"rem",breakpoints:b,transform:c}))}})),h}var b=i(85),_=i(22),y=i(18),x=i(5),w=i(4),M=i(1),P=i.n(M),E=(i(6),i(48)),S=i.n(E),C=i(260);function k(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).defaultTheme;return function(t){var i=P.a.forwardRef((function(i,r){var n=i.innerRef,o=Object(w.a)(i,["innerRef"]),s=Object(C.a)()||e;return P.a.createElement(t,Object(l.a)({theme:s,ref:n||r},o))}));return S()(i,t),i}}k();var O=k({defaultTheme:u.a}),A=i(261),T=i(209),D=i(66),R=i(42),L=i(27),B=i(268),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(D.a)(this,e),this.options=t}return Object(R.a)(e,[{key:"collect",value:function(e){var t=new Map;this.sheetsRegistry=new L.b;var i=Object(A.a)();return P.a.createElement(B.b,Object(l.a)({sheetsManager:t,serverGenerateClassName:i,sheetsRegistry:this.sheetsRegistry},this.options),e)}},{key:"toString",value:function(){return this.sheetsRegistry?this.sheetsRegistry.toString():""}},{key:"getStyleElement",value:function(e){return P.a.createElement("style",Object(l.a)({id:"jss-server-side",key:"jss-server-side",dangerouslySetInnerHTML:{__html:this.toString()}},e))}}]),e}(),N=i(92),j=i(93),F=function(e){var t=e.children,i=e.theme,r=Object(C.a)(),n=P.a.useMemo((function(){var e=null===r?i:function(e,t){return"function"==typeof t?t(e):Object(l.a)({},e,t)}(r,i);return null!=e&&(e[j.a]=null!==r),e}),[i,r]);return P.a.createElement(N.a.Provider,{value:n},t)}},function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";function r(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";var r=i(259);t.a=function(e,t){return t?Object(r.a)(e,t,{clone:!1}):e}},function(e,t,i){"use strict";var r=i(223),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||n}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,i,r){if("string"!=typeof i){if(f){var n=p(i);n&&n!==f&&e(t,n,r)}var s=u(i);h&&(s=s.concat(h(i)));for(var a=l(t),m=l(i),g=0;g<s.length;++g){var v=s[g];if(!(o[v]||r&&r[v]||m&&m[v]||a&&a[v])){var b=d(i,v);try{c(t,v,b)}catch(e){}}}}return t}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(8);function n(e={}){let t=e.radiusTop||1;t<0&&(console.error("negative radiusTop not allowed - will invert"),t*=-1);let i=e.radiusBottom||1;i<0&&(console.error("negative radiusBottom not allowed - will invert"),i*=-1);let n=e.height||1;n<0&&(console.error("negative height not allowed - will invert"),n*=-1);let o=e.radialSegments||32;o<0&&(console.error("negative radialSegments not allowed - will invert"),o*=-1),o<3&&(o=3);let s=e.heightSegments||1;s<0&&(console.error("negative heightSegments not allowed - will invert"),s*=-1),s<1&&(s=1);const a=!!e.openEnded;let l=e.center;const c=l?l[0]:0,u=l?l[1]:0,h=l?l[2]:0,d=n/2,p=n/s,f=2*Math.PI/o,m=1/o,g=(t-i)/s,v=[],b=[],_=[],y=[];let x,w,M,P,E,S,C,k,O,A,T;const D=(90-180*Math.atan(n/(i-t))/Math.PI)/90;for(x=0;x<=s;x++)for(E=t-x*g,S=d-x*p,w=0;w<=o;w++)M=Math.sin(w*f),P=Math.cos(w*f),b.push(E*M),b.push(D),b.push(E*P),_.push(w*m),_.push(1*x/s),v.push(E*M+c),v.push(S+u),v.push(E*P+h);for(x=0;x<s;x++)for(w=0;w<=o;w++)k=(C=x*(o+1)+w)+o,y.push(C),y.push(k),y.push(k+1),y.push(C),y.push(k+1),y.push(C+1);if(!a&&t>0){for(O=v.length/3,b.push(0),b.push(1),b.push(0),_.push(.5),_.push(.5),v.push(0+c),v.push(d+u),v.push(0+h),w=0;w<=o;w++)M=Math.sin(w*f),P=Math.cos(w*f),A=.5*Math.sin(w*f)+.5,T=.5*Math.cos(w*f)+.5,b.push(t*M),b.push(1),b.push(t*P),_.push(A),_.push(T),v.push(t*M+c),v.push(d+u),v.push(t*P+h);for(w=0;w<o;w++)l=O,C=O+1+w,y.push(C),y.push(C+1),y.push(l)}if(!a&&i>0){for(O=v.length/3,b.push(0),b.push(-1),b.push(0),_.push(.5),_.push(.5),v.push(0+c),v.push(0-d+u),v.push(0+h),w=0;w<=o;w++)M=Math.sin(w*f),P=Math.cos(w*f),A=.5*Math.sin(w*f)+.5,T=.5*Math.cos(w*f)+.5,b.push(i*M),b.push(-1),b.push(i*P),_.push(A),_.push(T),v.push(i*M+c),v.push(0-d+u),v.push(i*P+h);for(w=0;w<o;w++)l=O,C=O+1+w,y.push(l),y.push(C+1),y.push(C)}return r.utils.apply(e,{positions:v,normals:b,uv:_,indices:y})}},function(e,t,i){var r=i(226),n=i(6);e.exports=function(e,t,i){var n=e[t];if(n){var o=[];if(Object.keys(n).forEach((function(e){-1===r.indexOf(e)&&o.push(e)})),o.length)throw new Error("Prop "+t+" passed to "+i+". Has invalid keys "+o.join(", "))}},e.exports.isRequired=function(t,i,r){if(!t[i])throw new Error("Prop "+i+" passed to "+r+" is required");return e.exports(t,i,r)},e.exports.supportingArrays=n.oneOfType([n.arrayOf(e.exports),e.exports])},function(e,t,i){"use strict";t.a={black:"#000",white:"#fff"}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(91);function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object(r.a)(e,t)}},function(e,t,i){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n="object"===("undefined"==typeof window?"undefined":r(window))&&"object"===("undefined"==typeof document?"undefined":r(document))&&9===document.nodeType;t.a=n},,,function(e,t,i){"use strict";var r=i(12),n=i(4),o=i(259),s=i(39),a=i(2),l=i(258),c=i(51),u=i(64),h=i(60),d=i(59),p=i(58),f=i(63),m=i(61),g=i(62),v=i(10),b={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:c.a.white,default:u.a[50]},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},_={text:{primary:c.a.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",hint:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:u.a[800],default:"#303030"},action:{active:c.a.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function y(e,t,i,r){var n=r.light||r,o=r.dark||1.5*r;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:"light"===t?e.light=Object(v.i)(e.main,n):"dark"===t&&(e.dark=Object(v.a)(e.main,o)))}function x(e){return Math.round(1e5*e)/1e5}var w={textTransform:"uppercase"},M='"Roboto", "Helvetica", "Arial", sans-serif';function P(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var E=["none",P(0,2,1,-1,0,1,1,0,0,1,3,0),P(0,3,1,-2,0,2,2,0,0,1,5,0),P(0,3,3,-2,0,3,4,0,0,1,8,0),P(0,2,4,-1,0,4,5,0,0,1,10,0),P(0,3,5,-1,0,5,8,0,0,1,14,0),P(0,3,5,-1,0,6,10,0,0,1,18,0),P(0,4,5,-2,0,7,10,1,0,2,16,1),P(0,5,5,-3,0,8,10,1,0,3,14,2),P(0,5,6,-3,0,9,12,1,0,3,16,2),P(0,6,6,-3,0,10,14,1,0,4,18,3),P(0,6,7,-4,0,11,15,1,0,4,20,3),P(0,7,8,-4,0,12,17,2,0,5,22,4),P(0,7,8,-4,0,13,19,2,0,5,24,4),P(0,7,9,-4,0,14,21,2,0,5,26,4),P(0,8,9,-5,0,15,22,2,0,6,28,5),P(0,8,10,-5,0,16,24,2,0,6,30,5),P(0,8,11,-5,0,17,26,2,0,6,32,5),P(0,9,11,-5,0,18,28,2,0,7,34,6),P(0,9,12,-6,0,19,29,2,0,7,36,6),P(0,10,13,-6,0,20,31,3,0,8,38,7),P(0,10,13,-6,0,21,33,3,0,8,40,7),P(0,10,14,-6,0,22,35,3,0,8,42,7),P(0,11,14,-7,0,23,36,3,0,9,44,8),P(0,11,15,-7,0,24,38,3,0,9,46,8)],S={borderRadius:4},C=i(271),k=i(22),O=i(90);t.a=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,i=void 0===t?{}:t,P=e.mixins,A=void 0===P?{}:P,T=e.palette,D=void 0===T?{}:T,R=e.spacing,L=e.typography,B=void 0===L?{}:L,I=Object(n.a)(e,["breakpoints","mixins","palette","spacing","typography"]),N=function(e){var t=e.primary,i=void 0===t?{light:h.a[300],main:h.a[500],dark:h.a[700]}:t,r=e.secondary,s=void 0===r?{light:d.a.A200,main:d.a.A400,dark:d.a.A700}:r,x=e.error,w=void 0===x?{light:p.a[300],main:p.a[500],dark:p.a[700]}:x,M=e.warning,P=void 0===M?{light:f.a[300],main:f.a[500],dark:f.a[700]}:M,E=e.info,S=void 0===E?{light:m.a[300],main:m.a[500],dark:m.a[700]}:E,C=e.success,k=void 0===C?{light:g.a[300],main:g.a[500],dark:g.a[700]}:C,O=e.type,A=void 0===O?"light":O,T=e.contrastThreshold,D=void 0===T?3:T,R=e.tonalOffset,L=void 0===R?.2:R,B=Object(n.a)(e,["primary","secondary","error","warning","info","success","type","contrastThreshold","tonalOffset"]);function I(e){return Object(v.e)(e,_.text.primary)>=D?_.text.primary:b.text.primary}var N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:700;if(!(e=Object(a.a)({},e)).main&&e[t]&&(e.main=e[t]),!e.main)throw new Error(Object(l.a)(4,t));if("string"!=typeof e.main)throw new Error(Object(l.a)(5,JSON.stringify(e.main)));return y(e,"light",i,L),y(e,"dark",r,L),e.contrastText||(e.contrastText=I(e.main)),e},j={dark:_,light:b};return Object(o.a)(Object(a.a)({common:c.a,type:A,primary:N(i),secondary:N(s,"A400","A200","A700"),error:N(w),warning:N(P),info:N(S),success:N(k),grey:u.a,contrastThreshold:D,getContrastText:I,augmentColor:N,tonalOffset:L},j[A]),B)}(D),j=Object(s.a)(i),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=Object(C.a)({spacing:e}),i=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return 0===i.length?t(1):1===i.length?t(i[0]):i.map((function(e){if("string"==typeof e)return e;var i=t(e);return"number"==typeof i?"".concat(i,"px"):i})).join(" ")};return Object.defineProperty(i,"unit",{get:function(){return e}}),i.mui=!0,i}(R),z=Object(o.a)({breakpoints:j,direction:"ltr",mixins:function(e,t,i){var n;return Object(a.a)({gutters:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)({paddingLeft:t(2),paddingRight:t(2)},i,Object(r.a)({},e.up("sm"),Object(a.a)({paddingLeft:t(3),paddingRight:t(3)},i[e.up("sm")])))},toolbar:(n={minHeight:56},Object(r.a)(n,"".concat(e.up("xs")," and (orientation: landscape)"),{minHeight:48}),Object(r.a)(n,e.up("sm"),{minHeight:64}),n)},i)}(j,F,A),overrides:{},palette:N,props:{},shadows:E,typography:function(e,t){var i="function"==typeof t?t(e):t,r=i.fontFamily,s=void 0===r?M:r,l=i.fontSize,c=void 0===l?14:l,u=i.fontWeightLight,h=void 0===u?300:u,d=i.fontWeightRegular,p=void 0===d?400:d,f=i.fontWeightMedium,m=void 0===f?500:f,g=i.fontWeightBold,v=void 0===g?700:g,b=i.htmlFontSize,_=void 0===b?16:b,y=i.allVariants,P=i.pxToRem,E=Object(n.a)(i,["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"]),S=c/14,C=P||function(e){return"".concat(e/_*S,"rem")},k=function(e,t,i,r,n){return Object(a.a)({fontFamily:s,fontWeight:e,fontSize:C(t),lineHeight:i},s===M?{letterSpacing:"".concat(x(r/t),"em")}:{},n,y)},O={h1:k(h,96,1.167,-1.5),h2:k(h,60,1.2,-.5),h3:k(p,48,1.167,0),h4:k(p,34,1.235,.25),h5:k(p,24,1.334,0),h6:k(m,20,1.6,.15),subtitle1:k(p,16,1.75,.15),subtitle2:k(m,14,1.57,.1),body1:k(p,16,1.5,.15),body2:k(p,14,1.43,.15),button:k(m,14,1.75,.4,w),caption:k(p,12,1.66,.4),overline:k(p,12,2.66,1,w)};return Object(o.a)(Object(a.a)({htmlFontSize:_,pxToRem:C,round:x,fontFamily:s,fontSize:c,fontWeightLight:h,fontWeightRegular:p,fontWeightMedium:m,fontWeightBold:v},O),E,{clone:!1})}(N,B),spacing:F,shape:S,transitions:k.a,zIndex:O.a},I),V=arguments.length,U=new Array(V>1?V-1:0),W=1;W<V;W++)U[W-1]=arguments[W];return U.reduce((function(e,t){return Object(o.a)(e,t)}),z)}},function(e,t,i){"use strict";t.a={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"}},function(e,t,i){"use strict";t.a={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"}},function(e,t,i){"use strict";t.a={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"}},function(e,t,i){"use strict";t.a={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"}},function(e,t,i){"use strict";t.a={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"}},function(e,t,i){"use strict";t.a={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"}},function(e,t,i){"use strict";t.a={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(77);function n(e,t){if(e){if("string"==typeof e)return Object(r.a)(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Object(r.a)(e,t):void 0}}},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(0),n=function(){const e=[],t=[],i=[],n=[],o=[];let s=0;const a=new Uint16Array(3),l=new Uint16Array(3),c=new Uint16Array(3),u=r.math.vec3(),h=r.math.vec3(),d=r.math.vec3(),p=r.math.vec3(),f=r.math.vec3(),m=r.math.vec3(),g=r.math.vec3();return function(v,b,_,y){!function(r,o){const s={};let a,l,c,u;const h=Math.pow(10,4);let d,p,f=0;for(d=0,p=r.length;d<p;d+=3)a=r[d],l=r[d+1],c=r[d+2],void 0===s[u=Math.round(a*h)+"_"+Math.round(l*h)+"_"+Math.round(c*h)]&&(s[u]=f/3,e[f++]=a,e[f++]=l,e[f++]=c),t[d/3]=s[u];for(d=0,p=o.length;d<p;d++)n[d]=t[o[d]],i[n[d]]=o[d]}(v,b),function(t,i){s=0;for(let v=0,b=t;v<b;v+=3){const t=3*n[v],b=3*n[v+1],_=3*n[v+2];i?(a[0]=e[t],a[1]=e[t+1],a[2]=e[t+2],l[0]=e[b],l[1]=e[b+1],l[2]=e[b+2],c[0]=e[_],c[1]=e[_+1],c[2]=e[_+2],r.math.decompressPosition(a,i,u),r.math.decompressPosition(l,i,h),r.math.decompressPosition(c,i,d)):(u[0]=e[t],u[1]=e[t+1],u[2]=e[t+2],h[0]=e[b],h[1]=e[b+1],h[2]=e[b+2],d[0]=e[_],d[1]=e[_+1],d[2]=e[_+2]),r.math.subVec3(d,h,p),r.math.subVec3(u,h,f),r.math.cross3Vec3(p,f,m),r.math.normalizeVec3(m,g);const y=o[s]||(o[s]={normal:r.math.vec3()});y.normal[0]=g[0],y.normal[1]=g[1],y.normal[2]=g[2],s++}}(b.length,_);const x=[],w=Math.cos(r.math.DEGTORAD*y),M={};let P,E,S,C,k,O,A,T,D,R,L,B=!1;for(let e=0,t=b.length;e<t;e+=3){const t=e/3;for(let i=0;i<3;i++)P=n[e+i],E=n[e+(i+1)%3],void 0===M[k=(S=Math.min(P,E))+","+(C=Math.max(P,E))]?M[k]={index1:S,index2:C,face1:t,face2:void 0}:M[k].face2=t}for(k in M)void 0!==(O=M[k]).face2&&(A=o[O.face1].normal,T=o[O.face2].normal,(D=r.math.dotVec3(A,T))>w)||(R=i[O.index1],L=i[O.index2],(!B&&R>65535||L>65535)&&(B=!0),x.push(R),x.push(L));return B?new Uint32Array(x):new Uint16Array(x)}}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(16),n=i(15);class o extends r.a{get type(){return"Material"}constructor(e,t={}){super(e,t),n.a.memory.materials++}destroy(){super.destroy(),n.a.memory.materials--}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return ee}));var r=i(36),n=i(8),o=i(0),s=i(16),a=i(15);class l extends s.a{get type(){return"Spinner"}constructor(e,t={}){super(e,t),this._canvas=t.canvas,this._element=null,this._isCustom=!1,t.elementId&&(this._element=document.getElementById(t.elementId),this._element?this._adjustPosition():this.error("Can't find given Spinner HTML element: '"+t.elementId+"' - will automatically create default element")),this._element||this._createDefaultSpinner(),this.processes=0}_createDefaultSpinner(){this._injectDefaultCSS();const e=document.createElement("div"),t=e.style;t["z-index"]="9000",t.position="absolute",e.innerHTML='<div class="sk-fading-circle">                <div class="sk-circle1 sk-circle"></div>                <div class="sk-circle2 sk-circle"></div>                <div class="sk-circle3 sk-circle"></div>                <div class="sk-circle4 sk-circle"></div>                <div class="sk-circle5 sk-circle"></div>                <div class="sk-circle6 sk-circle"></div>                <div class="sk-circle7 sk-circle"></div>                <div class="sk-circle8 sk-circle"></div>                <div class="sk-circle9 sk-circle"></div>                <div class="sk-circle10 sk-circle"></div>                <div class="sk-circle11 sk-circle"></div>                <div class="sk-circle12 sk-circle"></div>                </div>',this._canvas.parentElement.appendChild(e),this._element=e,this._isCustom=!1,this._adjustPosition()}_injectDefaultCSS(){if(document.getElementById("xeokit-spinner-css"))return;const e=document.createElement("style");e.innerHTML=".sk-fading-circle {        background: transparent;        margin: 20px auto;        width: 50px;        height:50px;        position: relative;        }        .sk-fading-circle .sk-circle {        width: 120%;        height: 120%;        position: absolute;        left: 0;        top: 0;        }        .sk-fading-circle .sk-circle:before {        content: '';        display: block;        margin: 0 auto;        width: 15%;        height: 15%;        background-color: #ff8800;        border-radius: 100%;        -webkit-animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;        animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;        }        .sk-fading-circle .sk-circle2 {        -webkit-transform: rotate(30deg);        -ms-transform: rotate(30deg);        transform: rotate(30deg);    }    .sk-fading-circle .sk-circle3 {        -webkit-transform: rotate(60deg);        -ms-transform: rotate(60deg);        transform: rotate(60deg);    }    .sk-fading-circle .sk-circle4 {        -webkit-transform: rotate(90deg);        -ms-transform: rotate(90deg);        transform: rotate(90deg);    }    .sk-fading-circle .sk-circle5 {        -webkit-transform: rotate(120deg);        -ms-transform: rotate(120deg);        transform: rotate(120deg);    }    .sk-fading-circle .sk-circle6 {        -webkit-transform: rotate(150deg);        -ms-transform: rotate(150deg);        transform: rotate(150deg);    }    .sk-fading-circle .sk-circle7 {        -webkit-transform: rotate(180deg);        -ms-transform: rotate(180deg);        transform: rotate(180deg);    }    .sk-fading-circle .sk-circle8 {        -webkit-transform: rotate(210deg);        -ms-transform: rotate(210deg);        transform: rotate(210deg);    }    .sk-fading-circle .sk-circle9 {        -webkit-transform: rotate(240deg);        -ms-transform: rotate(240deg);        transform: rotate(240deg);    }    .sk-fading-circle .sk-circle10 {        -webkit-transform: rotate(270deg);        -ms-transform: rotate(270deg);        transform: rotate(270deg);    }    .sk-fading-circle .sk-circle11 {        -webkit-transform: rotate(300deg);        -ms-transform: rotate(300deg);        transform: rotate(300deg);    }    .sk-fading-circle .sk-circle12 {        -webkit-transform: rotate(330deg);        -ms-transform: rotate(330deg);        transform: rotate(330deg);    }    .sk-fading-circle .sk-circle2:before {        -webkit-animation-delay: -1.1s;        animation-delay: -1.1s;    }    .sk-fading-circle .sk-circle3:before {        -webkit-animation-delay: -1s;        animation-delay: -1s;    }    .sk-fading-circle .sk-circle4:before {        -webkit-animation-delay: -0.9s;        animation-delay: -0.9s;    }    .sk-fading-circle .sk-circle5:before {        -webkit-animation-delay: -0.8s;        animation-delay: -0.8s;    }    .sk-fading-circle .sk-circle6:before {        -webkit-animation-delay: -0.7s;        animation-delay: -0.7s;    }    .sk-fading-circle .sk-circle7:before {        -webkit-animation-delay: -0.6s;        animation-delay: -0.6s;    }    .sk-fading-circle .sk-circle8:before {        -webkit-animation-delay: -0.5s;        animation-delay: -0.5s;    }    .sk-fading-circle .sk-circle9:before {        -webkit-animation-delay: -0.4s;        animation-delay: -0.4s;    }    .sk-fading-circle .sk-circle10:before {        -webkit-animation-delay: -0.3s;        animation-delay: -0.3s;    }    .sk-fading-circle .sk-circle11:before {        -webkit-animation-delay: -0.2s;        animation-delay: -0.2s;    }    .sk-fading-circle .sk-circle12:before {        -webkit-animation-delay: -0.1s;        animation-delay: -0.1s;    }    @-webkit-keyframes sk-circleFadeDelay {        0%, 39%, 100% { opacity: 0; }        40% { opacity: 1; }    }    @keyframes sk-circleFadeDelay {        0%, 39%, 100% { opacity: 0; }        40% { opacity: 1; }    }",e.id="xeokit-spinner-css",document.body.appendChild(e)}_adjustPosition(){if(this._isCustom)return;const e=this._canvas,t=this._element,i=t.style;i.left=e.offsetLeft+.5*e.clientWidth-.5*t.clientWidth+"px",i.top=e.offsetTop+.5*e.clientHeight-.5*t.clientHeight+"px"}set processes(e){if(e=e||0,this._processes===e)return;if(e<0)return;const t=this._processes;this._processes=e;const i=this._element;i&&(i.style.visibility=this._processes>0?"visible":"hidden"),this.fire("processes",this._processes),0===this._processes&&this._processes!==t&&this.fire("zeroProcesses",this._processes)}get processes(){return this._processes}_destroy(){this._element&&!this._isCustom&&(this._element.parentNode.removeChild(this._element),this._element=null)}}var c=i(7);const u=["webgl","experimental-webgl","webkit-3d","moz-webgl","moz-glweb20"];class h extends s.a{get type(){return"Canvas"}constructor(e,t={}){super(e,t),this.canvas=t.canvas,this.gl=null,this.webgl2=!1,this.transparent=!!t.transparent,this.contextAttr=t.contextAttr||{},this.contextAttr.alpha=this.transparent,this.contextAttr.preserveDrawingBuffer=!!this.contextAttr.preserveDrawingBuffer,this.contextAttr.stencil=!1,this.contextAttr.premultipliedAlpha=!!this.contextAttr.premultipliedAlpha,this.contextAttr.antialias=!1!==this.contextAttr.antialias,this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.boundary=[this.canvas.offsetLeft,this.canvas.offsetTop,this.canvas.clientWidth,this.canvas.clientHeight],this._initWebGL(t);const i=this;this.canvas.addEventListener("webglcontextlost",this._webglcontextlostListener=function(e){console.time("webglcontextrestored"),i.scene._webglContextLost(),i.fire("webglcontextlost"),e.preventDefault()},!1),this.canvas.addEventListener("webglcontextrestored",this._webglcontextrestoredListener=function(e){i._initWebGL(),i.gl&&(i.scene._webglContextRestored(i.gl),i.fire("webglcontextrestored",i.gl),e.preventDefault()),console.timeEnd("webglcontextrestored")},!1);let n=null,o=null,s=null,c=null,u=null,h=null,d=null;this._tick=this.scene.on("tick",(function(){const e=i.canvas,t=window.innerWidth!==n||window.innerHeight!==o,l=e.clientWidth!==s||e.clientHeight!==c,p=e.offsetLeft!==u||e.offsetTop!==h,f=e.parentElement;if(t||l||p||f!==d){if(i._spinner._adjustPosition(),l||p){const t=e.clientWidth,n=e.clientHeight;if(l){let t,i=0;for(const e in r.a.scenes)r.a.scenes.hasOwnProperty(e)&&(i+=(t=r.a.scenes[e]).canvas.canvas.clientWidth*t.canvas.canvas.clientHeight);a.a.memory.pixels=i,e.width=e.clientWidth,e.height=e.clientHeight}const o=i.boundary;o[0]=e.offsetLeft,o[1]=e.offsetTop,o[2]=t,o[3]=n,i.fire("boundary",o),s=t,c=n}t&&(n=window.innerWidth,o=window.innerHeight),p&&(u=e.offsetLeft,h=e.offsetTop),d=f}})),this._spinner=new l(this.scene,{canvas:this.canvas,elementId:t.spinnerElementId}),this.clearColorAmbient=t.clearColorAmbient}_createCanvas(){const e="xeokit-canvas-"+o.math.createUUID(),t=document.getElementsByTagName("body")[0],i=document.createElement("div"),r=i.style;r.height="100%",r.width="100%",r.padding="0",r.margin="0",r.background="rgba(0,0,0,0);",r.float="left",r.left="0",r.top="0",r.position="absolute",r.opacity="1.0",r["z-index"]="-10000",i.innerHTML+='<canvas id="'+e+'" style="width: 100%; height: 100%; float: left; margin: 0; padding: 0;"></canvas>',t.appendChild(i),this.canvas=document.getElementById(e)}_getElementXY(e){let t=0,i=0;for(;e;)t+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{x:t,y:i}}_initWebGL(){if(!this.gl)for(let e=0;!this.gl&&e<u.length;e++)try{this.gl=this.canvas.getContext(u[e],this.contextAttr)}catch(e){}if(this.gl||(this.error("Failed to get a WebGL context"),this.fire("webglContextFailed",!0,!0)),this.gl)if(this.webgl2)this.gl.hint(this.gl.FRAGMENT_SHADER_DERIVATIVE_HINT,this.gl.FASTEST);else{if(c.a.SUPPORTED_EXTENSIONS.OES_standard_derivatives){const e=this.gl.getExtension("OES_standard_derivatives");this.gl.hint(e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,this.gl.FASTEST)}c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&this.gl.getExtension("EXT_frag_depth")}}set clearColorAmbient(e){this._clearColorAmbient=!!e}get clearColorAmbient(){return this._clearColorAmbient}getSnapshot(e){throw"Canvas#getSnapshot() has been replaced by Viewer#getSnapshot() - use that method instead."}readPixels(e,t,i,r){return this.scene._renderer.readPixels(e,t,i,r)}loseWebGLContext(){this.canvas.loseContext&&this.canvas.loseContext()}get spinner(){return this._spinner}destroy(){this.scene.off(this._tick),this._spinner._destroy(),this.canvas.removeEventListener("webglcontextlost",this._webglcontextlostListener),this.canvas.removeEventListener("webglcontextrestored",this._webglcontextrestoredListener),this.gl=null,super.destroy()}}var d=i(9),p=i(43),f=i(24),m=i(128),g=i(11),v=i(14);class b{constructor(e,t){this.scene=e,this.aabb=o.math.AABB3(),this.rtcCenter=o.math.vec3(t),this.rtcCenterHash=this.rtcCenter.join(),this.numMarkers=0,this.markers={},this.markerList=[],this.markerIndices={},this.positions=[],this.indices=[],this.positionsBuf=null,this.lenPositionsBuf=0,this.indicesBuf=null,this.sectionPlanesActive=[],this.culledBySectionPlanes=!1,this.occlusionTestList=[],this.lenOcclusionTestList=0,this.pixels=[],this.aabbDirty=!1,this.markerListDirty=!1,this.positionsDirty=!0,this.occlusionTestListDirty=!1}addMarker(e){this.markers[e.id]=e,this.markerListDirty=!0,this.numMarkers++}markerWorldPosUpdated(e){if(!this.markers[e.id])return;const t=this.markerIndices[e.id];this.positions[3*t+0]=e.worldPos[0],this.positions[3*t+1]=e.worldPos[1],this.positions[3*t+2]=e.worldPos[2],this.positionsDirty=!0}removeMarker(e){delete this.markers[e.id],this.markerListDirty=!0,this.numMarkers--}update(){this.markerListDirty&&(this._buildMarkerList(),this.markerListDirty=!1,this.positionsDirty=!0,this.occlusionTestListDirty=!0),this.positionsDirty&&(this._buildPositions(),this.positionsDirty=!1,this.aabbDirty=!0,this.vbosDirty=!0),this.aabbDirty&&(this._buildAABB(),this.aabbDirty=!1),this.vbosDirty&&(this._buildVBOs(),this.vbosDirty=!1),this.occlusionTestListDirty&&this._buildOcclusionTestList(),this._updateActiveSectionPlanes()}_buildMarkerList(){for(var e in this.numMarkers=0,this.markers)this.markers.hasOwnProperty(e)&&(this.markerList[this.numMarkers]=this.markers[e],this.markerIndices[e]=this.numMarkers,this.numMarkers++);this.markerList.length=this.numMarkers}_buildPositions(){let e=0;for(let t=0;t<this.numMarkers;t++)if(this.markerList[t]){const i=this.markerList[t].worldPos;this.positions[e++]=i[0],this.positions[e++]=i[1],this.positions[e++]=i[2],this.indices[t]=t}this.positions.length=3*this.numMarkers,this.indices.length=this.numMarkers}_buildAABB(){const e=this.aabb;o.math.collapseAABB3(e),o.math.expandAABB3Points3(e,this.positions);const t=this.rtcCenter;e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[0],e[4]+=t[1],e[5]+=t[2]}_buildVBOs(){if(this.positionsBuf){if(this.lenPositionsBuf===this.positions.length)return void this.positionsBuf.setData(this.positions);this.positionsBuf.destroy(),this.positionsBuf=null,this.indicesBuf.destroy(),this.indicesBuf=null}const e=this.scene.canvas.gl,t=3*this.numMarkers,i=this.numMarkers;this.positionsBuf=new v.a(e,e.ARRAY_BUFFER,new Float32Array(this.positions),t,3,e.STATIC_DRAW),this.indicesBuf=new v.a(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),i,1,e.STATIC_DRAW),this.lenPositionsBuf=this.positions.length}_buildOcclusionTestList(){const e=this.scene.canvas,t=this.scene.camera.perspective.near,i=e.boundary,r=i[2],n=i[3];let o=0;this.lenOcclusionTestList=0;for(let e=0;e<this.numMarkers;e++){const i=this.markerList[e];if(i.viewPos[2]>-t){i._setVisible(!1);continue}const s=i.canvasPos,a=s[0],l=s[1];a+10<0||l+10<0||a-10>r||l-10>n?i._setVisible(!1):!i.entity||i.entity.visible?i.occludable?(this.occlusionTestList[this.lenOcclusionTestList++]=i,this.pixels[o++]=a,this.pixels[o++]=l):i._setVisible(!0):i._setVisible(!1)}}_updateActiveSectionPlanes(){const e=this.scene._sectionPlanesState.sectionPlanes,t=e.length;if(t>0)for(let i=0;i<t;i++){const t=e[i];if(t.active){const e=o.math.planeAABB3Intersect(t.dir,t.dist,this.aabb);if(-1===e)return void(this.culledBySectionPlanes=!0);const r=0===e;this.sectionPlanesActive[i]=r}else this.sectionPlanesActive[i]=!1}this.culledBySectionPlanes=!1}destroy(){this.markers={},this.markerList.length=0,this.positionsBuf&&this.positionsBuf.destroy(),this.indicesBuf&&this.indicesBuf.destroy()}}const _=o.math.vec3([1,0,0]),y=o.math.vec3(),x=o.math.vec2(),w=function(e,t){t=t||{};const i=new class{constructor(e){this._scene=e,this._matPool=[],this._matPoolNextFreeIndex=0,this._rtcViewMats={},this._rtcPickViewMats={},this.reset()}reset(){this._matPoolNextFreeIndex=0,this._rtcViewMats={},this._rtcPickViewMats={},this.lastProgramId=null,this.withSAO=!1,this.backfaces=!1,this.frontface=!0,this.textureUnit=0,this.drawElements=0,this.drawArrays=0,this.useProgram=0,this.bindTexture=0,this.bindArray=0,this.pass=0,this.shadowViewMatrix=null,this.shadowProjMatrix=null,this.pickViewMatrix=null,this.pickProjMatrix=null,this.pickZNear=.01,this.pickZFar=5e3,this.pickInvisible=!1,this.lineWidth=1}getRTCViewMatrix(e,t){let i=this._rtcViewMats[e];return i||(i=this._getNewMat(),Object(d.a)(this._scene.camera.viewMatrix,t,i),this._rtcViewMats[e]=i),i}getRTCPickViewMatrix(e,t){let i=this._rtcPickViewMats[e];if(!i){i=this._getNewMat();const r=this.pickViewMatrix||this._scene.camera.viewMatrix;Object(d.a)(r,t,i),this._rtcPickViewMats[e]=i}return i}_getNewMat(){let e=this._matPool[this._matPoolNextFreeIndex];return e||(e=o.math.mat4(),this._matPool[this._matPoolNextFreeIndex]=e),this._matPoolNextFreeIndex++,e}}(e),r=e.canvas.canvas,n=e.canvas.gl,s=!!t.transparent,l=t.alphaDepthMask,u=new f.Map({});let h={},w={},M=!0,P=!0,E=!0,S=!0;const C=new p.a(r,n),k=new p.a(r,n),O=new p.a(r,n),A=new p.a(r,n),T=new p.a(r,n);let D=!1;const R=new class{constructor(e){this._scene=e,this._program=null,this._programError=!1,this._aPosition=null,this._aUV=null,this._uDepthTexture="uDepthTexture",this._uCameraNear=null,this._uCameraFar=null,this._uCameraProjectionMatrix=null,this._uCameraInverseProjectionMatrix=null,this._uScale=null,this._uIntensity=null,this._uBias=null,this._uKernelRadius=null,this._uMinResolution=null,this._uRandomSeed=null,this._uvBuf=null,this._positionsBuf=null,this._indicesBuf=null,this.init()}init(){const e=this._scene.canvas.gl;if(this._program=new g.a(e,{vertex:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                    \n                    attribute vec3 aPosition;\n                    attribute vec2 aUV;            \n                    varying vec2 vUV;\n                    void main () {\n                        gl_Position = vec4(aPosition, 1.0);\n                        vUV = aUV;\n                    }"],fragment:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                    \n                    #extension GL_OES_standard_derivatives : require\n                \n                #define NORMAL_TEXTURE 0\n                #define PI 3.14159265359\n                #define PI2 6.28318530718\n                #define EPSILON 1e-6\n                #define NUM_SAMPLES 7\n                #define NUM_RINGS 4\n\n                precision highp float;\n            \n                varying vec2        vUV;\n            \n                uniform sampler2D   uDepthTexture;\n               \n                uniform float       uCameraNear;\n                uniform float       uCameraFar;\n                uniform mat4        uProjectMatrix;\n                uniform mat4        uInverseProjectMatrix;\n                \n                uniform bool        uPerspective;\n\n                uniform float       uScale;\n                uniform float       uIntensity;\n                uniform float       uBias;\n                uniform float       uKernelRadius;\n                uniform float       uMinResolution;\n                uniform vec2        uViewport;\n                uniform float       uRandomSeed;\n\n                float pow2( const in float x ) { return x*x; }\n                \n                highp float rand( const in vec2 uv ) {\n                    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n                    highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n                    return fract(sin(sn) * c);\n                }\n\n                vec3 packNormalToRGB( const in vec3 normal ) {\n                    return normalize( normal ) * 0.5 + 0.5;\n                }\n\n                vec3 unpackRGBToNormal( const in vec3 rgb ) {\n                    return 2.0 * rgb.xyz - 1.0;\n                }\n\n                const float packUpscale = 256. / 255.;\n                const float unpackDownScale = 255. / 256.; \n\n                const vec3 packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\n                const vec4 unPackFactors = unpackDownScale / vec4( packFactors, 1. );   \n\n                const float shiftRights = 1. / 256.;\n\n                vec4 packDepthToRGBA( const in float v ) {\n                    vec4 r = vec4( fract( v * packFactors ), v );\n                    r.yzw -= r.xyz * shiftRights; \n                    return r * packUpscale;\n                }\n\n                float unpackRGBAToDepth( const in vec4 v ) {\n                    return dot( v, unPackFactors );\n                }\n                \n                float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n                    return ( near * far ) / ( ( far - near ) * invClipZ - far );\n                }\n\n                float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n                    return linearClipZ * ( near - far ) - near;\n                }\n                \n                float getDepth( const in vec2 screenPos ) {\n                \treturn unpackRGBAToDepth( texture2D( uDepthTexture, screenPos ) );\n                }\n\n                float getViewZ( const in float depth ) {\n                     if (uPerspective) {\n                         return perspectiveDepthToViewZ( depth, uCameraNear, uCameraFar );\n                     } else {\n                        return orthographicDepthToViewZ( depth, uCameraNear, uCameraFar );\n                     }\n                }\n\n                vec3 getViewPos( const in vec2 screenPos, const in float depth, const in float viewZ ) {\n                \tfloat clipW = uProjectMatrix[2][3] * viewZ + uProjectMatrix[3][3];\n                \tvec4 clipPosition = vec4( ( vec3( screenPos, depth ) - 0.5 ) * 2.0, 1.0 );\n                \tclipPosition *= clipW; \n                \treturn ( uInverseProjectMatrix * clipPosition ).xyz;\n                }\n\n                vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPos ) {               \n                    return normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\n                }\n\n                float scaleDividedByCameraFar;\n                float minResolutionMultipliedByCameraFar;\n\n                float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\n                \tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n                \tfloat viewDistance = length( viewDelta );\n                \tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;\n                \treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - uBias) / (1.0 + pow2( scaledScreenDistance ) );\n                }\n\n                const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\n                const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\n\n                float getAmbientOcclusion( const in vec3 centerViewPosition ) {\n            \n                \tscaleDividedByCameraFar = uScale / uCameraFar;\n                \tminResolutionMultipliedByCameraFar = uMinResolution * uCameraFar;\n                \tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUV );\n\n                \tfloat angle = rand( vUV + uRandomSeed ) * PI2;\n                \tvec2 radius = vec2( uKernelRadius * INV_NUM_SAMPLES ) / uViewport;\n                \tvec2 radiusStep = radius;\n\n                \tfloat occlusionSum = 0.0;\n                \tfloat weightSum = 0.0;\n\n                \tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {\n                \t\tvec2 sampleUv = vUV + vec2( cos( angle ), sin( angle ) ) * radius;\n                \t\tradius += radiusStep;\n                \t\tangle += ANGLE_STEP;\n\n                \t\tfloat sampleDepth = getDepth( sampleUv );\n                \t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {\n                \t\t\tcontinue;\n                \t\t}\n\n                \t\tfloat sampleViewZ = getViewZ( sampleDepth );\n                \t\tvec3 sampleViewPosition = getViewPos( sampleUv, sampleDepth, sampleViewZ );\n                \t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\n                \t\tweightSum += 1.0;\n                \t}\n\n                \tif( weightSum == 0.0 ) discard;\n\n                \treturn occlusionSum * ( uIntensity / weightSum );\n                }\n\n                void main() {\n                \n                \tfloat centerDepth = getDepth( vUV );\n                \t\n                \tif( centerDepth >= ( 1.0 - EPSILON ) ) {\n                \t\tdiscard;\n                \t}\n\n                \tfloat centerViewZ = getViewZ( centerDepth );\n                \tvec3 viewPosition = getViewPos( vUV, centerDepth, centerViewZ );\n\n                \tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );\n                \n                \tgl_FragColor = packDepthToRGBA(  1.0- ambientOcclusion );\n                }"]}),this._program.errors)return console.error(this._program.errors.join("\n")),void(this._programError=!0);const t=new Float32Array([1,1,0,1,0,0,1,0]),i=new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),r=new Uint8Array([0,1,2,0,2,3]);this._positionsBuf=new v.a(e,e.ARRAY_BUFFER,i,i.length,3,e.STATIC_DRAW),this._uvBuf=new v.a(e,e.ARRAY_BUFFER,t,t.length,2,e.STATIC_DRAW),this._indicesBuf=new v.a(e,e.ELEMENT_ARRAY_BUFFER,r,r.length,1,e.STATIC_DRAW),this._program.bind(),this._uCameraNear=this._program.getLocation("uCameraNear"),this._uCameraFar=this._program.getLocation("uCameraFar"),this._uCameraProjectionMatrix=this._program.getLocation("uProjectMatrix"),this._uCameraInverseProjectionMatrix=this._program.getLocation("uInverseProjectMatrix"),this._uPerspective=this._program.getLocation("uPerspective"),this._uScale=this._program.getLocation("uScale"),this._uIntensity=this._program.getLocation("uIntensity"),this._uBias=this._program.getLocation("uBias"),this._uKernelRadius=this._program.getLocation("uKernelRadius"),this._uMinResolution=this._program.getLocation("uMinResolution"),this._uViewport=this._program.getLocation("uViewport"),this._uRandomSeed=this._program.getLocation("uRandomSeed"),this._aPosition=this._program.getAttribute("aPosition"),this._aUV=this._program.getAttribute("aUV")}render(e){if(this._programError)return;this._getInverseProjectMat||(this._getInverseProjectMat=(()=>{let e=!0;this._scene.camera.on("projMatrix",(function(){e=!0}));const t=o.math.mat4();return()=>(e&&o.math.inverseMat4(r.camera.projMatrix,t),t)})());const t=this._scene.canvas.gl,i=this._program,r=this._scene,n=r.sao,s=t.drawingBufferWidth,a=t.drawingBufferHeight,l=r.camera.project._state,c=l.near,u=l.far,h=l.matrix,d=this._getInverseProjectMat(),p=Math.random(),f="perspective"===r.camera.projection;x[0]=s,x[1]=a,t.getExtension("OES_standard_derivatives"),t.viewport(0,0,s,a),t.clearColor(0,0,0,1),t.disable(t.DEPTH_TEST),t.disable(t.BLEND),t.frontFace(t.CCW),t.clear(t.COLOR_BUFFER_BIT),i.bind(),t.uniform1f(this._uCameraNear,c),t.uniform1f(this._uCameraFar,u),t.uniformMatrix4fv(this._uCameraProjectionMatrix,!1,h),t.uniformMatrix4fv(this._uCameraInverseProjectionMatrix,!1,d),t.uniform1i(this._uPerspective,f),t.uniform1f(this._uScale,n.scale),t.uniform1f(this._uIntensity,n.intensity),t.uniform1f(this._uBias,n.bias),t.uniform1f(this._uKernelRadius,n.kernelRadius),t.uniform1f(this._uMinResolution,n.minResolution),t.uniform2fv(this._uViewport,x),t.uniform1f(this._uRandomSeed,p),i.bindTexture(this._uDepthTexture,e,0),this._aUV.bindArrayBuffer(this._uvBuf),this._aPosition.bindArrayBuffer(this._positionsBuf),this._indicesBuf.bind(),t.drawElements(t.TRIANGLES,this._indicesBuf.numItems,this._indicesBuf.itemType,0)}destroy(){this._program.destroy()}}(e),L=new class{constructor(e){this._scene=e,this._texelOffset=new Float32Array([0,0]),this._program=null,this._programError=!1,this._uDepthTexture="uDepthTexture",this._uOcclusionTexture="uOcclusionTexture",this._aPosition=null,this._aUV=null,this._uvBuf=null,this._positionsBuf=null,this._indicesBuf=null,this.init()}init(){const e=this._scene.canvas.gl;if(this._program=new g.a(e,{vertex:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                    \n                    attribute   vec3 aPosition;\n                    attribute   vec2 aUV;\n            \n                    varying     vec2 vUV;\n            \n                    void main () {\n                       gl_Position = vec4(aPosition, 1.0);\n                       vUV = aUV;\n                    }"],fragment:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                       \n                    varying vec2        vUV;\n                    \n                    uniform sampler2D   uDepthTexture;\n                    uniform sampler2D   uOcclusionTexture;\n                    \n                    uniform float       uOcclusionScale;\n                    uniform float       uOcclusionCutoff;\n                    \n                    uniform vec2        uTexelOffset;\n                    \n                    const float unpackDownScale = 255. / 256.; \n                                   \n                    const vec3 packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\n                    const vec4 unPackFactors = unpackDownScale / vec4( packFactors, 1. );  \n                \n                    float unpackRGBAToDepth( const in vec4 v ) {\n                        return dot( v, unPackFactors );\n                    }\n                    \n                    const float packUpscale = 256. / 255.;\n       \n                    const float shiftRights = 1. / 256.;\n\n                    vec4 packDepthToRGBA( const in float v ) {\n                        vec4 r = vec4( fract( v * packFactors ), v );\n                        r.yzw -= r.xyz * shiftRights; \n                        return r * packUpscale;\n                    }\n                \n                    void main() {\n                    \n                        float centerOcclusion = unpackRGBAToDepth(texture2D(uOcclusionTexture, vUV));\n                        float centerDepth   = unpackRGBAToDepth(texture2D(uDepthTexture, vUV));\n                        \n                        float gaussian[5];\n                        \n                        gaussian[0] = 0.153170;\n                        gaussian[1] = 0.144893;\n                        gaussian[2] = 0.122649;\n                        gaussian[3] = 0.092902;\n                        gaussian[4] = 0.062970;\n                        \n                        float totalWeight = gaussian[0];\n                        float sum = centerOcclusion * totalWeight;\n            \n                        for (int r = 1; r <= 4; ++r) {\n                            \n                            vec2 uv = vUV + uTexelOffset * float(r) * 2.0;\n                            \n                            float occlusionSample = unpackRGBAToDepth(texture2D(uOcclusionTexture, uv));\n                            float depthSample = unpackRGBAToDepth(texture2D(uDepthTexture, uv));\n                            \n                            float weight = gaussian[r];\n                            weight *= max(0.0, 1.0 - 10.0 * abs(depthSample - centerDepth));\n                            \n                            sum += occlusionSample * weight;\n                            \n                            totalWeight += weight;\n                        }\n                        \n                        for (int r = 1; r <= 4; ++r) {\n                            \n                            vec2 uv = vUV + uTexelOffset * -float(r) * 2.0;\n                            \n                            float occlusionSample = unpackRGBAToDepth(texture2D(uOcclusionTexture, uv));\n                            float depthSample = unpackRGBAToDepth(texture2D(uDepthTexture, uv));\n                            \n                            float weight = gaussian[r];\n                            weight *= max(0.0, 1.0 - 10.0 * abs(depthSample - centerDepth));\n                            \n                            sum += occlusionSample * weight;\n                            \n                            totalWeight += weight;\n                        }\n                     \n                        float blurredOcclusion =  (sum / (totalWeight + 0.0001));\n                     \n                        gl_FragColor = packDepthToRGBA(blurredOcclusion);\n                       \n                    }"]}),this._program.errors)return console.error(this._program.errors.join("\n")),void(this._programError=!0);const t=new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),i=new Float32Array([1,1,0,1,0,0,1,0]),r=new Uint8Array([0,1,2,0,2,3]);this._positionsBuf=new v.a(e,e.ARRAY_BUFFER,t,t.length,3,e.STATIC_DRAW),this._uvBuf=new v.a(e,e.ARRAY_BUFFER,i,i.length,2,e.STATIC_DRAW),this._indicesBuf=new v.a(e,e.ELEMENT_ARRAY_BUFFER,r,r.length,1,e.STATIC_DRAW),this._uDepthTexture="uDepthTexture",this._uOcclusionTexture="uOcclusionTexture",this._aPosition=this._program.getAttribute("aPosition"),this._aUV=this._program.getAttribute("aUV"),this._uOcclusionScale=this._program.getLocation("uOcclusionScale"),this._uOcclusionCutoff=this._program.getLocation("uOcclusionCutoff"),this._uTexelOffset=this._program.getLocation("uTexelOffset")}render(e,t,i){if(this._programError)return;const r=this._scene.canvas.gl,n=this._program,o=r.drawingBufferWidth,s=r.drawingBufferHeight;0===i?(this._texelOffset[0]=1/o,this._texelOffset[1]=0):(this._texelOffset[0]=0,this._texelOffset[1]=1/s),r.viewport(0,0,o,s),r.clearColor(0,0,0,1),r.disable(r.DEPTH_TEST),r.disable(r.BLEND),r.frontFace(r.CCW),r.clear(r.COLOR_BUFFER_BIT),n.bind(),n.bindTexture(this._uDepthTexture,e,1),n.bindTexture(this._uOcclusionTexture,t,2),r.uniform1f(this._uOcclusionScale,.9),r.uniform1f(this._uOcclusionCutoff,.3),r.uniform2fv(this._uTexelOffset,this._texelOffset),this._aUV.bindArrayBuffer(this._uvBuf),this._aPosition.bindArrayBuffer(this._positionsBuf),this._indicesBuf.bind(),r.drawElements(r.TRIANGLES,this._indicesBuf.numItems,this._indicesBuf.itemType,0)}destroy(){this._program.destroy()}}(e),B=new class{constructor(e){this._scene=e,this._program=null,this._programError=!1,this._uColorTexture="uColorTexture",this._uOcclusionTexture="uOcclusionTexture",this._aPosition=null,this._aUV=null,this._uvBuf=null,this._positionsBuf=null,this._indicesBuf=null,this.init()}init(){const e=this._scene.canvas.gl;if(this._program=new g.a(e,{vertex:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                    \n                    attribute   vec3 aPosition;\n                    attribute   vec2 aUV;\n            \n                    varying     vec2 vUV;\n            \n                    void main () {\n                       gl_Position = vec4(aPosition, 1.0);\n                       vUV = aUV;\n                    }"],fragment:["#ifdef GL_FRAGMENT_PRECISION_HIGH\n                    precision highp float;\n                    precision highp int;\n                    #else\n                    precision mediump float;\n                    precision mediump int;\n                    #endif\n                    \n                    \n                    const float packUpscale = 256. / 255.;\n                    const float unpackDownScale = 255. / 256.; \n\n                    const vec3 packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\n                    const vec4 unPackFactors = unpackDownScale / vec4( packFactors, 1. );   \n\n                    const float shiftRights = 1. / 256.;\n\n                    vec4 packDepthToRGBA( const in float v ) {\n                        vec4 r = vec4( fract( v * packFactors ), v );\n                        r.yzw -= r.xyz * shiftRights; \n                        return r * packUpscale;\n                    }\n                \n                    varying vec2        vUV;\n                    \n                    uniform sampler2D   uColorTexture;\n                    uniform sampler2D   uOcclusionTexture;\n                    \n                    uniform float       uOcclusionScale;\n                    uniform float       uOcclusionCutoff;\n                    \n                    float unpackRGBAToDepth( const in vec4 v ) {\n                        return dot( v, unPackFactors );\n                    }\n                    \n                    void main() {\n                        vec4 color      = texture2D(uColorTexture, vUV);\n                        float ambient   = smoothstep(uOcclusionCutoff, 1.0, unpackRGBAToDepth(texture2D(uOcclusionTexture, vUV))) * uOcclusionScale;\n                        gl_FragColor    = vec4(color.rgb * (ambient), color.a);\n                    }"]}),this._program.errors)return console.error(this._program.errors.join("\n")),void(this._programError=!0);const t=new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),i=new Float32Array([1,1,0,1,0,0,1,0]),r=new Uint8Array([0,1,2,0,2,3]);this._positionsBuf=new v.a(e,e.ARRAY_BUFFER,t,t.length,3,e.STATIC_DRAW),this._uvBuf=new v.a(e,e.ARRAY_BUFFER,i,i.length,2,e.STATIC_DRAW),this._indicesBuf=new v.a(e,e.ELEMENT_ARRAY_BUFFER,r,r.length,1,e.STATIC_DRAW),this._uColorTexture="uColorTexture",this._uOcclusionTexture="uOcclusionTexture",this._aPosition=this._program.getAttribute("aPosition"),this._aUV=this._program.getAttribute("aUV"),this._uOcclusionScale=this._program.getLocation("uOcclusionScale"),this._uOcclusionCutoff=this._program.getLocation("uOcclusionCutoff")}render(e,t){if(this._programError)return;const i=this._scene.canvas.gl,r=this._program,n=i.drawingBufferWidth,o=i.drawingBufferHeight;i.viewport(0,0,n,o),i.clearColor(0,0,0,1),i.disable(i.DEPTH_TEST),i.disable(i.BLEND),i.frontFace(i.CCW),i.clear(i.COLOR_BUFFER_BIT),r.bind(),r.bindTexture(this._uColorTexture,e,0),r.bindTexture(this._uOcclusionTexture,t,2),i.uniform1f(this._uOcclusionScale,1),i.uniform1f(this._uOcclusionCutoff,.01),this._aUV.bindArrayBuffer(this._uvBuf),this._aPosition.bindArrayBuffer(this._positionsBuf),this._indicesBuf.bind(),i.drawElements(i.TRIANGLES,this._indicesBuf.numItems,this._indicesBuf.itemType,0)}destroy(){this._program.destroy()}}(e);function I(){M&&(function(){for(let e in h)if(h.hasOwnProperty(e)){const t=h[e],i=t.drawableMap,r=t.drawableListPreCull;let n=0;for(let e in i)i.hasOwnProperty(e)&&(r[n++]=i[e]);r.length=n}}(),M=!1,P=!0),P&&(function(){for(let e in h)if(h.hasOwnProperty(e)){const t=h[e];t.isStateSortable&&t.drawableListPreCull.sort(t.stateSortCompare)}}(),P=!1,E=!0),E&&function(){for(let e in h)if(h.hasOwnProperty(e)){const t=h[e],i=t.drawableListPreCull,r=t.drawableList;let n=0;for(let e=0,t=i.length;e<t;e++){const t=i[e];t.rebuildRenderFlags(),t.renderFlags.culled||(r[n++]=t)}r.length=n}}()}function N(e){if(!e.castsShadow)return;const t=e.getShadowRenderBuf();if(t){t.bind(),i.reset(),i.backfaces=!0,i.frontface=!0,i.shadowViewMatrix=e.getShadowViewMatrix(),i.shadowProjMatrix=e.getShadowProjMatrix(),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,1),n.enable(n.DEPTH_TEST),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);for(let e in h)if(h.hasOwnProperty(e)){const t=h[e].drawableList;for(let e=0,r=t.length;e<r;e++){const r=t[e];!1!==r.visible&&r.castsShadow&&r.drawShadow&&r.renderFlags.normalFillOpaque&&r.drawShadow(i)}}t.unbind()}}this._occlusionTester=null,this.needStateSort=function(){P=!0},this.shadowsDirty=function(){S=!0},this.imageDirty=function(){E=!0},this.webglContextLost=function(){},this.webglContextRestored=function(e){A.webglContextRestored(e),T.webglContextRestored(e),C.webglContextRestored(e),k.webglContextRestored(e),O.webglContextRestored(e),R.init(),L.init(),B.init(),E=!0},this.addDrawable=function(e,t){const i=t.type;if(!i)return void console.error("Renderer#addDrawable() : drawable with ID "+e+" has no 'type' - ignoring");let r=h[i];r||(r={type:t.type,count:0,isStateSortable:t.isStateSortable,stateSortCompare:t.stateSortCompare,drawableMap:{},drawableListPreCull:[],drawableList:[]},h[i]=r),r.count++,r.drawableMap[e]=t,w[e]=t,M=!0},this.removeDrawable=function(e){const t=w[e];if(!t)return void console.error("Renderer#removeDrawable() : drawable not found with ID "+e+" - ignoring");const i=t.type,r=h[i];--r.count<=0?delete h[i]:delete r.drawableMap[e],delete w[e],M=!0},this.getPickID=function(e){return u.addItem(e)},this.putPickID=function(e){u.removeItem(e)},this.clear=function(t){if(t=t||{},n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),s)n.clearColor(0,0,0,0);else{const i=t.ambientColor||e.canvas.backgroundColor||this.lights.getAmbientColor();n.clearColor(i[0],i[1],i[2],1)}n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT)},this.render=function(t){(t=t||{}).force&&(E=!0),I(),E&&(function(t){c.a.SUPPORTED_EXTENSIONS.OES_element_index_uint&&n.getExtension("OES_element_index_uint"),e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.getExtension("EXT_frag_depth"),e.sao.possible&&function(t){const r=e.sao;C.bind(),C.clear(),function(e){i.reset(),i.pass=e.pass,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.frontFace(n.CCW),n.enable(n.CULL_FACE),n.depthMask(!0),!1!==e.clear&&n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT);for(let e in h)if(h.hasOwnProperty(e)){const t=h[e].drawableList;for(let e=0,r=t.length;e<r;e++){const r=t[e];!0!==r.culled&&!1!==r.visible&&r.drawDepth&&r.renderFlags.normalFillOpaque&&r.drawDepth(i)}}}(t),C.unbind(),k.bind(),k.clear(),R.render(C.getTexture(),null),k.unbind(),r.blur&&(O.bind(),O.clear(),L.render(C.getTexture(),k.getTexture(),0),O.unbind(),k.bind(),k.clear(),L.render(C.getTexture(),O.getTexture(),1),k.unbind())}(t),function(){let t=e._lightsState.lights;for(let e=0,i=t.length;e<i;e++){const i=t[e];i.castsShadow&&N(i)}S=!1}(),j(t)}(t),a.a.frame.frameCount++,E=!1)};const j=function(){const t=[],r=[],o=[],u=[],d=[],p=[],f=[],m=[],g=[],v=[],b=[],_=[],y=[],x=[],w=[],M=[];return function(P){const E=e._lightsState.getAmbientColor();if(i.reset(),i.pass=P.pass,i.withSAO=!1,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),s)n.clearColor(0,0,0,0);else{const t=e.canvas.backgroundColor||E;n.clearColor(t[0],t[1],t[2],1)}n.enable(n.DEPTH_TEST),n.frontFace(n.CCW),n.enable(n.CULL_FACE),n.depthMask(!0),n.lineWidth(1),i.lineWidth=1;const S=e.sao.possible;let C,O,A;i.occlusionTexture=S?k.getTexture():null;const T=Date.now();!1!==P.clear&&n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT);let D=0,R=0,L=0,B=0,I=0,N=0,j=0,F=0,z=0,V=0,U=0,W=0,H=0,G=0,X=0,Y=0;for(let e in h)if(h.hasOwnProperty(e)){const n=h[e].drawableList;for(C=0,O=n.length;C<O;C++){if(!0===(A=n[C]).culled||!1===A.visible)continue;const e=A.renderFlags;e.normalFillOpaque&&(S&&A.saoEnabled?t[D++]=A:A.drawNormalOpaqueFill(i)),e.normalEdgesOpaque&&(r[R++]=A),e.normalFillTransparent&&(o[L++]=A),e.normalEdgesTransparent&&(u[B++]=A),e.xrayedFillTransparent&&(f[j++]=A),e.xrayedFillOpaque&&(d[I++]=A),e.xrayedEdgesTransparent&&(m[F++]=A),e.xrayedEdgesOpaque&&(p[N++]=A),e.highlightedFillTransparent&&(b[U++]=A),e.highlightedFillOpaque&&(g[z++]=A),e.highlightedEdgesTransparent&&(_[W++]=A),e.highlightedEdgesOpaque&&(v[V++]=A),e.selectedFillTransparent&&(w[X++]=A),e.selectedFillOpaque&&(y[H++]=A),e.selectedEdgesTransparent&&(M[Y++]=A),e.selectedEdgesOpaque&&(x[G++]=A)}}if(D>0)for(i.withSAO=!0,C=0;C<D;C++)t[C].drawNormalOpaqueFill(i);if(R>0)for(C=0;C<R;C++)r[C].drawNormalOpaqueEdges(i);if(I>0)for(C=0;C<I;C++)d[C].drawXRayedFill(i);if(N>0)for(C=0;C<N;C++)p[C].drawXRayedEdges(i);if(j>0||F>0||L>0||B>0){if(n.enable(n.CULL_FACE),n.enable(n.BLEND),s?(n.blendEquation(n.FUNC_ADD),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)):(n.blendEquation(n.FUNC_ADD),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)),i.backfaces=!1,l||n.depthMask(!1),F>0)for(C=0;C<F;C++)m[C].drawXRayedEdges(i);if(j>0)for(C=0;C<j;C++)f[C].drawXRayedFill(i);if((L>0||B>0)&&n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),B>0)for(C=0;C<B;C++)(A=u[C]).drawNormalTransparentEdges(i);if(L>0)for(C=0;C<L;C++)(A=o[C]).drawNormalTransparentFill(i);n.disable(n.BLEND),l||n.depthMask(!0)}if(z>0||V>0){if(i.lastProgramId=null,n.clear(n.DEPTH_BUFFER_BIT),V>0)for(C=0;C<V;C++)v[C].drawHighlightedEdges(i);if(z>0)for(C=0;C<z;C++)g[C].drawHighlightedFill(i)}if(U>0||W>0||z>0){if(i.lastProgramId=null,n.clear(n.DEPTH_BUFFER_BIT),n.enable(n.CULL_FACE),n.enable(n.BLEND),s?(n.blendEquation(n.FUNC_ADD),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)):n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),W>0)for(C=0;C<W;C++)_[C].drawHighlightedEdges(i);if(U>0)for(C=0;C<U;C++)b[C].drawHighlightedFill(i);n.disable(n.BLEND)}if(H>0||G>0){if(i.lastProgramId=null,n.clear(n.DEPTH_BUFFER_BIT),G>0)for(C=0;C<G;C++)x[C].drawSelectedEdges(i);if(H>0)for(C=0;C<H;C++)y[C].drawSelectedFill(i)}if(X>0||Y>0){if(i.lastProgramId=null,n.clear(n.DEPTH_BUFFER_BIT),n.enable(n.CULL_FACE),n.enable(n.BLEND),s?(n.blendEquation(n.FUNC_ADD),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)):n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),Y>0)for(C=0;C<Y;C++)M[C].drawSelectedEdges(i);if(X>0)for(C=0;C<X;C++)w[C].drawSelectedFill(i);n.disable(n.BLEND)}const $=Date.now(),q=a.a.frame;q.renderTime=($-T)/1e3,q.drawElements=i.drawElements,q.useProgram=i.useProgram,q.bindTexture=i.bindTexture,q.bindArray=i.bindArray;const K=c.a.MAX_TEXTURE_UNITS;for(let e=0;e<K;e++)n.activeTexture(n.TEXTURE0+e);n.bindTexture(n.TEXTURE_CUBE_MAP,null),n.bindTexture(n.TEXTURE_2D,null);const Z=c.a.MAX_VERTEX_ATTRIBS;for(let e=0;e<Z;e++)n.disableVertexAttribArray(e)}}();this.pick=function(){const t=o.math.vec3(),s=o.math.mat4(),a=o.math.mat4(),l=o.math.vec3([0,1,0]),d=new m.a,p=o.math.vec2();return function(f,m=d){let g,v,b,_,y;m.reset(),I(),c.a.SUPPORTED_EXTENSIONS.OES_element_index_uint&&n.getExtension("OES_element_index_uint"),e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&n.getExtension("EXT_frag_depth");let x=null,w=null;if(m.pickSurface=f.pickSurface,f.canvasPos)g=f.canvasPos[0],v=f.canvasPos[1],x=e.camera.viewMatrix,w=e.camera.projMatrix,m.canvasPos=f.canvasPos;else{const i=o.math.frustumMat4(-1,1,-1,1,e.camera.project.near,e.camera.project.far,s);f.matrix?(x=f.matrix,w=i):(b=f.origin||o.math.vec3([0,0,0]),_=f.direction||o.math.vec3([0,0,1]),y=o.math.addVec3(b,_,t),x=o.math.lookAtMat4v(b,y,l,a),w=i,m.origin=b,m.direction=_),g=.5*r.clientWidth,v=.5*r.clientHeight}A.bind();const M=function(e,t,r,o,s){let a,l;i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=r,i.pickProjMatrix=o,i.pickInvisible=!!s.pickInvisible,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);const c=s.includeEntityIds,d=s.excludeEntityIds;for(let e in h)if(h.hasOwnProperty(e)){const t=h[e].drawableList;for(a=0,l=t.length;a<l;a++){const e=t[a];!e.drawPickMesh||!0===e.culled||!0!==s.pickInvisible&&!1===e.visible||!1===e.pickable||c&&!c[e.id]||d&&d[e.id]||e.drawPickMesh(i)}}const p=A.read(Math.round(e),Math.round(t));let f=p[0]+256*p[1]+256*p[2]*256+256*p[3]*256*256;if(!(f<0))return u.items[f]}(g,v,x,w,f);if(!M)return A.unbind(),null;const P=M.delegatePickedEntity?M.delegatePickedEntity():M;return P?(f.pickSurface&&(M.canPickTriangle&&M.canPickTriangle()?(function(e,t,r,o,s,a){if(!e.drawPickTriangles)return;i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=o,i.pickProjMatrix=s,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),e.drawPickTriangles(i);const l=A.read(t,r);let c=l[0]+256*l[1]+256*l[2]*256+256*l[3]*256*256;c*=3,a.primIndex=c}(M,g,v,x,w,m),M.pickTriangleSurface(x,w,m)):M.canPickWorldPos&&M.canPickWorldPos()&&(p[0]=e.camera.project.near,p[1]=e.camera.project.far,F(M,g,v,x,w,p,m),!1!==f.pickSurfaceNormal&&function(e,t,r,s,a,l,c){i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=s,i.pickProjMatrix=a,i.pickZNear=l[0],i.pickZFar=l[1],n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),e.drawPickNormals(i);const u=A.read(Math.round(t),Math.round(r)),h=[u[0]/256-.5,u[1]/256-.5,u[2]/256-.5];o.math.normalizeVec3(h),c.worldNormal=h}(M,g,v,x,w,p,m))),A.unbind(),m.entity=P,m):null}}();const F=function(){const e=o.math.vec4(),t=o.math.vec4(),s=o.math.vec4(),a=o.math.vec4(),l=o.math.vec4(),c=o.math.mat4(),u=o.math.mat4(),h=o.math.mat4();return function(p,f,m,g,v,b,_){i.reset(),i.backfaces=!0,i.frontface=!0,i.pickViewMatrix=g,i.pickProjMatrix=v,i.pickZNear=b[0],i.pickZFar=b[1],n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),p.drawPickDepths(i);const y=function(e){const t=[e[0]/256,e[1]/256,e[2]/256,e[3]/256];return o.math.dotVec4(t,[1/16777216,1/65536,1/256,1])}(A.read(Math.round(f),Math.round(m))),x=(f-r.width/2)/(r.width/2),w=-(m-r.height/2)/(r.height/2),M=p.rtcCenter;let P;if(M){const e=Object(d.a)(g,M,c);P=o.math.mulMat4(v,e,u)}else P=o.math.mulMat4(v,g,u);const E=o.math.inverseMat4(P,h);e[0]=x,e[1]=w,e[2]=-1,e[3]=1;let S=o.math.transformVec4(E,e);S=o.math.mulVec4Scalar(S,1/S[3]),t[0]=x,t[1]=w,t[2]=1,t[3]=1;let C=o.math.transformVec4(E,t);C=o.math.mulVec4Scalar(C,1/C[3]);const k=o.math.subVec3(C,S,s),O=o.math.addVec3(S,o.math.mulVec4Scalar(k,y,a),l);M&&o.math.addVec3(O,M),_.worldPos=O}}();this.addMarker=function(t){this._occlusionTester=this._occlusionTester||new class{constructor(e){this._scene=e,this._occlusionLayers={},this._occlusionLayersList=[],this._occlusionLayersListDirty=!1,this._shaderSource=null,this._program=null,this._shaderSourceHash=null,this._shaderSourceDirty=!0,this._programDirty=!1,this._markersToOcclusionLayersMap={},this._onCameraViewMatrix=e.camera.on("viewMatrix",()=>{this._occlusionTestListDirty=!0}),this._onCameraProjMatrix=e.camera.on("projMatrix",()=>{this._occlusionTestListDirty=!0}),this._onCanvasBoundary=e.canvas.on("boundary",()=>{this._occlusionTestListDirty=!0})}addMarker(e){const t=e.rtcCenter.join();let i=this._occlusionLayers[t];i||(i=new b(this._scene,e.rtcCenter),this._occlusionLayers[i.rtcCenterHash]=i,this._occlusionLayersListDirty=!0),i.addMarker(e),this._markersToOcclusionLayersMap[e.id]=i,this._occlusionTestListDirty=!0}markerWorldPosUpdated(e){const t=this._markersToOcclusionLayersMap[e.id];if(!t)return void e.error("Marker has not been added to OcclusionTester");const i=e.rtcCenter.join();if(i!==t.rtcCenterHash){1===t.numMarkers?(t.destroy(),delete this._occlusionLayers[t.rtcCenterHash],this._occlusionLayersListDirty=!0):t.removeMarker(e);let r=this._occlusionLayers[i];r||(r=new b(this._scene,e.rtcCenter),this._occlusionLayers[i]=t,this._occlusionLayersListDirty=!0),r.addMarker(e),this._markersToOcclusionLayersMap[e.id]=r}else t.markerWorldPosUpdated(e)}removeMarker(e){const t=e.rtcCenter.join();let i=this._occlusionLayers[t];i&&(1===i.numMarkers?(i.destroy(),delete this._occlusionLayers[i.rtcCenterHash],this._occlusionLayersListDirty=!0):i.removeMarker(e),delete this._markersToOcclusionLayersMap[e.id])}get needOcclusionTest(){return this._occlusionTestListDirty}bindRenderBuf(){const e=[this._scene.canvas.canvas.id,this._scene._sectionPlanesState.getHash()].join(";");if(e!==this._shaderSourceHash&&(this._shaderSourceHash=e,this._shaderSourceDirty=!0),this._shaderSourceDirty&&(this._buildShaderSource(),this._shaderSourceDirty=!1,this._programDirty=!0),this._programDirty&&(this._buildProgram(),this._programDirty=!1,this._occlusionTestListDirty=!0),this._occlusionLayersListDirty&&(this._buildOcclusionLayersList(),this._occlusionLayersListDirty=!1),this._occlusionTestListDirty){for(let e=0,t=this._occlusionLayersList.length;e<t;e++)this._occlusionLayersList[e].occlusionTestListDirty=!0;this._occlusionTestListDirty=!1}this._readPixelBuf=this._readPixelBuf||(this._readPixelBuf=new p.a(this._scene.canvas.canvas,this._scene.canvas.gl)),this._readPixelBuf.bind(),this._readPixelBuf.clear()}_buildOcclusionLayersList(){let e=0;for(let t in this._occlusionLayers)this._occlusionLayers.hasOwnProperty(t)&&(this._occlusionLayersList[e++]=this._occlusionLayers[t]);this._occlusionLayersList.length=e}_buildShaderSource(){this._shaderSource={vertex:this._buildVertexShaderSource(),fragment:this._buildFragmentShaderSource()}}_buildVertexShaderSource(){const e=this._scene,t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// OcclusionTester vertex shader"),e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("attribute vec3 position;"),i.push("uniform mat4 modelMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&i.push("varying vec4 vWorldPosition;"),i.push("void main(void) {"),i.push("vec4 worldPosition = vec4(position, 1.0); "),i.push("   vec4 viewPosition = viewMatrix * worldPosition;"),t&&i.push("   vWorldPosition = worldPosition;"),i.push("   vec4 clipPos = projMatrix * viewPosition;"),i.push("   gl_Position = clipPos;"),i.push("   gl_PointSize = 20.0;"),e.logarithmicDepthBufferEnabled&&(c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("}"),i}_buildFragmentShaderSource(){const e=this._scene,t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// OcclusionTester fragment shader"),e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("void main(void) {"),i){r.push("  float dist = 0.0;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("if (sectionPlaneActive"+n+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("}");r.push("  if (dist > 0.0) { discard; }")}return e.logarithmicDepthBufferEnabled&&c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); "),r.push("}"),r}_buildProgram(){this._program&&this._program.destroy();const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new g.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}drawMarkers(){const e=this._scene,t=e.canvas.gl,i=this._program,r=e._sectionPlanesState,n=e.camera,o=e.camera.project;if(c.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&e.logarithmicDepthBufferEnabled&&t.getExtension("EXT_frag_depth"),i.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,n._project._state.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}for(let e=0,i=this._occlusionLayersList.length;e<i;e++){const i=this._occlusionLayersList[e];if(i.update(),i.culledBySectionPlanes)continue;const o=i.rtcCenter;t.uniformMatrix4fv(this._uViewMatrix,!1,Object(d.a)(n.viewMatrix,o));const s=r.sectionPlanes.length;if(s>0){const e=r.sectionPlanes;for(let r=0;r<s;r++){const n=this._uSectionPlanes[r],s=i.sectionPlanesActive[r];if(t.uniform1i(n.active,s?1:0),s){const i=e[r];t.uniform3fv(n.pos,Object(d.b)(i.dist,i.dir,o,y)),t.uniform3fv(n.dir,i.dir)}}}this._aPosition.bindArrayBuffer(i.positionsBuf);const a=i.indicesBuf;a.bind(),t.drawElements(t.POINTS,a.numItems,a.itemType,0)}}doOcclusionTest(){{const e=255*_[0],t=255*_[1],i=255*_[2];for(let r=0,n=this._occlusionLayersList.length;r<n;r++){const n=this._occlusionLayersList[r];for(let r=0;r<n.lenOcclusionTestList;r++){const o=n.occlusionTestList[r],s=2*r,a=this._readPixelBuf.read(n.pixels[s],n.pixels[s+1]),l=a[0]===e&&a[1]===t&&a[2]===i;o._setVisible(l)}}}}unbindRenderBuf(){this._readPixelBuf.unbind()}destroy(){if(!this.destroyed){for(let e=0,t=this._occlusionLayersList.length;e<t;e++)this._occlusionLayersList[e].destroy();this._program&&this._program.destroy(),this._scene.camera.off(this._onCameraViewMatrix),this._scene.camera.off(this._onCameraProjMatrix),this._scene.canvas.off(this._onCanvasBoundary),this.destroyed=!0}}}(e),this._occlusionTester.addMarker(t),e.occlusionTestCountdown=0},this.markerWorldPosUpdated=function(e){this._occlusionTester.markerWorldPosUpdated(e)},this.removeMarker=function(e){this._occlusionTester.removeMarker(e)},this.doOcclusionTest=function(){if(this._occlusionTester&&this._occlusionTester.needOcclusionTest){I(),this._occlusionTester.bindRenderBuf(),i.reset(),i.backfaces=!0,i.frontface=!0,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.clearColor(0,0,0,0),n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.disable(n.BLEND),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);for(let e in h)if(h.hasOwnProperty(e)){const t=h[e].drawableList;for(let e=0,r=t.length;e<r;e++){const r=t[e];r.drawOcclusion&&!0!==r.culled&&!1!==r.visible&&!1!==r.pickable&&r.drawOcclusion(i)}}this._occlusionTester.drawMarkers(i),this._occlusionTester.doOcclusionTest(),this._occlusionTester.unbindRenderBuf()}},this.readPixels=function(e,t,i,r){let n,o,s,a;for(T.bind(),T.clear(),this.render({force:!0,opaqueOnly:r}),o=0;o<i;o++)s=2*o,a=4*o,n=T.read(e[s],e[s+1]),t[a]=n[0],t[a+1]=n[1],t[a+2]=n[2],t[a+3]=n[3];T.unbind(),E=!0},this.beginSnapshot=function(){T.bind(),T.clear(),D=!0},this.renderSnapshot=function(){D&&(T.clear(),this.render({force:!0,opaqueOnly:!1}),E=!0)},this.readSnapshot=function(e){return T.readImage(e)},this.endSnapshot=function(){D&&(T.unbind(),D=!1)},this.destroy=function(){h={},w={},A.destroy(),T.destroy(),C.destroy(),k.destroy(),O.destroy(),R.destroy(),L.destroy(),B.destroy(),this._occlusionTester&&this._occlusionTester.destroy()}};class M extends s.a{constructor(e,t={}){super(e,t),this.KEY_BACKSPACE=8,this.KEY_TAB=9,this.KEY_ENTER=13,this.KEY_SHIFT=16,this.KEY_CTRL=17,this.KEY_ALT=18,this.KEY_PAUSE_BREAK=19,this.KEY_CAPS_LOCK=20,this.KEY_ESCAPE=27,this.KEY_PAGE_UP=33,this.KEY_PAGE_DOWN=34,this.KEY_END=35,this.KEY_HOME=36,this.KEY_LEFT_ARROW=37,this.KEY_UP_ARROW=38,this.KEY_RIGHT_ARROW=39,this.KEY_DOWN_ARROW=40,this.KEY_INSERT=45,this.KEY_DELETE=46,this.KEY_NUM_0=48,this.KEY_NUM_1=49,this.KEY_NUM_2=50,this.KEY_NUM_3=51,this.KEY_NUM_4=52,this.KEY_NUM_5=53,this.KEY_NUM_6=54,this.KEY_NUM_7=55,this.KEY_NUM_8=56,this.KEY_NUM_9=57,this.KEY_A=65,this.KEY_B=66,this.KEY_C=67,this.KEY_D=68,this.KEY_E=69,this.KEY_F=70,this.KEY_G=71,this.KEY_H=72,this.KEY_I=73,this.KEY_J=74,this.KEY_K=75,this.KEY_L=76,this.KEY_M=77,this.KEY_N=78,this.KEY_O=79,this.KEY_P=80,this.KEY_Q=81,this.KEY_R=82,this.KEY_S=83,this.KEY_T=84,this.KEY_U=85,this.KEY_V=86,this.KEY_W=87,this.KEY_X=88,this.KEY_Y=89,this.KEY_Z=90,this.KEY_LEFT_WINDOW=91,this.KEY_RIGHT_WINDOW=92,this.KEY_SELECT_KEY=93,this.KEY_NUMPAD_0=96,this.KEY_NUMPAD_1=97,this.KEY_NUMPAD_2=98,this.KEY_NUMPAD_3=99,this.KEY_NUMPAD_4=100,this.KEY_NUMPAD_5=101,this.KEY_NUMPAD_6=102,this.KEY_NUMPAD_7=103,this.KEY_NUMPAD_8=104,this.KEY_NUMPAD_9=105,this.KEY_MULTIPLY=106,this.KEY_ADD=107,this.KEY_SUBTRACT=109,this.KEY_DECIMAL_POINT=110,this.KEY_DIVIDE=111,this.KEY_F1=112,this.KEY_F2=113,this.KEY_F3=114,this.KEY_F4=115,this.KEY_F5=116,this.KEY_F6=117,this.KEY_F7=118,this.KEY_F8=119,this.KEY_F9=120,this.KEY_F10=121,this.KEY_F11=122,this.KEY_F12=123,this.KEY_NUM_LOCK=144,this.KEY_SCROLL_LOCK=145,this.KEY_SEMI_COLON=186,this.KEY_EQUAL_SIGN=187,this.KEY_COMMA=188,this.KEY_DASH=189,this.KEY_PERIOD=190,this.KEY_FORWARD_SLASH=191,this.KEY_GRAVE_ACCENT=192,this.KEY_OPEN_BRACKET=219,this.KEY_BACK_SLASH=220,this.KEY_CLOSE_BRACKET=221,this.KEY_SINGLE_QUOTE=222,this.KEY_SPACE=32,this.element=t.element,this.altDown=!1,this.ctrlDown=!1,this.mouseDownLeft=!1,this.mouseDownMiddle=!1,this.mouseDownRight=!1,this.keyDown=[],this.enabled=!0,this.keyboardEnabled=!0,this.mouseover=!1,this.mouseCanvasPos=o.math.vec2(),this._bindEvents()}_bindEvents(){if(!this._eventsBound){document.addEventListener("keydown",this._keyDownListener=e=>{this.enabled&&this.keyboardEnabled&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.keyCode===this.KEY_CTRL?this.ctrlDown=!0:e.keyCode===this.KEY_ALT?this.altDown=!0:e.keyCode===this.KEY_SHIFT&&(this.shiftDown=!0),this.keyDown[e.keyCode]=!0,this.fire("keydown",e.keyCode,!0))},!1),document.addEventListener("keyup",this._keyUpListener=e=>{this.enabled&&this.keyboardEnabled&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.keyCode===this.KEY_CTRL?this.ctrlDown=!1:e.keyCode===this.KEY_ALT?this.altDown=!1:e.keyCode===this.KEY_SHIFT&&(this.shiftDown=!1),this.keyDown[e.keyCode]=!1,this.fire("keyup",e.keyCode,!0))}),this.element.addEventListener("mouseenter",this._mouseEnterListener=e=>{this.enabled&&(this.mouseover=!0,this._getMouseCanvasPos(e),this.fire("mouseenter",this.mouseCanvasPos,!0))}),this.element.addEventListener("mouseleave",this._mouseLeaveListener=e=>{this.enabled&&(this.mouseover=!1,this._getMouseCanvasPos(e),this.fire("mouseleave",this.mouseCanvasPos,!0))}),this.element.addEventListener("mousedown",this._mouseDownListener=e=>{if(this.enabled){switch(e.which){case 1:this.mouseDownLeft=!0;break;case 2:this.mouseDownMiddle=!0;break;case 3:this.mouseDownRight=!0}this._getMouseCanvasPos(e),this.element.focus(),this.fire("mousedown",this.mouseCanvasPos,!0),this.mouseover&&e.preventDefault()}}),document.addEventListener("mouseup",this._mouseUpListener=e=>{if(this.enabled){switch(e.which){case 1:this.mouseDownLeft=!1;break;case 2:this.mouseDownMiddle=!1;break;case 3:this.mouseDownRight=!1}this.fire("mouseup",this.mouseCanvasPos,!0)}},!0),document.addEventListener("click",this._clickListener=e=>{if(this.enabled){switch(e.which){case 1:this.mouseDownLeft=!1,this.mouseDownRight=!1;break;case 2:this.mouseDownMiddle=!1;break;case 3:this.mouseDownLeft=!1,this.mouseDownRight=!1}this._getMouseCanvasPos(e),this.fire("click",this.mouseCanvasPos,!0),this.mouseover&&e.preventDefault()}}),document.addEventListener("dblclick",this._dblClickListener=e=>{if(this.enabled){switch(e.which){case 1:this.mouseDownLeft=!1,this.mouseDownRight=!1;break;case 2:this.mouseDownMiddle=!1;break;case 3:this.mouseDownLeft=!1,this.mouseDownRight=!1}this._getMouseCanvasPos(e),this.fire("dblclick",this.mouseCanvasPos,!0),this.mouseover&&e.preventDefault()}}),this.element.addEventListener("mousemove",this._mouseMoveListener=e=>{this.enabled&&(this._getMouseCanvasPos(e),this.fire("mousemove",this.mouseCanvasPos,!0),this.mouseover&&e.preventDefault())}),this.element.addEventListener("wheel",this._mouseWheelListener=(e,t)=>{if(!this.enabled)return;const i=Math.max(-1,Math.min(1,40*-e.deltaY));this.fire("mousewheel",i,!0)},{passive:!0});{let e,t;const i=2;this.on("mousedown",i=>{e=i[0],t=i[1]}),this.on("mouseup",r=>{e>=r[0]-i&&e<=r[0]+i&&t>=r[1]-i&&t<=r[1]+i&&this.fire("mouseclicked",r,!0)})}{const e={"landscape-primary":90,"landscape-secondary":-90,"portrait-secondary":180,"portrait-primary":0};let t,i;const r=o.math.vec3(),n=o.math.vec3(),s={orientation:null,orientationAngle:0},a={orientationAngle:0,acceleration:null,accelerationIncludingGravity:n,rotationRate:o.math.vec3(),interval:0},l={alpha:0,beta:0,gamma:0,absolute:!1};window.OrientationChangeEvent&&window.addEventListener("orientationchange",this._orientationchangedListener=()=>{t=window.screen.orientation||window.screen.mozOrientation||window.msOrientation||null,i=t&&e[t]||0,s.orientation=t,s.orientationAngle=i,this.fire("orientationchange",s)},!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",this._deviceMotionListener=e=>{a.interval=e.interval,a.orientationAngle=i;const t=e.acceleration;t?(r[0]=t.x,r[1]=t.y,r[2]=t.z,a.acceleration=r):a.acceleration=null;const o=e.accelerationIncludingGravity;o?(n[0]=o.x,n[1]=o.y,n[2]=o.z,a.accelerationIncludingGravity=n):a.accelerationIncludingGravity=null,a.rotationRate=e.rotationRate,this.fire("devicemotion",a)},!1),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",this._deviceOrientListener=e=>{l.gamma=e.gamma,l.beta=e.beta,l.alpha=e.alpha,l.absolute=e.absolute,this.fire("deviceorientation",l)},!1)}this._eventsBound=!0}}_unbindEvents(){this._eventsBound&&(document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener),this.element.removeEventListener("mouseenter",this._mouseEnterListener),this.element.removeEventListener("mouseleave",this._mouseLeaveListener),this.element.removeEventListener("mousedown",this._mouseDownListener),document.removeEventListener("mouseup",this._mouseDownListener),document.removeEventListener("click",this._clickListener),document.removeEventListener("dblclick",this._dblClickListener),this.element.removeEventListener("mousemove",this._mouseMoveListener),this.element.removeEventListener("wheel",this._mouseWheelListener),window.OrientationChangeEvent&&window.removeEventListener("orientationchange",this._orientationchangedListener),window.DeviceMotionEvent&&window.removeEventListener("devicemotion",this._deviceMotionListener),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",this._deviceOrientListener),this._eventsBound=!1)}_getMouseCanvasPos(e){if(e){let t=e.target,i=0,r=0;for(;t.offsetParent;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;this.mouseCanvasPos[0]=e.pageX-i,this.mouseCanvasPos[1]=e.pageY-r}else e=window.event,this.mouseCanvasPos[0]=e.x,this.mouseCanvasPos[1]=e.y}setEnabled(e){this.enabled!==e&&this.fire("enabled",this.enabled=e)}getEnabled(){return this.enabled}setKeyboardEnabled(e){this.keyboardEnabled=e}getKeyboardEnabled(){return this.keyboardEnabled}destroy(){super.destroy(),this._unbindEvents()}}var P=i(20);class E extends s.a{get type(){return"Viewport"}constructor(e,t={}){super(e,t),this._state=new P.a({boundary:[0,0,100,100]}),this.boundary=t.boundary,this.autoBoundary=t.autoBoundary}set boundary(e){if(!this._autoBoundary){if(!e){const t=this.scene.canvas.boundary;e=[0,0,t[2],t[3]]}this._state.boundary=e,this.glRedraw(),this.fire("boundary",this._state.boundary)}}get boundary(){return this._state.boundary}set autoBoundary(e){(e=!!e)!==this._autoBoundary&&(this._autoBoundary=e,this._autoBoundary?this._onCanvasSize=this.scene.canvas.on("boundary",(function(e){const t=e[2],i=e[3];this._state.boundary=[0,0,t,i],this.glRedraw(),this.fire("boundary",this._state.boundary)}),this):this._onCanvasSize&&(this.scene.canvas.off(this._onCanvasSize),this._onCanvasSize=null),this.fire("autoBoundary",this._autoBoundary))}get autoBoundary(){return this._autoBoundary}_getState(){return this._state}destroy(){super.destroy(),this._state.destroy()}}class S extends s.a{get type(){return"Perspective"}constructor(e,t={}){super(e,t),this.camera=e,this._state=new P.a({matrix:o.math.mat4(),inverseMatrix:o.math.mat4(),transposedMatrix:o.math.mat4(),near:.1,far:2e3}),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this._fov=60,this._canvasResized=this.scene.canvas.on("boundary",this._needUpdate,this),this.fov=t.fov,this.fovAxis=t.fovAxis,this.near=t.near,this.far=t.far}_update(){const e=this.scene.viewport.boundary,t=e[2]/e[3],i=this._fovAxis;let r=this._fov;("x"===i||"min"===i&&t<1||"max"===i&&t>1)&&(r/=t),r=Math.min(r,120),o.math.perspectiveMat4(r*(Math.PI/180),t,this._state.near,this._state.far,this._state.matrix),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.glRedraw(),this.fire("matrix",this._state.matrix)}set fov(e){this._fov=null!=e?e:60,this._needUpdate(0),this.fire("fov",this._fov)}get fov(){return this._fov}set fovAxis(e){e=e||"min",this._fovAxis!==e&&("x"!==e&&"y"!==e&&"min"!==e&&(this.error("Unsupported value for 'fovAxis': "+e+" - defaulting to 'min'"),e="min"),this._fovAxis=e,this._needUpdate(0),this.fire("fovAxis",this._fovAxis))}get fovAxis(){return this._fovAxis}set near(e){const t=null!=e?e:.1;this._state.near!==t&&(this._state.near=t,this._needUpdate(0),this.fire("near",this._state.near))}get near(){return this._state.near}set far(e){const t=null!=e?e:2e3;this._state.far!==t&&(this._state.far=t,this._needUpdate(0),this.fire("far",this._state.far))}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get inverseMatrix(){return this._updateScheduled&&this._doUpdate(),this._inverseMatrixDirty&&(o.math.inverseMat4(this._state.matrix,this._state.inverseMatrix),this._inverseMatrixDirty=!1),this._state.inverseMatrix}get transposedMatrix(){return this._updateScheduled&&this._doUpdate(),this._transposedMatrixDirty&&(o.math.transposeMat4(this._state.matrix,this._state.transposedMatrix),this._transposedMatrixDirty=!1),this._state.transposedMatrix}unproject(e,t,i,r,n){const s=this.scene.canvas.canvas,a=s.offsetWidth/2,l=s.offsetHeight/2;return i[0]=(e[0]-a)/a,i[1]=(e[1]-l)/l,i[2]=t,i[3]=1,o.math.mulMat4v4(this.inverseMatrix,i,r),o.math.mulVec3Scalar(r,1/r[3]),r[3]=1,r[1]*=-1,o.math.mulMat4v4(this.camera.inverseViewMatrix,r,n),n}destroy(){super.destroy(),this._state.destroy(),this.scene.canvas.off(this._canvasResized)}}class C extends s.a{get type(){return"Ortho"}constructor(e,t={}){super(e,t),this.camera=e,this._state=new P.a({matrix:o.math.mat4(),inverseMatrix:o.math.mat4(),transposedMatrix:o.math.mat4(),near:.1,far:2e3}),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.scale=t.scale,this.near=t.near,this.far=t.far,this._onCanvasBoundary=this.scene.canvas.on("boundary",this._needUpdate,this)}_update(){const e=this.scene,t=.5*this._scale,i=e.viewport.boundary,r=i[2],n=i[3],s=r/n;let a,l,c,u;r>n?(a=-t,l=t,c=t/s,u=-t/s):(a=-t*s,l=t*s,c=t,u=-t),o.math.orthoMat4c(a,l,u,c,this._state.near,this._state.far,this._state.matrix),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.glRedraw(),this.fire("matrix",this._state.matrix)}set scale(e){null!=e||(e=1),e<=0&&(e=.01),this._scale=e,this._needUpdate(0),this.fire("scale",this._scale)}get scale(){return this._scale}set near(e){const t=null!=e?e:.1;this._state.near!==t&&(this._state.near=t,this._needUpdate(0),this.fire("near",this._state.near))}get near(){return this._state.near}set far(e){const t=null!=e?e:2e3;this._state.far!==t&&(this._state.far=t,this._needUpdate(0),this.fire("far",this._state.far))}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get inverseMatrix(){return this._updateScheduled&&this._doUpdate(),this._inverseMatrixDirty&&(o.math.inverseMat4(this._state.matrix,this._state.inverseMatrix),this._inverseMatrixDirty=!1),this._state.inverseMatrix}get transposedMatrix(){return this._updateScheduled&&this._doUpdate(),this._transposedMatrixDirty&&(o.math.transposeMat4(this._state.matrix,this._state.transposedMatrix),this._transposedMatrixDirty=!1),this._state.transposedMatrix}unproject(e,t,i,r,n){const s=this.scene.canvas.canvas,a=s.offsetWidth/2,l=s.offsetHeight/2;return i[0]=(e[0]-a)/a,i[1]=(e[1]-l)/l,i[2]=t,i[3]=1,o.math.mulMat4v4(this.inverseMatrix,i,r),o.math.mulVec3Scalar(r,1/r[3]),r[3]=1,r[1]*=-1,o.math.mulMat4v4(this.camera.inverseViewMatrix,r,n),n}destroy(){super.destroy(),this._state.destroy(),this.scene.canvas.off(this._onCanvasBoundary)}}class k extends s.a{get type(){return"Frustum"}constructor(e,t={}){super(e,t),this.camera=e,this._state=new P.a({matrix:o.math.mat4(),inverseMatrix:o.math.mat4(),transposedMatrix:o.math.mat4(),near:.1,far:1e4}),this._left=-1,this._right=1,this._bottom=-1,this._top=1,this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.left=t.left,this.right=t.right,this.bottom=t.bottom,this.top=t.top,this.near=t.near,this.far=t.far}_update(){o.math.frustumMat4(this._left,this._right,this._bottom,this._top,this._state.near,this._state.far,this._state.matrix),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.glRedraw(),this.fire("matrix",this._state.matrix)}set left(e){this._left=null!=e?e:-1,this._needUpdate(0),this.fire("left",this._left)}get left(){return this._left}set right(e){this._right=null!=e?e:1,this._needUpdate(0),this.fire("right",this._right)}get right(){return this._right}set top(e){this._top=null!=e?e:1,this._needUpdate(0),this.fire("top",this._top)}get top(){return this._top}set bottom(e){this._bottom=null!=e?e:-1,this._needUpdate(0),this.fire("bottom",this._bottom)}get bottom(){return this._bottom}set near(e){this._state.near=null!=e?e:.1,this._needUpdate(0),this.fire("near",this._state.near)}get near(){return this._state.near}set far(e){this._state.far=null!=e?e:1e4,this._needUpdate(0),this.fire("far",this._state.far)}get far(){return this._state.far}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get inverseMatrix(){return this._updateScheduled&&this._doUpdate(),this._inverseMatrixDirty&&(o.math.inverseMat4(this._state.matrix,this._state.inverseMatrix),this._inverseMatrixDirty=!1),this._state.inverseMatrix}get transposedMatrix(){return this._updateScheduled&&this._doUpdate(),this._transposedMatrixDirty&&(o.math.transposeMat4(this._state.matrix,this._state.transposedMatrix),this._transposedMatrixDirty=!1),this._state.transposedMatrix}unproject(e,t,i,r,n){const s=this.scene.canvas.canvas,a=s.offsetWidth/2,l=s.offsetHeight/2;return i[0]=(e[0]-a)/a,i[1]=(e[1]-l)/l,i[2]=t,i[3]=1,o.math.mulMat4v4(this.inverseMatrix,i,r),o.math.mulVec3Scalar(r,1/r[3]),r[3]=1,r[1]*=-1,o.math.mulMat4v4(this.camera.inverseViewMatrix,r,n),n}destroy(){super.destroy(),this._state.destroy(),super.destroy()}}class O extends s.a{get type(){return"CustomProjection"}constructor(e,t={}){super(e,t),this.camera=e,this._state=new P.a({matrix:o.math.mat4(),inverseMatrix:o.math.mat4(),transposedMatrix:o.math.mat4()}),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!1,this.matrix=t.matrix}set matrix(e){this._state.matrix.set(e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._inverseMatrixDirty=!0,this._transposedMatrixDirty=!0,this.glRedraw(),this.fire("far",this._state.matrix)}get matrix(){return this._state.matrix}get inverseMatrix(){return this._updateScheduled&&this._doUpdate(),this._inverseMatrixDirty&&(o.math.inverseMat4(this._state.matrix,this._state.inverseMatrix),this._inverseMatrixDirty=!1),this._state.inverseMatrix}get transposedMatrix(){return this._updateScheduled&&this._doUpdate(),this._transposedMatrixDirty&&(o.math.transposeMat4(this._state.matrix,this._state.transposedMatrix),this._transposedMatrixDirty=!1),this._state.transposedMatrix}unproject(e,t,i,r,n){const s=this.scene.canvas.canvas,a=s.offsetWidth/2,l=s.offsetHeight/2;return i[0]=(e[0]-a)/a,i[1]=(e[1]-l)/l,i[2]=t,i[3]=1,o.math.mulMat4v4(this.inverseMatrix,i,r),o.math.mulVec3Scalar(r,1/r[3]),r[3]=1,r[1]*=-1,o.math.mulMat4v4(this.camera.inverseViewMatrix,r,n),n}destroy(){super.destroy(),this._state.destroy()}}const A=o.math.vec3(),T=o.math.vec3(),D=o.math.vec3(),R=o.math.vec3(),L=o.math.vec3(),B=o.math.vec3(),I=o.math.mat4(),N=o.math.mat4(),j=o.math.vec3(),F=o.math.vec3(),z=o.math.vec3(),V=o.math.vec3();class U extends s.a{get type(){return"Camera"}constructor(e,t={}){super(e,t),this._state=new P.a({deviceMatrix:o.math.mat4(),hasDeviceMatrix:!1,matrix:o.math.mat4(),normalMatrix:o.math.mat4(),inverseMatrix:o.math.mat4()}),this._perspective=new S(this),this._ortho=new C(this),this._frustum=new k(this),this._customProjection=new O(this),this._project=this._perspective,this._eye=o.math.vec3([0,0,10]),this._look=o.math.vec3([0,0,0]),this._up=o.math.vec3([0,1,0]),this._worldUp=o.math.vec3([0,1,0]),this._worldRight=o.math.vec3([1,0,0]),this._worldForward=o.math.vec3([0,0,-1]),this.deviceMatrix=t.deviceMatrix,this.eye=t.eye,this.look=t.look,this.up=t.up,this.worldAxis=t.worldAxis,this.gimbalLock=t.gimbalLock,this.constrainPitch=t.constrainPitch,this.projection=t.projection,this._perspective.on("matrix",()=>{"perspective"===this._projectionType&&this.fire("projMatrix",this._perspective.matrix)}),this._ortho.on("matrix",()=>{"ortho"===this._projectionType&&this.fire("projMatrix",this._ortho.matrix)}),this._frustum.on("matrix",()=>{"frustum"===this._projectionType&&this.fire("projMatrix",this._frustum.matrix)}),this._customProjection.on("matrix",()=>{"customProjection"===this._projectionType&&this.fire("projMatrix",this._customProjection.matrix)})}_update(){const e=this._state;let t;"ortho"===this.projection?(o.math.subVec3(this._eye,this._look,j),o.math.normalizeVec3(j,F),o.math.mulVec3Scalar(F,1e3,z),o.math.addVec3(this._look,z,V),t=V):t=this._eye,e.hasDeviceMatrix?(o.math.lookAtMat4v(t,this._look,this._up,N),o.math.mulMat4(e.deviceMatrix,N,e.matrix)):o.math.lookAtMat4v(t,this._look,this._up,e.matrix),o.math.inverseMat4(this._state.matrix,this._state.inverseMatrix),o.math.transposeMat4(this._state.inverseMatrix,this._state.normalMatrix),this.glRedraw(),this.fire("matrix",this._state.matrix),this.fire("viewMatrix",this._state.matrix)}orbitYaw(e){let t=o.math.subVec3(this._eye,this._look,A);o.math.rotationMat4v(.0174532925*e,this._gimbalLock?this._worldUp:this._up,I),t=o.math.transformPoint3(I,t,T),this.eye=o.math.addVec3(this._look,t,D),this.up=o.math.transformPoint3(I,this._up,R)}orbitPitch(e){if(this._constrainPitch&&(e=o.math.dotVec3(this._up,this._worldUp)/o.math.DEGTORAD)<1)return;let t=o.math.subVec3(this._eye,this._look,A);const i=o.math.cross3Vec3(o.math.normalizeVec3(t,T),o.math.normalizeVec3(this._up,D));o.math.rotationMat4v(.0174532925*e,i,I),t=o.math.transformPoint3(I,t,R),this.up=o.math.transformPoint3(I,this._up,L),this.eye=o.math.addVec3(t,this._look,B)}yaw(e){let t=o.math.subVec3(this._look,this._eye,A);o.math.rotationMat4v(.0174532925*e,this._gimbalLock?this._worldUp:this._up,I),t=o.math.transformPoint3(I,t,T),this.look=o.math.addVec3(t,this._eye,D),this._gimbalLock&&(this.up=o.math.transformPoint3(I,this._up,R))}pitch(e){if(this._constrainPitch&&(e=o.math.dotVec3(this._up,this._worldUp)/o.math.DEGTORAD)<1)return;let t=o.math.subVec3(this._look,this._eye,A);const i=o.math.cross3Vec3(o.math.normalizeVec3(t,T),o.math.normalizeVec3(this._up,D));o.math.rotationMat4v(.0174532925*e,i,I),this.up=o.math.transformPoint3(I,this._up,B),t=o.math.transformPoint3(I,t,R),this.look=o.math.addVec3(t,this._eye,L)}pan(e){const t=o.math.subVec3(this._eye,this._look,A),i=[0,0,0];let r;if(0!==e[0]){const n=o.math.cross3Vec3(o.math.normalizeVec3(t,[]),o.math.normalizeVec3(this._up,T));r=o.math.mulVec3Scalar(n,e[0]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]}0!==e[1]&&(r=o.math.mulVec3Scalar(o.math.normalizeVec3(this._up,D),e[1]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]),0!==e[2]&&(r=o.math.mulVec3Scalar(o.math.normalizeVec3(t,R),e[2]),i[0]+=r[0],i[1]+=r[1],i[2]+=r[2]),this.eye=o.math.addVec3(this._eye,i,L),this.look=o.math.addVec3(this._look,i,B)}zoom(e){const t=o.math.subVec3(this._eye,this._look,A),i=Math.abs(o.math.lenVec3(t,T)),r=Math.abs(i+e);if(r<.5)return;const n=o.math.normalizeVec3(t,D);this.eye=o.math.addVec3(this._look,o.math.mulVec3Scalar(n,r),R)}set eye(e){this._eye.set(e||[0,0,10]),this._needUpdate(0),this.fire("eye",this._eye)}get eye(){return this._eye}set look(e){this._look.set(e||[0,0,0]),this._needUpdate(0),this.fire("look",this._look)}get look(){return this._look}set up(e){this._up.set(e||[0,1,0]),this._needUpdate(0),this.fire("up",this._up)}get up(){return this._up}set deviceMatrix(e){this._state.deviceMatrix.set(e||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._state.hasDeviceMatrix=!!e,this._needUpdate(0),this.fire("deviceMatrix",this._state.deviceMatrix)}get deviceMatrix(){return this._state.deviceMatrix}set worldAxis(e){e=e||[1,0,0,0,1,0,0,0,1],this._worldAxis?this._worldAxis.set(e):this._worldAxis=o.math.vec3(e),this._worldRight[0]=this._worldAxis[0],this._worldRight[1]=this._worldAxis[1],this._worldRight[2]=this._worldAxis[2],this._worldUp[0]=this._worldAxis[3],this._worldUp[1]=this._worldAxis[4],this._worldUp[2]=this._worldAxis[5],this._worldForward[0]=this._worldAxis[6],this._worldForward[1]=this._worldAxis[7],this._worldForward[2]=this._worldAxis[8],this.fire("worldAxis",this._worldAxis)}get worldAxis(){return this._worldAxis}get worldUp(){return this._worldUp}get xUp(){return this._worldUp[0]>this._worldUp[1]&&this._worldUp[0]>this._worldUp[2]}get yUp(){return this._worldUp[1]>this._worldUp[0]&&this._worldUp[1]>this._worldUp[2]}get zUp(){return this._worldUp[2]>this._worldUp[0]&&this._worldUp[2]>this._worldUp[1]}get worldRight(){return this._worldRight}get worldForward(){return this._worldForward}set gimbalLock(e){this._gimbalLock=!1!==e,this.fire("gimbalLock",this._gimbalLock)}get gimbalLock(){return this._gimbalLock}set constrainPitch(e){this._constrainPitch=!!e,this.fire("constrainPitch",this._constrainPitch)}get eyeLookDist(){return o.math.lenVec3(o.math.subVec3(this._look,this._eye,A))}get matrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get viewMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.matrix}get normalMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.normalMatrix}get viewNormalMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.normalMatrix}get inverseViewMatrix(){return this._updateScheduled&&this._doUpdate(),this._state.inverseMatrix}get projMatrix(){return this[this.projection].matrix}get perspective(){return this._perspective}get ortho(){return this._ortho}get frustum(){return this._frustum}get customProjection(){return this._customProjection}set projection(e){e=e||"perspective",this._projectionType!==e&&("perspective"===e?this._project=this._perspective:"ortho"===e?this._project=this._ortho:"frustum"===e?this._project=this._frustum:"customProjection"===e?this._project=this._customProjection:(this.error("Unsupported value for 'projection': "+e+" defaulting to 'perspective'"),this._project=this._perspective,e="perspective"),this._project._update(),this._projectionType=e,this.glRedraw(),this._update(),this.fire("dirty"),this.fire("projection",this._projectionType),this.fire("projMatrix",this._project.matrix))}get projection(){return this._projectionType}get project(){return this._project}destroy(){super.destroy(),this._state.destroy()}}var W=i(38),H=i(129),G=i(26),X=i(95),Y=i(29),$=i(30),q=i(96);const K={meters:{abbrev:"m"},metres:{abbrev:"m"},centimeters:{abbrev:"cm"},centimetres:{abbrev:"cm"},millimeters:{abbrev:"mm"},millimetres:{abbrev:"mm"},yards:{abbrev:"yd"},feet:{abbrev:"ft"},inches:{abbrev:"in"}};class Z extends s.a{constructor(e,t={}){super(e,t),this._units="meters",this._scale=1,this._origin=o.math.vec3([0,0,0]),this.units=t.units,this.scale=t.scale,this.origin=t.origin}get unitsInfo(){return K}set units(e){e||(e="meters"),K[e]||(this.error("Unsupported value for 'units': "+e+" defaulting to 'meters'"),e="meters"),this._units=e,this.fire("units",this._units)}get units(){return this._units}set scale(e){(e=e||1)<=0?this.error("scale value should be larger than zero"):(this._scale=e,this.fire("scale",this._scale))}get scale(){return this._scale}set origin(e){if(!e)return this._origin[0]=0,this._origin[1]=0,void(this._origin[2]=0);this._origin[0]=e[0],this._origin[1]=e[1],this._origin[2]=e[2],this.fire("origin",this._origin)}get origin(){return this._origin}worldToRealPos(e,t=o.math.vec3(3)){t[0]=this._origin[0]+this._scale*e[0],t[1]=this._origin[1]+this._scale*e[1],t[2]=this._origin[2]+this._scale*e[2]}realToWorldPos(e,t=o.math.vec3(3)){return t[0]=(e[0]-this._origin[0])/this._scale,t[1]=(e[1]-this._origin[1])/this._scale,t[2]=(e[2]-this._origin[2])/this._scale,t}}class Q extends s.a{constructor(e,t={}){super(e,t),this._supported=c.a.SUPPORTED_EXTENSIONS.OES_standard_derivatives,this.enabled=t.enabled,this.kernelRadius=t.kernelRadius,this.intensity=t.intensity,this.bias=t.bias,this.scale=t.scale,this.minResolution=t.minResolution,this.blur=t.blur,this.blendCutoff=t.blendCutoff,this.blendFactor=t.blendFactor}get supported(){return this._supported}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.scene._needRecompile=!0,this.glRedraw())}get enabled(){return this._enabled}get possible(){if(!this._supported)return!1;if(!this._enabled)return!1;const e=this.scene.camera.projection;return"customProjection"!==e&&"frustum"!==e}get active(){return this._active}set kernelRadius(e){null!=e||(e=100),this._kernelRadius!==e&&(this._kernelRadius=e,this.glRedraw())}get kernelRadius(){return this._kernelRadius}set intensity(e){null!=e||(e=.2),this._intensity!==e&&(this._intensity=e,this.glRedraw())}get intensity(){return this._intensity}set bias(e){null!=e||(e=.5),this._bias!==e&&(this._bias=e,this.glRedraw())}get bias(){return this._bias}set scale(e){null!=e||(e=500),this._scale!==e&&(this._scale=e,this.glRedraw())}get scale(){return this._scale}set minResolution(e){null!=e||(e=0),this._minResolution!==e&&(this._minResolution=e,this.glRedraw())}get minResolution(){return this._minResolution}set blur(e){e=!1!==e,this._blur!==e&&(this._blur=e,this.glRedraw())}get blur(){return this._blur}set blendCutoff(e){null!=e||(e=.2),this._blendCutoff!==e&&(this._blendCutoff=e,this.glRedraw())}get blendCutoff(){return this._blendCutoff}set blendFactor(e){null!=e||(e=1),this._blendFactor!==e&&(this._blendFactor=e,this.glRedraw())}get blendFactor(){return this._blendFactor}destroy(){super.destroy()}}function J(e,t){const i={};let r,n;for(let o=0,s=t.length;o<s;o++)r=t[o],(n=e.component[r])?n.isEntity?i[r]=!0:e.warn("pick(): Component is not an Entity: "+r):e.warn("pick(): Component not found: "+r);return i}class ee extends s.a{get type(){return"Scene"}constructor(e,t={}){super(null,t);const i=t.canvasElement||document.getElementById(t.canvasId);if(!(i instanceof HTMLCanvasElement))throw"Mandatory config expected: valid canvasId or canvasElement";const n=!!t.transparent,s=!!t.alphaDepthMask;this._aabbDirty=!0,this.viewer=e,this.occlusionTestCountdown=0,this.loading=0,this.startTime=(new Date).getTime(),this.models={},this.objects={},this._numObjects=0,this.visibleObjects={},this._numVisibleObjects=0,this.xrayedObjects={},this._numXRayedObjects=0,this.highlightedObjects={},this._numHighlightedObjects=0,this.selectedObjects={},this._numSelectedObjects=0,this.colorizedObjects={},this._numColorizedObjects=0,this.opacityObjects={},this._numOpacityObjects=0,this.offsetObjects={},this._numOffsetObjects=0,this._modelIds=null,this._objectIds=null,this._visibleObjectIds=null,this._xrayedObjectIds=null,this._highlightedObjectIds=null,this._selectedObjectIds=null,this._colorizedObjectIds=null,this._opacityObjectIds=null,this._offsetObjectIds=null,this._collidables={},this._compilables={},this._needRecompile=!1,this.types={},this.components={},this.sectionPlanes={},this.lights={},this.lightMaps={},this.reflectionMaps={},this.realWorldOffset=t.realWorldOffset||new Float64Array([0,0,0]),this.canvas=new h(this,{dontClear:!0,canvas:i,spinnerElementId:t.spinnerElementId,transparent:n,backgroundColor:t.backgroundColor,webgl2:!1!==t.webgl2,contextAttr:t.contextAttr||{},clearColorAmbient:t.clearColorAmbient,premultipliedAlpha:t.premultipliedAlpha}),this.canvas.on("boundary",()=>{this.glRedraw()}),this.canvas.on("webglContextFailed",()=>{alert("xeokit failed to find WebGL!")}),this._renderer=new w(this,{transparent:n,alphaDepthMask:s}),this._sectionPlanesState=new function(){this.sectionPlanes=[];let e=null;this.getHash=function(){if(e)return e;const t=this.sectionPlanes;if(0===t.length)return this.hash=";";let i;const r=[];for(let e=0,n=t.length;e<n;e++)i=t[e],r.push("cp");return r.push(";"),e=r.join("")},this.addSectionPlane=function(t){this.sectionPlanes.push(t),e=null},this.removeSectionPlane=function(t){for(let i=0,r=this.sectionPlanes.length;i<r;i++)if(this.sectionPlanes[i].id===t.id)return this.sectionPlanes.splice(i,1),void(e=null)}},this._lightsState=new function(){const e=o.math.vec3([0,0,0]),t=o.math.vec3();this.lights=[],this.reflectionMaps=[],this.lightMaps=[];let i=null,r=null;this.getHash=function(){if(i)return i;const e=[],t=this.lights;let r;for(let i=0,n=t.length;i<n;i++)r=t[i],e.push("/"),e.push(r.type),e.push("world"===r.space?"w":"v"),r.castsShadow&&e.push("sh");return this.lightMaps.length>0&&e.push("/lm"),this.reflectionMaps.length>0&&e.push("/rm"),e.push(";"),i=e.join("")},this.addLight=function(e){this.lights.push(e),r=null,i=null},this.removeLight=function(e){for(let t=0,n=this.lights.length;t<n;t++)if(this.lights[t].id===e.id)return this.lights.splice(t,1),r&&r.id===e.id&&(r=null),void(i=null)},this.addReflectionMap=function(e){this.reflectionMaps.push(e),i=null},this.removeReflectionMap=function(e){for(let t=0,r=this.reflectionMaps.length;t<r;t++)if(this.reflectionMaps[t].id===e.id)return this.reflectionMaps.splice(t,1),void(i=null)},this.addLightMap=function(e){this.lightMaps.push(e),i=null},this.removeLightMap=function(e){for(let t=0,r=this.lightMaps.length;t<r;t++)if(this.lightMaps[t].id===e.id)return this.lightMaps.splice(t,1),void(i=null)},this.getAmbientColor=function(){if(!r)for(let e=0,t=this.lights.length;e<t;e++){const t=this.lights[e];if("ambient"===t.type){r=t;break}}if(r){const e=r.color,i=r.intensity;return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}return e}},this.input=new M(this,{dontClear:!0,element:this.canvas.canvas}),this.metrics=new Z(this,{units:t.units,scale:t.scale,origin:t.origin}),this.sao=new Q(this,{enabled:t.saoEnabled}),this.ticksPerRender=t.ticksPerRender,this.ticksPerOcclusionTest=t.ticksPerOcclusionTest,this.passes=t.passes,this.clearEachPass=t.clearEachPass,this.gammaInput=t.gammaInput,this.gammaOutput=t.gammaOutput,this.gammaFactor=t.gammaFactor,this._entityOffsetsEnabled=!!t.entityOffsetsEnabled,this._logarithmicDepthBufferEnabled=!!t.logarithmicDepthBufferEnabled,r.a._addScene(this),this._initDefaults(),this._viewport=new E(this,{id:"default.viewport",autoBoundary:!0,dontClear:!0}),this._camera=new U(this,{id:"default.camera",dontClear:!0}),new H.AmbientLight(this,{color:[1,1,1],intensity:.9}),new W.DirLight(this,{dir:[.8,-1,-.8],color:[1,1,1],intensity:1,space:"view"}),this._camera.on("dirty",()=>{this._renderer.imageDirty()})}_initDefaults(){let e;e=this.geometry,e=this.material,e=this.xrayMaterial,e=this.edgeMaterial,e=this.selectedMaterial,e=this.highlightMaterial}_addComponent(e){if(e.id&&this.components[e.id]&&(this.error("Component "+n.utils.inQuotes(e.id)+" already exists in Scene - ignoring ID, will randomly-generate instead"),e.id=null),!e.id)for(void 0===window.nextID&&(window.nextID=0),e.id="__"+window.nextID++;this.components[e.id];)e.id=o.math.createUUID();this.components[e.id]=e;const t=e.type;let i=this.types[e.type];i||(i=this.types[t]={}),i[e.id]=e,e.compile&&(this._compilables[e.id]=e),e.isDrawable&&(this._renderer.addDrawable(e.id,e),this._collidables[e.id]=e)}_removeComponent(e){var t=e.id,i=e.type;delete this.components[t];const r=this.types[i];r&&(delete r[t],n.utils.isEmptyObject(r)&&delete this.types[i]),e.compile&&delete this._compilables[e.id],e.isDrawable&&(this._renderer.removeDrawable(e.id),delete this._collidables[e.id])}_sectionPlaneCreated(e){this.sectionPlanes[e.id]=e,this.scene._sectionPlanesState.addSectionPlane(e._state),this.scene.fire("sectionPlaneCreated",e,!0),this._needRecompile=!0}_lightCreated(e){this.lights[e.id]=e,this.scene._lightsState.addLight(e._state),this._needRecompile=!0}_lightMapCreated(e){this.lightMaps[e.id]=e,this.scene._lightsState.addLightMap(e._state),this._needRecompile=!0}_reflectionMapCreated(e){this.reflectionMaps[e.id]=e,this.scene._lightsState.addReflectionMap(e._state),this._needRecompile=!0}_sectionPlaneDestroyed(e){delete this.sectionPlanes[e.id],this.scene._sectionPlanesState.removeSectionPlane(e._state),this.scene.fire("sectionPlaneDestroyed",e,!0),this._needRecompile=!0}_lightDestroyed(e){delete this.lights[e.id],this.scene._lightsState.removeLight(e._state),this._needRecompile=!0}_lightMapDestroyed(e){delete this.lightMaps[e.id],this.scene._lightsState.removeLightMap(e._state),this._needRecompile=!0}_reflectionMapDestroyed(e){delete this.reflectionMaps[e.id],this.scene._lightsState.removeReflectionMap(e._state),this._needRecompile=!0}_registerModel(e){this.models[e.id]=e,this._modelIds=null}_deregisterModel(e){delete this.models[e.id],this._modelIds=null}_registerObject(e){this.objects[e.id]=e,this._numObjects++,this._objectIds=null}_deregisterObject(e){delete this.objects[e.id],this._numObjects--,this._objectIds=null}_objectVisibilityUpdated(e,t=!0){e.visible?(this.visibleObjects[e.id]=e,this._numVisibleObjects++):(delete this.visibleObjects[e.id],this._numVisibleObjects--),this._visibleObjectIds=null,t&&this.fire("objectVisibility",e,!0)}_objectXRayedUpdated(e){e.xrayed?(this.xrayedObjects[e.id]=e,this._numXRayedObjects++):(delete this.xrayedObjects[e.id],this._numXRayedObjects--),this._xrayedObjectIds=null}_objectHighlightedUpdated(e){e.highlighted?(this.highlightedObjects[e.id]=e,this._numHighlightedObjects++):(delete this.highlightedObjects[e.id],this._numHighlightedObjects--),this._highlightedObjectIds=null}_objectSelectedUpdated(e){e.selected?(this.selectedObjects[e.id]=e,this._numSelectedObjects++):(delete this.selectedObjects[e.id],this._numSelectedObjects--),this._selectedObjectIds=null}_objectColorizeUpdated(e,t){t?(this.colorizedObjects[e.id]=e,this._numColorizedObjects++):(delete this.colorizedObjects[e.id],this._numColorizedObjects--),this._colorizedObjectIds=null}_objectOpacityUpdated(e,t){t?(this.opacityObjects[e.id]=e,this._numOpacityObjects++):(delete this.opacityObjects[e.id],this._numOpacityObjects--),this._opacityObjectIds=null}_objectOffsetUpdated(e,t){!t||0===t[0]&&0===t[1]&&0===t[2]?(this.offsetObjects[e.id]=e,this._numOffsetObjects++):(delete this.offsetObjects[e.id],this._numOffsetObjects--),this._offsetObjectIds=null}_webglContextLost(){this.canvas.spinner.processes++;for(const e in this.components)if(this.components.hasOwnProperty(e)){const t=this.components[e];t._webglContextLost&&t._webglContextLost()}this._renderer.webglContextLost()}_webglContextRestored(){const e=this.canvas.gl;for(const t in this.components)if(this.components.hasOwnProperty(t)){const i=this.components[t];i._webglContextRestored&&i._webglContextRestored(e)}this._renderer.webglContextRestored(e),this.canvas.spinner.processes--}get entityOffsetsEnabled(){return this._entityOffsetsEnabled}get logarithmicDepthBufferEnabled(){return this._logarithmicDepthBufferEnabled}doOcclusionTest(){this._needRecompile&&(this._recompile(),this._needRecompile=!1),this._renderer.doOcclusionTest()}render(e){e&&r.a.runTasks();const t={sceneId:null,pass:0};this._needRecompile&&(this._recompile(),this._renderer.imageDirty(),this._needRecompile=!1),t.sceneId=this.id;const i=this._passes,n=this._clearEachPass;let o,s;for(o=0;o<i;o++)t.pass=o,this.fire("rendering",t,!0),s=n||0===o,this._renderer.render({pass:o,clear:s,force:e}),this.fire("rendered",t,!0);this._saveAmbientColor()}_recompile(){for(const e in this._compilables)this._compilables.hasOwnProperty(e)&&this._compilables[e].compile();this._renderer.shadowsDirty(),this.fire("compile",this,!0)}_saveAmbientColor(){const e=this.canvas;if(e.transparent||e.backgroundImage||e.backgroundColor)this._lastAmbientColor=null;else{const t=this._lightsState.getAmbientColor();this._lastAmbientColor&&this._lastAmbientColor[0]===t[0]&&this._lastAmbientColor[1]===t[1]&&this._lastAmbientColor[2]===t[2]&&this._lastAmbientColor[3]===t[3]||(e.backgroundColor=t,this._lastAmbientColor||(this._lastAmbientColor=o.math.vec4([0,0,0,1])),this._lastAmbientColor.set(t))}}get modelIds(){return this._modelIds||(this._modelIds=Object.keys(this.models)),this._modelIds}get numObjects(){return this._numObjects}get objectIds(){return this._objectIds||(this._objectIds=Object.keys(this.objects)),this._objectIds}get numVisibleObjects(){return this._numVisibleObjects}get visibleObjectIds(){return this._visibleObjectIds||(this._visibleObjectIds=Object.keys(this.visibleObjects)),this._visibleObjectIds}get numXRayedObjects(){return this._numXRayedObjects}get xrayedObjectIds(){return this._xrayedObjectIds||(this._xrayedObjectIds=Object.keys(this.xrayedObjects)),this._xrayedObjectIds}get numHighlightedObjects(){return this._numHighlightedObjects}get highlightedObjectIds(){return this._highlightedObjectIds||(this._highlightedObjectIds=Object.keys(this.highlightedObjects)),this._highlightedObjectIds}get numSelectedObjects(){return this._numSelectedObjects}get selectedObjectIds(){return this._selectedObjectIds||(this._selectedObjectIds=Object.keys(this.selectedObjects)),this._selectedObjectIds}get numColorizedObjects(){return this._numColorizedObjects}get colorizedObjectIds(){return this._colorizedObjectIds||(this._colorizedObjectIds=Object.keys(this.colorizedObjects)),this._colorizedObjectIds}get opacityObjectIds(){return this._opacityObjectIds||(this._opacityObjectIds=Object.keys(this.opacityObjects)),this._opacityObjectIds}get offsetObjectIds(){return this._offsetObjectIds||(this._offsetObjectIds=Object.keys(this.offsetObjects)),this._offsetObjectIds}set ticksPerRender(e){null==e?e=1:(!n.utils.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'ticksPerRender': '"+e+"' - should be an integer greater than zero."),e=1),e!==this._ticksPerRender&&(this._ticksPerRender=e)}get ticksPerRender(){return this._ticksPerRender}set ticksPerOcclusionTest(e){null==e?e=20:(!n.utils.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'ticksPerOcclusionTest': '"+e+"' - should be an integer greater than zero."),e=20),e!==this._ticksPerOcclusionTest&&(this._ticksPerOcclusionTest=e)}get ticksPerOcclusionTest(){return this._ticksPerOcclusionTest}set passes(e){null==e?e=1:(!n.utils.isNumeric(e)||e<=0)&&(this.error("Unsupported value for 'passes': '"+e+"' - should be an integer greater than zero."),e=1),e!==this._passes&&(this._passes=e,this.glRedraw())}get passes(){return this._passes}set clearEachPass(e){(e=!!e)!==this._clearEachPass&&(this._clearEachPass=e,this.glRedraw())}get clearEachPass(){return this._clearEachPass}set gammaInput(e){(e=!1!==e)!==this._renderer.gammaInput&&(this._renderer.gammaInput=e,this._needRecompile=!0)}get gammaInput(){return this._renderer.gammaInput}set gammaOutput(e){(e=!1!==e)!==this._renderer.gammaOutput&&(this._renderer.gammaOutput=e,this._needRecompile=!0)}get gammaOutput(){return this._renderer.gammaOutput}set gammaFactor(e){(e=null==e?2.2:e)!==this._renderer.gammaFactor&&(this._renderer.gammaFactor=e,this.glRedraw())}get gammaFactor(){return this._renderer.gammaFactor}get geometry(){return this.components["default.geometry"]||Object(X.a)(G.a,this,{id:"default.geometry",dontClear:!0})}get material(){return this.components["default.material"]||new Y.a(this,{id:"default.material",emissive:[.4,.4,.4],dontClear:!0})}get xrayMaterial(){return this.components["default.xrayMaterial"]||new $.a(this,{id:"default.xrayMaterial",preset:"sepia",dontClear:!0})}get highlightMaterial(){return this.components["default.highlightMaterial"]||new $.a(this,{id:"default.highlightMaterial",preset:"yellowHighlight",dontClear:!0})}get selectedMaterial(){return this.components["default.selectedMaterial"]||new $.a(this,{id:"default.selectedMaterial",preset:"greenSelected",dontClear:!0})}get edgeMaterial(){return this.components["default.edgeMaterial"]||new q.a(this,{id:"default.edgeMaterial",preset:"default",edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1,dontClear:!0})}get viewport(){return this._viewport}get camera(){return this._camera}get center(){if(this._aabbDirty||!this._center){this._center&&this._center||(this._center=o.math.vec3());const e=this.aabb;this._center[0]=(e[0]+e[3])/2,this._center[1]=(e[1]+e[4])/2,this._center[2]=(e[2]+e[5])/2}return this._center}get aabb(){if(this._aabbDirty){this._aabb||(this._aabb=o.math.AABB3());let e,t=o.math.MAX_DOUBLE,i=o.math.MAX_DOUBLE,r=o.math.MAX_DOUBLE,n=o.math.MIN_DOUBLE,s=o.math.MIN_DOUBLE,a=o.math.MIN_DOUBLE;const l=this._collidables;let c,u=!1;for(const o in l)if(l.hasOwnProperty(o)){if(!1===(c=l[o]).collidable)continue;(e=c.aabb)[0]<t&&(t=e[0]),e[1]<i&&(i=e[1]),e[2]<r&&(r=e[2]),e[3]>n&&(n=e[3]),e[4]>s&&(s=e[4]),e[5]>a&&(a=e[5]),u=!0}u||(t=-100,i=-100,r=-100,n=100,s=100,a=100),this._aabb[0]=t,this._aabb[1]=i,this._aabb[2]=r,this._aabb[3]=n,this._aabb[4]=s,this._aabb[5]=a,this._aabbDirty=!1}return this._aabb}_setAABBDirty(){this._aabbDirty=!0,this.fire("boundary")}pick(e,t){if(0===this.canvas.boundary[2]||0===this.canvas.boundary[3])return this.error("Picking not allowed while canvas has zero width or height"),null;(e=e||{}).pickSurface=e.pickSurface||e.rayPick,e.canvasPos||e.matrix||e.origin&&e.direction||this.warn("picking without canvasPos, matrix, or ray origin and direction");const i=e.includeEntities||e.include;i&&(e.includeEntityIds=J(this,i));const r=e.excludeEntities||e.exclude;return r&&(e.excludeEntityIds=J(this,r)),this._needRecompile&&(this._recompile(),this._renderer.imageDirty(),this._needRecompile=!1),(t=this._renderer.pick(e,t))?(t.entity&&t.entity.fire&&t.entity.fire("picked",t),t):void 0}clear(){var e;for(const t in this.components)this.components.hasOwnProperty(t)&&((e=this.components[t])._dontClear||e.destroy())}clearLights(){const e=Object.keys(this.lights);for(let t=0,i=e.length;t<i;t++)this.lights[e[t]].destroy()}clearSectionPlanes(){const e=Object.keys(this.sectionPlanes);for(let t=0,i=e.length;t<i;t++)this.sectionPlanes[e[t]].destroy()}getAABB(e){if(void 0===e)return this.aabb;if(n.utils.isString(e)){const t=this.objects[e];if(t&&t.aabb)return t.aabb;e=[e]}if(0===e.length)return this.aabb;let t,i=o.math.MAX_DOUBLE,r=o.math.MAX_DOUBLE,s=o.math.MAX_DOUBLE,a=o.math.MIN_DOUBLE,l=o.math.MIN_DOUBLE,c=o.math.MIN_DOUBLE;if(this.withObjects(e,e=>{if(e.collidable){const n=e.aabb;n[0]<i&&(i=n[0]),n[1]<r&&(r=n[1]),n[2]<s&&(s=n[2]),n[3]>a&&(a=n[3]),n[4]>l&&(l=n[4]),n[5]>c&&(c=n[5]),t=!0}}),t){const e=o.math.AABB3();return e[0]=i,e[1]=r,e[2]=s,e[3]=a,e[4]=l,e[5]=c,e}return this.aabb}setObjectsVisible(e,t){return this.withObjects(e,e=>{const i=e.visible!==t;return e.visible=t,i})}setObjectsCollidable(e,t){return this.withObjects(e,e=>{const i=e.collidable!==t;return e.collidable=t,i})}setObjectsCulled(e,t){return this.withObjects(e,this.objects,e=>{const i=e.culled!==t;return e.culled=t,i})}setObjectsSelected(e,t){return this.withObjects(e,e=>{const i=e.selected!==t;return e.selected=t,i})}setObjectsHighlighted(e,t){return this.withObjects(e,e=>{const i=e.highlighted!==t;return e.highlighted=t,i})}setObjectsXRayed(e,t){return this.withObjects(e,e=>{const i=e.xrayed!==t;return e.xrayed=t,i})}setObjectsEdges(e,t){return this.withObjects(e,e=>{const i=e.edges!==t;return e.edges=t,i})}setObjectsColorized(e,t){return this.withObjects(e,e=>{e.colorize=t})}setObjectsOpacity(e,t){return this.withObjects(e,e=>{const i=e.opacity!==t;return e.opacity=t,i})}setObjectsPickable(e,t){return this.withObjects(e,e=>{const i=e.pickable!==t;return e.pickable=t,i})}setObjectsOffset(e,t){this.withObjects(e,e=>{e.offset=t})}withObjects(e,t){n.utils.isString(e)&&(e=[e]);let i=!1;for(let r=0,n=e.length;r<n;r++){const n=e[r];let s=this.objects[n];if(s)i=t(s)||i;else{const e=this.modelIds;for(let r=0,a=e.length;r<a;r++){const a=e[r],l=o.math.globalizeObjectId(a,n);(s=this.objects[l])&&(i=t(s)||i)}}}return i}destroy(){super.destroy();for(const e in this.components)this.components.hasOwnProperty(e)&&this.components[e].destroy();this.canvas.gl=null,this.components=null,this.models=null,this.objects=null,this.visibleObjects=null,this.xrayedObjects=null,this.highlightedObjects=null,this.selectedObjects=null,this.colorizedObjects=null,this.opacityObjects=null,this.sectionPlanes=null,this.lights=null,this.lightMaps=null,this.reflectionMaps=null,this._objectIds=null,this._visibleObjectIds=null,this._xrayedObjectIds=null,this._highlightedObjectIds=null,this._selectedObjectIds=null,this._colorizedObjectIds=null,this.types=null,this.components=null,this.canvas=null,this._renderer=null,this.input=null,this._viewport=null,this._camera=null}}},,,,,function(e,t,i){"use strict";i.r(t),i.d(t,"ContextMenu",(function(){return a}));const r=new(i(24).Map);class n{constructor(e){this.id=e,this.parentItem=null,this.groups=[],this.menuElement=null,this.shown=!1,this.mouseOver=0}}class o{constructor(){this.items=[]}}class s{constructor(e,t,i,r){this.id=e,this.getTitle=t,this.doAction=i,this.getEnabled=r,this.itemElement=null,this.subMenu=null,this.enabled=!0}}class a{constructor(e={}){this._id=r.addItem(),this._context=null,this._enabled=!1,this._itemsCfg=[],this._rootMenu=null,this._menuList=[],this._menuMap={},this._itemList=[],this._itemMap={},this._shown=!1,this._nextId=0,this._eventSubs={},!1!==e.hideOnMouseDown&&document.addEventListener("mousedown",e=>{e.target.classList.contains("xeokit-context-menu-item")||this.hide()}),e.items&&(this.items=e.items),this.context=e.context,this.enabled=!1!==e.enabled,this.hide()}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}set items(e){this._clear(),this._itemsCfg=e||[],this._parseItems(e),this._createUI()}get items(){return this._itemsCfg}set enabled(e){(e=!!e)!==this._enabled&&(this._enabled=e,this._enabled||this.hide())}get enabled(){return this._enabled}set context(e){this._context=e}get context(){return this._context}show(e,t){this._context?this._enabled&&(this._shown||(this._hideAllMenus(),this._updateItemsTitles(),this._updateItemsEnabledStatus(),this._showMenu(this._rootMenu.id,e,t),this._shown=!0,this.fire("shown",{}))):console.error("ContextMenu cannot be shown without a context - set context first")}get shown(){return this._shown}hide(){this._enabled&&this._shown&&(this._hideAllMenus(),this._shown=!1,this.fire("hidden",{}))}destroy(){this._context=null,this._clear(),null!==this._id&&(r.removeItem(this._id),this._id=null)}_clear(){for(let e=0,t=this._menuList.length;e<t;e++){const t=this._menuList[e].menuElement;t.parentElement.removeChild(t)}this._itemsCfg=[],this._rootMenu=null,this._menuList=[],this._menuMap={},this._itemList=[],this._itemMap={}}_parseItems(e){const t=e=>{const i=this._getNextId(),r=new n(i);for(let i=0,n=e.length;i<n;i++){const n=e[i],a=new o;r.groups.push(a);for(let e=0,i=n.length;e<i;e++){const i=n[e],o=i.items,l=o&&o.length>0,c=this._getNextId(),u=i.getTitle||(()=>i.title||""),h=i.doAction||i.callback||(()=>{}),d=i.getEnabled||(()=>!0),p=new s(c,u,h,d);if(p.parentMenu=r,a.items.push(p),l){const e=t(o);p.subMenu=e,e.parentItem=p}this._itemList.push(p),this._itemMap[p.id]=p}}return this._menuList.push(r),this._menuMap[r.id]=r,r};this._rootMenu=t(e)}_getNextId(){return"ContextMenu_"+this._id+this._nextId++}_createUI(){const e=t=>{this._createMenuUI(t);const i=t.groups;for(let t=0,r=i.length;t<r;t++){const r=i[t].items;for(let t=0,i=r.length;t<i;t++){const i=r[t].subMenu;i&&e(i)}}};e(this._rootMenu)}_createMenuUI(e){const t=e.groups,i=[];if(i.push('<div class="xeokit-context-menu '+e.id+'" style="z-index:300000; position: absolute;">'),i.push("<ul>"),t)for(let e=0,r=t.length;e<r;e++){const n=e,o=r,s=t[e].items;if(s)for(let e=0,t=s.length;e<t;e++){const r=s[e],a=r.subMenu,l=r.title||"";a?i.push('<li id="'+r.id+'" class="xeokit-context-menu-item" style="'+(n===o-1||e<t-1?"border-bottom: 0":"border-bottom: 1px solid black")+'">'+l+" [MORE]</li>"):i.push('<li id="'+r.id+'" class="xeokit-context-menu-item" style="'+(n===o-1||e<t-1?"border-bottom: 0":"border-bottom: 1px solid black")+'">'+l+"</li>")}}i.push("</ul>"),i.push("</div>");const r=i.join("");document.body.insertAdjacentHTML("beforeend",r);const n=document.querySelector("."+e.id);e.menuElement=n,n.style["border-radius"]="4px",n.style.display="none",n.style["z-index"]=3e5,n.style.background="white",n.style.border="1px solid black",n.style["box-shadow"]="0 4px 5px 0 gray",n.oncontextmenu=e=>{e.preventDefault()};const o=this;let s=null;if(t)for(let e=0,i=t.length;e<i;e++){const i=t[e].items;if(i)for(let e=0,t=i.length;e<t;e++){const t=i[e],r=t.subMenu;t.itemElement=document.getElementById(t.id),t.itemElement?(t.itemElement.addEventListener("mouseenter",e=>{if(e.preventDefault(),!1===t.enabled)return;const i=t.subMenu;if(!i)return void(s&&(o._hideMenu(s.id),s=null));s&&s.id!==i.id&&(o._hideMenu(s.id),s=null);const r=t.itemElement,n=i.menuElement,a=r.getBoundingClientRect();n.getBoundingClientRect(),a.right+200>window.innerWidth?o._showMenu(i.id,a.left-200,a.top-1):o._showMenu(i.id,a.right-5,a.top-1),s=i}),r||(t.itemElement.addEventListener("click",e=>{e.preventDefault(),o.hide(),o._context&&!1!==t.enabled&&t.doAction&&t.doAction(o._context)}),t.itemElement.addEventListener("mouseenter",e=>{e.preventDefault(),!1!==t.enabled&&t.doHover&&t.doHover(o._context)}))):console.error("ContextMenu item element not found: "+t.id)}}}_updateItemsTitles(){if(this._context)for(let e=0,t=this._itemList.length;e<t;e++){const t=this._itemList[e],i=t.itemElement;if(!i)continue;const r=t.getTitle(this._context);t.subMenu,i.innerText=r}}_updateItemsEnabledStatus(){if(this._context)for(let e=0,t=this._itemList.length;e<t;e++){const t=this._itemList[e],i=t.itemElement;if(!i)continue;const r=t.getEnabled;if(!r)continue;const n=r(this._context);t.enabled=n,n?i.classList.remove("disabled"):i.classList.add("disabled")}}_showMenu(e,t,i){const r=this._menuMap[e];if(!r)return void console.error("Menu not found: "+e);if(r.shown)return;const n=r.menuElement;n&&(this._showMenuElement(n,t,i),r.shown=!0)}_hideMenu(e){const t=this._menuMap[e];if(!t)return void console.error("Menu not found: "+e);if(!t.shown)return;const i=t.menuElement;i&&(this._hideMenuElement(i),t.shown=!1)}_hideAllMenus(){for(let e=0,t=this._menuList.length;e<t;e++){const t=this._menuList[e];this._hideMenu(t.id)}}_showMenuElement(e,t,i){e.style.display="block";const r=e.offsetHeight,n=e.offsetWidth;i+r>window.innerHeight&&(i=window.innerHeight-r),t+n>window.innerWidth&&(t=window.innerWidth-n),e.style.left=t+"px",e.style.top=i+"px"}_hideMenuElement(e){e.style.display="none"}}},function(e,t,i){"use strict";i.r(t),i.d(t,"colors",(function(){return r})),i.d(t,"hexToRgb",(function(){return P.hexToRgb})),i.d(t,"rgbToHex",(function(){return P.rgbToHex})),i.d(t,"hslToRgb",(function(){return P.hslToRgb})),i.d(t,"decomposeColor",(function(){return P.decomposeColor})),i.d(t,"recomposeColor",(function(){return P.recomposeColor})),i.d(t,"getContrastRatio",(function(){return P.getContrastRatio})),i.d(t,"getLuminance",(function(){return P.getLuminance})),i.d(t,"emphasize",(function(){return P.emphasize})),i.d(t,"fade",(function(){return P.fade})),i.d(t,"darken",(function(){return P.darken})),i.d(t,"lighten",(function(){return P.lighten})),i.d(t,"createMuiTheme",(function(){return P.createMuiTheme})),i.d(t,"unstable_createMuiStrictModeTheme",(function(){return P.unstable_createMuiStrictModeTheme})),i.d(t,"createStyles",(function(){return P.createStyles})),i.d(t,"makeStyles",(function(){return P.makeStyles})),i.d(t,"responsiveFontSizes",(function(){return P.responsiveFontSizes})),i.d(t,"styled",(function(){return P.styled})),i.d(t,"easing",(function(){return P.easing})),i.d(t,"duration",(function(){return P.duration})),i.d(t,"useTheme",(function(){return P.useTheme})),i.d(t,"withStyles",(function(){return P.withStyles})),i.d(t,"withTheme",(function(){return P.withTheme})),i.d(t,"createGenerateClassName",(function(){return P.createGenerateClassName})),i.d(t,"jssPreset",(function(){return P.jssPreset})),i.d(t,"ServerStyleSheets",(function(){return P.ServerStyleSheets})),i.d(t,"StylesProvider",(function(){return P.StylesProvider})),i.d(t,"MuiThemeProvider",(function(){return P.MuiThemeProvider})),i.d(t,"ThemeProvider",(function(){return P.ThemeProvider})),i.d(t,"capitalize",(function(){return S})),i.d(t,"createChainedFunction",(function(){return C})),i.d(t,"createSvgIcon",(function(){return j})),i.d(t,"debounce",(function(){return F})),i.d(t,"deprecatedPropType",(function(){return z})),i.d(t,"isMuiElement",(function(){return V})),i.d(t,"ownerDocument",(function(){return U})),i.d(t,"ownerWindow",(function(){return W})),i.d(t,"requirePropFactory",(function(){return H})),i.d(t,"setRef",(function(){return G})),i.d(t,"unsupportedProp",(function(){return X})),i.d(t,"useControlled",(function(){return Y})),i.d(t,"useEventCallback",(function(){return q})),i.d(t,"useForkRef",(function(){return K})),i.d(t,"unstable_useId",(function(){return Z})),i.d(t,"useIsFocusVisible",(function(){return ce})),i.d(t,"Accordion",(function(){return Ie})),i.d(t,"AccordionActions",(function(){return je})),i.d(t,"AccordionDetails",(function(){return ze})),i.d(t,"AccordionSummary",(function(){return ot})),i.d(t,"AppBar",(function(){return at})),i.d(t,"Avatar",(function(){return ut})),i.d(t,"Backdrop",(function(){return mt})),i.d(t,"Badge",(function(){return vt})),i.d(t,"BottomNavigation",(function(){return _t})),i.d(t,"BottomNavigationAction",(function(){return xt})),i.d(t,"Box",(function(){return $t})),i.d(t,"styleFunction",(function(){return Yt})),i.d(t,"Breadcrumbs",(function(){return ti})),i.d(t,"Button",(function(){return ri})),i.d(t,"ButtonBase",(function(){return et})),i.d(t,"ButtonGroup",(function(){return oi})),i.d(t,"Card",(function(){return ai})),i.d(t,"CardActionArea",(function(){return ci})),i.d(t,"CardActions",(function(){return hi})),i.d(t,"CardContent",(function(){return pi})),i.d(t,"CardHeader",(function(){return mi})),i.d(t,"CardMedia",(function(){return bi})),i.d(t,"Checkbox",(function(){return Di})),i.d(t,"Chip",(function(){return Ii})),i.d(t,"CircularProgress",(function(){return ji})),i.d(t,"ClickAwayListener",(function(){return zi})),i.d(t,"Collapse",(function(){return Te})),i.d(t,"Container",(function(){return Ui})),i.d(t,"CssBaseline",(function(){return Hi})),i.d(t,"Dialog",(function(){return hr})),i.d(t,"DialogActions",(function(){return pr})),i.d(t,"DialogContent",(function(){return mr})),i.d(t,"DialogContentText",(function(){return vr})),i.d(t,"DialogTitle",(function(){return _r})),i.d(t,"Divider",(function(){return xr})),i.d(t,"Drawer",(function(){return Ar})),i.d(t,"ExpansionPanel",(function(){return Rr})),i.d(t,"ExpansionPanelActions",(function(){return Br})),i.d(t,"ExpansionPanelDetails",(function(){return Nr})),i.d(t,"ExpansionPanelSummary",(function(){return Fr})),i.d(t,"Fab",(function(){return Vr})),i.d(t,"Fade",(function(){return pt})),i.d(t,"FilledInput",(function(){return Jr})),i.d(t,"FormControl",(function(){return tn})),i.d(t,"useFormControl",(function(){return wi})),i.d(t,"FormControlLabel",(function(){return nn})),i.d(t,"FormGroup",(function(){return sn})),i.d(t,"FormHelperText",(function(){return ln})),i.d(t,"FormLabel",(function(){return un})),i.d(t,"Grid",(function(){return mn})),i.d(t,"GridList",(function(){return vn})),i.d(t,"GridListTile",(function(){return yn})),i.d(t,"GridListTileBar",(function(){return wn})),i.d(t,"Grow",(function(){return Sn})),i.d(t,"Hidden",(function(){return jn})),i.d(t,"Icon",(function(){return zn})),i.d(t,"IconButton",(function(){return rt})),i.d(t,"Input",(function(){return Un})),i.d(t,"InputAdornment",(function(){return Hn})),i.d(t,"InputBase",(function(){return Zr})),i.d(t,"InputLabel",(function(){return Xn})),i.d(t,"LinearProgress",(function(){return $n})),i.d(t,"Link",(function(){return Kn})),i.d(t,"List",(function(){return Jn})),i.d(t,"ListItem",(function(){return io})),i.d(t,"ListItemAvatar",(function(){return no})),i.d(t,"ListItemIcon",(function(){return so})),i.d(t,"ListItemSecondaryAction",(function(){return lo})),i.d(t,"ListItemText",(function(){return uo})),i.d(t,"ListSubheader",(function(){return po})),i.d(t,"Menu",(function(){return Oo})),i.d(t,"MenuItem",(function(){return To})),i.d(t,"MenuList",(function(){return Eo})),i.d(t,"MobileStepper",(function(){return Ro})),i.d(t,"Modal",(function(){return lr})),i.d(t,"ModalManager",(function(){return rr})),i.d(t,"NativeSelect",(function(){return Fo})),i.d(t,"NoSsr",(function(){return Vo})),i.d(t,"OutlinedInput",(function(){return Go})),i.d(t,"Paper",(function(){return Re})),i.d(t,"Popover",(function(){return _o})),i.d(t,"Popper",(function(){return Ko})),i.d(t,"Portal",(function(){return $i})),i.d(t,"Radio",(function(){return os})),i.d(t,"RadioGroup",(function(){return ss})),i.d(t,"useRadioGroup",(function(){return ts})),i.d(t,"RootRef",(function(){return us})),i.d(t,"Select",(function(){return bs})),i.d(t,"Slide",(function(){return Pr})),i.d(t,"Slider",(function(){return Ts})),i.d(t,"Snackbar",(function(){return Bs})),i.d(t,"SnackbarContent",(function(){return Rs})),i.d(t,"Step",(function(){return Ns})),i.d(t,"StepButton",(function(){return Xs})),i.d(t,"StepConnector",(function(){return $s})),i.d(t,"StepContent",(function(){return Ks})),i.d(t,"StepIcon",(function(){return Us})),i.d(t,"StepLabel",(function(){return Hs})),i.d(t,"Stepper",(function(){return Js})),i.d(t,"SvgIcon",(function(){return N})),i.d(t,"SwipeableDrawer",(function(){return ha})),i.d(t,"Switch",(function(){return pa})),i.d(t,"Tab",(function(){return ma})),i.d(t,"Table",(function(){return ba})),i.d(t,"TableBody",(function(){return wa})),i.d(t,"TableCell",(function(){return Pa})),i.d(t,"TableContainer",(function(){return Sa})),i.d(t,"TableFooter",(function(){return Oa})),i.d(t,"TableHead",(function(){return Da})),i.d(t,"TablePagination",(function(){return Ga})),i.d(t,"TableRow",(function(){return Ya})),i.d(t,"TableSortLabel",(function(){return Ka})),i.d(t,"Tabs",(function(){return cl})),i.d(t,"TabScrollButton",(function(){return al})),i.d(t,"TextField",(function(){return dl})),i.d(t,"TextareaAutosize",(function(){return Xr})),i.d(t,"Toolbar",(function(){return La})),i.d(t,"Tooltip",(function(){return bl})),i.d(t,"Typography",(function(){return Zt})),i.d(t,"Unstable_TrapFocus",(function(){return nr})),i.d(t,"useMediaQuery",(function(){return An})),i.d(t,"useScrollTrigger",(function(){return xl})),i.d(t,"withMobileDialog",(function(){return wl})),i.d(t,"withWidth",(function(){return Ln})),i.d(t,"isWidthUp",(function(){return Tn})),i.d(t,"isWidthDown",(function(){return Dn})),i.d(t,"Zoom",(function(){return El}));var r={};i.r(r),i.d(r,"common",(function(){return n.a})),i.d(r,"red",(function(){return o.a})),i.d(r,"pink",(function(){return s.a})),i.d(r,"purple",(function(){return a})),i.d(r,"deepPurple",(function(){return l})),i.d(r,"indigo",(function(){return c.a})),i.d(r,"blue",(function(){return u.a})),i.d(r,"lightBlue",(function(){return h})),i.d(r,"cyan",(function(){return d})),i.d(r,"teal",(function(){return p})),i.d(r,"green",(function(){return f.a})),i.d(r,"lightGreen",(function(){return m})),i.d(r,"lime",(function(){return g})),i.d(r,"yellow",(function(){return v})),i.d(r,"amber",(function(){return b})),i.d(r,"orange",(function(){return _.a})),i.d(r,"deepOrange",(function(){return y})),i.d(r,"brown",(function(){return x})),i.d(r,"grey",(function(){return w.a})),i.d(r,"blueGrey",(function(){return M}));var n=i(51),o=i(58),s=i(59),a={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},l={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",A100:"#b388ff",A200:"#7c4dff",A400:"#651fff",A700:"#6200ea"},c=i(60),u=i(61),h={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},d={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",A100:"#84ffff",A200:"#18ffff",A400:"#00e5ff",A700:"#00b8d4"},p={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",A100:"#a7ffeb",A200:"#64ffda",A400:"#1de9b6",A700:"#00bfa5"},f=i(62),m={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},g={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",A100:"#f4ff81",A200:"#eeff41",A400:"#c6ff00",A700:"#aeea00"},v={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",A100:"#ffff8d",A200:"#ffff00",A400:"#ffea00",A700:"#ffd600"},b={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",A100:"#ffe57f",A200:"#ffd740",A400:"#ffc400",A700:"#ffab00"},_=i(63),y={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",A100:"#ff9e80",A200:"#ff6e40",A400:"#ff3d00",A700:"#dd2c00"},x={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723",A100:"#d7ccc8",A200:"#bcaaa4",A400:"#8d6e63",A700:"#5d4037"},w=i(64),M={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238",A100:"#cfd8dc",A200:"#b0bec5",A400:"#78909c",A700:"#455a64"},P=i(44),E=i(258);function S(e){if("string"!=typeof e)throw new Error(Object(E.a)(7));return e.charAt(0).toUpperCase()+e.slice(1)}function C(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce((function(e,t){return null==t?e:function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];e.apply(this,r),t.apply(this,r)}}),(function(){}))}var k=i(2),O=i(1),A=i.n(O),T=i(4),D=i(6),R=i.n(D),L=i(3),B=i(5),I=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.color,s=void 0===o?"inherit":o,a=e.component,l=void 0===a?"svg":a,c=e.fontSize,u=void 0===c?"default":c,h=e.htmlColor,d=e.titleAccess,p=e.viewBox,f=void 0===p?"0 0 24 24":p,m=Object(T.a)(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return O.createElement(l,Object(k.a)({className:Object(L.a)(r.root,n,"inherit"!==s&&r["color".concat(S(s))],"default"!==u&&r["fontSize".concat(S(u))]),focusable:"false",viewBox:f,color:h,"aria-hidden":!d||void 0,role:d?"img":void 0,ref:t},m),i,d?O.createElement("title",null,d):null)}));I.muiName="SvgIcon";var N=Object(B.a)((function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}}),{name:"MuiSvgIcon"})(I);function j(e,t){var i=function(t,i){return A.a.createElement(N,Object(k.a)({ref:i},t),e)};return i.muiName=N.muiName,A.a.memo(A.a.forwardRef(i))}function F(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var s=this;clearTimeout(t),t=setTimeout((function(){e.apply(s,n)}),i)}return r.clear=function(){clearTimeout(t)},r}function z(e,t){return function(){return null}}function V(e,t){return O.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}function U(e){return e&&e.ownerDocument||document}function W(e){return U(e).defaultView||window}function H(e){return function(){return null}}function G(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function X(e,t,i,r,n){return null}function Y(e){var t=e.controlled,i=e.default,r=(e.name,e.state,O.useRef(void 0!==t).current),n=O.useState(i),o=n[0],s=n[1];return[r?t:o,O.useCallback((function(e){r||s(e)}),[])]}var $="undefined"!=typeof window?O.useLayoutEffect:O.useEffect;function q(e){var t=O.useRef(e);return $((function(){t.current=e})),O.useCallback((function(){return t.current.apply(void 0,arguments)}),[])}function K(e,t){return O.useMemo((function(){return null==e&&null==t?null:function(i){G(e,i),G(t,i)}}),[e,t])}function Z(e){var t=O.useState(e),i=t[0],r=t[1],n=e||i;return O.useEffect((function(){null==i&&r("mui-".concat(Math.round(1e5*Math.random())))}),[i]),n}var Q=i(19),J=i.n(Q),ee=!0,te=!1,ie=null,re={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function ne(e){e.metaKey||e.altKey||e.ctrlKey||(ee=!0)}function oe(){ee=!1}function se(){"hidden"===this.visibilityState&&te&&(ee=!0)}function ae(e){var t=e.target;try{return t.matches(":focus-visible")}catch(e){}return ee||function(e){var t=e.type,i=e.tagName;return!("INPUT"!==i||!re[t]||e.readOnly)||"TEXTAREA"===i&&!e.readOnly||!!e.isContentEditable}(t)}function le(){te=!0,window.clearTimeout(ie),ie=window.setTimeout((function(){te=!1}),100)}function ce(){return{isFocusVisible:ae,onBlurVisible:le,ref:O.useCallback((function(e){var t=Q.findDOMNode(e);null!=t&&function(e){e.addEventListener("keydown",ne,!0),e.addEventListener("mousedown",oe,!0),e.addEventListener("pointerdown",oe,!0),e.addEventListener("touchstart",oe,!0),e.addEventListener("visibilitychange",se,!0)}(t.ownerDocument)}),[])}}var ue=i(86),he=i(89),de=i(65),pe=i(87);function fe(e){return Object(ue.a)(e)||Object(he.a)(e)||Object(de.a)(e)||Object(pe.a)()}var me=i(23),ge=(i(37),i(46)),ve=i(52),be=A.a.createContext(null),_e="unmounted",ye="exited",xe="entering",we="entered",Me=function(e){function t(t,i){var r;r=e.call(this,t,i)||this;var n,o=i&&!i.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(n=ye,r.appearStatus=xe):n=we:n=t.unmountOnExit||t.mountOnEnter?_e:ye,r.state={status:n},r.nextCallback=null,r}Object(ve.a)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===_e?{status:ye}:null};var i=t.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var i=this.state.status;this.props.in?i!==xe&&i!==we&&(t=xe):i!==xe&&i!==we||(t="exiting")}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,i,r=this.props.timeout;return e=t=i=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,i=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:i}},i.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===xe?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===ye&&this.setState({status:_e})},i.performEnter=function(e){var t=this,i=this.props.enter,r=this.context?this.context.isMounting:e,n=this.props.nodeRef?[r]:[J.a.findDOMNode(this),r],o=n[0],s=n[1],a=this.getTimeouts(),l=r?a.appear:a.enter;e||i?(this.props.onEnter(o,s),this.safeSetState({status:xe},(function(){t.props.onEntering(o,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:we},(function(){t.props.onEntered(o,s)}))}))}))):this.safeSetState({status:we},(function(){t.props.onEntered(o)}))},i.performExit=function(){var e=this,t=this.props.exit,i=this.getTimeouts(),r=this.props.nodeRef?void 0:J.a.findDOMNode(this);t?(this.props.onExit(r),this.safeSetState({status:"exiting"},(function(){e.props.onExiting(r),e.onTransitionEnd(i.exit,(function(){e.safeSetState({status:ye},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:ye},(function(){e.props.onExited(r)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,i=!0;return this.nextCallback=function(r){i&&(i=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var i=this.props.nodeRef?this.props.nodeRef.current:J.a.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(i&&!r){if(this.props.addEndListener){var n=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],o=n[0],s=n[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===_e)return null;var t=this.props,i=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,Object(ge.a)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return A.a.createElement(be.Provider,{value:null},"function"==typeof i?i(e,r):A.a.cloneElement(A.a.Children.only(i),r))},t}(A.a.Component);function Pe(){}Me.contextType=be,Me.propTypes={},Me.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Pe,onEntering:Pe,onEntered:Pe,onExit:Pe,onExiting:Pe,onExited:Pe},Me.UNMOUNTED=_e,Me.EXITED=ye,Me.ENTERING=xe,Me.ENTERED=we,Me.EXITING="exiting";var Ee=Me,Se=i(22),Ce=function(e){return e.scrollTop};function ke(e,t){var i=e.timeout,r=e.style,n=void 0===r?{}:r;return{duration:n.transitionDuration||"number"==typeof i?i:i[t.mode]||0,delay:n.transitionDelay}}var Oe=i(18),Ae=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.collapsedHeight,s=void 0===o?"0px":o,a=e.component,l=void 0===a?"div":a,c=e.disableStrictModeCompat,u=void 0!==c&&c,h=e.in,d=e.onEnter,p=e.onEntered,f=e.onEntering,m=e.onExit,g=e.onExited,v=e.onExiting,b=e.style,_=e.timeout,y=void 0===_?Se.b.standard:_,x=e.TransitionComponent,w=void 0===x?Ee:x,M=Object(T.a)(e,["children","classes","className","collapsedHeight","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),P=Object(Oe.a)(),E=O.useRef(),S=O.useRef(null),C=O.useRef(),A="number"==typeof s?"".concat(s,"px"):s;O.useEffect((function(){return function(){clearTimeout(E.current)}}),[]);var D=P.unstable_strictMode&&!u,R=O.useRef(null),B=K(t,D?R:void 0),I=function(e){return function(t,i){if(e){var r=D?[R.current,t]:[t,i],n=Object(me.a)(r,2),o=n[0],s=n[1];void 0===s?e(o):e(o,s)}}},N=I((function(e,t){e.style.height=A,d&&d(e,t)})),j=I((function(e,t){var i=S.current?S.current.clientHeight:0,r=ke({style:b,timeout:y},{mode:"enter"}).duration;if("auto"===y){var n=P.transitions.getAutoHeightDuration(i);e.style.transitionDuration="".concat(n,"ms"),C.current=n}else e.style.transitionDuration="string"==typeof r?r:"".concat(r,"ms");e.style.height="".concat(i,"px"),f&&f(e,t)})),F=I((function(e,t){e.style.height="auto",p&&p(e,t)})),z=I((function(e){var t=S.current?S.current.clientHeight:0;e.style.height="".concat(t,"px"),m&&m(e)})),V=I(g),U=I((function(e){var t=S.current?S.current.clientHeight:0,i=ke({style:b,timeout:y},{mode:"exit"}).duration;if("auto"===y){var r=P.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(r,"ms"),C.current=r}else e.style.transitionDuration="string"==typeof i?i:"".concat(i,"ms");e.style.height=A,v&&v(e)}));return O.createElement(w,Object(k.a)({in:h,onEnter:N,onEntered:F,onEntering:j,onExit:z,onExited:V,onExiting:U,addEndListener:function(e,t){var i=D?e:t;"auto"===y&&(E.current=setTimeout(i,C.current||0))},nodeRef:D?R:void 0,timeout:"auto"===y?null:y},M),(function(e,t){return O.createElement(l,Object(k.a)({className:Object(L.a)(r.container,n,{entered:r.entered,exited:!h&&"0px"===A&&r.hidden}[e]),style:Object(k.a)({minHeight:A},b),ref:B},t),O.createElement("div",{className:r.wrapper,ref:S},O.createElement("div",{className:r.wrapperInner},i)))}))}));Ae.muiSupportAuto=!0;var Te=Object(B.a)((function(e){return{container:{height:0,overflow:"hidden",transition:e.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}}),{name:"MuiCollapse"})(Ae),De=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"div":n,s=e.square,a=void 0!==s&&s,l=e.elevation,c=void 0===l?1:l,u=e.variant,h=void 0===u?"elevation":u,d=Object(T.a)(e,["classes","className","component","square","elevation","variant"]);return O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r,"outlined"===h?i.outlined:i["elevation".concat(c)],!a&&i.rounded),ref:t},d))})),Re=Object(B.a)((function(e){var t={};return e.shadows.forEach((function(e,i){t["elevation".concat(i)]={boxShadow:e}})),Object(k.a)({root:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary,transition:e.transitions.create("box-shadow")},rounded:{borderRadius:e.shape.borderRadius},outlined:{border:"1px solid ".concat(e.palette.divider)}},t)}),{name:"MuiPaper"})(De),Le=O.createContext({}),Be=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.defaultExpanded,s=void 0!==o&&o,a=e.disabled,l=void 0!==a&&a,c=e.expanded,u=e.onChange,h=e.square,d=void 0!==h&&h,p=e.TransitionComponent,f=void 0===p?Te:p,m=e.TransitionProps,g=Object(T.a)(e,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),v=Y({controlled:c,default:s,name:"Accordion",state:"expanded"}),b=Object(me.a)(v,2),_=b[0],y=b[1],x=O.useCallback((function(e){y(!_),u&&u(e,!_)}),[_,u,y]),w=fe(O.Children.toArray(i)),M=w[0],P=w.slice(1),E=O.useMemo((function(){return{expanded:_,disabled:l,toggle:x}}),[_,l,x]);return O.createElement(Re,Object(k.a)({className:Object(L.a)(r.root,n,_&&r.expanded,l&&r.disabled,!d&&r.rounded),ref:t,square:d},g),O.createElement(Le.Provider,{value:E},M),O.createElement(f,Object(k.a)({in:_,timeout:"auto"},m),O.createElement("div",{"aria-labelledby":M.props.id,id:M.props["aria-controls"],role:"region"},P)))})),Ie=Object(B.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{position:"relative",transition:e.transitions.create(["margin"],t),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:e.palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:e.shape.borderRadius,borderBottomRightRadius:e.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}}),{name:"MuiAccordion"})(Be),Ne=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.disableSpacing,o=void 0!==n&&n,s=Object(T.a)(e,["classes","className","disableSpacing"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,!o&&i.spacing),ref:t},s))})),je=Object(B.a)({root:{display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end"},spacing:{"& > :not(:first-child)":{marginLeft:8}}},{name:"MuiAccordionActions"})(Ne),Fe=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=Object(T.a)(e,["classes","className"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r),ref:t},n))})),ze=Object(B.a)((function(e){return{root:{display:"flex",padding:e.spacing(1,2,2)}}}),{name:"MuiAccordionDetails"})(Fe),Ve=i(25),Ue=i(53);function We(e,t){var i=Object.create(null);return e&&O.Children.map(e,(function(e){return e})).forEach((function(e){i[e.key]=function(e){return t&&Object(O.isValidElement)(e)?t(e):e}(e)})),i}function He(e,t,i){return null!=i[t]?i[t]:e.props[t]}function Ge(e,t,i){var r=We(e.children),n=function(e,t){function i(i){return i in t?t[i]:e[i]}e=e||{},t=t||{};var r,n=Object.create(null),o=[];for(var s in e)s in t?o.length&&(n[s]=o,o=[]):o.push(s);var a={};for(var l in t){if(n[l])for(r=0;r<n[l].length;r++){var c=n[l][r];a[n[l][r]]=i(c)}a[l]=i(l)}for(r=0;r<o.length;r++)a[o[r]]=i(o[r]);return a}(t,r);return Object.keys(n).forEach((function(o){var s=n[o];if(Object(O.isValidElement)(s)){var a=o in t,l=o in r,c=t[o],u=Object(O.isValidElement)(c)&&!c.props.in;!l||a&&!u?l||!a||u?l&&a&&Object(O.isValidElement)(c)&&(n[o]=Object(O.cloneElement)(s,{onExited:i.bind(null,s),in:c.props.in,exit:He(s,"exit",e),enter:He(s,"enter",e)})):n[o]=Object(O.cloneElement)(s,{in:!1}):n[o]=Object(O.cloneElement)(s,{onExited:i.bind(null,s),in:!0,exit:He(s,"exit",e),enter:He(s,"enter",e)})}})),n}var Xe=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Ye=function(e){function t(t,i){var r,n=(r=e.call(this,t,i)||this).handleExited.bind(Object(Ue.a)(r));return r.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},r}Object(ve.a)(t,e);var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var i=t.children,r=t.handleExited;return{children:t.firstRender?function(e,t){return We(e.children,(function(i){return Object(O.cloneElement)(i,{onExited:t.bind(null,i),in:!0,appear:He(i,"appear",e),enter:He(i,"enter",e),exit:He(i,"exit",e)})}))}(e,r):Ge(e,i,r),firstRender:!1}},i.handleExited=function(e,t){var i=We(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var i=Object(k.a)({},t.children);return delete i[e.key],{children:i}})))},i.render=function(){var e=this.props,t=e.component,i=e.childFactory,r=Object(ge.a)(e,["component","childFactory"]),n=this.state.contextValue,o=Xe(this.state.children).map(i);return delete r.appear,delete r.enter,delete r.exit,null===t?A.a.createElement(be.Provider,{value:n},o):A.a.createElement(be.Provider,{value:n},A.a.createElement(t,r,o))},t}(A.a.Component);Ye.propTypes={},Ye.defaultProps={component:"div",childFactory:function(e){return e}};var $e=Ye,qe="undefined"==typeof window?O.useEffect:O.useLayoutEffect,Ke=function(e){var t=e.classes,i=e.pulsate,r=void 0!==i&&i,n=e.rippleX,o=e.rippleY,s=e.rippleSize,a=e.in,l=e.onExited,c=void 0===l?function(){}:l,u=e.timeout,h=O.useState(!1),d=h[0],p=h[1],f=Object(L.a)(t.ripple,t.rippleVisible,r&&t.ripplePulsate),m={width:s,height:s,top:-s/2+o,left:-s/2+n},g=Object(L.a)(t.child,d&&t.childLeaving,r&&t.childPulsate),v=q(c);return qe((function(){if(!a){p(!0);var e=setTimeout(v,u);return function(){clearTimeout(e)}}}),[v,a,u]),O.createElement("span",{className:f,style:m},O.createElement("span",{className:g}))},Ze=O.forwardRef((function(e,t){var i=e.center,r=void 0!==i&&i,n=e.classes,o=e.className,s=Object(T.a)(e,["center","classes","className"]),a=O.useState([]),l=a[0],c=a[1],u=O.useRef(0),h=O.useRef(null);O.useEffect((function(){h.current&&(h.current(),h.current=null)}),[l]);var d=O.useRef(!1),p=O.useRef(null),f=O.useRef(null),m=O.useRef(null);O.useEffect((function(){return function(){clearTimeout(p.current)}}),[]);var g=O.useCallback((function(e){var t=e.pulsate,i=e.rippleX,r=e.rippleY,o=e.rippleSize,s=e.cb;c((function(e){return[].concat(Object(Ve.a)(e),[O.createElement(Ke,{key:u.current,classes:n,timeout:550,pulsate:t,rippleX:i,rippleY:r,rippleSize:o})])})),u.current+=1,h.current=s}),[n]),v=O.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=t.pulsate,o=void 0!==n&&n,s=t.center,a=void 0===s?r||t.pulsate:s,l=t.fakeElement,c=void 0!==l&&l;if("mousedown"===e.type&&d.current)d.current=!1;else{"touchstart"===e.type&&(d.current=!0);var u,h,v,b=c?null:m.current,_=b?b.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(a||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)u=Math.round(_.width/2),h=Math.round(_.height/2);else{var y=e.touches?e.touches[0]:e,x=y.clientX,w=y.clientY;u=Math.round(x-_.left),h=Math.round(w-_.top)}if(a)(v=Math.sqrt((2*Math.pow(_.width,2)+Math.pow(_.height,2))/3))%2==0&&(v+=1);else{var M=2*Math.max(Math.abs((b?b.clientWidth:0)-u),u)+2,P=2*Math.max(Math.abs((b?b.clientHeight:0)-h),h)+2;v=Math.sqrt(Math.pow(M,2)+Math.pow(P,2))}e.touches?null===f.current&&(f.current=function(){g({pulsate:o,rippleX:u,rippleY:h,rippleSize:v,cb:i})},p.current=setTimeout((function(){f.current&&(f.current(),f.current=null)}),80)):g({pulsate:o,rippleX:u,rippleY:h,rippleSize:v,cb:i})}}),[r,g]),b=O.useCallback((function(){v({},{pulsate:!0})}),[v]),_=O.useCallback((function(e,t){if(clearTimeout(p.current),"touchend"===e.type&&f.current)return e.persist(),f.current(),f.current=null,void(p.current=setTimeout((function(){_(e,t)})));f.current=null,c((function(e){return e.length>0?e.slice(1):e})),h.current=t}),[]);return O.useImperativeHandle(t,(function(){return{pulsate:b,start:v,stop:_}}),[b,v,_]),O.createElement("span",Object(k.a)({className:Object(L.a)(n.root,o),ref:m},s),O.createElement($e,{component:null,exit:!0},l))})),Qe=Object(B.a)((function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}}),{flip:!1,name:"MuiTouchRipple"})(O.memo(Ze)),Je=O.forwardRef((function(e,t){var i=e.action,r=e.buttonRef,n=e.centerRipple,o=void 0!==n&&n,s=e.children,a=e.classes,l=e.className,c=e.component,u=void 0===c?"button":c,h=e.disabled,d=void 0!==h&&h,p=e.disableRipple,f=void 0!==p&&p,m=e.disableTouchRipple,g=void 0!==m&&m,v=e.focusRipple,b=void 0!==v&&v,_=e.focusVisibleClassName,y=e.onBlur,x=e.onClick,w=e.onFocus,M=e.onFocusVisible,P=e.onKeyDown,E=e.onKeyUp,S=e.onMouseDown,C=e.onMouseLeave,A=e.onMouseUp,D=e.onTouchEnd,R=e.onTouchMove,B=e.onTouchStart,I=e.onDragLeave,N=e.tabIndex,j=void 0===N?0:N,F=e.TouchRippleProps,z=e.type,V=void 0===z?"button":z,U=Object(T.a)(e,["action","buttonRef","centerRipple","children","classes","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","onBlur","onClick","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","onDragLeave","tabIndex","TouchRippleProps","type"]),W=O.useRef(null),H=O.useRef(null),G=O.useState(!1),X=G[0],Y=G[1];d&&X&&Y(!1);var $=ce(),Z=$.isFocusVisible,J=$.onBlurVisible,ee=$.ref;function te(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;return q((function(r){return t&&t(r),!i&&H.current&&H.current[e](r),!0}))}O.useImperativeHandle(i,(function(){return{focusVisible:function(){Y(!0),W.current.focus()}}}),[]),O.useEffect((function(){X&&b&&!f&&H.current.pulsate()}),[f,b,X]);var ie=te("start",S),re=te("stop",I),ne=te("stop",A),oe=te("stop",(function(e){X&&e.preventDefault(),C&&C(e)})),se=te("start",B),ae=te("stop",D),le=te("stop",R),ue=te("stop",(function(e){X&&(J(e),Y(!1)),y&&y(e)}),!1),he=q((function(e){W.current||(W.current=e.currentTarget),Z(e)&&(Y(!0),M&&M(e)),w&&w(e)})),de=function(){var e=Q.findDOMNode(W.current);return u&&"button"!==u&&!("A"===e.tagName&&e.href)},pe=O.useRef(!1),fe=q((function(e){b&&!pe.current&&X&&H.current&&" "===e.key&&(pe.current=!0,e.persist(),H.current.stop(e,(function(){H.current.start(e)}))),e.target===e.currentTarget&&de()&&" "===e.key&&e.preventDefault(),P&&P(e),e.target===e.currentTarget&&de()&&"Enter"===e.key&&!d&&(e.preventDefault(),x&&x(e))})),me=q((function(e){b&&" "===e.key&&H.current&&X&&!e.defaultPrevented&&(pe.current=!1,e.persist(),H.current.stop(e,(function(){H.current.pulsate(e)}))),E&&E(e),x&&e.target===e.currentTarget&&de()&&" "===e.key&&!e.defaultPrevented&&x(e)})),ge=u;"button"===ge&&U.href&&(ge="a");var ve={};"button"===ge?(ve.type=V,ve.disabled=d):("a"===ge&&U.href||(ve.role="button"),ve["aria-disabled"]=d);var be=K(K(r,t),K(ee,W)),_e=O.useState(!1),ye=_e[0],xe=_e[1];O.useEffect((function(){xe(!0)}),[]);var we=ye&&!f&&!d;return O.createElement(ge,Object(k.a)({className:Object(L.a)(a.root,l,X&&[a.focusVisible,_],d&&a.disabled),onBlur:ue,onClick:x,onFocus:he,onKeyDown:fe,onKeyUp:me,onMouseDown:ie,onMouseLeave:oe,onMouseUp:ne,onDragLeave:re,onTouchEnd:ae,onTouchMove:le,onTouchStart:se,ref:be,tabIndex:d?-1:j},ve,U),s,we?O.createElement(Qe,Object(k.a)({ref:H,center:o},F)):null)})),et=Object(B.a)({root:{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},"&$disabled":{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}},disabled:{},focusVisible:{}},{name:"MuiButtonBase"})(Je),tt=i(10),it=O.forwardRef((function(e,t){var i=e.edge,r=void 0!==i&&i,n=e.children,o=e.classes,s=e.className,a=e.color,l=void 0===a?"default":a,c=e.disabled,u=void 0!==c&&c,h=e.disableFocusRipple,d=void 0!==h&&h,p=e.size,f=void 0===p?"medium":p,m=Object(T.a)(e,["edge","children","classes","className","color","disabled","disableFocusRipple","size"]);return O.createElement(et,Object(k.a)({className:Object(L.a)(o.root,s,"default"!==l&&o["color".concat(S(l))],u&&o.disabled,"small"===f&&o["size".concat(S(f))],{start:o.edgeStart,end:o.edgeEnd}[r]),centerRipple:!0,focusRipple:!d,disabled:u,ref:t},m),O.createElement("span",{className:o.label},n))})),rt=Object(B.a)((function(e){return{root:{textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:12,borderRadius:"50%",overflow:"visible",color:e.palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{backgroundColor:Object(tt.d)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{backgroundColor:"transparent",color:e.palette.action.disabled}},edgeStart:{marginLeft:-12,"$sizeSmall&":{marginLeft:-3}},edgeEnd:{marginRight:-12,"$sizeSmall&":{marginRight:-3}},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},colorSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},disabled:{},sizeSmall:{padding:3,fontSize:e.typography.pxToRem(18)},label:{width:"100%",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}}),{name:"MuiIconButton"})(it),nt=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.expandIcon,s=e.IconButtonProps,a=e.onBlur,l=e.onClick,c=e.onFocusVisible,u=Object(T.a)(e,["children","classes","className","expandIcon","IconButtonProps","onBlur","onClick","onFocusVisible"]),h=O.useState(!1),d=h[0],p=h[1],f=O.useContext(Le),m=f.disabled,g=void 0!==m&&m,v=f.expanded,b=f.toggle;return O.createElement(et,Object(k.a)({focusRipple:!1,disableRipple:!0,disabled:g,component:"div","aria-expanded":v,className:Object(L.a)(r.root,n,g&&r.disabled,v&&r.expanded,d&&r.focused),onFocusVisible:function(e){p(!0),c&&c(e)},onBlur:function(e){p(!1),a&&a(e)},onClick:function(e){b&&b(e),l&&l(e)},ref:t},u),O.createElement("div",{className:Object(L.a)(r.content,v&&r.expanded)},i),o&&O.createElement(rt,Object(k.a)({className:Object(L.a)(r.expandIcon,v&&r.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},s),o))})),ot=Object(B.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{display:"flex",minHeight:48,transition:e.transitions.create(["min-height","background-color"],t),padding:e.spacing(0,2),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused":{backgroundColor:e.palette.action.focus},"&$disabled":{opacity:e.palette.action.disabledOpacity}},expanded:{},focused:{},disabled:{},content:{display:"flex",flexGrow:1,transition:e.transitions.create(["margin"],t),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:e.transitions.create("transform",t),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}}),{name:"MuiAccordionSummary"})(nt),st=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"primary":n,s=e.position,a=void 0===s?"fixed":s,l=Object(T.a)(e,["classes","className","color","position"]);return O.createElement(Re,Object(k.a)({square:!0,component:"header",elevation:4,className:Object(L.a)(i.root,i["position".concat(S(a))],i["color".concat(S(o))],r,"fixed"===a&&"mui-fixed"),ref:t},l))})),at=Object(B.a)((function(e){var t="light"===e.palette.type?e.palette.grey[100]:e.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:e.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0,"@media print":{position:"absolute"}},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},positionRelative:{position:"relative"},colorDefault:{backgroundColor:t,color:e.palette.getContrastText(t)},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorInherit:{color:"inherit"},colorTransparent:{backgroundColor:"transparent",color:"inherit"}}}),{name:"MuiAppBar"})(st),lt=j(O.createElement("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})),ct=O.forwardRef((function(e,t){var i,r=e.alt,n=e.children,o=e.classes,s=e.className,a=e.component,l=void 0===a?"div":a,c=e.imgProps,u=e.sizes,h=e.src,d=e.srcSet,p=e.variant,f=void 0===p?"circle":p,m=Object(T.a)(e,["alt","children","classes","className","component","imgProps","sizes","src","srcSet","variant"]),g=function(e){var t=e.src,i=e.srcSet,r=O.useState(!1),n=r[0],o=r[1];return O.useEffect((function(){if(t||i){o(!1);var e=!0,r=new Image;return r.src=t,r.srcSet=i,r.onload=function(){e&&o("loaded")},r.onerror=function(){e&&o("error")},function(){e=!1}}}),[t,i]),n}({src:h,srcSet:d}),v=h||d,b=v&&"error"!==g;return i=b?O.createElement("img",Object(k.a)({alt:r,src:h,srcSet:d,sizes:u,className:o.img},c)):null!=n?n:v&&r?r[0]:O.createElement(lt,{className:o.fallback}),O.createElement(l,Object(k.a)({className:Object(L.a)(o.root,o.system,o[f],s,!b&&o.colorDefault),ref:t},m),i)})),ut=Object(B.a)((function(e){return{root:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},colorDefault:{color:e.palette.background.default,backgroundColor:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[600]},circle:{},circular:{},rounded:{borderRadius:e.shape.borderRadius},square:{borderRadius:0},img:{width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4},fallback:{width:"75%",height:"75%"}}}),{name:"MuiAvatar"})(ct),ht={entering:{opacity:1},entered:{opacity:1}},dt={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},pt=O.forwardRef((function(e,t){var i=e.children,r=e.disableStrictModeCompat,n=void 0!==r&&r,o=e.in,s=e.onEnter,a=e.onEntered,l=e.onEntering,c=e.onExit,u=e.onExited,h=e.onExiting,d=e.style,p=e.TransitionComponent,f=void 0===p?Ee:p,m=e.timeout,g=void 0===m?dt:m,v=Object(T.a)(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","TransitionComponent","timeout"]),b=Object(Oe.a)(),_=b.unstable_strictMode&&!n,y=O.useRef(null),x=K(i.ref,t),w=K(_?y:void 0,x),M=function(e){return function(t,i){if(e){var r=_?[y.current,t]:[t,i],n=Object(me.a)(r,2),o=n[0],s=n[1];void 0===s?e(o):e(o,s)}}},P=M(l),E=M((function(e,t){Ce(e);var i=ke({style:d,timeout:g},{mode:"enter"});e.style.webkitTransition=b.transitions.create("opacity",i),e.style.transition=b.transitions.create("opacity",i),s&&s(e,t)})),S=M(a),C=M(h),A=M((function(e){var t=ke({style:d,timeout:g},{mode:"exit"});e.style.webkitTransition=b.transitions.create("opacity",t),e.style.transition=b.transitions.create("opacity",t),c&&c(e)})),D=M(u);return O.createElement(f,Object(k.a)({appear:!0,in:o,nodeRef:_?y:void 0,onEnter:E,onEntered:S,onEntering:P,onExit:A,onExited:D,onExiting:C,timeout:g},v),(function(e,t){return O.cloneElement(i,Object(k.a)({style:Object(k.a)({opacity:0,visibility:"exited"!==e||o?void 0:"hidden"},ht[e],d,i.props.style),ref:w},t))}))})),ft=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.invisible,s=void 0!==o&&o,a=e.open,l=e.transitionDuration,c=e.TransitionComponent,u=void 0===c?pt:c,h=Object(T.a)(e,["children","classes","className","invisible","open","transitionDuration","TransitionComponent"]);return O.createElement(u,Object(k.a)({in:a,timeout:l},h),O.createElement("div",{className:Object(L.a)(r.root,n,s&&r.invisible),"aria-hidden":!0,ref:t},i))})),mt=Object(B.a)({root:{zIndex:-1,position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},invisible:{backgroundColor:"transparent"}},{name:"MuiBackdrop"})(ft),gt=O.forwardRef((function(e,t){var i=e.anchorOrigin,r=void 0===i?{vertical:"top",horizontal:"right"}:i,n=e.badgeContent,o=e.children,s=e.classes,a=e.className,l=e.color,c=void 0===l?"default":l,u=e.component,h=void 0===u?"span":u,d=e.invisible,p=e.max,f=void 0===p?99:p,m=e.overlap,g=void 0===m?"rectangle":m,v=e.showZero,b=void 0!==v&&v,_=e.variant,y=void 0===_?"standard":_,x=Object(T.a)(e,["anchorOrigin","badgeContent","children","classes","className","color","component","invisible","max","overlap","showZero","variant"]),w=d;null==d&&(0===n&&!b||null==n&&"dot"!==y)&&(w=!0);var M="";return"dot"!==y&&(M=n>f?"".concat(f,"+"):n),O.createElement(h,Object(k.a)({className:Object(L.a)(s.root,a),ref:t},x),o,O.createElement("span",{className:Object(L.a)(s.badge,s["".concat(r.horizontal).concat(S(r.vertical),"}")],s["anchorOrigin".concat(S(r.vertical)).concat(S(r.horizontal)).concat(S(g))],"default"!==c&&s["color".concat(S(c))],w&&s.invisible,"dot"===y&&s.dot)},M))})),vt=Object(B.a)((function(e){return{root:{position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0},badge:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen})},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorError:{backgroundColor:e.palette.error.main,color:e.palette.error.contrastText},dot:{borderRadius:4,height:8,minWidth:8,padding:0},anchorOriginTopRightRectangle:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%","&$invisible":{transform:"scale(0) translate(50%, -50%)"}},anchorOriginBottomRightRectangle:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%","&$invisible":{transform:"scale(0) translate(50%, 50%)"}},anchorOriginTopLeftRectangle:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%","&$invisible":{transform:"scale(0) translate(-50%, -50%)"}},anchorOriginBottomLeftRectangle:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%","&$invisible":{transform:"scale(0) translate(-50%, 50%)"}},anchorOriginTopRightCircle:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%","&$invisible":{transform:"scale(0) translate(50%, -50%)"}},anchorOriginBottomRightCircle:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%","&$invisible":{transform:"scale(0) translate(50%, 50%)"}},anchorOriginTopLeftCircle:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%","&$invisible":{transform:"scale(0) translate(-50%, -50%)"}},anchorOriginBottomLeftCircle:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%","&$invisible":{transform:"scale(0) translate(-50%, 50%)"}},invisible:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}}),{name:"MuiBadge"})(gt),bt=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"div":o,a=e.onChange,l=e.showLabels,c=void 0!==l&&l,u=e.value,h=Object(T.a)(e,["children","classes","className","component","onChange","showLabels","value"]);return O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,n),ref:t},h),O.Children.map(i,(function(e,t){if(!O.isValidElement(e))return null;var i=void 0===e.props.value?t:e.props.value;return O.cloneElement(e,{selected:i===u,showLabel:void 0!==e.props.showLabel?e.props.showLabel:c,value:i,onChange:a})})))})),_t=Object(B.a)((function(e){return{root:{display:"flex",justifyContent:"center",height:56,backgroundColor:e.palette.background.paper}}}),{name:"MuiBottomNavigation"})(bt),yt=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.icon,o=e.label,s=e.onChange,a=e.onClick,l=e.selected,c=e.showLabel,u=e.value,h=Object(T.a)(e,["classes","className","icon","label","onChange","onClick","selected","showLabel","value"]);return O.createElement(et,Object(k.a)({ref:t,className:Object(L.a)(i.root,r,l?i.selected:!c&&i.iconOnly),focusRipple:!0,onClick:function(e){s&&s(e,u),a&&a(e)}},h),O.createElement("span",{className:i.wrapper},n,O.createElement("span",{className:Object(L.a)(i.label,l?i.selected:!c&&i.iconOnly)},o)))})),xt=Object(B.a)((function(e){return{root:{transition:e.transitions.create(["color","padding-top"],{duration:e.transitions.duration.short}),padding:"6px 12px 8px",minWidth:80,maxWidth:168,color:e.palette.text.secondary,flex:"1","&$iconOnly":{paddingTop:16},"&$selected":{paddingTop:6,color:e.palette.primary.main}},selected:{},iconOnly:{},wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"100%",flexDirection:"column"},label:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s","&$iconOnly":{opacity:0,transitionDelay:"0s"},"&$selected":{fontSize:e.typography.pxToRem(14)}}}}),{name:"MuiBottomNavigationAction"})(yt),wt=i(47),Mt=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=function(e){return t.reduce((function(t,i){var r=i(e);return r?Object(wt.a)(t,r):t}),{})};return r.propTypes={},r.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),r},Pt=i(12),Et=i(88);function St(e,t){return t&&"string"==typeof t?t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e):null}var Ct=function(e){var t=e.prop,i=e.cssProperty,r=void 0===i?e.prop:i,n=e.themeKey,o=e.transform,s=function(e){if(null==e[t])return null;var i=e[t],s=St(e.theme,n)||{};return Object(Et.a)(e,i,(function(e){var t;return"function"==typeof s?t=s(e):Array.isArray(s)?t=s[e]||e:(t=St(s,e)||e,o&&(t=o(t))),!1===r?t:Object(Pt.a)({},r,t)}))};return s.propTypes={},s.filterProps=[t],s};function kt(e){return"number"!=typeof e?e:"".concat(e,"px solid")}var Ot=Mt(Ct({prop:"border",themeKey:"borders",transform:kt}),Ct({prop:"borderTop",themeKey:"borders",transform:kt}),Ct({prop:"borderRight",themeKey:"borders",transform:kt}),Ct({prop:"borderBottom",themeKey:"borders",transform:kt}),Ct({prop:"borderLeft",themeKey:"borders",transform:kt}),Ct({prop:"borderColor",themeKey:"palette"}),Ct({prop:"borderRadius",themeKey:"shape"})),At=Mt(Ct({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),Ct({prop:"display"}),Ct({prop:"overflow"}),Ct({prop:"textOverflow"}),Ct({prop:"visibility"}),Ct({prop:"whiteSpace"})),Tt=Mt(Ct({prop:"flexBasis"}),Ct({prop:"flexDirection"}),Ct({prop:"flexWrap"}),Ct({prop:"justifyContent"}),Ct({prop:"alignItems"}),Ct({prop:"alignContent"}),Ct({prop:"order"}),Ct({prop:"flex"}),Ct({prop:"flexGrow"}),Ct({prop:"flexShrink"}),Ct({prop:"alignSelf"}),Ct({prop:"justifyItems"}),Ct({prop:"justifySelf"})),Dt=Mt(Ct({prop:"gridGap"}),Ct({prop:"gridColumnGap"}),Ct({prop:"gridRowGap"}),Ct({prop:"gridColumn"}),Ct({prop:"gridRow"}),Ct({prop:"gridAutoFlow"}),Ct({prop:"gridAutoColumns"}),Ct({prop:"gridAutoRows"}),Ct({prop:"gridTemplateColumns"}),Ct({prop:"gridTemplateRows"}),Ct({prop:"gridTemplateAreas"}),Ct({prop:"gridArea"})),Rt=Mt(Ct({prop:"position"}),Ct({prop:"zIndex",themeKey:"zIndex"}),Ct({prop:"top"}),Ct({prop:"right"}),Ct({prop:"bottom"}),Ct({prop:"left"})),Lt=Mt(Ct({prop:"color",themeKey:"palette"}),Ct({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"})),Bt=Ct({prop:"boxShadow",themeKey:"shadows"});function It(e){return e<=1?"".concat(100*e,"%"):e}var Nt=Ct({prop:"width",transform:It}),jt=Ct({prop:"maxWidth",transform:It}),Ft=Ct({prop:"minWidth",transform:It}),zt=Ct({prop:"height",transform:It}),Vt=Ct({prop:"maxHeight",transform:It}),Ut=Ct({prop:"minHeight",transform:It}),Wt=(Ct({prop:"size",cssProperty:"width",transform:It}),Ct({prop:"size",cssProperty:"height",transform:It}),Mt(Nt,jt,Ft,zt,Vt,Ut,Ct({prop:"boxSizing"}))),Ht=i(271),Gt=Mt(Ct({prop:"fontFamily",themeKey:"typography"}),Ct({prop:"fontSize",themeKey:"typography"}),Ct({prop:"fontStyle",themeKey:"typography"}),Ct({prop:"fontWeight",themeKey:"typography"}),Ct({prop:"letterSpacing"}),Ct({prop:"lineHeight"}),Ct({prop:"textAlign"})),Xt=i(85),Yt=function(e){var t=function(t){var i=e(t);return t.css?Object(k.a)({},Object(wt.a)(i,e(Object(k.a)({theme:t.theme},t.css))),function(e,t){var i={};return Object.keys(e).forEach((function(r){-1===t.indexOf(r)&&(i[r]=e[r])})),i}(t.css,[e.filterProps])):i};return t.propTypes={},t.filterProps=["css"].concat(Object(Ve.a)(e.filterProps)),t}(Mt(Ot,At,Tt,Dt,Rt,Lt,Bt,Wt,Ht.b,Gt)),$t=Object(Xt.a)("div")(Yt,{name:"MuiBox"}),qt={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p"},Kt=O.forwardRef((function(e,t){var i=e.align,r=void 0===i?"inherit":i,n=e.classes,o=e.className,s=e.color,a=void 0===s?"initial":s,l=e.component,c=e.display,u=void 0===c?"initial":c,h=e.gutterBottom,d=void 0!==h&&h,p=e.noWrap,f=void 0!==p&&p,m=e.paragraph,g=void 0!==m&&m,v=e.variant,b=void 0===v?"body1":v,_=e.variantMapping,y=void 0===_?qt:_,x=Object(T.a)(e,["align","classes","className","color","component","display","gutterBottom","noWrap","paragraph","variant","variantMapping"]),w=l||(g?"p":y[b]||qt[b])||"span";return O.createElement(w,Object(k.a)({className:Object(L.a)(n.root,o,"inherit"!==b&&n[b],"initial"!==a&&n["color".concat(S(a))],f&&n.noWrap,d&&n.gutterBottom,g&&n.paragraph,"inherit"!==r&&n["align".concat(S(r))],"initial"!==u&&n["display".concat(S(u))]),ref:t},x))})),Zt=Object(B.a)((function(e){return{root:{margin:0},body2:e.typography.body2,body1:e.typography.body1,caption:e.typography.caption,button:e.typography.button,h1:e.typography.h1,h2:e.typography.h2,h3:e.typography.h3,h4:e.typography.h4,h5:e.typography.h5,h6:e.typography.h6,subtitle1:e.typography.subtitle1,subtitle2:e.typography.subtitle2,overline:e.typography.overline,srOnly:{position:"absolute",height:1,width:1,overflow:"hidden"},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right"},alignJustify:{textAlign:"justify"},noWrap:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},gutterBottom:{marginBottom:"0.35em"},paragraph:{marginBottom:16},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorTextPrimary:{color:e.palette.text.primary},colorTextSecondary:{color:e.palette.text.secondary},colorError:{color:e.palette.error.main},displayInline:{display:"inline"},displayBlock:{display:"block"}}}),{name:"MuiTypography"})(Kt),Qt=j(O.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})),Jt=Object(B.a)((function(e){return{root:{display:"flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5),backgroundColor:e.palette.grey[100],color:e.palette.grey[700],borderRadius:2,cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.grey[200]},"&:active":{boxShadow:e.shadows[0],backgroundColor:Object(tt.c)(e.palette.grey[200],.12)}},icon:{width:24,height:16}}}),{name:"PrivateBreadcrumbCollapsed"})((function(e){var t=e.classes,i=Object(T.a)(e,["classes"]);return O.createElement(et,Object(k.a)({component:"li",className:t.root,focusRipple:!0},i),O.createElement(Qt,{className:t.icon}))})),ei=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"nav":o,a=e.expandText,l=void 0===a?"Show path":a,c=e.itemsAfterCollapse,u=void 0===c?1:c,h=e.itemsBeforeCollapse,d=void 0===h?1:h,p=e.maxItems,f=void 0===p?8:p,m=e.separator,g=void 0===m?"/":m,v=Object(T.a)(e,["children","classes","className","component","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"]),b=O.useState(!1),_=b[0],y=b[1],x=O.Children.toArray(i).filter((function(e){return O.isValidElement(e)})).map((function(e,t){return O.createElement("li",{className:r.li,key:"child-".concat(t)},e)}));return O.createElement(Zt,Object(k.a)({ref:t,component:s,color:"textSecondary",className:Object(L.a)(r.root,n)},v),O.createElement("ol",{className:r.ol},function(e,t,i){return e.reduce((function(r,n,o){return o<e.length-1?r=r.concat(n,O.createElement("li",{"aria-hidden":!0,key:"separator-".concat(o),className:t},i)):r.push(n),r}),[])}(_||f&&x.length<=f?x:function(e){return d+u>=e.length?e:[].concat(Object(Ve.a)(e.slice(0,d)),[O.createElement(Jt,{"aria-label":l,key:"ellipsis",onClick:function(e){y(!0);var t=e.currentTarget.parentNode.querySelector("a[href],button,[tabindex]");t&&t.focus()}})],Object(Ve.a)(e.slice(e.length-u,e.length)))}(x),r.separator,g)))})),ti=Object(B.a)({root:{},ol:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"},li:{},separator:{display:"flex",userSelect:"none",marginLeft:8,marginRight:8}},{name:"MuiBreadcrumbs"})(ei),ii=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.color,s=void 0===o?"default":o,a=e.component,l=void 0===a?"button":a,c=e.disabled,u=void 0!==c&&c,h=e.disableElevation,d=void 0!==h&&h,p=e.disableFocusRipple,f=void 0!==p&&p,m=e.endIcon,g=e.focusVisibleClassName,v=e.fullWidth,b=void 0!==v&&v,_=e.size,y=void 0===_?"medium":_,x=e.startIcon,w=e.type,M=void 0===w?"button":w,P=e.variant,E=void 0===P?"text":P,C=Object(T.a)(e,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"]),A=x&&O.createElement("span",{className:Object(L.a)(r.startIcon,r["iconSize".concat(S(y))])},x),D=m&&O.createElement("span",{className:Object(L.a)(r.endIcon,r["iconSize".concat(S(y))])},m);return O.createElement(et,Object(k.a)({className:Object(L.a)(r.root,r[E],n,"inherit"===s?r.colorInherit:"default"!==s&&r["".concat(E).concat(S(s))],"medium"!==y&&[r["".concat(E,"Size").concat(S(y))],r["size".concat(S(y))]],d&&r.disableElevation,u&&r.disabled,b&&r.fullWidth),component:l,disabled:u,focusRipple:!f,focusVisibleClassName:Object(L.a)(r.focusVisible,g),ref:t,type:M},C),O.createElement("span",{className:r.label},A,i,D))})),ri=Object(B.a)((function(e){return{root:Object(k.a)({},e.typography.button,{boxSizing:"border-box",minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,color:e.palette.text.primary,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:Object(tt.d)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:e.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{padding:"6px 8px"},textPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlined:{padding:"5px 15px",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$disabled":{border:"1px solid ".concat(e.palette.action.disabledBackground)}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(Object(tt.d)(e.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.primary.main),backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(Object(tt.d)(e.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.secondary.main),backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},contained:{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2],"&:hover":{backgroundColor:e.palette.grey.A100,boxShadow:e.shadows[4],"@media (hover: none)":{boxShadow:e.shadows[2],backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},"&$focusVisible":{boxShadow:e.shadows[6]},"&:active":{boxShadow:e.shadows[8]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}},containedPrimary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},containedSecondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},disableElevation:{boxShadow:"none","&:hover":{boxShadow:"none"},"&$focusVisible":{boxShadow:"none"},"&:active":{boxShadow:"none"},"&$disabled":{boxShadow:"none"}},focusVisible:{},disabled:{},colorInherit:{color:"inherit",borderColor:"currentColor"},textSizeSmall:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},textSizeLarge:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},outlinedSizeSmall:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},outlinedSizeLarge:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},containedSizeSmall:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},containedSizeLarge:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},sizeSmall:{},sizeLarge:{},fullWidth:{width:"100%"},startIcon:{display:"inherit",marginRight:8,marginLeft:-4,"&$iconSizeSmall":{marginLeft:-2}},endIcon:{display:"inherit",marginRight:-4,marginLeft:8,"&$iconSizeSmall":{marginRight:-2}},iconSizeSmall:{"& > *:first-child":{fontSize:18}},iconSizeMedium:{"& > *:first-child":{fontSize:20}},iconSizeLarge:{"& > *:first-child":{fontSize:22}}}}),{name:"MuiButton"})(ii);ri.styles;var ni=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.color,s=void 0===o?"default":o,a=e.component,l=void 0===a?"div":a,c=e.disabled,u=void 0!==c&&c,h=e.disableElevation,d=void 0!==h&&h,p=e.disableFocusRipple,f=void 0!==p&&p,m=e.disableRipple,g=void 0!==m&&m,v=e.fullWidth,b=void 0!==v&&v,_=e.orientation,y=void 0===_?"horizontal":_,x=e.size,w=void 0===x?"medium":x,M=e.variant,P=void 0===M?"outlined":M,E=Object(T.a)(e,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"]),C=Object(L.a)(r.grouped,r["grouped".concat(S(y))],r["grouped".concat(S(P))],r["grouped".concat(S(P)).concat(S(y))],r["grouped".concat(S(P)).concat("default"!==s?S(s):"")],u&&r.disabled);return O.createElement(l,Object(k.a)({role:"group",className:Object(L.a)(r.root,n,b&&r.fullWidth,d&&r.disableElevation,"contained"===P&&r.contained,"vertical"===y&&r.vertical),ref:t},E),O.Children.map(i,(function(e){return O.isValidElement(e)?O.cloneElement(e,{className:Object(L.a)(C,e.props.className),color:e.props.color||s,disabled:e.props.disabled||u,disableElevation:e.props.disableElevation||d,disableFocusRipple:f,disableRipple:g,fullWidth:b,size:e.props.size||w,variant:e.props.variant||P}):null})))})),oi=Object(B.a)((function(e){return{root:{display:"inline-flex",borderRadius:e.shape.borderRadius},contained:{boxShadow:e.shadows[2]},disableElevation:{boxShadow:"none"},disabled:{},fullWidth:{width:"100%"},vertical:{flexDirection:"column"},grouped:{minWidth:40},groupedHorizontal:{"&:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0}},groupedVertical:{"&:not(:first-child)":{borderTopRightRadius:0,borderTopLeftRadius:0},"&:not(:last-child)":{borderBottomRightRadius:0,borderBottomLeftRadius:0}},groupedText:{},groupedTextHorizontal:{"&:not(:last-child)":{borderRight:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")}},groupedTextVertical:{"&:not(:last-child)":{borderBottom:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")}},groupedTextPrimary:{"&:not(:last-child)":{borderColor:Object(tt.d)(e.palette.primary.main,.5)}},groupedTextSecondary:{"&:not(:last-child)":{borderColor:Object(tt.d)(e.palette.secondary.main,.5)}},groupedOutlined:{},groupedOutlinedHorizontal:{"&:not(:first-child)":{marginLeft:-1},"&:not(:last-child)":{borderRightColor:"transparent"}},groupedOutlinedVertical:{"&:not(:first-child)":{marginTop:-1},"&:not(:last-child)":{borderBottomColor:"transparent"}},groupedOutlinedPrimary:{"&:hover":{borderColor:e.palette.primary.main}},groupedOutlinedSecondary:{"&:hover":{borderColor:e.palette.secondary.main}},groupedContained:{boxShadow:"none"},groupedContainedHorizontal:{"&:not(:last-child)":{borderRight:"1px solid ".concat(e.palette.grey[400]),"&$disabled":{borderRight:"1px solid ".concat(e.palette.action.disabled)}}},groupedContainedVertical:{"&:not(:last-child)":{borderBottom:"1px solid ".concat(e.palette.grey[400]),"&$disabled":{borderBottom:"1px solid ".concat(e.palette.action.disabled)}}},groupedContainedPrimary:{"&:not(:last-child)":{borderColor:e.palette.primary.dark}},groupedContainedSecondary:{"&:not(:last-child)":{borderColor:e.palette.secondary.dark}}}}),{name:"MuiButtonGroup"})(ni),si=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.raised,o=void 0!==n&&n,s=Object(T.a)(e,["classes","className","raised"]);return O.createElement(Re,Object(k.a)({className:Object(L.a)(i.root,r),elevation:o?8:1,ref:t},s))})),ai=Object(B.a)({root:{overflow:"hidden"}},{name:"MuiCard"})(si),li=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.focusVisibleClassName,s=Object(T.a)(e,["children","classes","className","focusVisibleClassName"]);return O.createElement(et,Object(k.a)({className:Object(L.a)(r.root,n),focusVisibleClassName:Object(L.a)(o,r.focusVisible),ref:t},s),i,O.createElement("span",{className:r.focusHighlight}))})),ci=Object(B.a)((function(e){return{root:{display:"block",textAlign:"inherit",width:"100%","&:hover $focusHighlight":{opacity:e.palette.action.hoverOpacity},"&$focusVisible $focusHighlight":{opacity:.12}},focusVisible:{},focusHighlight:{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:e.transitions.create("opacity",{duration:e.transitions.duration.short})}}}),{name:"MuiCardActionArea"})(li),ui=O.forwardRef((function(e,t){var i=e.disableSpacing,r=void 0!==i&&i,n=e.classes,o=e.className,s=Object(T.a)(e,["disableSpacing","classes","className"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(n.root,o,!r&&n.spacing),ref:t},s))})),hi=Object(B.a)({root:{display:"flex",alignItems:"center",padding:8},spacing:{"& > :not(:first-child)":{marginLeft:8}}},{name:"MuiCardActions"})(ui),di=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"div":n,s=Object(T.a)(e,["classes","className","component"]);return O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r),ref:t},s))})),pi=Object(B.a)({root:{padding:16,"&:last-child":{paddingBottom:24}}},{name:"MuiCardContent"})(di),fi=O.forwardRef((function(e,t){var i=e.action,r=e.avatar,n=e.classes,o=e.className,s=e.component,a=void 0===s?"div":s,l=e.disableTypography,c=void 0!==l&&l,u=e.subheader,h=e.subheaderTypographyProps,d=e.title,p=e.titleTypographyProps,f=Object(T.a)(e,["action","avatar","classes","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"]),m=d;null==m||m.type===Zt||c||(m=O.createElement(Zt,Object(k.a)({variant:r?"body2":"h5",className:n.title,component:"span",display:"block"},p),m));var g=u;return null==g||g.type===Zt||c||(g=O.createElement(Zt,Object(k.a)({variant:r?"body2":"body1",className:n.subheader,color:"textSecondary",component:"span",display:"block"},h),g)),O.createElement(a,Object(k.a)({className:Object(L.a)(n.root,o),ref:t},f),r&&O.createElement("div",{className:n.avatar},r),O.createElement("div",{className:n.content},m,g),i&&O.createElement("div",{className:n.action},i))})),mi=Object(B.a)({root:{display:"flex",alignItems:"center",padding:16},avatar:{flex:"0 0 auto",marginRight:16},action:{flex:"0 0 auto",alignSelf:"flex-start",marginTop:-8,marginRight:-8},content:{flex:"1 1 auto"},title:{},subheader:{}},{name:"MuiCardHeader"})(fi),gi=["video","audio","picture","iframe","img"],vi=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"div":o,a=e.image,l=e.src,c=e.style,u=Object(T.a)(e,["children","classes","className","component","image","src","style"]),h=-1!==gi.indexOf(s),d=!h&&a?Object(k.a)({backgroundImage:'url("'.concat(a,'")')},c):c;return O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,n,h&&r.media,-1!=="picture img".indexOf(s)&&r.img),ref:t,style:d,src:h?a||l:void 0},u),i)})),bi=Object(B.a)({root:{display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},media:{width:"100%"},img:{objectFit:"cover"}},{name:"MuiCardMedia"})(vi),_i=O.createContext();function yi(){return O.useContext(_i)}var xi=_i;function wi(){return O.useContext(xi)}var Mi=O.forwardRef((function(e,t){var i=e.autoFocus,r=e.checked,n=e.checkedIcon,o=e.classes,s=e.className,a=e.defaultChecked,l=e.disabled,c=e.icon,u=e.id,h=e.inputProps,d=e.inputRef,p=e.name,f=e.onBlur,m=e.onChange,g=e.onFocus,v=e.readOnly,b=e.required,_=e.tabIndex,y=e.type,x=e.value,w=Object(T.a)(e,["autoFocus","checked","checkedIcon","classes","className","defaultChecked","disabled","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"]),M=Y({controlled:r,default:Boolean(a),name:"SwitchBase",state:"checked"}),P=Object(me.a)(M,2),E=P[0],S=P[1],C=wi(),A=l;C&&void 0===A&&(A=C.disabled);var D="checkbox"===y||"radio"===y;return O.createElement(rt,Object(k.a)({component:"span",className:Object(L.a)(o.root,s,E&&o.checked,A&&o.disabled),disabled:A,tabIndex:null,role:void 0,onFocus:function(e){g&&g(e),C&&C.onFocus&&C.onFocus(e)},onBlur:function(e){f&&f(e),C&&C.onBlur&&C.onBlur(e)},ref:t},w),O.createElement("input",Object(k.a)({autoFocus:i,checked:r,defaultChecked:a,className:o.input,disabled:A,id:D&&u,name:p,onChange:function(e){var t=e.target.checked;S(t),m&&m(e,t)},readOnly:v,ref:d,required:b,tabIndex:_,type:y,value:x},h)),E?n:c)})),Pi=Object(B.a)({root:{padding:9},checked:{},disabled:{},input:{cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}},{name:"PrivateSwitchBase"})(Mi),Ei=j(O.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Si=j(O.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Ci=j(O.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"})),ki=O.createElement(Si,null),Oi=O.createElement(Ei,null),Ai=O.createElement(Ci,null),Ti=O.forwardRef((function(e,t){var i=e.checkedIcon,r=void 0===i?ki:i,n=e.classes,o=e.color,s=void 0===o?"secondary":o,a=e.icon,l=void 0===a?Oi:a,c=e.indeterminate,u=void 0!==c&&c,h=e.indeterminateIcon,d=void 0===h?Ai:h,p=e.inputProps,f=e.size,m=void 0===f?"medium":f,g=Object(T.a)(e,["checkedIcon","classes","color","icon","indeterminate","indeterminateIcon","inputProps","size"]),v=u?d:l,b=u?d:r;return O.createElement(Pi,Object(k.a)({type:"checkbox",classes:{root:Object(L.a)(n.root,n["color".concat(S(s))],u&&n.indeterminate),checked:n.checked,disabled:n.disabled},color:s,inputProps:Object(k.a)({"data-indeterminate":u},p),icon:O.cloneElement(v,{fontSize:void 0===v.props.fontSize&&"small"===m?m:v.props.fontSize}),checkedIcon:O.cloneElement(b,{fontSize:void 0===b.props.fontSize&&"small"===m?m:b.props.fontSize}),ref:t},g))})),Di=Object(B.a)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},indeterminate:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiCheckbox"})(Ti),Ri=j(O.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function Li(e){return"Backspace"===e.key||"Delete"===e.key}var Bi=O.forwardRef((function(e,t){var i=e.avatar,r=e.classes,n=e.className,o=e.clickable,s=e.color,a=void 0===s?"default":s,l=e.component,c=e.deleteIcon,u=e.disabled,h=void 0!==u&&u,d=e.icon,p=e.label,f=e.onClick,m=e.onDelete,g=e.onKeyDown,v=e.onKeyUp,b=e.size,_=void 0===b?"medium":b,y=e.variant,x=void 0===y?"default":y,w=Object(T.a)(e,["avatar","classes","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant"]),M=O.useRef(null),P=K(M,t),E=function(e){e.stopPropagation(),m&&m(e)},C=!(!1===o||!f)||o,A="small"===_,D=l||(C?et:"div"),R=D===et?{component:"div"}:{},B=null;if(m){var I=Object(L.a)("default"!==a&&("default"===x?r["deleteIconColor".concat(S(a))]:r["deleteIconOutlinedColor".concat(S(a))]),A&&r.deleteIconSmall);B=c&&O.isValidElement(c)?O.cloneElement(c,{className:Object(L.a)(c.props.className,r.deleteIcon,I),onClick:E}):O.createElement(Ri,{className:Object(L.a)(r.deleteIcon,I),onClick:E})}var N=null;i&&O.isValidElement(i)&&(N=O.cloneElement(i,{className:Object(L.a)(r.avatar,i.props.className,A&&r.avatarSmall,"default"!==a&&r["avatarColor".concat(S(a))])}));var j=null;return d&&O.isValidElement(d)&&(j=O.cloneElement(d,{className:Object(L.a)(r.icon,d.props.className,A&&r.iconSmall,"default"!==a&&r["iconColor".concat(S(a))])})),O.createElement(D,Object(k.a)({role:C||m?"button":void 0,className:Object(L.a)(r.root,n,"default"!==a&&[r["color".concat(S(a))],C&&r["clickableColor".concat(S(a))],m&&r["deletableColor".concat(S(a))]],"default"!==x&&[r.outlined,{primary:r.outlinedPrimary,secondary:r.outlinedSecondary}[a]],h&&r.disabled,A&&r.sizeSmall,C&&r.clickable,m&&r.deletable),"aria-disabled":!!h||void 0,tabIndex:C||m?0:void 0,onClick:f,onKeyDown:function(e){e.currentTarget===e.target&&Li(e)&&e.preventDefault(),g&&g(e)},onKeyUp:function(e){e.currentTarget===e.target&&(m&&Li(e)?m(e):"Escape"===e.key&&M.current&&M.current.blur()),v&&v(e)},ref:P},R,w),N||j,O.createElement("span",{className:Object(L.a)(r.label,A&&r.labelSmall)},p),B)})),Ii=Object(B.a)((function(e){var t="light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],i=Object(tt.d)(e.palette.text.primary,.26);return{root:{fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:e.palette.getContrastText(t),backgroundColor:t,borderRadius:16,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:"none",padding:0,verticalAlign:"middle",boxSizing:"border-box","&$disabled":{opacity:.5,pointerEvents:"none"},"& $avatar":{marginLeft:5,marginRight:-6,width:24,height:24,color:"light"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],fontSize:e.typography.pxToRem(12)},"& $avatarColorPrimary":{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.dark},"& $avatarColorSecondary":{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.dark},"& $avatarSmall":{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)}},sizeSmall:{height:24},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},disabled:{},clickable:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover, &:focus":{backgroundColor:Object(tt.c)(t,.08)},"&:active":{boxShadow:e.shadows[1]}},clickableColorPrimary:{"&:hover, &:focus":{backgroundColor:Object(tt.c)(e.palette.primary.main,.08)}},clickableColorSecondary:{"&:hover, &:focus":{backgroundColor:Object(tt.c)(e.palette.secondary.main,.08)}},deletable:{"&:focus":{backgroundColor:Object(tt.c)(t,.08)}},deletableColorPrimary:{"&:focus":{backgroundColor:Object(tt.c)(e.palette.primary.main,.2)}},deletableColorSecondary:{"&:focus":{backgroundColor:Object(tt.c)(e.palette.secondary.main,.2)}},outlined:{backgroundColor:"transparent",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:Object(tt.d)(e.palette.text.primary,e.palette.action.hoverOpacity)},"& $avatar":{marginLeft:4},"& $avatarSmall":{marginLeft:2},"& $icon":{marginLeft:4},"& $iconSmall":{marginLeft:2},"& $deleteIcon":{marginRight:5},"& $deleteIconSmall":{marginRight:3}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(e.palette.primary.main),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity)}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(e.palette.secondary.main),"$clickable&:hover, $clickable&:focus, $deletable&:focus":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity)}},avatar:{},avatarSmall:{},avatarColorPrimary:{},avatarColorSecondary:{},icon:{color:"light"===e.palette.type?e.palette.grey[700]:e.palette.grey[300],marginLeft:5,marginRight:-6},iconSmall:{width:18,height:18,marginLeft:4,marginRight:-4},iconColorPrimary:{color:"inherit"},iconColorSecondary:{color:"inherit"},label:{overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},labelSmall:{paddingLeft:8,paddingRight:8},deleteIcon:{WebkitTapHighlightColor:"transparent",color:i,height:22,width:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:Object(tt.d)(i,.4)}},deleteIconSmall:{height:16,width:16,marginRight:4,marginLeft:-4},deleteIconColorPrimary:{color:Object(tt.d)(e.palette.primary.contrastText,.7),"&:hover, &:active":{color:e.palette.primary.contrastText}},deleteIconColorSecondary:{color:Object(tt.d)(e.palette.secondary.contrastText,.7),"&:hover, &:active":{color:e.palette.secondary.contrastText}},deleteIconOutlinedColorPrimary:{color:Object(tt.d)(e.palette.primary.main,.7),"&:hover, &:active":{color:e.palette.primary.main}},deleteIconOutlinedColorSecondary:{color:Object(tt.d)(e.palette.secondary.main,.7),"&:hover, &:active":{color:e.palette.secondary.main}}}}),{name:"MuiChip"})(Bi),Ni=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"primary":n,s=e.disableShrink,a=void 0!==s&&s,l=e.size,c=void 0===l?40:l,u=e.style,h=e.thickness,d=void 0===h?3.6:h,p=e.value,f=void 0===p?0:p,m=e.variant,g=void 0===m?"indeterminate":m,v=Object(T.a)(e,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),b={},_={},y={};if("determinate"===g||"static"===g){var x=2*Math.PI*((44-d)/2);b.strokeDasharray=x.toFixed(3),y["aria-valuenow"]=Math.round(f),b.strokeDashoffset="".concat(((100-f)/100*x).toFixed(3),"px"),_.transform="rotate(-90deg)"}return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,"inherit"!==o&&i["color".concat(S(o))],{determinate:i.determinate,indeterminate:i.indeterminate,static:i.static}[g]),style:Object(k.a)({width:c,height:c},_,u),ref:t,role:"progressbar"},y,v),O.createElement("svg",{className:i.svg,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},O.createElement("circle",{className:Object(L.a)(i.circle,a&&i.circleDisableShrink,{determinate:i.circleDeterminate,indeterminate:i.circleIndeterminate,static:i.circleStatic}[g]),style:b,cx:44,cy:44,r:(44-d)/2,fill:"none",strokeWidth:d})))})),ji=Object(B.a)((function(e){return{root:{display:"inline-block"},static:{transition:e.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:e.transitions.create("transform")},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:e.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:e.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}}),{name:"MuiCircularProgress",flip:!1})(Ni);function Fi(e){return e.substring(2).toLowerCase()}var zi=function(e){var t=e.children,i=e.disableReactTree,r=void 0!==i&&i,n=e.mouseEvent,o=void 0===n?"onClick":n,s=e.onClickAway,a=e.touchEvent,l=void 0===a?"onTouchEnd":a,c=O.useRef(!1),u=O.useRef(null),h=O.useRef(!1),d=O.useRef(!1);O.useEffect((function(){return setTimeout((function(){h.current=!0}),0),function(){h.current=!1}}),[]);var p=O.useCallback((function(e){u.current=Q.findDOMNode(e)}),[]),f=K(t.ref,p),m=q((function(e){var t=d.current;d.current=!1,h.current&&u.current&&!function(e){return document.documentElement.clientWidth<e.clientX||document.documentElement.clientHeight<e.clientY}(e)&&(c.current?c.current=!1:(e.composedPath?e.composedPath().indexOf(u.current)>-1:!U(u.current).documentElement.contains(e.target)||u.current.contains(e.target))||!r&&t||s(e))})),g=function(e){return function(i){d.current=!0;var r=t.props[e];r&&r(i)}},v={ref:f};return!1!==l&&(v[l]=g(l)),O.useEffect((function(){if(!1!==l){var e=Fi(l),t=U(u.current),i=function(){c.current=!0};return t.addEventListener(e,m),t.addEventListener("touchmove",i),function(){t.removeEventListener(e,m),t.removeEventListener("touchmove",i)}}}),[m,l]),!1!==o&&(v[o]=g(o)),O.useEffect((function(){if(!1!==o){var e=Fi(o),t=U(u.current);return t.addEventListener(e,m),function(){t.removeEventListener(e,m)}}}),[m,o]),O.createElement(O.Fragment,null,O.cloneElement(t,v))},Vi=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"div":n,s=e.disableGutters,a=void 0!==s&&s,l=e.fixed,c=void 0!==l&&l,u=e.maxWidth,h=void 0===u?"lg":u,d=Object(T.a)(e,["classes","className","component","disableGutters","fixed","maxWidth"]);return O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r,c&&i.fixed,a&&i.disableGutters,!1!==h&&i["maxWidth".concat(S(String(h)))]),ref:t},d))})),Ui=Object(B.a)((function(e){return{root:Object(Pt.a)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),display:"block"},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),disableGutters:{paddingLeft:0,paddingRight:0},fixed:Object.keys(e.breakpoints.values).reduce((function(t,i){var r=e.breakpoints.values[i];return 0!==r&&(t[e.breakpoints.up(i)]={maxWidth:r}),t}),{}),maxWidthXs:Object(Pt.a)({},e.breakpoints.up("xs"),{maxWidth:Math.max(e.breakpoints.values.xs,444)}),maxWidthSm:Object(Pt.a)({},e.breakpoints.up("sm"),{maxWidth:e.breakpoints.values.sm}),maxWidthMd:Object(Pt.a)({},e.breakpoints.up("md"),{maxWidth:e.breakpoints.values.md}),maxWidthLg:Object(Pt.a)({},e.breakpoints.up("lg"),{maxWidth:e.breakpoints.values.lg}),maxWidthXl:Object(Pt.a)({},e.breakpoints.up("xl"),{maxWidth:e.breakpoints.values.xl})}}),{name:"MuiContainer"})(Vi),Wi={WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box"},Hi=Object(B.a)((function(e){return{"@global":{html:Wi,"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:Object(k.a)({margin:0},function(e){return Object(k.a)({color:e.palette.text.primary},e.typography.body2,{backgroundColor:e.palette.background.default,"@media print":{backgroundColor:e.palette.common.white}})}(e),{"&::backdrop":{backgroundColor:e.palette.background.default}})}}}),{name:"MuiCssBaseline"})((function(e){var t=e.children,i=void 0===t?null:t;return e.classes,O.createElement(O.Fragment,null,i)})),Gi=i(260),Xi=i(269),Yi="undefined"!=typeof window?O.useLayoutEffect:O.useEffect,$i=O.forwardRef((function(e,t){var i=e.children,r=e.container,n=e.disablePortal,o=void 0!==n&&n,s=e.onRendered,a=O.useState(null),l=a[0],c=a[1],u=K(O.isValidElement(i)?i.ref:null,t);return Yi((function(){o||c(function(e){return e="function"==typeof e?e():e,Q.findDOMNode(e)}(r)||document.body)}),[r,o]),Yi((function(){if(l&&!o)return G(t,l),function(){G(t,null)}}),[t,l,o]),Yi((function(){s&&(l||o)&&s()}),[s,l,o]),o?O.isValidElement(i)?O.cloneElement(i,{ref:u}):i:l?Q.createPortal(i,l):l})),qi=i(90),Ki=i(66),Zi=i(42);function Qi(){var e=document.createElement("div");e.style.width="99px",e.style.height="99px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}function Ji(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function er(e){return parseInt(window.getComputedStyle(e)["padding-right"],10)||0}function tr(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4?arguments[4]:void 0,o=[t,i].concat(Object(Ve.a)(r)),s=["TEMPLATE","SCRIPT","STYLE"];[].forEach.call(e.children,(function(e){1===e.nodeType&&-1===o.indexOf(e)&&-1===s.indexOf(e.tagName)&&Ji(e,n)}))}function ir(e,t){var i=-1;return e.some((function(e,r){return!!t(e)&&(i=r,!0)})),i}var rr=function(){function e(){Object(Ki.a)(this,e),this.modals=[],this.containers=[]}return Object(Zi.a)(e,[{key:"add",value:function(e,t){var i=this.modals.indexOf(e);if(-1!==i)return i;i=this.modals.length,this.modals.push(e),e.modalRef&&Ji(e.modalRef,!1);var r=function(e){var t=[];return[].forEach.call(e.children,(function(e){e.getAttribute&&"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);tr(t,e.mountNode,e.modalRef,r,!0);var n=ir(this.containers,(function(e){return e.container===t}));return-1!==n?(this.containers[n].modals.push(e),i):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblingNodes:r}),i)}},{key:"mount",value:function(e,t){var i=ir(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),r=this.containers[i];r.restore||(r.restore=function(e,t){var i,r=[],n=[],o=e.container;if(!t.disableScrollLock){if(function(e){var t=U(e);return t.body===e?W(t).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(o)){var s=Qi();r.push({value:o.style.paddingRight,key:"padding-right",el:o}),o.style["padding-right"]="".concat(er(o)+s,"px"),i=U(o).querySelectorAll(".mui-fixed"),[].forEach.call(i,(function(e){n.push(e.style.paddingRight),e.style.paddingRight="".concat(er(e)+s,"px")}))}var a=o.parentElement,l="HTML"===a.nodeName&&"scroll"===window.getComputedStyle(a)["overflow-y"]?a:o;r.push({value:l.style.overflow,key:"overflow",el:l}),l.style.overflow="hidden"}return function(){i&&[].forEach.call(i,(function(e,t){n[t]?e.style.paddingRight=n[t]:e.style.removeProperty("padding-right")})),r.forEach((function(e){var t=e.value,i=e.el,r=e.key;t?i.style.setProperty(r,t):i.style.removeProperty(r)}))}}(r,t))}},{key:"remove",value:function(e){var t=this.modals.indexOf(e);if(-1===t)return t;var i=ir(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),r=this.containers[i];if(r.modals.splice(r.modals.indexOf(e),1),this.modals.splice(t,1),0===r.modals.length)r.restore&&r.restore(),e.modalRef&&Ji(e.modalRef,!0),tr(r.container,e.mountNode,e.modalRef,r.hiddenSiblingNodes,!1),this.containers.splice(i,1);else{var n=r.modals[r.modals.length-1];n.modalRef&&Ji(n.modalRef,!1)}return t}},{key:"isTopModal",value:function(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}]),e}(),nr=function(e){var t=e.children,i=e.disableAutoFocus,r=void 0!==i&&i,n=e.disableEnforceFocus,o=void 0!==n&&n,s=e.disableRestoreFocus,a=void 0!==s&&s,l=e.getDoc,c=e.isEnabled,u=e.open,h=O.useRef(),d=O.useRef(null),p=O.useRef(null),f=O.useRef(),m=O.useRef(null),g=O.useCallback((function(e){m.current=Q.findDOMNode(e)}),[]),v=K(t.ref,g),b=O.useRef();return O.useEffect((function(){b.current=u}),[u]),!b.current&&u&&"undefined"!=typeof window&&(f.current=l().activeElement),O.useEffect((function(){if(u){var e=U(m.current);r||!m.current||m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex",-1),m.current.focus());var t=function(){null!==m.current&&(e.hasFocus()&&!o&&c()&&!h.current?m.current&&!m.current.contains(e.activeElement)&&m.current.focus():h.current=!1)},i=function(t){!o&&c()&&9===t.keyCode&&e.activeElement===m.current&&(h.current=!0,t.shiftKey?p.current.focus():d.current.focus())};e.addEventListener("focus",t,!0),e.addEventListener("keydown",i,!0);var n=setInterval((function(){t()}),50);return function(){clearInterval(n),e.removeEventListener("focus",t,!0),e.removeEventListener("keydown",i,!0),a||(f.current&&f.current.focus&&f.current.focus(),f.current=null)}}}),[r,o,a,c,u]),O.createElement(O.Fragment,null,O.createElement("div",{tabIndex:0,ref:d,"data-test":"sentinelStart"}),O.cloneElement(t,{ref:v}),O.createElement("div",{tabIndex:0,ref:p,"data-test":"sentinelEnd"}))},or={root:{zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},invisible:{backgroundColor:"transparent"}},sr=O.forwardRef((function(e,t){var i=e.invisible,r=void 0!==i&&i,n=e.open,o=Object(T.a)(e,["invisible","open"]);return n?O.createElement("div",Object(k.a)({"aria-hidden":!0,ref:t},o,{style:Object(k.a)({},or.root,r?or.invisible:{},o.style)})):null})),ar=new rr,lr=O.forwardRef((function(e,t){var i=Object(Gi.a)(),r=Object(Xi.a)({name:"MuiModal",props:Object(k.a)({},e),theme:i}),n=r.BackdropComponent,o=void 0===n?sr:n,s=r.BackdropProps,a=r.children,l=r.closeAfterTransition,c=void 0!==l&&l,u=r.container,h=r.disableAutoFocus,d=void 0!==h&&h,p=r.disableBackdropClick,f=void 0!==p&&p,m=r.disableEnforceFocus,g=void 0!==m&&m,v=r.disableEscapeKeyDown,b=void 0!==v&&v,_=r.disablePortal,y=void 0!==_&&_,x=r.disableRestoreFocus,w=void 0!==x&&x,M=r.disableScrollLock,P=void 0!==M&&M,E=r.hideBackdrop,S=void 0!==E&&E,A=r.keepMounted,D=void 0!==A&&A,R=r.manager,L=void 0===R?ar:R,B=r.onBackdropClick,I=r.onClose,N=r.onEscapeKeyDown,j=r.onRendered,F=r.open,z=Object(T.a)(r,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),V=O.useState(!0),W=V[0],H=V[1],G=O.useRef({}),X=O.useRef(null),Y=O.useRef(null),$=K(Y,t),Z=function(e){return!!e.children&&e.children.props.hasOwnProperty("in")}(r),J=function(){return U(X.current)},ee=function(){return G.current.modalRef=Y.current,G.current.mountNode=X.current,G.current},te=function(){L.mount(ee(),{disableScrollLock:P}),Y.current.scrollTop=0},ie=q((function(){var e=function(e){return e="function"==typeof e?e():e,Q.findDOMNode(e)}(u)||J().body;L.add(ee(),e),Y.current&&te()})),re=O.useCallback((function(){return L.isTopModal(ee())}),[L]),ne=q((function(e){X.current=e,e&&(j&&j(),F&&re()?te():Ji(Y.current,!0))})),oe=O.useCallback((function(){L.remove(ee())}),[L]);if(O.useEffect((function(){return function(){oe()}}),[oe]),O.useEffect((function(){F?ie():Z&&c||oe()}),[F,oe,Z,c,ie]),!D&&!F&&(!Z||W))return null;var se=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}}(i||{zIndex:qi.a}),ae={};return void 0===a.props.tabIndex&&(ae.tabIndex=a.props.tabIndex||"-1"),Z&&(ae.onEnter=C((function(){H(!1)}),a.props.onEnter),ae.onExited=C((function(){H(!0),c&&oe()}),a.props.onExited)),O.createElement($i,{ref:ne,container:u,disablePortal:y},O.createElement("div",Object(k.a)({ref:$,onKeyDown:function(e){"Escape"===e.key&&re()&&(N&&N(e),b||(e.stopPropagation(),I&&I(e,"escapeKeyDown")))},role:"presentation"},z,{style:Object(k.a)({},se.root,!F&&W?se.hidden:{},z.style)}),S?null:O.createElement(o,Object(k.a)({open:F,onClick:function(e){e.target===e.currentTarget&&(B&&B(e),!f&&I&&I(e,"backdropClick"))}},s)),O.createElement(nr,{disableEnforceFocus:g,disableAutoFocus:d,disableRestoreFocus:w,getDoc:J,isEnabled:re,open:F},O.cloneElement(a,ae))))})),cr={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},ur=O.forwardRef((function(e,t){var i=e.BackdropProps,r=e.children,n=e.classes,o=e.className,s=e.disableBackdropClick,a=void 0!==s&&s,l=e.disableEscapeKeyDown,c=void 0!==l&&l,u=e.fullScreen,h=void 0!==u&&u,d=e.fullWidth,p=void 0!==d&&d,f=e.maxWidth,m=void 0===f?"sm":f,g=e.onBackdropClick,v=e.onClose,b=e.onEnter,_=e.onEntered,y=e.onEntering,x=e.onEscapeKeyDown,w=e.onExit,M=e.onExited,P=e.onExiting,E=e.open,C=e.PaperComponent,A=void 0===C?Re:C,D=e.PaperProps,R=void 0===D?{}:D,B=e.scroll,I=void 0===B?"paper":B,N=e.TransitionComponent,j=void 0===N?pt:N,F=e.transitionDuration,z=void 0===F?cr:F,V=e.TransitionProps,U=e["aria-describedby"],W=e["aria-labelledby"],H=Object(T.a)(e,["BackdropProps","children","classes","className","disableBackdropClick","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClose","onEnter","onEntered","onEntering","onEscapeKeyDown","onExit","onExited","onExiting","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps","aria-describedby","aria-labelledby"]),G=O.useRef();return O.createElement(lr,Object(k.a)({className:Object(L.a)(n.root,o),BackdropComponent:mt,BackdropProps:Object(k.a)({transitionDuration:z},i),closeAfterTransition:!0,disableBackdropClick:a,disableEscapeKeyDown:c,onEscapeKeyDown:x,onClose:v,open:E,ref:t},H),O.createElement(j,Object(k.a)({appear:!0,in:E,timeout:z,onEnter:b,onEntering:y,onEntered:_,onExit:w,onExiting:P,onExited:M,role:"none presentation"},V),O.createElement("div",{className:Object(L.a)(n.container,n["scroll".concat(S(I))]),onMouseUp:function(e){e.target===e.currentTarget&&e.target===G.current&&(G.current=null,g&&g(e),!a&&v&&v(e,"backdropClick"))},onMouseDown:function(e){G.current=e.target}},O.createElement(A,Object(k.a)({elevation:24,role:"dialog","aria-describedby":U,"aria-labelledby":W},R,{className:Object(L.a)(n.paper,n["paperScroll".concat(S(I))],n["paperWidth".concat(S(String(m)))],R.className,h&&n.paperFullScreen,p&&n.paperFullWidth)}),r))))})),hr=Object(B.a)((function(e){return{root:{"@media print":{position:"absolute !important"}},scrollPaper:{display:"flex",justifyContent:"center",alignItems:"center"},scrollBody:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&:after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}},container:{height:"100%","@media print":{height:"auto"},outline:0},paper:{margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},paperScrollPaper:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},paperScrollBody:{display:"inline-block",verticalAlign:"middle",textAlign:"left"},paperWidthFalse:{maxWidth:"calc(100% - 64px)"},paperWidthXs:{maxWidth:Math.max(e.breakpoints.values.xs,444),"&$paperScrollBody":Object(Pt.a)({},e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64),{maxWidth:"calc(100% - 64px)"})},paperWidthSm:{maxWidth:e.breakpoints.values.sm,"&$paperScrollBody":Object(Pt.a)({},e.breakpoints.down(e.breakpoints.values.sm+64),{maxWidth:"calc(100% - 64px)"})},paperWidthMd:{maxWidth:e.breakpoints.values.md,"&$paperScrollBody":Object(Pt.a)({},e.breakpoints.down(e.breakpoints.values.md+64),{maxWidth:"calc(100% - 64px)"})},paperWidthLg:{maxWidth:e.breakpoints.values.lg,"&$paperScrollBody":Object(Pt.a)({},e.breakpoints.down(e.breakpoints.values.lg+64),{maxWidth:"calc(100% - 64px)"})},paperWidthXl:{maxWidth:e.breakpoints.values.xl,"&$paperScrollBody":Object(Pt.a)({},e.breakpoints.down(e.breakpoints.values.xl+64),{maxWidth:"calc(100% - 64px)"})},paperFullWidth:{width:"calc(100% - 64px)"},paperFullScreen:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,"&$paperScrollBody":{margin:0,maxWidth:"100%"}}}}),{name:"MuiDialog"})(ur),dr=O.forwardRef((function(e,t){var i=e.disableSpacing,r=void 0!==i&&i,n=e.classes,o=e.className,s=Object(T.a)(e,["disableSpacing","classes","className"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(n.root,o,!r&&n.spacing),ref:t},s))})),pr=Object(B.a)({root:{display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},spacing:{"& > :not(:first-child)":{marginLeft:8}}},{name:"MuiDialogActions"})(dr),fr=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.dividers,o=void 0!==n&&n,s=Object(T.a)(e,["classes","className","dividers"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,o&&i.dividers),ref:t},s))})),mr=Object(B.a)((function(e){return{root:{flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"8px 24px","&:first-child":{paddingTop:20}},dividers:{padding:"16px 24px",borderTop:"1px solid ".concat(e.palette.divider),borderBottom:"1px solid ".concat(e.palette.divider)}}}),{name:"MuiDialogContent"})(fr),gr=O.forwardRef((function(e,t){return O.createElement(Zt,Object(k.a)({component:"p",variant:"body1",color:"textSecondary",ref:t},e))})),vr=Object(B.a)({root:{marginBottom:12}},{name:"MuiDialogContentText"})(gr),br=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.disableTypography,s=void 0!==o&&o,a=Object(T.a)(e,["children","classes","className","disableTypography"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(r.root,n),ref:t},a),s?i:O.createElement(Zt,{component:"h2",variant:"h6"},i))})),_r=Object(B.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(br),yr=O.forwardRef((function(e,t){var i=e.absolute,r=void 0!==i&&i,n=e.classes,o=e.className,s=e.component,a=void 0===s?"hr":s,l=e.flexItem,c=void 0!==l&&l,u=e.light,h=void 0!==u&&u,d=e.orientation,p=void 0===d?"horizontal":d,f=e.role,m=void 0===f?"hr"!==a?"separator":void 0:f,g=e.variant,v=void 0===g?"fullWidth":g,b=Object(T.a)(e,["absolute","classes","className","component","flexItem","light","orientation","role","variant"]);return O.createElement(a,Object(k.a)({className:Object(L.a)(n.root,o,"fullWidth"!==v&&n[v],r&&n.absolute,c&&n.flexItem,h&&n.light,"vertical"===p&&n.vertical),role:m,ref:t},b))})),xr=Object(B.a)((function(e){return{root:{height:1,margin:0,border:"none",flexShrink:0,backgroundColor:e.palette.divider},absolute:{position:"absolute",bottom:0,left:0,width:"100%"},inset:{marginLeft:72},light:{backgroundColor:Object(tt.d)(e.palette.divider,.08)},middle:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},vertical:{height:"100%",width:1},flexItem:{alignSelf:"stretch",height:"auto"}}}),{name:"MuiDivider"})(yr);function wr(e,t){var i=function(e,t){var i,r=t.getBoundingClientRect();if(t.fakeTransform)i=t.fakeTransform;else{var n=window.getComputedStyle(t);i=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("transform")}var o=0,s=0;if(i&&"none"!==i&&"string"==typeof i){var a=i.split("(")[1].split(")")[0].split(",");o=parseInt(a[4],10),s=parseInt(a[5],10)}return"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(").concat(o-r.left,"px)"):"right"===e?"translateX(-".concat(r.left+r.width-o,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(").concat(s-r.top,"px)"):"translateY(-".concat(r.top+r.height-s,"px)")}(e,t);i&&(t.style.webkitTransform=i,t.style.transform=i)}var Mr={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},Pr=O.forwardRef((function(e,t){var i=e.children,r=e.direction,n=void 0===r?"down":r,o=e.in,s=e.onEnter,a=e.onEntered,l=e.onEntering,c=e.onExit,u=e.onExited,h=e.onExiting,d=e.style,p=e.timeout,f=void 0===p?Mr:p,m=e.TransitionComponent,g=void 0===m?Ee:m,v=Object(T.a)(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),b=Object(Oe.a)(),_=O.useRef(null),y=O.useCallback((function(e){_.current=Q.findDOMNode(e)}),[]),x=K(K(i.ref,y),t),w=function(e){return function(t){e&&(void 0===t?e(_.current):e(_.current,t))}},M=w((function(e,t){wr(n,e),Ce(e),s&&s(e,t)})),P=w((function(e,t){var i=ke({timeout:f,style:d},{mode:"enter"});e.style.webkitTransition=b.transitions.create("-webkit-transform",Object(k.a)({},i,{easing:b.transitions.easing.easeOut})),e.style.transition=b.transitions.create("transform",Object(k.a)({},i,{easing:b.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",l&&l(e,t)})),E=w(a),S=w(h),C=w((function(e){var t=ke({timeout:f,style:d},{mode:"exit"});e.style.webkitTransition=b.transitions.create("-webkit-transform",Object(k.a)({},t,{easing:b.transitions.easing.sharp})),e.style.transition=b.transitions.create("transform",Object(k.a)({},t,{easing:b.transitions.easing.sharp})),wr(n,e),c&&c(e)})),A=w((function(e){e.style.webkitTransition="",e.style.transition="",u&&u(e)})),D=O.useCallback((function(){_.current&&wr(n,_.current)}),[n]);return O.useEffect((function(){if(!o&&"down"!==n&&"right"!==n){var e=F((function(){_.current&&wr(n,_.current)}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}}),[n,o]),O.useEffect((function(){o||D()}),[o,D]),O.createElement(g,Object(k.a)({nodeRef:_,onEnter:M,onEntered:E,onEntering:P,onExit:C,onExited:A,onExiting:S,appear:!0,in:o,timeout:f},v),(function(e,t){return O.cloneElement(i,Object(k.a)({ref:x,style:Object(k.a)({visibility:"exited"!==e||o?void 0:"hidden"},d,i.props.style)},t))}))})),Er={left:"right",right:"left",top:"down",bottom:"up"};function Sr(e){return-1!==["left","right"].indexOf(e)}function Cr(e,t){return"rtl"===e.direction&&Sr(t)?Er[t]:t}var kr={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},Or=O.forwardRef((function(e,t){var i=e.anchor,r=void 0===i?"left":i,n=e.BackdropProps,o=e.children,s=e.classes,a=e.className,l=e.elevation,c=void 0===l?16:l,u=e.ModalProps,h=(u=void 0===u?{}:u).BackdropProps,d=Object(T.a)(u,["BackdropProps"]),p=e.onClose,f=e.open,m=void 0!==f&&f,g=e.PaperProps,v=void 0===g?{}:g,b=e.SlideProps,_=e.TransitionComponent,y=void 0===_?Pr:_,x=e.transitionDuration,w=void 0===x?kr:x,M=e.variant,P=void 0===M?"temporary":M,E=Object(T.a)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"]),C=Object(Oe.a)(),A=O.useRef(!1);O.useEffect((function(){A.current=!0}),[]);var D=Cr(C,r),R=O.createElement(Re,Object(k.a)({elevation:"temporary"===P?c:0,square:!0},v,{className:Object(L.a)(s.paper,s["paperAnchor".concat(S(D))],v.className,"temporary"!==P&&s["paperAnchorDocked".concat(S(D))])}),o);if("permanent"===P)return O.createElement("div",Object(k.a)({className:Object(L.a)(s.root,s.docked,a),ref:t},E),R);var B=O.createElement(y,Object(k.a)({in:m,direction:Er[D],timeout:w,appear:A.current},b),R);return"persistent"===P?O.createElement("div",Object(k.a)({className:Object(L.a)(s.root,s.docked,a),ref:t},E),B):O.createElement(lr,Object(k.a)({BackdropProps:Object(k.a)({},n,h,{transitionDuration:w}),BackdropComponent:mt,className:Object(L.a)(s.root,s.modal,a),open:m,onClose:p,ref:t},E,d),B)})),Ar=Object(B.a)((function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}}),{name:"MuiDrawer",flip:!1})(Or),Tr=O.createContext({}),Dr=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.defaultExpanded,s=void 0!==o&&o,a=e.disabled,l=void 0!==a&&a,c=e.expanded,u=e.onChange,h=e.square,d=void 0!==h&&h,p=e.TransitionComponent,f=void 0===p?Te:p,m=e.TransitionProps,g=Object(T.a)(e,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),v=Y({controlled:c,default:s,name:"ExpansionPanel",state:"expanded"}),b=Object(me.a)(v,2),_=b[0],y=b[1],x=O.useCallback((function(e){y(!_),u&&u(e,!_)}),[_,u,y]),w=fe(O.Children.toArray(i)),M=w[0],P=w.slice(1),E=O.useMemo((function(){return{expanded:_,disabled:l,toggle:x}}),[_,l,x]);return O.createElement(Re,Object(k.a)({className:Object(L.a)(r.root,n,_&&r.expanded,l&&r.disabled,!d&&r.rounded),ref:t,square:d},g),O.createElement(Tr.Provider,{value:E},M),O.createElement(f,Object(k.a)({in:_,timeout:"auto"},m),O.createElement("div",{"aria-labelledby":M.props.id,id:M.props["aria-controls"],role:"region"},P)))})),Rr=Object(B.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{position:"relative",transition:e.transitions.create(["margin"],t),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:e.palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:e.shape.borderRadius,borderBottomRightRadius:e.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}}),{name:"MuiExpansionPanel"})(Dr),Lr=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.disableSpacing,o=void 0!==n&&n,s=Object(T.a)(e,["classes","className","disableSpacing"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,!o&&i.spacing),ref:t},s))})),Br=Object(B.a)({root:{display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end"},spacing:{"& > :not(:first-child)":{marginLeft:8}}},{name:"MuiExpansionPanelActions"})(Lr),Ir=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=Object(T.a)(e,["classes","className"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r),ref:t},n))})),Nr=Object(B.a)((function(e){return{root:{display:"flex",padding:e.spacing(1,2,2)}}}),{name:"MuiExpansionPanelDetails"})(Ir),jr=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.expandIcon,s=e.IconButtonProps,a=e.onBlur,l=e.onClick,c=e.onFocusVisible,u=Object(T.a)(e,["children","classes","className","expandIcon","IconButtonProps","onBlur","onClick","onFocusVisible"]),h=O.useState(!1),d=h[0],p=h[1],f=O.useContext(Tr),m=f.disabled,g=void 0!==m&&m,v=f.expanded,b=f.toggle;return O.createElement(et,Object(k.a)({focusRipple:!1,disableRipple:!0,disabled:g,component:"div","aria-expanded":v,className:Object(L.a)(r.root,n,g&&r.disabled,v&&r.expanded,d&&r.focused),onFocusVisible:function(e){p(!0),c&&c(e)},onBlur:function(e){p(!1),a&&a(e)},onClick:function(e){b&&b(e),l&&l(e)},ref:t},u),O.createElement("div",{className:Object(L.a)(r.content,v&&r.expanded)},i),o&&O.createElement(rt,Object(k.a)({className:Object(L.a)(r.expandIcon,v&&r.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},s),o))})),Fr=Object(B.a)((function(e){var t={duration:e.transitions.duration.shortest};return{root:{display:"flex",minHeight:48,transition:e.transitions.create(["min-height","background-color"],t),padding:e.spacing(0,2),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused":{backgroundColor:e.palette.action.focus},"&$disabled":{opacity:e.palette.action.disabledOpacity}},expanded:{},focused:{},disabled:{},content:{display:"flex",flexGrow:1,transition:e.transitions.create(["margin"],t),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:e.transitions.create("transform",t),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}}),{name:"MuiExpansionPanelSummary"})(jr),zr=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.color,s=void 0===o?"default":o,a=e.component,l=void 0===a?"button":a,c=e.disabled,u=void 0!==c&&c,h=e.disableFocusRipple,d=void 0!==h&&h,p=e.focusVisibleClassName,f=e.size,m=void 0===f?"large":f,g=e.variant,v=void 0===g?"round":g,b=Object(T.a)(e,["children","classes","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"]);return O.createElement(et,Object(k.a)({className:Object(L.a)(r.root,n,"round"!==v&&r.extended,"large"!==m&&r["size".concat(S(m))],u&&r.disabled,{primary:r.primary,secondary:r.secondary,inherit:r.colorInherit}[s]),component:l,disabled:u,focusRipple:!d,focusVisibleClassName:Object(L.a)(r.focusVisible,p),ref:t},b),O.createElement("span",{className:r.label},i))})),Vr=Object(B.a)((function(e){return{root:Object(k.a)({},e.typography.button,{boxSizing:"border-box",minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:e.shadows[6],"&:active":{boxShadow:e.shadows[12]},color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],"&:hover":{backgroundColor:e.palette.grey.A100,"@media (hover: none)":{backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground},textDecoration:"none"},"&$focusVisible":{boxShadow:e.shadows[6]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},primary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},secondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},extended:{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48,"&$sizeSmall":{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"&$sizeMedium":{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40}},focusVisible:{},disabled:{},colorInherit:{color:"inherit"},sizeSmall:{width:40,height:40},sizeMedium:{width:48,height:48}}}),{name:"MuiFab"})(zr);function Ur(e){var t=e.props,i=e.states,r=e.muiFormControl;return i.reduce((function(e,i){return e[i]=t[i],r&&void 0===t[i]&&(e[i]=r[i]),e}),{})}function Wr(e,t){return parseInt(e[t],10)||0}var Hr="undefined"!=typeof window?O.useLayoutEffect:O.useEffect,Gr={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"},Xr=O.forwardRef((function(e,t){var i=e.onChange,r=e.rows,n=e.rowsMax,o=e.rowsMin,s=void 0===o?1:o,a=e.style,l=e.value,c=Object(T.a)(e,["onChange","rows","rowsMax","rowsMin","style","value"]),u=r||s,h=O.useRef(null!=l).current,d=O.useRef(null),p=K(t,d),f=O.useRef(null),m=O.useRef(0),g=O.useState({}),v=g[0],b=g[1],_=O.useCallback((function(){var t=d.current,i=window.getComputedStyle(t),r=f.current;r.style.width=i.width,r.value=t.value||e.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var o=i["box-sizing"],s=Wr(i,"padding-bottom")+Wr(i,"padding-top"),a=Wr(i,"border-bottom-width")+Wr(i,"border-top-width"),l=r.scrollHeight-s;r.value="x";var c=r.scrollHeight-s,h=l;u&&(h=Math.max(Number(u)*c,h)),n&&(h=Math.min(Number(n)*c,h));var p=(h=Math.max(h,c))+("border-box"===o?s+a:0),g=Math.abs(h-l)<=1;b((function(e){return m.current<20&&(p>0&&Math.abs((e.outerHeightStyle||0)-p)>1||e.overflow!==g)?(m.current+=1,{overflow:g,outerHeightStyle:p}):e}))}),[n,u,e.placeholder]);return O.useEffect((function(){var e=F((function(){m.current=0,_()}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}),[_]),Hr((function(){_()})),O.useEffect((function(){m.current=0}),[l]),O.createElement(O.Fragment,null,O.createElement("textarea",Object(k.a)({value:l,onChange:function(e){m.current=0,h||_(),i&&i(e)},ref:p,rows:u,style:Object(k.a)({height:v.outerHeightStyle,overflow:v.overflow?"hidden":null},a)},c)),O.createElement("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:f,tabIndex:-1,style:Object(k.a)({},Gr,a)}))}));function Yr(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function $r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(Yr(e.value)&&""!==e.value||t&&Yr(e.defaultValue)&&""!==e.defaultValue)}var qr="undefined"==typeof window?O.useEffect:O.useLayoutEffect,Kr=O.forwardRef((function(e,t){var i=e["aria-describedby"],r=e.autoComplete,n=e.autoFocus,o=e.classes,s=e.className,a=(e.color,e.defaultValue),l=e.disabled,c=e.endAdornment,u=(e.error,e.fullWidth),h=void 0!==u&&u,d=e.id,p=e.inputComponent,f=void 0===p?"input":p,m=e.inputProps,g=void 0===m?{}:m,v=e.inputRef,b=(e.margin,e.multiline),_=void 0!==b&&b,y=e.name,x=e.onBlur,w=e.onChange,M=e.onClick,P=e.onFocus,C=e.onKeyDown,A=e.onKeyUp,D=e.placeholder,R=e.readOnly,B=e.renderSuffix,I=e.rows,N=e.rowsMax,j=e.rowsMin,F=e.startAdornment,z=e.type,V=void 0===z?"text":z,U=e.value,W=Object(T.a)(e,["aria-describedby","autoComplete","autoFocus","classes","className","color","defaultValue","disabled","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","rowsMax","rowsMin","startAdornment","type","value"]),H=null!=g.value?g.value:U,G=O.useRef(null!=H).current,X=O.useRef(),Y=O.useCallback((function(e){}),[]),$=K(v,K(g.ref,Y)),q=K(X,$),Z=O.useState(!1),Q=Z[0],J=Z[1],ee=yi(),te=Ur({props:e,muiFormControl:ee,states:["color","disabled","error","hiddenLabel","margin","required","filled"]});te.focused=ee?ee.focused:Q,O.useEffect((function(){!ee&&l&&Q&&(J(!1),x&&x())}),[ee,l,Q,x]);var ie=ee&&ee.onFilled,re=ee&&ee.onEmpty,ne=O.useCallback((function(e){$r(e)?ie&&ie():re&&re()}),[ie,re]);qr((function(){G&&ne({value:H})}),[H,ne,G]),O.useEffect((function(){ne(X.current)}),[]);var oe=f,se=Object(k.a)({},g,{ref:q});return"string"!=typeof oe?se=Object(k.a)({inputRef:q,type:V},se,{ref:null}):_?!I||N||j?(se=Object(k.a)({rows:I,rowsMax:N},se),oe=Xr):oe="textarea":se=Object(k.a)({type:V},se),O.useEffect((function(){ee&&ee.setAdornedStart(Boolean(F))}),[ee,F]),O.createElement("div",Object(k.a)({className:Object(L.a)(o.root,o["color".concat(S(te.color||"primary"))],s,te.disabled&&o.disabled,te.error&&o.error,h&&o.fullWidth,te.focused&&o.focused,ee&&o.formControl,_&&o.multiline,F&&o.adornedStart,c&&o.adornedEnd,"dense"===te.margin&&o.marginDense),onClick:function(e){X.current&&e.currentTarget===e.target&&X.current.focus(),M&&M(e)},ref:t},W),F,O.createElement(xi.Provider,{value:null},O.createElement(oe,Object(k.a)({"aria-invalid":te.error,"aria-describedby":i,autoComplete:r,autoFocus:n,defaultValue:a,disabled:te.disabled,id:d,onAnimationStart:function(e){ne("mui-auto-fill-cancel"===e.animationName?X.current:{value:"x"})},name:y,placeholder:D,readOnly:R,required:te.required,rows:I,value:H,onKeyDown:C,onKeyUp:A},se,{className:Object(L.a)(o.input,g.className,te.disabled&&o.disabled,_&&o.inputMultiline,te.hiddenLabel&&o.inputHiddenLabel,F&&o.inputAdornedStart,c&&o.inputAdornedEnd,"search"===V&&o.inputTypeSearch,"dense"===te.margin&&o.inputMarginDense),onBlur:function(e){x&&x(e),g.onBlur&&g.onBlur(e),ee&&ee.onBlur?ee.onBlur(e):J(!1)},onChange:function(e){if(!G){var t=e.target||X.current;if(null==t)throw new Error(Object(E.a)(1));ne({value:t.value})}for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];g.onChange&&g.onChange.apply(g,[e].concat(r)),w&&w.apply(void 0,[e].concat(r))},onFocus:function(e){te.disabled?e.stopPropagation():(P&&P(e),g.onFocus&&g.onFocus(e),ee&&ee.onFocus?ee.onFocus(e):J(!0))}}))),c,B?B(Object(k.a)({},te,{startAdornment:F})):null)})),Zr=Object(B.a)((function(e){var t="light"===e.palette.type,i={color:"currentColor",opacity:t?.42:.5,transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},r={opacity:"0 !important"},n={opacity:t?.42:.5};return{"@global":{"@keyframes mui-auto-fill":{},"@keyframes mui-auto-fill-cancel":{}},root:Object(k.a)({},e.typography.body1,{color:e.palette.text.primary,lineHeight:"1.1876em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center","&$disabled":{color:e.palette.text.disabled,cursor:"default"}}),formControl:{},focused:{},disabled:{},adornedStart:{},adornedEnd:{},error:{},marginDense:{},multiline:{padding:"".concat(6,"px 0 ").concat(7,"px"),"&$marginDense":{paddingTop:3}},colorSecondary:{},fullWidth:{width:"100%"},input:{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"".concat(6,"px 0 ").concat(7,"px"),border:0,boxSizing:"content-box",background:"none",height:"1.1876em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{"-webkit-appearance":"none"},"label[data-shrink=false] + $formControl &":{"&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus::-webkit-input-placeholder":n,"&:focus::-moz-placeholder":n,"&:focus:-ms-input-placeholder":n,"&:focus::-ms-input-placeholder":n},"&$disabled":{opacity:1},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},inputMarginDense:{paddingTop:3},inputMultiline:{height:"auto",resize:"none",padding:0},inputTypeSearch:{"-moz-appearance":"textfield","-webkit-appearance":"textfield"},inputAdornedStart:{},inputAdornedEnd:{},inputHiddenLabel:{}}}),{name:"MuiInputBase"})(Kr),Qr=O.forwardRef((function(e,t){var i=e.disableUnderline,r=e.classes,n=e.fullWidth,o=void 0!==n&&n,s=e.inputComponent,a=void 0===s?"input":s,l=e.multiline,c=void 0!==l&&l,u=e.type,h=void 0===u?"text":u,d=Object(T.a)(e,["disableUnderline","classes","fullWidth","inputComponent","multiline","type"]);return O.createElement(Zr,Object(k.a)({classes:Object(k.a)({},r,{root:Object(L.a)(r.root,!i&&r.underline),underline:null}),fullWidth:o,inputComponent:a,multiline:c,ref:t,type:h},d))}));Qr.muiName="Input";var Jr=Object(B.a)((function(e){var t="light"===e.palette.type,i=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",r=t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.09)";return{root:{position:"relative",backgroundColor:r,borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:t?"rgba(0, 0, 0, 0.13)":"rgba(255, 255, 255, 0.13)","@media (hover: none)":{backgroundColor:r}},"&$focused":{backgroundColor:t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.09)"},"&$disabled":{backgroundColor:t?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)"}},colorSecondary:{"&$underline:after":{borderBottomColor:e.palette.secondary.main}},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(i),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:before":{borderBottom:"1px solid ".concat(e.palette.text.primary)},"&$disabled:before":{borderBottomStyle:"dotted"}},focused:{},disabled:{},adornedStart:{paddingLeft:12},adornedEnd:{paddingRight:12},error:{},marginDense:{},multiline:{padding:"27px 12px 10px","&$marginDense":{paddingTop:23,paddingBottom:6}},input:{padding:"27px 12px 10px","&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.type?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.type?null:"#fff",caretColor:"light"===e.palette.type?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},inputMarginDense:{paddingTop:23,paddingBottom:6},inputHiddenLabel:{paddingTop:18,paddingBottom:19,"&$inputMarginDense":{paddingTop:10,paddingBottom:11}},inputMultiline:{padding:0},inputAdornedStart:{paddingLeft:0},inputAdornedEnd:{paddingRight:0}}}),{name:"MuiFilledInput"})(Qr),en=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.color,s=void 0===o?"primary":o,a=e.component,l=void 0===a?"div":a,c=e.disabled,u=void 0!==c&&c,h=e.error,d=void 0!==h&&h,p=e.fullWidth,f=void 0!==p&&p,m=e.focused,g=e.hiddenLabel,v=void 0!==g&&g,b=e.margin,_=void 0===b?"none":b,y=e.required,x=void 0!==y&&y,w=e.size,M=e.variant,P=void 0===M?"standard":M,E=Object(T.a)(e,["children","classes","className","color","component","disabled","error","fullWidth","focused","hiddenLabel","margin","required","size","variant"]),C=O.useState((function(){var e=!1;return i&&O.Children.forEach(i,(function(t){if(V(t,["Input","Select"])){var i=V(t,["Select"])?t.props.input:t;i&&function(e){return e.startAdornment}(i.props)&&(e=!0)}})),e})),A=C[0],D=C[1],R=O.useState((function(){var e=!1;return i&&O.Children.forEach(i,(function(t){V(t,["Input","Select"])&&$r(t.props,!0)&&(e=!0)})),e})),B=R[0],I=R[1],N=O.useState(!1),j=N[0],F=N[1],z=void 0!==m?m:j;u&&z&&F(!1);var U=O.useCallback((function(){I(!0)}),[]),W={adornedStart:A,setAdornedStart:D,color:s,disabled:u,error:d,filled:B,focused:z,fullWidth:f,hiddenLabel:v,margin:("small"===w?"dense":void 0)||_,onBlur:function(){F(!1)},onEmpty:O.useCallback((function(){I(!1)}),[]),onFilled:U,onFocus:function(){F(!0)},registerEffect:void 0,required:x,variant:P};return O.createElement(xi.Provider,{value:W},O.createElement(l,Object(k.a)({className:Object(L.a)(r.root,n,"none"!==_&&r["margin".concat(S(_))],f&&r.fullWidth),ref:t},E),i))})),tn=Object(B.a)({root:{display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},marginNormal:{marginTop:16,marginBottom:8},marginDense:{marginTop:8,marginBottom:4},fullWidth:{width:"100%"}},{name:"MuiFormControl"})(en),rn=O.forwardRef((function(e,t){e.checked;var i=e.classes,r=e.className,n=e.control,o=e.disabled,s=(e.inputRef,e.label),a=e.labelPlacement,l=void 0===a?"end":a,c=(e.name,e.onChange,e.value,Object(T.a)(e,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"])),u=wi(),h=o;void 0===h&&void 0!==n.props.disabled&&(h=n.props.disabled),void 0===h&&u&&(h=u.disabled);var d={disabled:h};return["checked","name","onChange","value","inputRef"].forEach((function(t){void 0===n.props[t]&&void 0!==e[t]&&(d[t]=e[t])})),O.createElement("label",Object(k.a)({className:Object(L.a)(i.root,r,"end"!==l&&i["labelPlacement".concat(S(l))],h&&i.disabled),ref:t},c),O.cloneElement(n,d),O.createElement(Zt,{component:"span",className:Object(L.a)(i.label,h&&i.disabled)},s))})),nn=Object(B.a)((function(e){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},labelPlacementTop:{flexDirection:"column-reverse",marginLeft:16},labelPlacementBottom:{flexDirection:"column",marginLeft:16},disabled:{},label:{"&$disabled":{color:e.palette.text.disabled}}}}),{name:"MuiFormControlLabel"})(rn),on=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.row,o=void 0!==n&&n,s=Object(T.a)(e,["classes","className","row"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,o&&i.row),ref:t},s))})),sn=Object(B.a)({root:{display:"flex",flexDirection:"column",flexWrap:"wrap"},row:{flexDirection:"row"}},{name:"MuiFormGroup"})(on),an=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"p":o,a=(e.disabled,e.error,e.filled,e.focused,e.margin,e.required,e.variant,Object(T.a)(e,["children","classes","className","component","disabled","error","filled","focused","margin","required","variant"])),l=Ur({props:e,muiFormControl:wi(),states:["variant","margin","disabled","error","filled","focused","required"]});return O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,("filled"===l.variant||"outlined"===l.variant)&&r.contained,n,l.disabled&&r.disabled,l.error&&r.error,l.filled&&r.filled,l.focused&&r.focused,l.required&&r.required,"dense"===l.margin&&r.marginDense),ref:t},a)," "===i?O.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):i)})),ln=Object(B.a)((function(e){return{root:Object(k.a)({color:e.palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,margin:0,"&$disabled":{color:e.palette.text.disabled},"&$error":{color:e.palette.error.main}}),error:{},disabled:{},marginDense:{marginTop:4},contained:{marginLeft:14,marginRight:14},focused:{},filled:{},required:{}}}),{name:"MuiFormHelperText"})(an),cn=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=(e.color,e.component),s=void 0===o?"label":o,a=(e.disabled,e.error,e.filled,e.focused,e.required,Object(T.a)(e,["children","classes","className","color","component","disabled","error","filled","focused","required"])),l=Ur({props:e,muiFormControl:wi(),states:["color","required","focused","disabled","error","filled"]});return O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,r["color".concat(S(l.color||"primary"))],n,l.disabled&&r.disabled,l.error&&r.error,l.filled&&r.filled,l.focused&&r.focused,l.required&&r.required),ref:t},a),i,l.required&&O.createElement("span",{"aria-hidden":!0,className:Object(L.a)(r.asterisk,l.error&&r.error)}," ","*"))})),un=Object(B.a)((function(e){return{root:Object(k.a)({color:e.palette.text.secondary},e.typography.body1,{lineHeight:1,padding:0,"&$focused":{color:e.palette.primary.main},"&$disabled":{color:e.palette.text.disabled},"&$error":{color:e.palette.error.main}}),colorSecondary:{"&$focused":{color:e.palette.secondary.main}},focused:{},disabled:{},error:{},filled:{},required:{},asterisk:{"&$error":{color:e.palette.error.main}}}}),{name:"MuiFormLabel"})(cn),hn=[0,1,2,3,4,5,6,7,8,9,10],dn=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function pn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=parseFloat(e);return"".concat(i/t).concat(String(e).replace(String(i),"")||"px")}var fn=O.forwardRef((function(e,t){var i=e.alignContent,r=void 0===i?"stretch":i,n=e.alignItems,o=void 0===n?"stretch":n,s=e.classes,a=e.className,l=e.component,c=void 0===l?"div":l,u=e.container,h=void 0!==u&&u,d=e.direction,p=void 0===d?"row":d,f=e.item,m=void 0!==f&&f,g=e.justify,v=void 0===g?"flex-start":g,b=e.lg,_=void 0!==b&&b,y=e.md,x=void 0!==y&&y,w=e.sm,M=void 0!==w&&w,P=e.spacing,E=void 0===P?0:P,S=e.wrap,C=void 0===S?"wrap":S,A=e.xl,D=void 0!==A&&A,R=e.xs,B=void 0!==R&&R,I=e.zeroMinWidth,N=void 0!==I&&I,j=Object(T.a)(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),F=Object(L.a)(s.root,a,h&&[s.container,0!==E&&s["spacing-xs-".concat(String(E))]],m&&s.item,N&&s.zeroMinWidth,"row"!==p&&s["direction-xs-".concat(String(p))],"wrap"!==C&&s["wrap-xs-".concat(String(C))],"stretch"!==o&&s["align-items-xs-".concat(String(o))],"stretch"!==r&&s["align-content-xs-".concat(String(r))],"flex-start"!==v&&s["justify-xs-".concat(String(v))],!1!==B&&s["grid-xs-".concat(String(B))],!1!==M&&s["grid-sm-".concat(String(M))],!1!==x&&s["grid-md-".concat(String(x))],!1!==_&&s["grid-lg-".concat(String(_))],!1!==D&&s["grid-xl-".concat(String(D))]);return O.createElement(c,Object(k.a)({className:F,ref:t},j))})),mn=Object(B.a)((function(e){return Object(k.a)({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-xs-center":{justifyContent:"center"},"justify-xs-flex-end":{justifyContent:"flex-end"},"justify-xs-space-between":{justifyContent:"space-between"},"justify-xs-space-around":{justifyContent:"space-around"},"justify-xs-space-evenly":{justifyContent:"space-evenly"}},function(e,t){var i={};return hn.forEach((function(t){var r=e.spacing(t);0!==r&&(i["spacing-".concat("xs","-").concat(t)]={margin:"-".concat(pn(r,2)),width:"calc(100% + ".concat(pn(r),")"),"& > $item":{padding:pn(r,2)}})})),i}(e),e.breakpoints.keys.reduce((function(t,i){return function(e,t,i){var r={};dn.forEach((function(e){var t="grid-".concat(i,"-").concat(e);if(!0!==e)if("auto"!==e){var n="".concat(Math.round(e/12*1e8)/1e6,"%");r[t]={flexBasis:n,flexGrow:0,maxWidth:n}}else r[t]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};else r[t]={flexBasis:0,flexGrow:1,maxWidth:"100%"}})),"xs"===i?Object(k.a)(e,r):e[t.breakpoints.up(i)]=r}(t,e,i),t}),{}))}),{name:"MuiGrid"})(fn),gn=O.forwardRef((function(e,t){var i=e.cellHeight,r=void 0===i?180:i,n=e.children,o=e.classes,s=e.className,a=e.cols,l=void 0===a?2:a,c=e.component,u=void 0===c?"ul":c,h=e.spacing,d=void 0===h?4:h,p=e.style,f=Object(T.a)(e,["cellHeight","children","classes","className","cols","component","spacing","style"]);return O.createElement(u,Object(k.a)({className:Object(L.a)(o.root,s),ref:t,style:Object(k.a)({margin:-d/2},p)},f),O.Children.map(n,(function(e){if(!O.isValidElement(e))return null;var t=e.props.cols||1,i=e.props.rows||1;return O.cloneElement(e,{style:Object(k.a)({width:"".concat(100/l*t,"%"),height:"auto"===r?"auto":r*i+d,padding:d/2},e.props.style)})})))})),vn=Object(B.a)({root:{display:"flex",flexWrap:"wrap",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch"}},{name:"MuiGridList"})(gn),bn=function(e,t){var i,r,n,o;e&&e.complete&&(e.width/e.height>e.parentElement.offsetWidth/e.parentElement.offsetHeight?((i=e.classList).remove.apply(i,Object(Ve.a)(t.imgFullWidth.split(" "))),(r=e.classList).add.apply(r,Object(Ve.a)(t.imgFullHeight.split(" ")))):((n=e.classList).remove.apply(n,Object(Ve.a)(t.imgFullHeight.split(" "))),(o=e.classList).add.apply(o,Object(Ve.a)(t.imgFullWidth.split(" ")))))},_n=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=(e.cols,e.component),s=void 0===o?"li":o,a=(e.rows,Object(T.a)(e,["children","classes","className","cols","component","rows"])),l=O.useRef(null);return O.useEffect((function(){!function(e,t){e&&(e.complete?bn(e,t):e.addEventListener("load",(function(){bn(e,t)})))}(l.current,r)})),O.useEffect((function(){var e=F((function(){bn(l.current,r)}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}),[r]),O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,n),ref:t},a),O.createElement("div",{className:r.tile},O.Children.map(i,(function(e){return O.isValidElement(e)?"img"===e.type||V(e,["Image"])?O.cloneElement(e,{ref:l}):e:null}))))})),yn=Object(B.a)({root:{boxSizing:"border-box",flexShrink:0},tile:{position:"relative",display:"block",height:"100%",overflow:"hidden"},imgFullHeight:{height:"100%",transform:"translateX(-50%)",position:"relative",left:"50%"},imgFullWidth:{width:"100%",position:"relative",transform:"translateY(-50%)",top:"50%"}},{name:"MuiGridListTile"})(_n),xn=O.forwardRef((function(e,t){var i=e.actionIcon,r=e.actionPosition,n=void 0===r?"right":r,o=e.classes,s=e.className,a=e.subtitle,l=e.title,c=e.titlePosition,u=void 0===c?"bottom":c,h=Object(T.a)(e,["actionIcon","actionPosition","classes","className","subtitle","title","titlePosition"]),d=i&&n;return O.createElement("div",Object(k.a)({className:Object(L.a)(o.root,s,"top"===u?o.titlePositionTop:o.titlePositionBottom,a&&o.rootSubtitle),ref:t},h),O.createElement("div",{className:Object(L.a)(o.titleWrap,{left:o.titleWrapActionPosLeft,right:o.titleWrapActionPosRight}[d])},O.createElement("div",{className:o.title},l),a?O.createElement("div",{className:o.subtitle},a):null),i?O.createElement("div",{className:Object(L.a)(o.actionIcon,"left"===d&&o.actionIconActionPosLeft)},i):null)})),wn=Object(B.a)((function(e){return{root:{position:"absolute",left:0,right:0,height:48,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",fontFamily:e.typography.fontFamily},titlePositionBottom:{bottom:0},titlePositionTop:{top:0},rootSubtitle:{height:68},titleWrap:{flexGrow:1,marginLeft:16,marginRight:16,color:e.palette.common.white,overflow:"hidden"},titleWrapActionPosLeft:{marginLeft:0},titleWrapActionPosRight:{marginRight:0},title:{fontSize:e.typography.pxToRem(16),lineHeight:"24px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},subtitle:{fontSize:e.typography.pxToRem(12),lineHeight:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},actionIcon:{},actionIconActionPosLeft:{order:-1}}}),{name:"MuiGridListTileBar"})(xn);function Mn(e){return"scale(".concat(e,", ").concat(Math.pow(e,2),")")}var Pn={entering:{opacity:1,transform:Mn(1)},entered:{opacity:1,transform:"none"}},En=O.forwardRef((function(e,t){var i=e.children,r=e.disableStrictModeCompat,n=void 0!==r&&r,o=e.in,s=e.onEnter,a=e.onEntered,l=e.onEntering,c=e.onExit,u=e.onExited,h=e.onExiting,d=e.style,p=e.timeout,f=void 0===p?"auto":p,m=e.TransitionComponent,g=void 0===m?Ee:m,v=Object(T.a)(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),b=O.useRef(),_=O.useRef(),y=Object(Oe.a)(),x=y.unstable_strictMode&&!n,w=O.useRef(null),M=K(i.ref,t),P=K(x?w:void 0,M),E=function(e){return function(t,i){if(e){var r=x?[w.current,t]:[t,i],n=Object(me.a)(r,2),o=n[0],s=n[1];void 0===s?e(o):e(o,s)}}},S=E(l),C=E((function(e,t){Ce(e);var i,r=ke({style:d,timeout:f},{mode:"enter"}),n=r.duration,o=r.delay;"auto"===f?(i=y.transitions.getAutoHeightDuration(e.clientHeight),_.current=i):i=n,e.style.transition=[y.transitions.create("opacity",{duration:i,delay:o}),y.transitions.create("transform",{duration:.666*i,delay:o})].join(","),s&&s(e,t)})),A=E(a),D=E(h),R=E((function(e){var t,i=ke({style:d,timeout:f},{mode:"exit"}),r=i.duration,n=i.delay;"auto"===f?(t=y.transitions.getAutoHeightDuration(e.clientHeight),_.current=t):t=r,e.style.transition=[y.transitions.create("opacity",{duration:t,delay:n}),y.transitions.create("transform",{duration:.666*t,delay:n||.333*t})].join(","),e.style.opacity="0",e.style.transform=Mn(.75),c&&c(e)})),L=E(u);return O.useEffect((function(){return function(){clearTimeout(b.current)}}),[]),O.createElement(g,Object(k.a)({appear:!0,in:o,nodeRef:x?w:void 0,onEnter:C,onEntered:A,onEntering:S,onExit:R,onExited:L,onExiting:D,addEndListener:function(e,t){var i=x?e:t;"auto"===f&&(b.current=setTimeout(i,_.current||0))},timeout:"auto"===f?null:f},v),(function(e,t){return O.cloneElement(i,Object(k.a)({style:Object(k.a)({opacity:0,transform:Mn(.75),visibility:"exited"!==e||o?void 0:"hidden"},Pn[e],d,i.props.style),ref:P},t))}))}));En.muiSupportAuto=!0;var Sn=En,Cn=i(48),kn=i.n(Cn),On=i(39);function An(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object(Gi.a)(),r=Object(Xi.a)({theme:i,name:"MuiUseMediaQuery",props:{}}),n="function"==typeof e?e(i):e;n=n.replace(/^@media( ?)/m,"");var o="undefined"!=typeof window&&void 0!==window.matchMedia,s=Object(k.a)({},r,t),a=s.defaultMatches,l=void 0!==a&&a,c=s.matchMedia,u=void 0===c?o?window.matchMedia:null:c,h=s.noSsr,d=void 0!==h&&h,p=s.ssrMatchMedia,f=void 0===p?null:p,m=O.useState((function(){return d&&o?u(n).matches:f?f(n).matches:l})),g=m[0],v=m[1];return O.useEffect((function(){var e=!0;if(o){var t=u(n),i=function(){e&&v(t.matches)};return i(),t.addListener(i),function(){e=!1,t.removeListener(i)}}}),[n,u,o]),g}var Tn=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?On.b.indexOf(e)<On.b.indexOf(t):On.b.indexOf(e)<=On.b.indexOf(t)},Dn=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?On.b.indexOf(t)<On.b.indexOf(e):On.b.indexOf(t)<=On.b.indexOf(e)},Rn="undefined"==typeof window?O.useEffect:O.useLayoutEffect,Ln=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var i=e.withTheme,r=void 0!==i&&i,n=e.noSSR,o=void 0!==n&&n,s=e.initialWidth;function a(e){var i=Object(Oe.a)(),n=e.theme||i,a=Object(Xi.a)({theme:n,name:"MuiWithWidth",props:Object(k.a)({},e)}),l=a.initialWidth,c=a.width,u=Object(T.a)(a,["initialWidth","width"]),h=O.useState(!1),d=h[0],p=h[1];Rn((function(){p(!0)}),[]);var f=n.breakpoints.keys.slice().reverse().reduce((function(e,t){var i=An(n.breakpoints.up(t));return!e&&i?t:e}),null),m=Object(k.a)({width:c||(d||o?f:void 0)||l||s},r?{theme:n}:{},u);return void 0===m.width?null:O.createElement(t,m)}return kn()(a,t),a}};function Bn(e){var t=e.children,i=e.only,r=e.width,n=Object(Oe.a)(),o=!0;if(i)if(Array.isArray(i)){for(var s=0;s<i.length;s+=1)if(r===i[s]){o=!1;break}}else i&&r===i&&(o=!1);if(o)for(var a=0;a<n.breakpoints.keys.length;a+=1){var l=n.breakpoints.keys[a],c=e["".concat(l,"Up")],u=e["".concat(l,"Down")];if(c&&Tn(l,r)||u&&Dn(l,r)){o=!1;break}}return o?t:null}Bn.propTypes={children:R.a.node,className:R.a.string,implementation:R.a.oneOf(["js","css"]),initialWidth:R.a.oneOf(["xs","sm","md","lg","xl"]),lgDown:R.a.bool,lgUp:R.a.bool,mdDown:R.a.bool,mdUp:R.a.bool,only:R.a.oneOfType([R.a.oneOf(["xs","sm","md","lg","xl"]),R.a.arrayOf(R.a.oneOf(["xs","sm","md","lg","xl"]))]),smDown:R.a.bool,smUp:R.a.bool,width:R.a.string.isRequired,xlDown:R.a.bool,xlUp:R.a.bool,xsDown:R.a.bool,xsUp:R.a.bool};var In=Ln()(Bn),Nn=Object(B.a)((function(e){var t={display:"none"};return e.breakpoints.keys.reduce((function(i,r){return i["only".concat(S(r))]=Object(Pt.a)({},e.breakpoints.only(r),t),i["".concat(r,"Up")]=Object(Pt.a)({},e.breakpoints.up(r),t),i["".concat(r,"Down")]=Object(Pt.a)({},e.breakpoints.down(r),t),i}),{})}),{name:"PrivateHiddenCss"})((function(e){var t=e.children,i=e.classes,r=e.className,n=e.only,o=(Object(T.a)(e,["children","classes","className","only"]),Object(Oe.a)()),s=[];r&&s.push(r);for(var a=0;a<o.breakpoints.keys.length;a+=1){var l=o.breakpoints.keys[a],c=e["".concat(l,"Up")],u=e["".concat(l,"Down")];c&&s.push(i["".concat(l,"Up")]),u&&s.push(i["".concat(l,"Down")])}return n&&(Array.isArray(n)?n:[n]).forEach((function(e){s.push(i["only".concat(S(e))])})),O.createElement("div",{className:s.join(" ")},t)})),jn=function(e){var t=e.implementation,i=void 0===t?"js":t,r=e.lgDown,n=void 0!==r&&r,o=e.lgUp,s=void 0!==o&&o,a=e.mdDown,l=void 0!==a&&a,c=e.mdUp,u=void 0!==c&&c,h=e.smDown,d=void 0!==h&&h,p=e.smUp,f=void 0!==p&&p,m=e.xlDown,g=void 0!==m&&m,v=e.xlUp,b=void 0!==v&&v,_=e.xsDown,y=void 0!==_&&_,x=e.xsUp,w=void 0!==x&&x,M=Object(T.a)(e,["implementation","lgDown","lgUp","mdDown","mdUp","smDown","smUp","xlDown","xlUp","xsDown","xsUp"]);return"js"===i?O.createElement(In,Object(k.a)({lgDown:n,lgUp:s,mdDown:l,mdUp:u,smDown:d,smUp:f,xlDown:g,xlUp:b,xsDown:y,xsUp:w},M)):O.createElement(Nn,Object(k.a)({lgDown:n,lgUp:s,mdDown:l,mdUp:u,smDown:d,smUp:f,xlDown:g,xlUp:b,xsDown:y,xsUp:w},M))},Fn=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"inherit":n,s=e.component,a=void 0===s?"span":s,l=e.fontSize,c=void 0===l?"default":l,u=Object(T.a)(e,["classes","className","color","component","fontSize"]);return O.createElement(a,Object(k.a)({className:Object(L.a)("material-icons",i.root,r,"inherit"!==o&&i["color".concat(S(o))],"default"!==c&&i["fontSize".concat(S(c))]),"aria-hidden":!0,ref:t},u))}));Fn.muiName="Icon";var zn=Object(B.a)((function(e){return{root:{userSelect:"none",fontSize:e.typography.pxToRem(24),width:"1em",height:"1em",overflow:"hidden",flexShrink:0},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(36)}}}),{name:"MuiIcon"})(Fn),Vn=O.forwardRef((function(e,t){var i=e.disableUnderline,r=e.classes,n=e.fullWidth,o=void 0!==n&&n,s=e.inputComponent,a=void 0===s?"input":s,l=e.multiline,c=void 0!==l&&l,u=e.type,h=void 0===u?"text":u,d=Object(T.a)(e,["disableUnderline","classes","fullWidth","inputComponent","multiline","type"]);return O.createElement(Zr,Object(k.a)({classes:Object(k.a)({},r,{root:Object(L.a)(r.root,!i&&r.underline),underline:null}),fullWidth:o,inputComponent:a,multiline:c,ref:t,type:h},d))}));Vn.muiName="Input";var Un=Object(B.a)((function(e){var t="light"===e.palette.type?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{position:"relative"},formControl:{"label + &":{marginTop:16}},focused:{},disabled:{},colorSecondary:{"&$underline:after":{borderBottomColor:e.palette.secondary.main}},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(t),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):before":{borderBottom:"2px solid ".concat(e.palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(t)}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{},marginDense:{},multiline:{},fullWidth:{},input:{},inputMarginDense:{},inputMultiline:{},inputTypeSearch:{}}}),{name:"MuiInput"})(Vn),Wn=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"div":o,a=e.disablePointerEvents,l=void 0!==a&&a,c=e.disableTypography,u=void 0!==c&&c,h=e.position,d=e.variant,p=Object(T.a)(e,["children","classes","className","component","disablePointerEvents","disableTypography","position","variant"]),f=yi()||{},m=d;return d&&f.variant,f&&!m&&(m=f.variant),O.createElement(xi.Provider,{value:null},O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,n,l&&r.disablePointerEvents,f.hiddenLabel&&r.hiddenLabel,"filled"===m&&r.filled,{start:r.positionStart,end:r.positionEnd}[h],"dense"===f.margin&&r.marginDense),ref:t},p),"string"!=typeof i||u?i:O.createElement(Zt,{color:"textSecondary"},i)))})),Hn=Object(B.a)({root:{display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap"},filled:{"&$positionStart:not($hiddenLabel)":{marginTop:16}},positionStart:{marginRight:8},positionEnd:{marginLeft:8},disablePointerEvents:{pointerEvents:"none"},hiddenLabel:{},marginDense:{}},{name:"MuiInputAdornment"})(Wn),Gn=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.disableAnimation,o=void 0!==n&&n,s=(e.margin,e.shrink),a=(e.variant,Object(T.a)(e,["classes","className","disableAnimation","margin","shrink","variant"])),l=wi(),c=s;void 0===c&&l&&(c=l.filled||l.focused||l.adornedStart);var u=Ur({props:e,muiFormControl:l,states:["margin","variant"]});return O.createElement(un,Object(k.a)({"data-shrink":c,className:Object(L.a)(i.root,r,l&&i.formControl,!o&&i.animated,c&&i.shrink,"dense"===u.margin&&i.marginDense,{filled:i.filled,outlined:i.outlined}[u.variant]),classes:{focused:i.focused,disabled:i.disabled,error:i.error,required:i.required,asterisk:i.asterisk},ref:t},a))})),Xn=Object(B.a)((function(e){return{root:{display:"block",transformOrigin:"top left"},focused:{},disabled:{},error:{},required:{},asterisk:{},formControl:{position:"absolute",left:0,top:0,transform:"translate(0, 24px) scale(1)"},marginDense:{transform:"translate(0, 21px) scale(1)"},shrink:{transform:"translate(0, 1.5px) scale(0.75)",transformOrigin:"top left"},animated:{transition:e.transitions.create(["color","transform"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},filled:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 20px) scale(1)","&$marginDense":{transform:"translate(12px, 17px) scale(1)"},"&$shrink":{transform:"translate(12px, 10px) scale(0.75)","&$marginDense":{transform:"translate(12px, 7px) scale(0.75)"}}},outlined:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 20px) scale(1)","&$marginDense":{transform:"translate(14px, 12px) scale(1)"},"&$shrink":{transform:"translate(14px, -6px) scale(0.75)"}}}}),{name:"MuiInputLabel"})(Gn),Yn=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"primary":n,s=e.value,a=e.valueBuffer,l=e.variant,c=void 0===l?"indeterminate":l,u=Object(T.a)(e,["classes","className","color","value","valueBuffer","variant"]),h=Object(Oe.a)(),d={},p={bar1:{},bar2:{}};if(("determinate"===c||"buffer"===c)&&void 0!==s){d["aria-valuenow"]=Math.round(s),d["aria-valuemin"]=0,d["aria-valuemax"]=100;var f=s-100;"rtl"===h.direction&&(f=-f),p.bar1.transform="translateX(".concat(f,"%)")}if("buffer"===c&&void 0!==a){var m=(a||0)-100;"rtl"===h.direction&&(m=-m),p.bar2.transform="translateX(".concat(m,"%)")}return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,i["color".concat(S(o))],r,{determinate:i.determinate,indeterminate:i.indeterminate,buffer:i.buffer,query:i.query}[c]),role:"progressbar"},d,{ref:t},u),"buffer"===c?O.createElement("div",{className:Object(L.a)(i.dashed,i["dashedColor".concat(S(o))])}):null,O.createElement("div",{className:Object(L.a)(i.bar,i["barColor".concat(S(o))],("indeterminate"===c||"query"===c)&&i.bar1Indeterminate,{determinate:i.bar1Determinate,buffer:i.bar1Buffer}[c]),style:p.bar1}),"determinate"===c?null:O.createElement("div",{className:Object(L.a)(i.bar,("indeterminate"===c||"query"===c)&&i.bar2Indeterminate,"buffer"===c?[i["color".concat(S(o))],i.bar2Buffer]:i["barColor".concat(S(o))]),style:p.bar2}))})),$n=Object(B.a)((function(e){var t=function(t){return"light"===e.palette.type?Object(tt.i)(t,.62):Object(tt.a)(t,.5)},i=t(e.palette.primary.main),r=t(e.palette.secondary.main);return{root:{position:"relative",overflow:"hidden",height:4,"@media print":{colorAdjust:"exact"}},colorPrimary:{backgroundColor:i},colorSecondary:{backgroundColor:r},determinate:{},indeterminate:{},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"$buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat(i," 0%, ").concat(i," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:e.palette.primary.main},barColorSecondary:{backgroundColor:e.palette.secondary.main},bar1Indeterminate:{width:"auto",animation:"$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{transition:"transform .".concat(4,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(4,"s linear")},bar2Indeterminate:{width:"auto",animation:"$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite"},bar2Buffer:{transition:"transform .".concat(4,"s linear")},"@keyframes indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0 -23px"},"50%":{opacity:0,backgroundPosition:"0 -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}}),{name:"MuiLinearProgress"})(Yn),qn=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"primary":n,s=e.component,a=void 0===s?"a":s,l=e.onBlur,c=e.onFocus,u=e.TypographyClasses,h=e.underline,d=void 0===h?"hover":h,p=e.variant,f=void 0===p?"inherit":p,m=Object(T.a)(e,["classes","className","color","component","onBlur","onFocus","TypographyClasses","underline","variant"]),g=ce(),v=g.isFocusVisible,b=g.onBlurVisible,_=g.ref,y=O.useState(!1),x=y[0],w=y[1],M=K(t,_);return O.createElement(Zt,Object(k.a)({className:Object(L.a)(i.root,i["underline".concat(S(d))],r,x&&i.focusVisible,"button"===a&&i.button),classes:u,color:o,component:a,onBlur:function(e){x&&(b(),w(!1)),l&&l(e)},onFocus:function(e){v(e)&&w(!0),c&&c(e)},ref:M,variant:f},m))})),Kn=Object(B.a)({root:{},underlineNone:{textDecoration:"none"},underlineHover:{textDecoration:"none","&:hover":{textDecoration:"underline"}},underlineAlways:{textDecoration:"underline"},button:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none","&::-moz-focus-inner":{borderStyle:"none"},"&$focusVisible":{outline:"auto"}},focusVisible:{}},{name:"MuiLink"})(qn),Zn=O.createContext({}),Qn=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.component,s=void 0===o?"ul":o,a=e.dense,l=void 0!==a&&a,c=e.disablePadding,u=void 0!==c&&c,h=e.subheader,d=Object(T.a)(e,["children","classes","className","component","dense","disablePadding","subheader"]),p=O.useMemo((function(){return{dense:l}}),[l]);return O.createElement(Zn.Provider,{value:p},O.createElement(s,Object(k.a)({className:Object(L.a)(r.root,n,l&&r.dense,!u&&r.padding,h&&r.subheader),ref:t},d),h,i))})),Jn=Object(B.a)({root:{listStyle:"none",margin:0,padding:0,position:"relative"},padding:{paddingTop:8,paddingBottom:8},dense:{},subheader:{paddingTop:0}},{name:"MuiList"})(Qn),eo="undefined"==typeof window?O.useEffect:O.useLayoutEffect,to=O.forwardRef((function(e,t){var i=e.alignItems,r=void 0===i?"center":i,n=e.autoFocus,o=void 0!==n&&n,s=e.button,a=void 0!==s&&s,l=e.children,c=e.classes,u=e.className,h=e.component,d=e.ContainerComponent,p=void 0===d?"li":d,f=e.ContainerProps,m=(f=void 0===f?{}:f).className,g=Object(T.a)(f,["className"]),v=e.dense,b=void 0!==v&&v,_=e.disabled,y=void 0!==_&&_,x=e.disableGutters,w=void 0!==x&&x,M=e.divider,P=void 0!==M&&M,E=e.focusVisibleClassName,S=e.selected,C=void 0!==S&&S,A=Object(T.a)(e,["alignItems","autoFocus","button","children","classes","className","component","ContainerComponent","ContainerProps","dense","disabled","disableGutters","divider","focusVisibleClassName","selected"]),D=O.useContext(Zn),R={dense:b||D.dense||!1,alignItems:r},B=O.useRef(null);eo((function(){o&&B.current&&B.current.focus()}),[o]);var I=O.Children.toArray(l),N=I.length&&V(I[I.length-1],["ListItemSecondaryAction"]),j=K(O.useCallback((function(e){B.current=Q.findDOMNode(e)}),[]),t),F=Object(k.a)({className:Object(L.a)(c.root,u,R.dense&&c.dense,!w&&c.gutters,P&&c.divider,y&&c.disabled,a&&c.button,"center"!==r&&c.alignItemsFlexStart,N&&c.secondaryAction,C&&c.selected),disabled:y},A),z=h||"li";return a&&(F.component=h||"div",F.focusVisibleClassName=Object(L.a)(c.focusVisible,E),z=et),N?(z=F.component||h?z:"div","li"===p&&("li"===z?z="div":"li"===F.component&&(F.component="div")),O.createElement(Zn.Provider,{value:R},O.createElement(p,Object(k.a)({className:Object(L.a)(c.container,m),ref:j},g),O.createElement(z,F,I),I.pop()))):O.createElement(Zn.Provider,{value:R},O.createElement(z,Object(k.a)({ref:j},F),I))})),io=Object(B.a)((function(e){return{root:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,"&$focusVisible":{backgroundColor:e.palette.action.selected},"&$selected, &$selected:hover":{backgroundColor:e.palette.action.selected},"&$disabled":{opacity:.5}},container:{position:"relative"},focusVisible:{},dense:{paddingTop:4,paddingBottom:4},alignItemsFlexStart:{alignItems:"flex-start"},disabled:{},divider:{borderBottom:"1px solid ".concat(e.palette.divider),backgroundClip:"padding-box"},gutters:{paddingLeft:16,paddingRight:16},button:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},secondaryAction:{paddingRight:48},selected:{}}}),{name:"MuiListItem"})(to),ro=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=Object(T.a)(e,["classes","className"]),o=O.useContext(Zn);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,"flex-start"===o.alignItems&&i.alignItemsFlexStart),ref:t},n))})),no=Object(B.a)({root:{minWidth:56,flexShrink:0},alignItemsFlexStart:{marginTop:8}},{name:"MuiListItemAvatar"})(ro),oo=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=Object(T.a)(e,["classes","className"]),o=O.useContext(Zn);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r,"flex-start"===o.alignItems&&i.alignItemsFlexStart),ref:t},n))})),so=Object(B.a)((function(e){return{root:{minWidth:56,color:e.palette.action.active,flexShrink:0,display:"inline-flex"},alignItemsFlexStart:{marginTop:8}}}),{name:"MuiListItemIcon"})(oo),ao=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=Object(T.a)(e,["classes","className"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(i.root,r),ref:t},n))}));ao.muiName="ListItemSecondaryAction";var lo=Object(B.a)({root:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"}},{name:"MuiListItemSecondaryAction"})(ao),co=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.className,o=e.disableTypography,s=void 0!==o&&o,a=e.inset,l=void 0!==a&&a,c=e.primary,u=e.primaryTypographyProps,h=e.secondary,d=e.secondaryTypographyProps,p=Object(T.a)(e,["children","classes","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"]),f=O.useContext(Zn).dense,m=null!=c?c:i;null==m||m.type===Zt||s||(m=O.createElement(Zt,Object(k.a)({variant:f?"body2":"body1",className:r.primary,component:"span",display:"block"},u),m));var g=h;return null==g||g.type===Zt||s||(g=O.createElement(Zt,Object(k.a)({variant:"body2",className:r.secondary,color:"textSecondary",display:"block"},d),g)),O.createElement("div",Object(k.a)({className:Object(L.a)(r.root,n,f&&r.dense,l&&r.inset,m&&g&&r.multiline),ref:t},p),m,g)})),uo=Object(B.a)({root:{flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},multiline:{marginTop:6,marginBottom:6},dense:{},inset:{paddingLeft:56},primary:{},secondary:{}},{name:"MuiListItemText"})(co),ho=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"default":n,s=e.component,a=void 0===s?"li":s,l=e.disableGutters,c=void 0!==l&&l,u=e.disableSticky,h=void 0!==u&&u,d=e.inset,p=void 0!==d&&d,f=Object(T.a)(e,["classes","className","color","component","disableGutters","disableSticky","inset"]);return O.createElement(a,Object(k.a)({className:Object(L.a)(i.root,r,"default"!==o&&i["color".concat(S(o))],p&&i.inset,!h&&i.sticky,!c&&i.gutters),ref:t},f))})),po=Object(B.a)((function(e){return{root:{boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:e.palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14)},colorPrimary:{color:e.palette.primary.main},colorInherit:{color:"inherit"},gutters:{paddingLeft:16,paddingRight:16},inset:{paddingLeft:72},sticky:{position:"sticky",top:0,zIndex:1,backgroundColor:"inherit"}}}),{name:"MuiListSubheader"})(ho);function fo(e,t){var i=0;return"number"==typeof t?i=t:"center"===t?i=e.height/2:"bottom"===t&&(i=e.height),i}function mo(e,t){var i=0;return"number"==typeof t?i=t:"center"===t?i=e.width/2:"right"===t&&(i=e.width),i}function go(e){return[e.horizontal,e.vertical].map((function(e){return"number"==typeof e?"".concat(e,"px"):e})).join(" ")}function vo(e){return"function"==typeof e?e():e}var bo=O.forwardRef((function(e,t){var i=e.action,r=e.anchorEl,n=e.anchorOrigin,o=void 0===n?{vertical:"top",horizontal:"left"}:n,s=e.anchorPosition,a=e.anchorReference,l=void 0===a?"anchorEl":a,c=e.children,u=e.classes,h=e.className,d=e.container,p=e.elevation,f=void 0===p?8:p,m=e.getContentAnchorEl,g=e.marginThreshold,v=void 0===g?16:g,b=e.onEnter,_=e.onEntered,y=e.onEntering,x=e.onExit,w=e.onExited,M=e.onExiting,P=e.open,E=e.PaperProps,S=void 0===E?{}:E,A=e.transformOrigin,D=void 0===A?{vertical:"top",horizontal:"left"}:A,R=e.TransitionComponent,B=void 0===R?Sn:R,I=e.transitionDuration,N=void 0===I?"auto":I,j=e.TransitionProps,z=void 0===j?{}:j,V=Object(T.a)(e,["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","classes","className","container","elevation","getContentAnchorEl","marginThreshold","onEnter","onEntered","onEntering","onExit","onExited","onExiting","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"]),H=O.useRef(),G=O.useCallback((function(e){if("anchorPosition"===l)return s;var t=vo(r),i=(t&&1===t.nodeType?t:U(H.current).body).getBoundingClientRect(),n=0===e?o.vertical:"center";return{top:i.top+fo(i,n),left:i.left+mo(i,o.horizontal)}}),[r,o.horizontal,o.vertical,s,l]),X=O.useCallback((function(e){var t=0;if(m&&"anchorEl"===l){var i=m(e);if(i&&e.contains(i)){var r=function(e,t){for(var i=t,r=0;i&&i!==e;)r+=(i=i.parentElement).scrollTop;return r}(e,i);t=i.offsetTop+i.clientHeight/2-r||0}}return t}),[o.vertical,l,m]),Y=O.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{vertical:fo(e,D.vertical)+t,horizontal:mo(e,D.horizontal)}}),[D.horizontal,D.vertical]),$=O.useCallback((function(e){var t=X(e),i={width:e.offsetWidth,height:e.offsetHeight},n=Y(i,t);if("none"===l)return{top:null,left:null,transformOrigin:go(n)};var o=G(t),s=o.top-n.vertical,a=o.left-n.horizontal,c=s+i.height,u=a+i.width,h=W(vo(r)),d=h.innerHeight-v,p=h.innerWidth-v;if(s<v){var f=s-v;s-=f,n.vertical+=f}else if(c>d){var m=c-d;s-=m,n.vertical+=m}if(a<v){var g=a-v;a-=g,n.horizontal+=g}else if(u>p){var b=u-p;a-=b,n.horizontal+=b}return{top:"".concat(Math.round(s),"px"),left:"".concat(Math.round(a),"px"),transformOrigin:go(n)}}),[r,l,G,X,Y,v]),q=O.useCallback((function(){var e=H.current;if(e){var t=$(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin}}),[$]),K=O.useCallback((function(e){H.current=Q.findDOMNode(e)}),[]);O.useEffect((function(){P&&q()})),O.useImperativeHandle(i,(function(){return P?{updatePosition:function(){q()}}:null}),[P,q]),O.useEffect((function(){if(P){var e=F((function(){q()}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}}),[P,q]);var Z=N;"auto"!==N||B.muiSupportAuto||(Z=void 0);var J=d||(r?U(vo(r)).body:void 0);return O.createElement(lr,Object(k.a)({container:J,open:P,ref:t,BackdropProps:{invisible:!0},className:Object(L.a)(u.root,h)},V),O.createElement(B,Object(k.a)({appear:!0,in:P,onEnter:b,onEntered:_,onExit:x,onExited:w,onExiting:M,timeout:Z},z,{onEntering:C((function(e,t){y&&y(e,t),q()}),z.onEntering)}),O.createElement(Re,Object(k.a)({elevation:f,ref:K},S,{className:Object(L.a)(u.paper,S.className)}),c)))})),_o=Object(B.a)({root:{},paper:{position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}},{name:"MuiPopover"})(bo);function yo(e,t,i){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:i?null:e.firstChild}function xo(e,t,i){return e===t?i?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:i?null:e.lastChild}function wo(e,t){if(void 0===t)return!0;var i=e.innerText;return void 0===i&&(i=e.textContent),0!==(i=i.trim().toLowerCase()).length&&(t.repeating?i[0]===t.keys[0]:0===i.indexOf(t.keys.join("")))}function Mo(e,t,i,r,n,o){for(var s=!1,a=n(e,t,!!t&&i);a;){if(a===e.firstChild){if(s)return;s=!0}var l=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&wo(a,o)&&!l)return void a.focus();a=n(e,a,i)}}var Po="undefined"==typeof window?O.useEffect:O.useLayoutEffect,Eo=O.forwardRef((function(e,t){var i=e.actions,r=e.autoFocus,n=void 0!==r&&r,o=e.autoFocusItem,s=void 0!==o&&o,a=e.children,l=e.className,c=e.disabledItemsFocusable,u=void 0!==c&&c,h=e.disableListWrap,d=void 0!==h&&h,p=e.onKeyDown,f=e.variant,m=void 0===f?"selectedMenu":f,g=Object(T.a)(e,["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"]),v=O.useRef(null),b=O.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Po((function(){n&&v.current.focus()}),[n]),O.useImperativeHandle(i,(function(){return{adjustStyleForScrollbar:function(e,t){var i=!v.current.style.width;if(e.clientHeight<v.current.clientHeight&&i){var r="".concat(Qi(),"px");v.current.style["rtl"===t.direction?"paddingLeft":"paddingRight"]=r,v.current.style.width="calc(100% + ".concat(r,")")}return v.current}}}),[]);var _=K(O.useCallback((function(e){v.current=Q.findDOMNode(e)}),[]),t),y=-1;O.Children.forEach(a,(function(e,t){O.isValidElement(e)&&(e.props.disabled||("selectedMenu"===m&&e.props.selected||-1===y)&&(y=t))}));var x=O.Children.map(a,(function(e,t){if(t===y){var i={};return s&&(i.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===m&&(i.tabIndex=0),O.cloneElement(e,i)}return e}));return O.createElement(Jn,Object(k.a)({role:"menu",ref:_,className:l,onKeyDown:function(e){var t=v.current,i=e.key,r=U(t).activeElement;if("ArrowDown"===i)e.preventDefault(),Mo(t,r,d,u,yo);else if("ArrowUp"===i)e.preventDefault(),Mo(t,r,d,u,xo);else if("Home"===i)e.preventDefault(),Mo(t,null,d,u,yo);else if("End"===i)e.preventDefault(),Mo(t,null,d,u,xo);else if(1===i.length){var n=b.current,o=i.toLowerCase(),s=performance.now();n.keys.length>0&&(s-n.lastTime>500?(n.keys=[],n.repeating=!0,n.previousKeyMatched=!0):n.repeating&&o!==n.keys[0]&&(n.repeating=!1)),n.lastTime=s,n.keys.push(o);var a=r&&!n.repeating&&wo(r,n);n.previousKeyMatched&&(a||Mo(t,r,!1,u,yo,n))?e.preventDefault():n.previousKeyMatched=!1}p&&p(e)},tabIndex:n?0:-1},g),x)})),So={vertical:"top",horizontal:"right"},Co={vertical:"top",horizontal:"left"},ko=O.forwardRef((function(e,t){var i=e.autoFocus,r=void 0===i||i,n=e.children,o=e.classes,s=e.disableAutoFocusItem,a=void 0!==s&&s,l=e.MenuListProps,c=void 0===l?{}:l,u=e.onClose,h=e.onEntering,d=e.open,p=e.PaperProps,f=void 0===p?{}:p,m=e.PopoverClasses,g=e.transitionDuration,v=void 0===g?"auto":g,b=e.variant,_=void 0===b?"selectedMenu":b,y=Object(T.a)(e,["autoFocus","children","classes","disableAutoFocusItem","MenuListProps","onClose","onEntering","open","PaperProps","PopoverClasses","transitionDuration","variant"]),x=Object(Oe.a)(),w=r&&!a&&d,M=O.useRef(null),P=O.useRef(null),E=-1;O.Children.map(n,(function(e,t){O.isValidElement(e)&&(e.props.disabled||("menu"!==_&&e.props.selected||-1===E)&&(E=t))}));var S=O.Children.map(n,(function(e,t){return t===E?O.cloneElement(e,{ref:function(t){P.current=Q.findDOMNode(t),G(e.ref,t)}}):e}));return O.createElement(_o,Object(k.a)({getContentAnchorEl:function(){return P.current},classes:m,onClose:u,onEntering:function(e,t){M.current&&M.current.adjustStyleForScrollbar(e,x),h&&h(e,t)},anchorOrigin:"rtl"===x.direction?So:Co,transformOrigin:"rtl"===x.direction?So:Co,PaperProps:Object(k.a)({},f,{classes:Object(k.a)({},f.classes,{root:o.paper})}),open:d,ref:t,transitionDuration:v},y),O.createElement(Eo,Object(k.a)({onKeyDown:function(e){"Tab"===e.key&&(e.preventDefault(),u&&u(e,"tabKeyDown"))},actions:M,autoFocus:r&&(-1===E||a),autoFocusItem:w,variant:_},c,{className:Object(L.a)(o.list,c.className)}),S))})),Oo=Object(B.a)({paper:{maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"},list:{outline:0}},{name:"MuiMenu"})(ko),Ao=O.forwardRef((function(e,t){var i,r=e.classes,n=e.className,o=e.component,s=void 0===o?"li":o,a=e.disableGutters,l=void 0!==a&&a,c=e.ListItemClasses,u=e.role,h=void 0===u?"menuitem":u,d=e.selected,p=e.tabIndex,f=Object(T.a)(e,["classes","className","component","disableGutters","ListItemClasses","role","selected","tabIndex"]);return e.disabled||(i=void 0!==p?p:-1),O.createElement(io,Object(k.a)({button:!0,role:h,tabIndex:i,component:s,selected:d,disableGutters:l,classes:Object(k.a)({dense:r.dense},c),className:Object(L.a)(r.root,n,d&&r.selected,!l&&r.gutters),ref:t},f))})),To=Object(B.a)((function(e){return{root:Object(k.a)({},e.typography.body1,Object(Pt.a)({minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",width:"auto",overflow:"hidden",whiteSpace:"nowrap"},e.breakpoints.up("sm"),{minHeight:"auto"})),gutters:{},selected:{},dense:Object(k.a)({},e.typography.body2,{minHeight:"auto"})}}),{name:"MuiMenuItem"})(Ao),Do=O.forwardRef((function(e,t){var i=e.activeStep,r=void 0===i?0:i,n=e.backButton,o=e.classes,s=e.className,a=e.LinearProgressProps,l=e.nextButton,c=e.position,u=void 0===c?"bottom":c,h=e.steps,d=e.variant,p=void 0===d?"dots":d,f=Object(T.a)(e,["activeStep","backButton","classes","className","LinearProgressProps","nextButton","position","steps","variant"]);return O.createElement(Re,Object(k.a)({square:!0,elevation:0,className:Object(L.a)(o.root,o["position".concat(S(u))],s),ref:t},f),n,"text"===p&&O.createElement(O.Fragment,null,r+1," / ",h),"dots"===p&&O.createElement("div",{className:o.dots},Object(Ve.a)(new Array(h)).map((function(e,t){return O.createElement("div",{key:t,className:Object(L.a)(o.dot,t===r&&o.dotActive)})}))),"progress"===p&&O.createElement($n,Object(k.a)({className:o.progress,variant:"determinate",value:Math.ceil(r/(h-1)*100)},a)),l)})),Ro=Object(B.a)((function(e){return{root:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:e.palette.background.default,padding:8},positionBottom:{position:"fixed",bottom:0,left:0,right:0,zIndex:e.zIndex.mobileStepper},positionTop:{position:"fixed",top:0,left:0,right:0,zIndex:e.zIndex.mobileStepper},positionStatic:{},dots:{display:"flex",flexDirection:"row"},dot:{backgroundColor:e.palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"},dotActive:{backgroundColor:e.palette.primary.main},progress:{width:"50%"}}}),{name:"MuiMobileStepper"})(Do),Lo=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.disabled,o=e.IconComponent,s=e.inputRef,a=e.variant,l=void 0===a?"standard":a,c=Object(T.a)(e,["classes","className","disabled","IconComponent","inputRef","variant"]);return O.createElement(O.Fragment,null,O.createElement("select",Object(k.a)({className:Object(L.a)(i.root,i.select,i[l],r,n&&i.disabled),disabled:n,ref:s||t},c)),e.multiple?null:O.createElement(o,{className:Object(L.a)(i.icon,i["icon".concat(S(l))],n&&i.disabled)}))})),Bo=j(O.createElement("path",{d:"M7 10l5 5 5-5z"})),Io=function(e){return{root:{},select:{"-moz-appearance":"none","-webkit-appearance":"none",userSelect:"none",borderRadius:0,minWidth:16,cursor:"pointer","&:focus":{backgroundColor:"light"===e.palette.type?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",borderRadius:0},"&::-ms-expand":{display:"none"},"&$disabled":{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:e.palette.background.paper},"&&":{paddingRight:24}},filled:{"&&":{paddingRight:32}},outlined:{borderRadius:e.shape.borderRadius,"&&":{paddingRight:32}},selectMenu:{height:"auto",minHeight:"1.1876em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},disabled:{},icon:{position:"absolute",right:0,top:"calc(50% - 12px)",pointerEvents:"none",color:e.palette.action.active,"&$disabled":{color:e.palette.action.disabled}},iconOpen:{transform:"rotate(180deg)"},iconFilled:{right:7},iconOutlined:{right:7},nativeInput:{bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%"}}},No=O.createElement(Un,null),jo=O.forwardRef((function(e,t){var i=e.children,r=e.classes,n=e.IconComponent,o=void 0===n?Bo:n,s=e.input,a=void 0===s?No:s,l=e.inputProps,c=(e.variant,Object(T.a)(e,["children","classes","IconComponent","input","inputProps","variant"])),u=Ur({props:e,muiFormControl:wi(),states:["variant"]});return O.cloneElement(a,Object(k.a)({inputComponent:Lo,inputProps:Object(k.a)({children:i,classes:r,IconComponent:o,variant:u.variant,type:void 0},l,a?a.props.inputProps:{}),ref:t},c))}));jo.muiName="Select";var Fo=Object(B.a)(Io,{name:"MuiNativeSelect"})(jo),zo="undefined"!=typeof window?O.useLayoutEffect:O.useEffect,Vo=function(e){var t=e.children,i=e.defer,r=void 0!==i&&i,n=e.fallback,o=void 0===n?null:n,s=O.useState(!1),a=s[0],l=s[1];return zo((function(){r||l(!0)}),[r]),O.useEffect((function(){r&&l(!0)}),[r]),O.createElement(O.Fragment,null,a?t:o)},Uo=O.forwardRef((function(e,t){e.children;var i=e.classes,r=e.className,n=e.label,o=e.labelWidth,s=e.notched,a=e.style,l=Object(T.a)(e,["children","classes","className","label","labelWidth","notched","style"]),c="rtl"===Object(Oe.a)().direction?"right":"left";if(void 0!==n)return O.createElement("fieldset",Object(k.a)({"aria-hidden":!0,className:Object(L.a)(i.root,r),ref:t,style:a},l),O.createElement("legend",{className:Object(L.a)(i.legendLabelled,s&&i.legendNotched)},n?O.createElement("span",null,n):O.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}})));var u=o>0?.75*o+8:.01;return O.createElement("fieldset",Object(k.a)({"aria-hidden":!0,style:Object(k.a)(Object(Pt.a)({},"padding".concat(S(c)),8),a),className:Object(L.a)(i.root,r),ref:t},l),O.createElement("legend",{className:i.legend,style:{width:s?u:.01}},O.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}})))})),Wo=Object(B.a)((function(e){return{root:{position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden"},legend:{textAlign:"left",padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},legendLabelled:{display:"block",width:"auto",textAlign:"left",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),"& > span":{paddingLeft:5,paddingRight:5,display:"inline-block"}},legendNotched:{maxWidth:1e3,transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}}),{name:"PrivateNotchedOutline"})(Uo),Ho=O.forwardRef((function(e,t){var i=e.classes,r=e.fullWidth,n=void 0!==r&&r,o=e.inputComponent,s=void 0===o?"input":o,a=e.label,l=e.labelWidth,c=void 0===l?0:l,u=e.multiline,h=void 0!==u&&u,d=e.notched,p=e.type,f=void 0===p?"text":p,m=Object(T.a)(e,["classes","fullWidth","inputComponent","label","labelWidth","multiline","notched","type"]);return O.createElement(Zr,Object(k.a)({renderSuffix:function(e){return O.createElement(Wo,{className:i.notchedOutline,label:a,labelWidth:c,notched:void 0!==d?d:Boolean(e.startAdornment||e.filled||e.focused)})},classes:Object(k.a)({},i,{root:Object(L.a)(i.root,i.underline),notchedOutline:null}),fullWidth:n,inputComponent:s,multiline:h,ref:t,type:f},m))}));Ho.muiName="Input";var Go=Object(B.a)((function(e){var t="light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{root:{position:"relative",borderRadius:e.shape.borderRadius,"&:hover $notchedOutline":{borderColor:e.palette.text.primary},"@media (hover: none)":{"&:hover $notchedOutline":{borderColor:t}},"&$focused $notchedOutline":{borderColor:e.palette.primary.main,borderWidth:2},"&$error $notchedOutline":{borderColor:e.palette.error.main},"&$disabled $notchedOutline":{borderColor:e.palette.action.disabled}},colorSecondary:{"&$focused $notchedOutline":{borderColor:e.palette.secondary.main}},focused:{},disabled:{},adornedStart:{paddingLeft:14},adornedEnd:{paddingRight:14},error:{},marginDense:{},multiline:{padding:"18.5px 14px","&$marginDense":{paddingTop:10.5,paddingBottom:10.5}},notchedOutline:{borderColor:t},input:{padding:"18.5px 14px","&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.type?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.type?null:"#fff",caretColor:"light"===e.palette.type?null:"#fff",borderRadius:"inherit"}},inputMarginDense:{paddingTop:10.5,paddingBottom:10.5},inputMultiline:{padding:0},inputAdornedStart:{paddingLeft:0},inputAdornedEnd:{paddingRight:0}}}),{name:"MuiOutlinedInput"})(Ho),Xo=i(208);function Yo(e){return"function"==typeof e?e():e}var $o="undefined"!=typeof window?O.useLayoutEffect:O.useEffect,qo={},Ko=O.forwardRef((function(e,t){var i=e.anchorEl,r=e.children,n=e.container,o=e.disablePortal,s=void 0!==o&&o,a=e.keepMounted,l=void 0!==a&&a,c=e.modifiers,u=e.open,h=e.placement,d=void 0===h?"bottom":h,p=e.popperOptions,f=void 0===p?qo:p,m=e.popperRef,g=e.style,v=e.transition,b=void 0!==v&&v,_=Object(T.a)(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition"]),y=O.useRef(null),x=K(y,t),w=O.useRef(null),M=K(w,m),P=O.useRef(M);$o((function(){P.current=M}),[M]),O.useImperativeHandle(m,(function(){return w.current}),[]);var E=O.useState(!0),S=E[0],A=E[1],D=function(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(d,Object(Gi.a)()),R=O.useState(D),L=R[0],B=R[1];O.useEffect((function(){w.current&&w.current.update()}));var I=O.useCallback((function(){if(y.current&&i&&u){w.current&&(w.current.destroy(),P.current(null));var e=function(e){B(e.placement)},t=(Yo(i),new Xo.a(Yo(i),y.current,Object(k.a)({placement:D},f,{modifiers:Object(k.a)({},s?{}:{preventOverflow:{boundariesElement:"window"}},c,f.modifiers),onCreate:C(e,f.onCreate),onUpdate:C(e,f.onUpdate)})));P.current(t)}}),[i,s,c,u,D,f]),N=O.useCallback((function(e){G(x,e),I()}),[x,I]),j=function(){w.current&&(w.current.destroy(),P.current(null))};if(O.useEffect((function(){return function(){j()}}),[]),O.useEffect((function(){u||b||j()}),[u,b]),!l&&!u&&(!b||S))return null;var F={placement:L};return b&&(F.TransitionProps={in:u,onEnter:function(){A(!1)},onExited:function(){A(!0),j()}}),O.createElement($i,{disablePortal:s,container:n},O.createElement("div",Object(k.a)({ref:N,role:"tooltip"},_,{style:Object(k.a)({position:"fixed",top:0,left:0,display:u||!l||b?null:"none"},g)}),"function"==typeof r?r(F):r))})),Zo=j(O.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Qo=j(O.createElement("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Jo=Object(B.a)((function(e){return{root:{position:"relative",display:"flex","&$checked $layer":{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}},layer:{left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest})},checked:{}}}),{name:"PrivateRadioButtonIcon"})((function(e){var t=e.checked,i=e.classes,r=e.fontSize;return O.createElement("div",{className:Object(L.a)(i.root,t&&i.checked)},O.createElement(Zo,{fontSize:r}),O.createElement(Qo,{fontSize:r,className:i.layer}))})),es=O.createContext();function ts(){return O.useContext(es)}var is=O.createElement(Jo,{checked:!0}),rs=O.createElement(Jo,null),ns=O.forwardRef((function(e,t){var i=e.checked,r=e.classes,n=e.color,o=void 0===n?"secondary":n,s=e.name,a=e.onChange,l=e.size,c=void 0===l?"medium":l,u=Object(T.a)(e,["checked","classes","color","name","onChange","size"]),h=ts(),d=i,p=C(a,h&&h.onChange),f=s;return h&&(void 0===d&&(d=h.value===e.value),void 0===f&&(f=h.name)),O.createElement(Pi,Object(k.a)({color:o,type:"radio",icon:O.cloneElement(rs,{fontSize:"small"===c?"small":"default"}),checkedIcon:O.cloneElement(is,{fontSize:"small"===c?"small":"default"}),classes:{root:Object(L.a)(r.root,r["color".concat(S(o))]),checked:r.checked,disabled:r.disabled},name:f,checked:d,onChange:p,ref:t},u))})),os=Object(B.a)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiRadio"})(ns),ss=O.forwardRef((function(e,t){var i=e.actions,r=e.children,n=e.name,o=e.value,s=e.onChange,a=Object(T.a)(e,["actions","children","name","value","onChange"]),l=O.useRef(null),c=Y({controlled:o,default:e.defaultValue,name:"RadioGroup"}),u=Object(me.a)(c,2),h=u[0],d=u[1];O.useImperativeHandle(i,(function(){return{focus:function(){var e=l.current.querySelector("input:not(:disabled):checked");e||(e=l.current.querySelector("input:not(:disabled)")),e&&e.focus()}}}),[]);var p=K(t,l),f=Z(n);return O.createElement(es.Provider,{value:{name:f,onChange:function(e){d(e.target.value),s&&s(e,e.target.value)},value:h}},O.createElement(sn,Object(k.a)({role:"radiogroup",ref:p},a),r))})),as=i(91),ls=i(45);function cs(e){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var us=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(as.a)(e,t)}(i,O.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=cs(e);if(t){var n=cs(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return function(e,t){return!t||"object"!==Object(ls.a)(t)&&"function"!=typeof t?Object(Ue.a)(e):t}(this,i)}}(i);function i(){return Object(Ki.a)(this,i),t.apply(this,arguments)}return Object(Zi.a)(i,[{key:"componentDidMount",value:function(){this.ref=Q.findDOMNode(this),G(this.props.rootRef,this.ref)}},{key:"componentDidUpdate",value:function(e){var t=Q.findDOMNode(this);e.rootRef===this.props.rootRef&&this.ref===t||(e.rootRef!==this.props.rootRef&&G(e.rootRef,null),this.ref=t,G(this.props.rootRef,this.ref))}},{key:"componentWillUnmount",value:function(){this.ref=null,G(this.props.rootRef,null)}},{key:"render",value:function(){return this.props.children}}]),i}(),hs=i(267);function ds(e,t){return"object"===Object(ls.a)(t)&&null!==t?e===t:String(e)===String(t)}var ps=O.forwardRef((function(e,t){var i=e["aria-label"],r=e.autoFocus,n=e.autoWidth,o=e.children,s=e.classes,a=e.className,l=e.defaultValue,c=e.disabled,u=e.displayEmpty,h=e.IconComponent,d=e.inputRef,p=e.labelId,f=e.MenuProps,m=void 0===f?{}:f,g=e.multiple,v=e.name,b=e.onBlur,_=e.onChange,y=e.onClose,x=e.onFocus,w=e.onOpen,M=e.open,P=e.readOnly,C=e.renderValue,A=e.SelectDisplayProps,D=void 0===A?{}:A,R=e.tabIndex,B=(e.type,e.value),I=e.variant,N=void 0===I?"standard":I,j=Object(T.a)(e,["aria-label","autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"]),F=Y({controlled:B,default:l,name:"Select"}),z=Object(me.a)(F,2),V=z[0],W=z[1],H=O.useRef(null),G=O.useState(null),X=G[0],$=G[1],q=O.useRef(null!=M).current,Z=O.useState(),Q=Z[0],J=Z[1],ee=O.useState(!1),te=ee[0],ie=ee[1],re=K(t,d);O.useImperativeHandle(re,(function(){return{focus:function(){X.focus()},node:H.current,value:V}}),[X,V]),O.useEffect((function(){r&&X&&X.focus()}),[r,X]),O.useEffect((function(){if(X){var e=U(X).getElementById(p);if(e){var t=function(){getSelection().isCollapsed&&X.focus()};return e.addEventListener("click",t),function(){e.removeEventListener("click",t)}}}}),[p,X]);var ne,oe,se=function(e,t){e?w&&w(t):y&&y(t),q||(J(n?null:X.clientWidth),ie(e))},ae=O.Children.toArray(o),le=null!==X&&(q?M:te);delete j["aria-invalid"];var ce=[],ue=!1;($r({value:V})||u)&&(C?ne=C(V):ue=!0);var he=ae.map((function(e){if(!O.isValidElement(e))return null;var t;if(g){if(!Array.isArray(V))throw new Error(Object(E.a)(2));(t=V.some((function(t){return ds(t,e.props.value)})))&&ue&&ce.push(e.props.children)}else(t=ds(V,e.props.value))&&ue&&(oe=e.props.children);return O.cloneElement(e,{"aria-selected":t?"true":void 0,onClick:function(e){return function(t){var i;if(g||se(!1,t),g){i=Array.isArray(V)?V.slice():[];var r=V.indexOf(e.props.value);-1===r?i.push(e.props.value):i.splice(r,1)}else i=e.props.value;e.props.onClick&&e.props.onClick(t),V!==i&&(W(i),_&&(t.persist(),Object.defineProperty(t,"target",{writable:!0,value:{value:i,name:v}}),_(t,e)))}}(e),onKeyUp:function(t){" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})}));ue&&(ne=g?ce.join(", "):oe);var de,pe=Q;!n&&q&&X&&(pe=X.clientWidth),de=void 0!==R?R:c?null:0;var fe=D.id||(v?"mui-component-select-".concat(v):void 0);return O.createElement(O.Fragment,null,O.createElement("div",Object(k.a)({className:Object(L.a)(s.root,s.select,s.selectMenu,s[N],a,c&&s.disabled),ref:$,tabIndex:de,role:"button","aria-disabled":c?"true":void 0,"aria-expanded":le?"true":void 0,"aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[p,fe].filter(Boolean).join(" ")||void 0,onKeyDown:function(e){P||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),se(!0,e))},onMouseDown:c||P?null:function(e){0===e.button&&(e.preventDefault(),X.focus(),se(!0,e))},onBlur:function(e){!le&&b&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:V,name:v}}),b(e))},onFocus:x},D,{id:fe}),function(e){return null==e||"string"==typeof e&&!e.trim()}(ne)?O.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):ne),O.createElement("input",Object(k.a)({value:Array.isArray(V)?V.join(","):V,name:v,ref:H,"aria-hidden":!0,onChange:function(e){var t=ae.map((function(e){return e.props.value})).indexOf(e.target.value);if(-1!==t){var i=ae[t];W(i.props.value),_&&_(e,i)}},tabIndex:-1,className:s.nativeInput,autoFocus:r},j)),O.createElement(h,{className:Object(L.a)(s.icon,s["icon".concat(S(N))],le&&s.iconOpen,c&&s.disabled)}),O.createElement(Oo,Object(k.a)({id:"menu-".concat(v||""),anchorEl:X,open:le,onClose:function(e){se(!1,e)}},m,{MenuListProps:Object(k.a)({"aria-labelledby":p,role:"listbox",disableListWrap:!0},m.MenuListProps),PaperProps:Object(k.a)({},m.PaperProps,{style:Object(k.a)({minWidth:pe},null!=m.PaperProps?m.PaperProps.style:null)})}),he))})),fs=Io,ms=O.createElement(Un,null),gs=O.createElement(Jr,null),vs=O.forwardRef((function e(t,i){var r=t.autoWidth,n=void 0!==r&&r,o=t.children,s=t.classes,a=t.displayEmpty,l=void 0!==a&&a,c=t.IconComponent,u=void 0===c?Bo:c,h=t.id,d=t.input,p=t.inputProps,f=t.label,m=t.labelId,g=t.labelWidth,v=void 0===g?0:g,b=t.MenuProps,_=t.multiple,y=void 0!==_&&_,x=t.native,w=void 0!==x&&x,M=t.onClose,P=t.onOpen,E=t.open,S=t.renderValue,C=t.SelectDisplayProps,A=t.variant,D=void 0===A?"standard":A,R=Object(T.a)(t,["autoWidth","children","classes","displayEmpty","IconComponent","id","input","inputProps","label","labelId","labelWidth","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"]),L=w?Lo:ps,B=Ur({props:t,muiFormControl:wi(),states:["variant"]}).variant||D,I=d||{standard:ms,outlined:O.createElement(Go,{label:f,labelWidth:v}),filled:gs}[B];return O.cloneElement(I,Object(k.a)({inputComponent:L,inputProps:Object(k.a)({children:o,IconComponent:u,variant:B,type:void 0,multiple:y},w?{id:h}:{autoWidth:n,displayEmpty:l,labelId:m,MenuProps:b,onClose:M,onOpen:P,open:E,renderValue:S,SelectDisplayProps:Object(k.a)({id:h},C)},p,{classes:p?Object(hs.a)({baseClasses:s,newClasses:p.classes,Component:e}):s},d?d.props.inputProps:{}),ref:i},R))}));vs.muiName="Select";var bs=Object(B.a)(fs,{name:"MuiSelect"})(vs),_s=Object(B.a)((function(e){return{thumb:{"&$open":{"& $offset":{transform:"scale(1) translateY(-10px)"}}},open:{},offset:Object(k.a)({zIndex:1},e.typography.body2,{fontSize:e.typography.pxToRem(12),lineHeight:1.2,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),top:-34,transformOrigin:"bottom center",transform:"scale(0)",position:"absolute"}),circle:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:"50% 50% 50% 0",backgroundColor:"currentColor",transform:"rotate(-45deg)"},label:{color:e.palette.primary.contrastText,transform:"rotate(45deg)"}}}),{name:"PrivateValueLabel"})((function(e){var t=e.children,i=e.classes,r=e.className,n=e.open,o=e.value,s=e.valueLabelDisplay;return"off"===s?t:O.cloneElement(t,{className:Object(L.a)(t.props.className,(n||"on"===s)&&i.open,i.thumb)},O.createElement("span",{className:Object(L.a)(i.offset,r)},O.createElement("span",{className:i.circle},O.createElement("span",{className:i.label},o))))}));function ys(e,t){return e-t}function xs(e,t,i){return Math.min(Math.max(t,e),i)}function ws(e,t){return e.reduce((function(e,i,r){var n=Math.abs(t-i);return null===e||n<e.distance||n===e.distance?{distance:n,index:r}:e}),null).index}function Ms(e,t){if(void 0!==t.current&&e.changedTouches){for(var i=0;i<e.changedTouches.length;i+=1){var r=e.changedTouches[i];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function Ps(e,t,i){return 100*(e-t)/(i-t)}function Es(e,t,i){var r=Math.round((e-i)/t)*t+i;return Number(r.toFixed(function(e){if(Math.abs(e)<1){var t=e.toExponential().split("e-"),i=t[0].split(".")[1];return(i?i.length:0)+parseInt(t[1],10)}var r=e.toString().split(".")[1];return r?r.length:0}(t)))}function Ss(e){var t=e.values,i=e.source,r=e.newValue,n=e.index;if(t[n]===r)return i;var o=t.slice();return o[n]=r,o}function Cs(e){var t=e.sliderRef,i=e.activeIndex,r=e.setActive;t.current.contains(document.activeElement)&&Number(document.activeElement.getAttribute("data-index"))===i||t.current.querySelector('[role="slider"][data-index="'.concat(i,'"]')).focus(),r&&r(i)}var ks={horizontal:{offset:function(e){return{left:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},"horizontal-reverse":{offset:function(e){return{right:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},vertical:{offset:function(e){return{bottom:"".concat(e,"%")}},leap:function(e){return{height:"".concat(e,"%")}}}},Os=function(e){return e},As=O.forwardRef((function(e,t){var i=e["aria-label"],r=e["aria-labelledby"],n=e["aria-valuetext"],o=e.classes,s=e.className,a=e.color,l=void 0===a?"primary":a,c=e.component,u=void 0===c?"span":c,h=e.defaultValue,d=e.disabled,p=void 0!==d&&d,f=e.getAriaLabel,m=e.getAriaValueText,g=e.marks,v=void 0!==g&&g,b=e.max,_=void 0===b?100:b,y=e.min,x=void 0===y?0:y,w=e.name,M=e.onChange,P=e.onChangeCommitted,E=e.onMouseDown,C=e.orientation,A=void 0===C?"horizontal":C,D=e.scale,R=void 0===D?Os:D,B=e.step,I=void 0===B?1:B,N=e.ThumbComponent,j=void 0===N?"span":N,F=e.track,z=void 0===F?"normal":F,V=e.value,W=e.ValueLabelComponent,H=void 0===W?_s:W,G=e.valueLabelDisplay,X=void 0===G?"off":G,$=e.valueLabelFormat,Z=void 0===$?Os:$,Q=Object(T.a)(e,["aria-label","aria-labelledby","aria-valuetext","classes","className","color","component","defaultValue","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","onMouseDown","orientation","scale","step","ThumbComponent","track","value","ValueLabelComponent","valueLabelDisplay","valueLabelFormat"]),J=Object(Oe.a)(),ee=O.useRef(),te=O.useState(-1),ie=te[0],re=te[1],ne=O.useState(-1),oe=ne[0],se=ne[1],ae=Y({controlled:V,default:h,name:"Slider"}),le=Object(me.a)(ae,2),ue=le[0],he=le[1],de=Array.isArray(ue),pe=de?ue.slice().sort(ys):[ue];pe=pe.map((function(e){return xs(e,x,_)}));var fe=!0===v&&null!==I?Object(Ve.a)(Array(Math.floor((_-x)/I)+1)).map((function(e,t){return{value:x+I*t}})):v||[],ge=ce(),ve=ge.isFocusVisible,be=ge.onBlurVisible,_e=ge.ref,ye=O.useState(-1),xe=ye[0],we=ye[1],Me=O.useRef(),Pe=K(t,K(_e,Me)),Ee=q((function(e){var t=Number(e.currentTarget.getAttribute("data-index"));ve(e)&&we(t),se(t)})),Se=q((function(){-1!==xe&&(we(-1),be()),se(-1)})),Ce=q((function(e){var t=Number(e.currentTarget.getAttribute("data-index"));se(t)})),ke=q((function(){se(-1)})),Ae="rtl"===J.direction,Te=q((function(e){var t,i=Number(e.currentTarget.getAttribute("data-index")),r=pe[i],n=(_-x)/10,o=fe.map((function(e){return e.value})),s=o.indexOf(r),a=Ae?"ArrowLeft":"ArrowRight",l=Ae?"ArrowRight":"ArrowLeft";switch(e.key){case"Home":t=x;break;case"End":t=_;break;case"PageUp":I&&(t=r+n);break;case"PageDown":I&&(t=r-n);break;case a:case"ArrowUp":t=I?r+I:o[s+1]||o[o.length-1];break;case l:case"ArrowDown":t=I?r-I:o[s-1]||o[0];break;default:return}if(e.preventDefault(),I&&(t=Es(t,I,x)),t=xs(t,x,_),de){var c=t;t=Ss({values:pe,source:ue,newValue:t,index:i}).sort(ys),Cs({sliderRef:Me,activeIndex:t.indexOf(c)})}he(t),we(i),M&&M(e,t),P&&P(e,t)})),De=O.useRef(),Re=A;Ae&&"vertical"!==A&&(Re+="-reverse");var Le=function(e){var t,i,r=e.finger,n=e.move,o=void 0!==n&&n,s=e.values,a=e.source,l=Me.current.getBoundingClientRect(),c=l.width,u=l.height,h=l.bottom,d=l.left;if(t=0===Re.indexOf("vertical")?(h-r.y)/u:(r.x-d)/c,-1!==Re.indexOf("-reverse")&&(t=1-t),i=function(e,t,i){return(i-t)*e+t}(t,x,_),I)i=Es(i,I,x);else{var p=fe.map((function(e){return e.value}));i=p[ws(p,i)]}i=xs(i,x,_);var f=0;if(de){var m=i;f=(i=Ss({values:s,source:a,newValue:i,index:f=o?De.current:ws(s,i)}).sort(ys)).indexOf(m),De.current=f}return{newValue:i,activeIndex:f}},Be=q((function(e){var t=Ms(e,ee);if(t){var i=Le({finger:t,move:!0,values:pe,source:ue}),r=i.newValue,n=i.activeIndex;Cs({sliderRef:Me,activeIndex:n,setActive:re}),he(r),M&&M(e,r)}})),Ie=q((function(e){var t=Ms(e,ee);if(t){var i=Le({finger:t,values:pe,source:ue}).newValue;re(-1),"touchend"===e.type&&se(-1),P&&P(e,i),ee.current=void 0;var r=U(Me.current);r.removeEventListener("mousemove",Be),r.removeEventListener("mouseup",Ie),r.removeEventListener("touchmove",Be),r.removeEventListener("touchend",Ie)}})),Ne=q((function(e){e.preventDefault();var t=e.changedTouches[0];null!=t&&(ee.current=t.identifier);var i=Ms(e,ee),r=Le({finger:i,values:pe,source:ue}),n=r.newValue,o=r.activeIndex;Cs({sliderRef:Me,activeIndex:o,setActive:re}),he(n),M&&M(e,n);var s=U(Me.current);s.addEventListener("touchmove",Be),s.addEventListener("touchend",Ie)}));O.useEffect((function(){var e=Me.current;e.addEventListener("touchstart",Ne);var t=U(e);return function(){e.removeEventListener("touchstart",Ne),t.removeEventListener("mousemove",Be),t.removeEventListener("mouseup",Ie),t.removeEventListener("touchmove",Be),t.removeEventListener("touchend",Ie)}}),[Ie,Be,Ne]);var je=q((function(e){E&&E(e),e.preventDefault();var t=Ms(e,ee),i=Le({finger:t,values:pe,source:ue}),r=i.newValue,n=i.activeIndex;Cs({sliderRef:Me,activeIndex:n,setActive:re}),he(r),M&&M(e,r);var o=U(Me.current);o.addEventListener("mousemove",Be),o.addEventListener("mouseup",Ie)})),Fe=Ps(de?pe[0]:x,x,_),ze=Ps(pe[pe.length-1],x,_)-Fe,Ue=Object(k.a)({},ks[Re].offset(Fe),ks[Re].leap(ze));return O.createElement(u,Object(k.a)({ref:Pe,className:Object(L.a)(o.root,o["color".concat(S(l))],s,p&&o.disabled,fe.length>0&&fe.some((function(e){return e.label}))&&o.marked,!1===z&&o.trackFalse,"vertical"===A&&o.vertical,"inverted"===z&&o.trackInverted),onMouseDown:je},Q),O.createElement("span",{className:o.rail}),O.createElement("span",{className:o.track,style:Ue}),O.createElement("input",{value:pe.join(","),name:w,type:"hidden"}),fe.map((function(e,t){var i,r=Ps(e.value,x,_),n=ks[Re].offset(r);return i=!1===z?-1!==pe.indexOf(e.value):"normal"===z&&(de?e.value>=pe[0]&&e.value<=pe[pe.length-1]:e.value<=pe[0])||"inverted"===z&&(de?e.value<=pe[0]||e.value>=pe[pe.length-1]:e.value>=pe[0]),O.createElement(O.Fragment,{key:e.value},O.createElement("span",{style:n,"data-index":t,className:Object(L.a)(o.mark,i&&o.markActive)}),null!=e.label?O.createElement("span",{"aria-hidden":!0,"data-index":t,style:n,className:Object(L.a)(o.markLabel,i&&o.markLabelActive)},e.label):null)})),pe.map((function(e,t){var s=Ps(e,x,_),a=ks[Re].offset(s);return O.createElement(H,{key:t,valueLabelFormat:Z,valueLabelDisplay:X,className:o.valueLabel,value:"function"==typeof Z?Z(R(e),t):Z,index:t,open:oe===t||ie===t||"on"===X,disabled:p},O.createElement(j,{className:Object(L.a)(o.thumb,o["thumbColor".concat(S(l))],ie===t&&o.active,p&&o.disabled,xe===t&&o.focusVisible),tabIndex:p?null:0,role:"slider",style:a,"data-index":t,"aria-label":f?f(t):i,"aria-labelledby":r,"aria-orientation":A,"aria-valuemax":R(_),"aria-valuemin":R(x),"aria-valuenow":R(e),"aria-valuetext":m?m(R(e),t):n,onKeyDown:Te,onFocus:Ee,onBlur:Se,onMouseOver:Ce,onMouseLeave:ke}))})))})),Ts=Object(B.a)((function(e){return{root:{height:2,width:"100%",boxSizing:"content-box",padding:"13px 0",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:e.palette.primary.main,WebkitTapHighlightColor:"transparent","&$disabled":{pointerEvents:"none",cursor:"default",color:e.palette.grey[400]},"&$vertical":{width:2,height:"100%",padding:"0 13px"},"@media (pointer: coarse)":{padding:"20px 0","&$vertical":{padding:"0 20px"}},"@media print":{colorAdjust:"exact"}},colorPrimary:{},colorSecondary:{color:e.palette.secondary.main},marked:{marginBottom:20,"&$vertical":{marginBottom:"auto",marginRight:20}},vertical:{},disabled:{},rail:{display:"block",position:"absolute",width:"100%",height:2,borderRadius:1,backgroundColor:"currentColor",opacity:.38,"$vertical &":{height:"100%",width:2}},track:{display:"block",position:"absolute",height:2,borderRadius:1,backgroundColor:"currentColor","$vertical &":{width:2}},trackFalse:{"& $track":{display:"none"}},trackInverted:{"& $track":{backgroundColor:"light"===e.palette.type?Object(tt.i)(e.palette.primary.main,.62):Object(tt.a)(e.palette.primary.main,.5)},"& $rail":{opacity:1}},thumb:{position:"absolute",width:12,height:12,marginLeft:-6,marginTop:-5,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow"],{duration:e.transitions.duration.shortest}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",left:-15,top:-15,right:-15,bottom:-15},"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(Object(tt.d)(e.palette.primary.main,.16)),"@media (hover: none)":{boxShadow:"none"}},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(Object(tt.d)(e.palette.primary.main,.16))},"&$disabled":{width:8,height:8,marginLeft:-4,marginTop:-3,"&:hover":{boxShadow:"none"}},"$vertical &":{marginLeft:-5,marginBottom:-6},"$vertical &$disabled":{marginLeft:-3,marginBottom:-4}},thumbColorPrimary:{},thumbColorSecondary:{"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(Object(tt.d)(e.palette.secondary.main,.16))},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(Object(tt.d)(e.palette.secondary.main,.16))}},active:{},focusVisible:{},valueLabel:{left:"calc(-50% - 4px)"},mark:{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},markActive:{backgroundColor:e.palette.background.paper,opacity:.8},markLabel:Object(k.a)({},e.typography.body2,{color:e.palette.text.secondary,position:"absolute",top:26,transform:"translateX(-50%)",whiteSpace:"nowrap","$vertical &":{top:"auto",left:26,transform:"translateY(50%)"},"@media (pointer: coarse)":{top:40,"$vertical &":{left:31}}}),markLabelActive:{color:e.palette.text.primary}}}),{name:"MuiSlider"})(As),Ds=O.forwardRef((function(e,t){var i=e.action,r=e.classes,n=e.className,o=e.message,s=e.role,a=void 0===s?"alert":s,l=Object(T.a)(e,["action","classes","className","message","role"]);return O.createElement(Re,Object(k.a)({role:a,square:!0,elevation:6,className:Object(L.a)(r.root,n),ref:t},l),O.createElement("div",{className:r.message},o),i?O.createElement("div",{className:r.action},i):null)})),Rs=Object(B.a)((function(e){var t="light"===e.palette.type?.8:.98,i=Object(tt.c)(e.palette.background.default,t);return{root:Object(k.a)({},e.typography.body2,Object(Pt.a)({color:e.palette.getContrastText(i),backgroundColor:i,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:e.shape.borderRadius,flexGrow:1},e.breakpoints.up("sm"),{flexGrow:"initial",minWidth:288})),message:{padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}}),{name:"MuiSnackbarContent"})(Ds),Ls=O.forwardRef((function(e,t){var i=e.action,r=e.anchorOrigin,n=(r=void 0===r?{vertical:"bottom",horizontal:"center"}:r).vertical,o=r.horizontal,s=e.autoHideDuration,a=void 0===s?null:s,l=e.children,c=e.classes,u=e.className,h=e.ClickAwayListenerProps,d=e.ContentProps,p=e.disableWindowBlurListener,f=void 0!==p&&p,m=e.message,g=e.onClose,v=e.onEnter,b=e.onEntered,_=e.onEntering,y=e.onExit,x=e.onExited,w=e.onExiting,M=e.onMouseEnter,P=e.onMouseLeave,E=e.open,A=e.resumeHideDuration,D=e.TransitionComponent,R=void 0===D?Sn:D,B=e.transitionDuration,I=void 0===B?{enter:Se.b.enteringScreen,exit:Se.b.leavingScreen}:B,N=e.TransitionProps,j=Object(T.a)(e,["action","anchorOrigin","autoHideDuration","children","classes","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onClose","onEnter","onEntered","onEntering","onExit","onExited","onExiting","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"]),F=O.useRef(),z=O.useState(!0),V=z[0],U=z[1],W=q((function(){g&&g.apply(void 0,arguments)})),H=q((function(e){g&&null!=e&&(clearTimeout(F.current),F.current=setTimeout((function(){W(null,"timeout")}),e))}));O.useEffect((function(){return E&&H(a),function(){clearTimeout(F.current)}}),[E,a,H]);var G=function(){clearTimeout(F.current)},X=O.useCallback((function(){null!=a&&H(null!=A?A:.5*a)}),[a,A,H]);return O.useEffect((function(){if(!f&&E)return window.addEventListener("focus",X),window.addEventListener("blur",G),function(){window.removeEventListener("focus",X),window.removeEventListener("blur",G)}}),[f,X,E]),!E&&V?null:O.createElement(zi,Object(k.a)({onClickAway:function(e){g&&g(e,"clickaway")}},h),O.createElement("div",Object(k.a)({className:Object(L.a)(c.root,c["anchorOrigin".concat(S(n)).concat(S(o))],u),onMouseEnter:function(e){M&&M(e),G()},onMouseLeave:function(e){P&&P(e),X()},ref:t},j),O.createElement(R,Object(k.a)({appear:!0,in:E,onEnter:C((function(){U(!1)}),v),onEntered:b,onEntering:_,onExit:y,onExited:C((function(){U(!0)}),x),onExiting:w,timeout:I,direction:"top"===n?"down":"up"},N),l||O.createElement(Rs,Object(k.a)({message:m,action:i},d)))))})),Bs=Object(B.a)((function(e){var t={top:8},i={bottom:8},r={justifyContent:"flex-end"},n={justifyContent:"flex-start"},o={top:24},s={bottom:24},a={right:24},l={left:24},c={left:"50%",right:"auto",transform:"translateX(-50%)"};return{root:{zIndex:e.zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},anchorOriginTopCenter:Object(k.a)({},t,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({},o,c))),anchorOriginBottomCenter:Object(k.a)({},i,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({},s,c))),anchorOriginTopRight:Object(k.a)({},t,r,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({left:"auto"},o,a))),anchorOriginBottomRight:Object(k.a)({},i,r,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({left:"auto"},s,a))),anchorOriginTopLeft:Object(k.a)({},t,n,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({right:"auto"},o,l))),anchorOriginBottomLeft:Object(k.a)({},i,n,Object(Pt.a)({},e.breakpoints.up("sm"),Object(k.a)({right:"auto"},s,l)))}}),{flip:!1,name:"MuiSnackbar"})(Ls),Is=O.forwardRef((function(e,t){var i=e.active,r=void 0!==i&&i,n=e.alternativeLabel,o=e.children,s=e.classes,a=e.className,l=e.completed,c=void 0!==l&&l,u=e.connector,h=e.disabled,d=void 0!==h&&h,p=e.expanded,f=void 0!==p&&p,m=e.index,g=e.last,v=e.orientation,b=Object(T.a)(e,["active","alternativeLabel","children","classes","className","completed","connector","disabled","expanded","index","last","orientation"]),_=u?O.cloneElement(u,{orientation:v,alternativeLabel:n,index:m,active:r,completed:c,disabled:d}):null,y=O.createElement("div",Object(k.a)({className:Object(L.a)(s.root,s[v],a,n&&s.alternativeLabel,c&&s.completed),ref:t},b),_&&n&&0!==m?_:null,O.Children.map(o,(function(e){return O.isValidElement(e)?O.cloneElement(e,Object(k.a)({active:r,alternativeLabel:n,completed:c,disabled:d,expanded:f,last:g,icon:m+1,orientation:v},e.props)):null})));return _&&!n&&0!==m?O.createElement(O.Fragment,null,_,y):y})),Ns=Object(B.a)({root:{},horizontal:{paddingLeft:8,paddingRight:8},vertical:{},alternativeLabel:{flex:1,position:"relative"},completed:{}},{name:"MuiStep"})(Is),js=j(O.createElement("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),Fs=j(O.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})),zs=O.createElement("circle",{cx:"12",cy:"12",r:"12"}),Vs=O.forwardRef((function(e,t){var i=e.completed,r=void 0!==i&&i,n=e.icon,o=e.active,s=void 0!==o&&o,a=e.error,l=void 0!==a&&a,c=e.classes;if("number"==typeof n||"string"==typeof n){var u=Object(L.a)(c.root,s&&c.active,l&&c.error,r&&c.completed);return l?O.createElement(Fs,{className:u,ref:t}):r?O.createElement(js,{className:u,ref:t}):O.createElement(N,{className:u,ref:t},zs,O.createElement("text",{className:c.text,x:"12",y:"16",textAnchor:"middle"},n))}return n})),Us=Object(B.a)((function(e){return{root:{display:"block",color:e.palette.text.disabled,"&$completed":{color:e.palette.primary.main},"&$active":{color:e.palette.primary.main},"&$error":{color:e.palette.error.main}},text:{fill:e.palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily},active:{},completed:{},error:{}}}),{name:"MuiStepIcon"})(Vs),Ws=O.forwardRef((function(e,t){var i=e.active,r=void 0!==i&&i,n=e.alternativeLabel,o=void 0!==n&&n,s=e.children,a=e.classes,l=e.className,c=e.completed,u=void 0!==c&&c,h=e.disabled,d=void 0!==h&&h,p=e.error,f=void 0!==p&&p,m=(e.expanded,e.icon),g=(e.last,e.optional),v=e.orientation,b=void 0===v?"horizontal":v,_=e.StepIconComponent,y=e.StepIconProps,x=Object(T.a)(e,["active","alternativeLabel","children","classes","className","completed","disabled","error","expanded","icon","last","optional","orientation","StepIconComponent","StepIconProps"]),w=_;return m&&!w&&(w=Us),O.createElement("span",Object(k.a)({className:Object(L.a)(a.root,a[b],l,d&&a.disabled,o&&a.alternativeLabel,f&&a.error),ref:t},x),m||w?O.createElement("span",{className:Object(L.a)(a.iconContainer,o&&a.alternativeLabel)},O.createElement(w,Object(k.a)({completed:u,active:r,error:f,icon:m},y))):null,O.createElement("span",{className:a.labelContainer},s?O.createElement(Zt,{variant:"body2",component:"span",display:"block",className:Object(L.a)(a.label,o&&a.alternativeLabel,u&&a.completed,r&&a.active,f&&a.error)},s):null,g))}));Ws.muiName="StepLabel";var Hs=Object(B.a)((function(e){return{root:{display:"flex",alignItems:"center","&$alternativeLabel":{flexDirection:"column"},"&$disabled":{cursor:"default"}},horizontal:{},vertical:{},label:{color:e.palette.text.secondary,"&$active":{color:e.palette.text.primary,fontWeight:500},"&$completed":{color:e.palette.text.primary,fontWeight:500},"&$alternativeLabel":{textAlign:"center",marginTop:16},"&$error":{color:e.palette.error.main}},active:{},completed:{},error:{},disabled:{},iconContainer:{flexShrink:0,display:"flex",paddingRight:8,"&$alternativeLabel":{paddingRight:0}},alternativeLabel:{},labelContainer:{width:"100%"}}}),{name:"MuiStepLabel"})(Ws),Gs=O.forwardRef((function(e,t){var i=e.active,r=e.alternativeLabel,n=e.children,o=e.classes,s=e.className,a=e.completed,l=e.disabled,c=(e.expanded,e.icon),u=(e.last,e.optional),h=e.orientation,d=Object(T.a)(e,["active","alternativeLabel","children","classes","className","completed","disabled","expanded","icon","last","optional","orientation"]),p={active:i,alternativeLabel:r,completed:a,disabled:l,icon:c,optional:u,orientation:h},f=V(n,["StepLabel"])?O.cloneElement(n,p):O.createElement(Hs,p,n);return O.createElement(et,Object(k.a)({focusRipple:!0,disabled:l,TouchRippleProps:{className:o.touchRipple},className:Object(L.a)(o.root,o[h],s),ref:t},d),f)})),Xs=Object(B.a)({root:{width:"100%",padding:"24px 16px",margin:"-24px -16px",boxSizing:"content-box"},horizontal:{},vertical:{justifyContent:"flex-start",padding:"8px",margin:"-8px"},touchRipple:{color:"rgba(0, 0, 0, 0.3)"}},{name:"MuiStepButton"})(Gs),Ys=O.forwardRef((function(e,t){var i=e.active,r=e.alternativeLabel,n=void 0!==r&&r,o=e.classes,s=e.className,a=e.completed,l=e.disabled,c=(e.index,e.orientation),u=void 0===c?"horizontal":c,h=Object(T.a)(e,["active","alternativeLabel","classes","className","completed","disabled","index","orientation"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(o.root,o[u],s,n&&o.alternativeLabel,i&&o.active,a&&o.completed,l&&o.disabled),ref:t},h),O.createElement("span",{className:Object(L.a)(o.line,{horizontal:o.lineHorizontal,vertical:o.lineVertical}[u])}))})),$s=Object(B.a)((function(e){return{root:{flex:"1 1 auto"},horizontal:{},vertical:{marginLeft:12,padding:"0 0 8px"},alternativeLabel:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"},active:{},completed:{},disabled:{},line:{display:"block",borderColor:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[600]},lineHorizontal:{borderTopStyle:"solid",borderTopWidth:1},lineVertical:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}}),{name:"MuiStepConnector"})(Ys),qs=O.forwardRef((function(e,t){var i=e.active,r=(e.alternativeLabel,e.children),n=e.classes,o=e.className,s=(e.completed,e.expanded),a=e.last,l=(e.optional,e.orientation,e.TransitionComponent),c=void 0===l?Te:l,u=e.transitionDuration,h=void 0===u?"auto":u,d=e.TransitionProps,p=Object(T.a)(e,["active","alternativeLabel","children","classes","className","completed","expanded","last","optional","orientation","TransitionComponent","transitionDuration","TransitionProps"]),f=h;return"auto"!==h||c.muiSupportAuto||(f=void 0),O.createElement("div",Object(k.a)({className:Object(L.a)(n.root,o,a&&n.last),ref:t},p),O.createElement(c,Object(k.a)({in:i||s,className:n.transition,timeout:f,unmountOnExit:!0},d),r))})),Ks=Object(B.a)((function(e){return{root:{marginTop:8,marginLeft:12,paddingLeft:20,paddingRight:8,borderLeft:"1px solid ".concat("light"===e.palette.type?e.palette.grey[400]:e.palette.grey[600])},last:{borderLeft:"none"},transition:{}}}),{name:"MuiStepContent"})(qs),Zs=O.createElement($s,null),Qs=O.forwardRef((function(e,t){var i=e.activeStep,r=void 0===i?0:i,n=e.alternativeLabel,o=void 0!==n&&n,s=e.children,a=e.classes,l=e.className,c=e.connector,u=void 0===c?Zs:c,h=e.nonLinear,d=void 0!==h&&h,p=e.orientation,f=void 0===p?"horizontal":p,m=Object(T.a)(e,["activeStep","alternativeLabel","children","classes","className","connector","nonLinear","orientation"]),g=O.isValidElement(u)?O.cloneElement(u,{orientation:f}):null,v=O.Children.toArray(s),b=v.map((function(e,t){var i={index:t,active:!1,completed:!1,disabled:!1};return r===t?i.active=!0:!d&&r>t?i.completed=!0:!d&&r<t&&(i.disabled=!0),O.cloneElement(e,Object(k.a)({alternativeLabel:o,connector:g,last:t+1===v.length,orientation:f},i,e.props))}));return O.createElement(Re,Object(k.a)({square:!0,elevation:0,className:Object(L.a)(a.root,a[f],l,o&&a.alternativeLabel),ref:t},m),b)})),Js=Object(B.a)({root:{display:"flex",padding:24},horizontal:{flexDirection:"row",alignItems:"center"},vertical:{flexDirection:"column"},alternativeLabel:{alignItems:"flex-start"}},{name:"MuiStepper"})(Qs),ea=O.forwardRef((function(e,t){var i=e.anchor,r=e.classes,n=e.className,o=e.width,s=Object(T.a)(e,["anchor","classes","className","width"]);return O.createElement("div",Object(k.a)({className:Object(L.a)(r.root,r["anchor".concat(S(i))],n),ref:t,style:Object(Pt.a)({},Sr(i)?"width":"height",o)},s))})),ta=Object(B.a)((function(e){return{root:{position:"fixed",top:0,left:0,bottom:0,zIndex:e.zIndex.drawer-1},anchorLeft:{right:"auto"},anchorRight:{left:"auto",right:0},anchorTop:{bottom:"auto",right:0},anchorBottom:{top:"auto",bottom:0,right:0}}}),{name:"PrivateSwipeArea"})(ea),ia=null;function ra(e,t){return"right"===e?document.body.offsetWidth-t[0].pageX:t[0].pageX}function na(e,t){return"bottom"===e?window.innerHeight-t[0].clientY:t[0].clientY}function oa(e,t){return e?t.clientWidth:t.clientHeight}function sa(e,t,i,r){return Math.min(Math.max(i?t-e:r+t-e,0),r)}var aa,la="undefined"!=typeof navigator&&/iPad|iPhone|iPod/.test(navigator.userAgent),ca={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},ua="undefined"!=typeof window?O.useLayoutEffect:O.useEffect,ha=O.forwardRef((function(e,t){var i=Object(Oe.a)(),r=Object(Xi.a)({name:"MuiSwipeableDrawer",props:Object(k.a)({},e),theme:i}),n=r.anchor,o=void 0===n?"left":n,s=r.disableBackdropTransition,a=void 0!==s&&s,l=r.disableDiscovery,c=void 0!==l&&l,u=r.disableSwipeToOpen,h=void 0===u?la:u,d=r.hideBackdrop,p=r.hysteresis,f=void 0===p?.52:p,m=r.minFlingVelocity,g=void 0===m?450:m,v=r.ModalProps,b=(v=void 0===v?{}:v).BackdropProps,_=Object(T.a)(v,["BackdropProps"]),y=r.onClose,x=r.onOpen,w=r.open,M=r.PaperProps,P=void 0===M?{}:M,E=r.SwipeAreaProps,S=r.swipeAreaWidth,C=void 0===S?20:S,A=r.transitionDuration,D=void 0===A?ca:A,R=r.variant,L=void 0===R?"temporary":R,B=Object(T.a)(r,["anchor","disableBackdropTransition","disableDiscovery","disableSwipeToOpen","hideBackdrop","hysteresis","minFlingVelocity","ModalProps","onClose","onOpen","open","PaperProps","SwipeAreaProps","swipeAreaWidth","transitionDuration","variant"]),I=O.useState(!1),N=I[0],j=I[1],F=O.useRef({isSwiping:null}),z=O.useRef(),V=O.useRef(),W=O.useRef(),H=O.useRef(!1),G=O.useRef();ua((function(){G.current=null}),[w]);var X=O.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.mode,n=void 0===r?null:r,s=t.changeTransition,l=void 0===s||s,c=Cr(i,o),u=-1!==["right","bottom"].indexOf(c)?1:-1,h=Sr(o),p=h?"translate(".concat(u*e,"px, 0)"):"translate(0, ".concat(u*e,"px)"),f=W.current.style;f.webkitTransform=p,f.transform=p;var m="";if(n&&(m=i.transitions.create("all",ke({timeout:D},{mode:n}))),l&&(f.webkitTransition=m,f.transition=m),!a&&!d){var g=V.current.style;g.opacity=1-e/oa(h,W.current),l&&(g.webkitTransition=m,g.transition=m)}}),[o,a,d,i,D]),Y=q((function(e){if(H.current)if(ia=null,H.current=!1,j(!1),F.current.isSwiping){F.current.isSwiping=null;var t,r=Cr(i,o),n=Sr(o);t=n?ra(r,e.changedTouches):na(r,e.changedTouches);var s=n?F.current.startX:F.current.startY,a=oa(n,W.current),l=sa(t,s,w,a),c=l/a;Math.abs(F.current.velocity)>g&&(G.current=1e3*Math.abs((a-l)/F.current.velocity)),w?F.current.velocity>g||c>f?y():X(0,{mode:"exit"}):F.current.velocity<-g||1-c>f?x():X(oa(n,W.current),{mode:"enter"})}else F.current.isSwiping=null})),$=q((function(e){if(W.current&&H.current&&(null==ia||ia===F.current)){var t=Cr(i,o),r=Sr(o),n=ra(t,e.touches),s=na(t,e.touches);if(w&&W.current.contains(e.target)&&null==ia){var a=function(e){var t=e.start,i=e.current,r=e.anchor,n={x:"scrollLeft",y:"scrollTop"},o={x:"scrollWidth",y:"scrollHeight"},s={x:"clientWidth",y:"clientHeight"};return e.domTreeShapes.some((function(e){var a=i>=t;"top"!==r&&"left"!==r||(a=!a);var l="left"===r||"right"===r?"x":"y",c=e[n[l]],u=c>0,h=c+e[s[l]]<e[o[l]];return a&&h||!a&&u?e:null}))}({domTreeShapes:function(e,t){for(var i=[];e&&e!==t;){var r=window.getComputedStyle(e);"absolute"===r.getPropertyValue("position")||"hidden"===r.getPropertyValue("overflow-x")?i=[]:(e.clientWidth>0&&e.scrollWidth>e.clientWidth||e.clientHeight>0&&e.scrollHeight>e.clientHeight)&&i.push(e),e=e.parentElement}return i}(e.target,W.current),start:r?F.current.startX:F.current.startY,current:r?n:s,anchor:o});if(a)return void(ia=a);ia=F.current}if(null==F.current.isSwiping){var l=Math.abs(n-F.current.startX),u=Math.abs(s-F.current.startY);l>u&&e.cancelable&&e.preventDefault();var h=r?l>u&&l>3:u>l&&u>3;if(!0===h||(r?u>3:l>3)){if(F.current.isSwiping=h,!h)return void Y(e);F.current.startX=n,F.current.startY=s,c||w||(r?F.current.startX-=C:F.current.startY-=C)}}if(F.current.isSwiping){var d=oa(r,W.current),p=r?F.current.startX:F.current.startY;w&&!F.current.paperHit&&(p=Math.min(p,d));var f=sa(r?n:s,p,w,d);if(w)if(F.current.paperHit)0===f&&(F.current.startX=n,F.current.startY=s);else{if(!(r?n<d:s<d))return;F.current.paperHit=!0,F.current.startX=n,F.current.startY=s}null===F.current.lastTranslate&&(F.current.lastTranslate=f,F.current.lastTime=performance.now()+1);var m=(f-F.current.lastTranslate)/(performance.now()-F.current.lastTime)*1e3;F.current.velocity=.4*F.current.velocity+.6*m,F.current.lastTranslate=f,F.current.lastTime=performance.now(),e.cancelable&&e.preventDefault(),X(f)}}})),K=q((function(e){if(!e.defaultPrevented&&!e.muiHandled&&(!w||V.current.contains(e.target)||W.current.contains(e.target))){var t=Cr(i,o),r=Sr(o),n=ra(t,e.touches),s=na(t,e.touches);if(!w){if(h||e.target!==z.current)return;if(r){if(n>C)return}else if(s>C)return}e.muiHandled=!0,ia=null,F.current.startX=n,F.current.startY=s,j(!0),!w&&W.current&&X(oa(r,W.current)+(c?20:-C),{changeTransition:!1}),F.current.velocity=0,F.current.lastTime=null,F.current.lastTranslate=null,F.current.paperHit=!1,H.current=!0}}));O.useEffect((function(){if("temporary"===L){var e=U(W.current);return e.addEventListener("touchstart",K),e.addEventListener("touchmove",$,{passive:!1}),e.addEventListener("touchend",Y),function(){e.removeEventListener("touchstart",K),e.removeEventListener("touchmove",$,{passive:!1}),e.removeEventListener("touchend",Y)}}}),[L,K,$,Y]),O.useEffect((function(){return function(){ia===F.current&&(ia=null)}}),[]),O.useEffect((function(){w||j(!1)}),[w]);var Z=O.useCallback((function(e){V.current=Q.findDOMNode(e)}),[]);return O.createElement(O.Fragment,null,O.createElement(Ar,Object(k.a)({open:!("temporary"!==L||!N)||w,variant:L,ModalProps:Object(k.a)({BackdropProps:Object(k.a)({},b,{ref:Z})},_),PaperProps:Object(k.a)({},P,{style:Object(k.a)({pointerEvents:"temporary"!==L||w?"":"none"},P.style),ref:W}),anchor:o,transitionDuration:G.current||D,onClose:y,ref:t},B)),!h&&"temporary"===L&&O.createElement(Vo,null,O.createElement(ta,Object(k.a)({anchor:o,ref:z,width:C},E))))})),da=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=void 0===n?"secondary":n,s=e.edge,a=void 0!==s&&s,l=e.size,c=void 0===l?"medium":l,u=Object(T.a)(e,["classes","className","color","edge","size"]),h=O.createElement("span",{className:i.thumb});return O.createElement("span",{className:Object(L.a)(i.root,r,{start:i.edgeStart,end:i.edgeEnd}[a],"small"===c&&i["size".concat(S(c))])},O.createElement(Pi,Object(k.a)({type:"checkbox",icon:h,checkedIcon:h,classes:{root:Object(L.a)(i.switchBase,i["color".concat(S(o))]),input:i.input,checked:i.checked,disabled:i.disabled},ref:t},u)),O.createElement("span",{className:i.track}))})),pa=Object(B.a)((function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),"&$checked":{transform:"translateX(20px)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4,"&$checked":{transform:"translateX(16px)"}}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}}),{name:"MuiSwitch"})(da),fa=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.disabled,o=void 0!==n&&n,s=e.disableFocusRipple,a=void 0!==s&&s,l=e.fullWidth,c=e.icon,u=e.indicator,h=e.label,d=e.onChange,p=e.onClick,f=e.onFocus,m=e.selected,g=e.selectionFollowsFocus,v=e.textColor,b=void 0===v?"inherit":v,_=e.value,y=e.wrapped,x=void 0!==y&&y,w=Object(T.a)(e,["classes","className","disabled","disableFocusRipple","fullWidth","icon","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"]);return O.createElement(et,Object(k.a)({focusRipple:!a,className:Object(L.a)(i.root,i["textColor".concat(S(b))],r,o&&i.disabled,m&&i.selected,h&&c&&i.labelIcon,l&&i.fullWidth,x&&i.wrapped),ref:t,role:"tab","aria-selected":m,disabled:o,onClick:function(e){d&&d(e,_),p&&p(e)},onFocus:function(e){g&&!m&&d&&d(e,_),f&&f(e)},tabIndex:m?0:-1},w),O.createElement("span",{className:i.wrapper},c,h),u)})),ma=Object(B.a)((function(e){var t;return{root:Object(k.a)({},e.typography.button,(t={maxWidth:264,minWidth:72,position:"relative",boxSizing:"border-box",minHeight:48,flexShrink:0,padding:"6px 12px"},Object(Pt.a)(t,e.breakpoints.up("sm"),{padding:"6px 24px"}),Object(Pt.a)(t,"overflow","hidden"),Object(Pt.a)(t,"whiteSpace","normal"),Object(Pt.a)(t,"textAlign","center"),Object(Pt.a)(t,e.breakpoints.up("sm"),{minWidth:160}),t)),labelIcon:{minHeight:72,paddingTop:9,"& $wrapper > *:first-child":{marginBottom:6}},textColorInherit:{color:"inherit",opacity:.7,"&$selected":{opacity:1},"&$disabled":{opacity:.5}},textColorPrimary:{color:e.palette.text.secondary,"&$selected":{color:e.palette.primary.main},"&$disabled":{color:e.palette.text.disabled}},textColorSecondary:{color:e.palette.text.secondary,"&$selected":{color:e.palette.secondary.main},"&$disabled":{color:e.palette.text.disabled}},selected:{},disabled:{},fullWidth:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},wrapped:{fontSize:e.typography.pxToRem(12),lineHeight:1.5},wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"100%",flexDirection:"column"}}}),{name:"MuiTab"})(fa),ga=O.createContext(),va=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"table":n,s=e.padding,a=void 0===s?"default":s,l=e.size,c=void 0===l?"medium":l,u=e.stickyHeader,h=void 0!==u&&u,d=Object(T.a)(e,["classes","className","component","padding","size","stickyHeader"]),p=O.useMemo((function(){return{padding:a,size:c,stickyHeader:h}}),[a,c,h]);return O.createElement(ga.Provider,{value:p},O.createElement(o,Object(k.a)({role:"table"===o?null:"table",ref:t,className:Object(L.a)(i.root,r,h&&i.stickyHeader)},d)))})),ba=Object(B.a)((function(e){return{root:{display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":Object(k.a)({},e.typography.body2,{padding:e.spacing(2),color:e.palette.text.secondary,textAlign:"left",captionSide:"bottom"})},stickyHeader:{borderCollapse:"separate"}}}),{name:"MuiTable"})(va),_a=O.createContext(),ya={variant:"body"},xa=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"tbody":n,s=Object(T.a)(e,["classes","className","component"]);return O.createElement(_a.Provider,{value:ya},O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r),ref:t,role:"tbody"===o?null:"rowgroup"},s)))})),wa=Object(B.a)({root:{display:"table-row-group"}},{name:"MuiTableBody"})(xa),Ma=O.forwardRef((function(e,t){var i,r,n=e.align,o=void 0===n?"inherit":n,s=e.classes,a=e.className,l=e.component,c=e.padding,u=e.scope,h=e.size,d=e.sortDirection,p=e.variant,f=Object(T.a)(e,["align","classes","className","component","padding","scope","size","sortDirection","variant"]),m=O.useContext(ga),g=O.useContext(_a),v=g&&"head"===g.variant;l?(r=l,i=v?"columnheader":"cell"):r=v?"th":"td";var b=u;!b&&v&&(b="col");var _=c||(m&&m.padding?m.padding:"default"),y=h||(m&&m.size?m.size:"medium"),x=p||g&&g.variant,w=null;return d&&(w="asc"===d?"ascending":"descending"),O.createElement(r,Object(k.a)({ref:t,className:Object(L.a)(s.root,s[x],a,"inherit"!==o&&s["align".concat(S(o))],"default"!==_&&s["padding".concat(S(_))],"medium"!==y&&s["size".concat(S(y))],"head"===x&&m&&m.stickyHeader&&s.stickyHeader),"aria-sort":w,role:i,scope:b},f))})),Pa=Object(B.a)((function(e){return{root:Object(k.a)({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:"1px solid\n    ".concat("light"===e.palette.type?Object(tt.i)(Object(tt.d)(e.palette.divider,1),.88):Object(tt.a)(Object(tt.d)(e.palette.divider,1),.68)),textAlign:"left",padding:16}),head:{color:e.palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},body:{color:e.palette.text.primary},footer:{color:e.palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},sizeSmall:{padding:"6px 24px 6px 16px","&:last-child":{paddingRight:16},"&$paddingCheckbox":{width:24,padding:"0 12px 0 16px","&:last-child":{paddingLeft:12,paddingRight:16},"& > *":{padding:0}}},paddingCheckbox:{width:48,padding:"0 0 0 4px","&:last-child":{paddingLeft:0,paddingRight:4}},paddingNone:{padding:0,"&:last-child":{padding:0}},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right",flexDirection:"row-reverse"},alignJustify:{textAlign:"justify"},stickyHeader:{position:"sticky",top:0,left:0,zIndex:2,backgroundColor:e.palette.background.default}}}),{name:"MuiTableCell"})(Ma),Ea=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"div":n,s=Object(T.a)(e,["classes","className","component"]);return O.createElement(o,Object(k.a)({ref:t,className:Object(L.a)(i.root,r)},s))})),Sa=Object(B.a)({root:{width:"100%",overflowX:"auto"}},{name:"MuiTableContainer"})(Ea),Ca={variant:"footer"},ka=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"tfoot":n,s=Object(T.a)(e,["classes","className","component"]);return O.createElement(_a.Provider,{value:Ca},O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r),ref:t,role:"tfoot"===o?null:"rowgroup"},s)))})),Oa=Object(B.a)({root:{display:"table-footer-group"}},{name:"MuiTableFooter"})(ka),Aa={variant:"head"},Ta=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"thead":n,s=Object(T.a)(e,["classes","className","component"]);return O.createElement(_a.Provider,{value:Aa},O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,r),ref:t,role:"thead"===o?null:"rowgroup"},s)))})),Da=Object(B.a)({root:{display:"table-header-group"}},{name:"MuiTableHead"})(Ta),Ra=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"div":n,s=e.disableGutters,a=void 0!==s&&s,l=e.variant,c=void 0===l?"regular":l,u=Object(T.a)(e,["classes","className","component","disableGutters","variant"]);return O.createElement(o,Object(k.a)({className:Object(L.a)(i.root,i[c],r,!a&&i.gutters),ref:t},u))})),La=Object(B.a)((function(e){return{root:{position:"relative",display:"flex",alignItems:"center"},gutters:Object(Pt.a)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),regular:e.mixins.toolbar,dense:{minHeight:48}}}),{name:"MuiToolbar"})(Ra),Ba=j(O.createElement("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),Ia=j(O.createElement("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"})),Na=O.createElement(Ia,null),ja=O.createElement(Ba,null),Fa=O.createElement(Ba,null),za=O.createElement(Ia,null),Va=O.forwardRef((function(e,t){var i=e.backIconButtonProps,r=e.count,n=e.nextIconButtonProps,o=e.onChangePage,s=e.page,a=e.rowsPerPage,l=Object(T.a)(e,["backIconButtonProps","count","nextIconButtonProps","onChangePage","page","rowsPerPage"]),c=Object(Oe.a)();return O.createElement("div",Object(k.a)({ref:t},l),O.createElement(rt,Object(k.a)({onClick:function(e){o(e,s-1)},disabled:0===s,color:"inherit"},i),"rtl"===c.direction?Na:ja),O.createElement(rt,Object(k.a)({onClick:function(e){o(e,s+1)},disabled:-1!==r&&s>=Math.ceil(r/a)-1,color:"inherit"},n),"rtl"===c.direction?Fa:za))})),Ua=function(e){var t=e.from,i=e.to,r=e.count;return"".concat(t,"-").concat(i," of ").concat(-1!==r?r:"more than ".concat(i))},Wa=[10,25,50,100],Ha=O.forwardRef((function(e,t){var i,r=e.ActionsComponent,n=void 0===r?Va:r,o=e.backIconButtonProps,s=e.backIconButtonText,a=void 0===s?"Previous page":s,l=e.classes,c=e.className,u=e.colSpan,h=e.component,d=void 0===h?Pa:h,p=e.count,f=e.labelDisplayedRows,m=void 0===f?Ua:f,g=e.labelRowsPerPage,v=void 0===g?"Rows per page:":g,b=e.nextIconButtonProps,_=e.nextIconButtonText,y=void 0===_?"Next page":_,x=e.onChangePage,w=e.onChangeRowsPerPage,M=e.page,P=e.rowsPerPage,E=e.rowsPerPageOptions,S=void 0===E?Wa:E,C=e.SelectProps,A=void 0===C?{}:C,D=Object(T.a)(e,["ActionsComponent","backIconButtonProps","backIconButtonText","classes","className","colSpan","component","count","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","nextIconButtonText","onChangePage","onChangeRowsPerPage","page","rowsPerPage","rowsPerPageOptions","SelectProps"]);d!==Pa&&"td"!==d||(i=u||1e3);var R=Z(),B=Z(),I=A.native?"option":To;return O.createElement(d,Object(k.a)({className:Object(L.a)(l.root,c),colSpan:i,ref:t},D),O.createElement(La,{className:l.toolbar},O.createElement("div",{className:l.spacer}),S.length>1&&O.createElement(Zt,{color:"inherit",variant:"body2",className:l.caption,id:B},v),S.length>1&&O.createElement(bs,Object(k.a)({classes:{select:l.select,icon:l.selectIcon},input:O.createElement(Zr,{className:Object(L.a)(l.input,l.selectRoot)}),value:P,onChange:w,id:R,labelId:B},A),S.map((function(e){return O.createElement(I,{className:l.menuItem,key:e.value?e.value:e,value:e.value?e.value:e},e.label?e.label:e)}))),O.createElement(Zt,{color:"inherit",variant:"body2",className:l.caption},m({from:0===p?0:M*P+1,to:-1!==p?Math.min(p,(M+1)*P):(M+1)*P,count:-1===p?-1:p,page:M})),O.createElement(n,{className:l.actions,backIconButtonProps:Object(k.a)({title:a,"aria-label":a},o),count:p,nextIconButtonProps:Object(k.a)({title:y,"aria-label":y},b),onChangePage:x,page:M,rowsPerPage:P})))})),Ga=Object(B.a)((function(e){return{root:{color:e.palette.text.primary,fontSize:e.typography.pxToRem(14),overflow:"auto","&:last-child":{padding:0}},toolbar:{minHeight:52,paddingRight:2},spacer:{flex:"1 1 100%"},caption:{flexShrink:0},selectRoot:{marginRight:32,marginLeft:8},select:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"},selectIcon:{},input:{color:"inherit",fontSize:"inherit",flexShrink:0},menuItem:{},actions:{flexShrink:0,marginLeft:20}}}),{name:"MuiTablePagination"})(Ha),Xa=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.component,o=void 0===n?"tr":n,s=e.hover,a=void 0!==s&&s,l=e.selected,c=void 0!==l&&l,u=Object(T.a)(e,["classes","className","component","hover","selected"]),h=O.useContext(_a);return O.createElement(o,Object(k.a)({ref:t,className:Object(L.a)(i.root,r,h&&{head:i.head,footer:i.footer}[h.variant],a&&i.hover,c&&i.selected),role:"tr"===o?null:"row"},u))})),Ya=Object(B.a)((function(e){return{root:{color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,"&$hover:hover":{backgroundColor:e.palette.action.hover},"&$selected, &$selected:hover":{backgroundColor:Object(tt.d)(e.palette.secondary.main,e.palette.action.selectedOpacity)}},selected:{},hover:{},head:{},footer:{}}}),{name:"MuiTableRow"})(Xa),$a=j(O.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"})),qa=O.forwardRef((function(e,t){var i=e.active,r=void 0!==i&&i,n=e.children,o=e.classes,s=e.className,a=e.direction,l=void 0===a?"asc":a,c=e.hideSortIcon,u=void 0!==c&&c,h=e.IconComponent,d=void 0===h?$a:h,p=Object(T.a)(e,["active","children","classes","className","direction","hideSortIcon","IconComponent"]);return O.createElement(et,Object(k.a)({className:Object(L.a)(o.root,s,r&&o.active),component:"span",disableRipple:!0,ref:t},p),n,u&&!r?null:O.createElement(d,{className:Object(L.a)(o.icon,o["iconDirection".concat(S(l))])}))})),Ka=Object(B.a)((function(e){return{root:{cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:e.palette.text.secondary},"&:hover":{color:e.palette.text.secondary,"& $icon":{opacity:.5}},"&$active":{color:e.palette.text.primary,"&& $icon":{opacity:1,color:e.palette.text.secondary}}},active:{},icon:{fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none"},iconDirectionDesc:{transform:"rotate(0deg)"},iconDirectionAsc:{transform:"rotate(180deg)"}}}),{name:"MuiTableSortLabel"})(qa);function Za(){if(aa)return aa;var e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),aa="reverse",e.scrollLeft>0?aa="default":(e.scrollLeft=1,0===e.scrollLeft&&(aa="negative")),document.body.removeChild(e),aa}function Qa(e,t){var i=e.scrollLeft;if("rtl"!==t)return i;switch(Za()){case"negative":return e.scrollWidth-e.clientWidth+i;case"reverse":return e.scrollWidth-e.clientWidth-i;default:return i}}function Ja(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}var el={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function tl(e){var t=e.onChange,i=Object(T.a)(e,["onChange"]),r=O.useRef(),n=O.useRef(null),o=function(){r.current=n.current.offsetHeight-n.current.clientHeight};return O.useEffect((function(){var e=F((function(){var e=r.current;o(),e!==r.current&&t(r.current)}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}),[t]),O.useEffect((function(){o(),t(r.current)}),[t]),O.createElement("div",Object(k.a)({style:el,ref:n},i))}var il=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.color,o=e.orientation,s=Object(T.a)(e,["classes","className","color","orientation"]);return O.createElement("span",Object(k.a)({className:Object(L.a)(i.root,i["color".concat(S(n))],r,"vertical"===o&&i.vertical),ref:t},s))})),rl=Object(B.a)((function(e){return{root:{position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create()},colorPrimary:{backgroundColor:e.palette.primary.main},colorSecondary:{backgroundColor:e.palette.secondary.main},vertical:{height:"100%",width:2,right:0}}}),{name:"PrivateTabIndicator"})(il),nl=O.createElement(Ba,{fontSize:"small"}),ol=O.createElement(Ia,{fontSize:"small"}),sl=O.forwardRef((function(e,t){var i=e.classes,r=e.className,n=e.direction,o=e.orientation,s=e.disabled,a=Object(T.a)(e,["classes","className","direction","orientation","disabled"]);return O.createElement(et,Object(k.a)({component:"div",className:Object(L.a)(i.root,r,s&&i.disabled,"vertical"===o&&i.vertical),ref:t,role:null,tabIndex:null},a),"left"===n?nl:ol)})),al=Object(B.a)({root:{width:40,flexShrink:0,opacity:.8,"&$disabled":{opacity:0}},vertical:{width:"100%",height:40,"& svg":{transform:"rotate(90deg)"}},disabled:{}},{name:"MuiTabScrollButton"})(sl),ll=O.forwardRef((function(e,t){var i=e["aria-label"],r=e["aria-labelledby"],n=e.action,o=e.centered,s=void 0!==o&&o,a=e.children,l=e.classes,c=e.className,u=e.component,h=void 0===u?"div":u,d=e.indicatorColor,p=void 0===d?"secondary":d,f=e.onChange,m=e.orientation,g=void 0===m?"horizontal":m,v=e.ScrollButtonComponent,b=void 0===v?al:v,_=e.scrollButtons,y=void 0===_?"auto":_,x=e.selectionFollowsFocus,w=e.TabIndicatorProps,M=void 0===w?{}:w,P=e.TabScrollButtonProps,E=e.textColor,S=void 0===E?"inherit":E,C=e.value,A=e.variant,D=void 0===A?"standard":A,R=Object(T.a)(e,["aria-label","aria-labelledby","action","centered","children","classes","className","component","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant"]),B=Object(Oe.a)(),I="scrollable"===D,N="rtl"===B.direction,j="vertical"===g,z=j?"scrollTop":"scrollLeft",V=j?"top":"left",U=j?"bottom":"right",H=j?"clientHeight":"clientWidth",G=j?"height":"width",X=O.useState(!1),Y=X[0],$=X[1],K=O.useState({}),Z=K[0],Q=K[1],J=O.useState({start:!1,end:!1}),ee=J[0],te=J[1],ie=O.useState({overflow:"hidden",marginBottom:null}),re=ie[0],ne=ie[1],oe=new Map,se=O.useRef(null),ae=O.useRef(null),le=function(){var e,t,i=se.current;if(i){var r=i.getBoundingClientRect();e={clientWidth:i.clientWidth,scrollLeft:i.scrollLeft,scrollTop:i.scrollTop,scrollLeftNormalized:Qa(i,B.direction),scrollWidth:i.scrollWidth,top:r.top,bottom:r.bottom,left:r.left,right:r.right}}if(i&&!1!==C){var n=ae.current.children;if(n.length>0){var o=n[oe.get(C)];t=o?o.getBoundingClientRect():null}}return{tabsMeta:e,tabMeta:t}},ce=q((function(){var e,t=le(),i=t.tabsMeta,r=t.tabMeta,n=0;if(r&&i)if(j)n=r.top-i.top+i.scrollTop;else{var o=N?i.scrollLeftNormalized+i.clientWidth-i.scrollWidth:i.scrollLeft;n=r.left-i.left+o}var s=(e={},Object(Pt.a)(e,V,n),Object(Pt.a)(e,G,r?r[G]:0),e);if(isNaN(Z[V])||isNaN(Z[G]))Q(s);else{var a=Math.abs(Z[V]-s[V]),l=Math.abs(Z[G]-s[G]);(a>=1||l>=1)&&Q(s)}})),ue=function(e){!function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=r.ease,s=void 0===o?Ja:o,a=r.duration,l=void 0===a?300:a,c=null,u=t[e],h=!1;u===i?n(new Error("Element already at target position")):requestAnimationFrame((function r(o){if(h)n(new Error("Animation cancelled"));else{null===c&&(c=o);var a=Math.min(1,(o-c)/l);t[e]=s(a)*(i-u)+u,a>=1?requestAnimationFrame((function(){n(null)})):requestAnimationFrame(r)}}))}(z,se.current,e)},he=function(e){var t=se.current[z];j?t+=e:(t+=e*(N?-1:1),t*=N&&"reverse"===Za()?-1:1),ue(t)},de=function(){he(-se.current[H])},pe=function(){he(se.current[H])},fe=O.useCallback((function(e){ne({overflow:null,marginBottom:-e})}),[]),me=q((function(){var e=le(),t=e.tabsMeta,i=e.tabMeta;if(i&&t)if(i[V]<t[V]){var r=t[z]+(i[V]-t[V]);ue(r)}else if(i[U]>t[U]){var n=t[z]+(i[U]-t[U]);ue(n)}})),ge=q((function(){if(I&&"off"!==y){var e,t,i=se.current,r=i.scrollTop,n=i.scrollHeight,o=i.clientHeight,s=i.scrollWidth,a=i.clientWidth;if(j)e=r>1,t=r<n-o-1;else{var l=Qa(se.current,B.direction);e=N?l<s-a-1:l>1,t=N?l>1:l<s-a-1}e===ee.start&&t===ee.end||te({start:e,end:t})}}));O.useEffect((function(){var e=F((function(){ce(),ge()})),t=W(se.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}}),[ce,ge]);var ve=O.useCallback(F((function(){ge()})));O.useEffect((function(){return function(){ve.clear()}}),[ve]),O.useEffect((function(){$(!0)}),[]),O.useEffect((function(){ce(),ge()})),O.useEffect((function(){me()}),[me,Z]),O.useImperativeHandle(n,(function(){return{updateIndicator:ce,updateScrollButtons:ge}}),[ce,ge]);var be=O.createElement(rl,Object(k.a)({className:l.indicator,orientation:g,color:p},M,{style:Object(k.a)({},Z,M.style)})),_e=0,ye=O.Children.map(a,(function(e){if(!O.isValidElement(e))return null;var t=void 0===e.props.value?_e:e.props.value;oe.set(t,_e);var i=t===C;return _e+=1,O.cloneElement(e,{fullWidth:"fullWidth"===D,indicator:i&&!Y&&be,selected:i,selectionFollowsFocus:x,onChange:f,textColor:S,value:t})})),xe=function(){var e={};e.scrollbarSizeListener=I?O.createElement(tl,{className:l.scrollable,onChange:fe}):null;var t=ee.start||ee.end,i=I&&("auto"===y&&t||"desktop"===y||"on"===y);return e.scrollButtonStart=i?O.createElement(b,Object(k.a)({orientation:g,direction:N?"right":"left",onClick:de,disabled:!ee.start,className:Object(L.a)(l.scrollButtons,"on"!==y&&l.scrollButtonsDesktop)},P)):null,e.scrollButtonEnd=i?O.createElement(b,Object(k.a)({orientation:g,direction:N?"left":"right",onClick:pe,disabled:!ee.end,className:Object(L.a)(l.scrollButtons,"on"!==y&&l.scrollButtonsDesktop)},P)):null,e}();return O.createElement(h,Object(k.a)({className:Object(L.a)(l.root,c,j&&l.vertical),ref:t},R),xe.scrollButtonStart,xe.scrollbarSizeListener,O.createElement("div",{className:Object(L.a)(l.scroller,I?l.scrollable:l.fixed),style:re,ref:se,onScroll:ve},O.createElement("div",{"aria-label":i,"aria-labelledby":r,className:Object(L.a)(l.flexContainer,j&&l.flexContainerVertical,s&&!I&&l.centered),onKeyDown:function(e){var t=e.target;if("tab"===t.getAttribute("role")){var i=null,r="vertical"!==g?"ArrowLeft":"ArrowUp",n="vertical"!==g?"ArrowRight":"ArrowDown";switch("vertical"!==g&&"rtl"===B.direction&&(r="ArrowRight",n="ArrowLeft"),e.key){case r:i=t.previousElementSibling||ae.current.lastChild;break;case n:i=t.nextElementSibling||ae.current.firstChild;break;case"Home":i=ae.current.firstChild;break;case"End":i=ae.current.lastChild}null!==i&&(i.focus(),e.preventDefault())}},ref:ae,role:"tablist"},ye),Y&&be),xe.scrollButtonEnd)})),cl=Object(B.a)((function(e){return{root:{overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},vertical:{flexDirection:"column"},flexContainer:{display:"flex"},flexContainerVertical:{flexDirection:"column"},centered:{justifyContent:"center"},scroller:{position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},fixed:{overflowX:"hidden",width:"100%"},scrollable:{overflowX:"scroll",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},scrollButtons:{},scrollButtonsDesktop:Object(Pt.a)({},e.breakpoints.down("xs"),{display:"none"}),indicator:{}}}),{name:"MuiTabs"})(ll),ul={standard:Un,filled:Jr,outlined:Go},hl=O.forwardRef((function(e,t){var i=e.autoComplete,r=e.autoFocus,n=void 0!==r&&r,o=e.children,s=e.classes,a=e.className,l=e.color,c=void 0===l?"primary":l,u=e.defaultValue,h=e.disabled,d=void 0!==h&&h,p=e.error,f=void 0!==p&&p,m=e.FormHelperTextProps,g=e.fullWidth,v=void 0!==g&&g,b=e.helperText,_=e.hiddenLabel,y=e.id,x=e.InputLabelProps,w=e.inputProps,M=e.InputProps,P=e.inputRef,E=e.label,S=e.multiline,C=void 0!==S&&S,A=e.name,D=e.onBlur,R=e.onChange,B=e.onFocus,I=e.placeholder,N=e.required,j=void 0!==N&&N,F=e.rows,z=e.rowsMax,V=e.select,U=void 0!==V&&V,W=e.SelectProps,H=e.type,G=e.value,X=e.variant,Y=void 0===X?"standard":X,$=Object(T.a)(e,["autoComplete","autoFocus","children","classes","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","hiddenLabel","id","InputLabelProps","inputProps","InputProps","inputRef","label","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","rowsMax","select","SelectProps","type","value","variant"]),q={};if("outlined"===Y&&(x&&void 0!==x.shrink&&(q.notched=x.shrink),E)){var K,Z=null!==(K=null==x?void 0:x.required)&&void 0!==K?K:j;q.label=O.createElement(O.Fragment,null,E,Z&&" *")}U&&(W&&W.native||(q.id=void 0),q["aria-describedby"]=void 0);var Q=b&&y?"".concat(y,"-helper-text"):void 0,J=E&&y?"".concat(y,"-label"):void 0,ee=ul[Y],te=O.createElement(ee,Object(k.a)({"aria-describedby":Q,autoComplete:i,autoFocus:n,defaultValue:u,fullWidth:v,multiline:C,name:A,rows:F,rowsMax:z,type:H,value:G,id:y,inputRef:P,onBlur:D,onChange:R,onFocus:B,placeholder:I,inputProps:w},q,M));return O.createElement(tn,Object(k.a)({className:Object(L.a)(s.root,a),disabled:d,error:f,fullWidth:v,hiddenLabel:_,ref:t,required:j,color:c,variant:Y},$),E&&O.createElement(Xn,Object(k.a)({htmlFor:y,id:J},x),E),U?O.createElement(bs,Object(k.a)({"aria-describedby":Q,id:y,labelId:J,value:G,input:te},W),o):te,b&&O.createElement(ln,Object(k.a)({id:Q},m),b))})),dl=Object(B.a)({root:{}},{name:"MuiTextField"})(hl),pl=i(259);function fl(e){return Math.round(1e5*e)/1e5}var ml=!1,gl=null,vl=O.forwardRef((function(e,t){var i=e.arrow,r=void 0!==i&&i,n=e.children,o=e.classes,s=e.disableFocusListener,a=void 0!==s&&s,l=e.disableHoverListener,c=void 0!==l&&l,u=e.disableTouchListener,h=void 0!==u&&u,d=e.enterDelay,p=void 0===d?100:d,f=e.enterNextDelay,m=void 0===f?0:f,g=e.enterTouchDelay,v=void 0===g?700:g,b=e.id,_=e.interactive,y=void 0!==_&&_,x=e.leaveDelay,w=void 0===x?0:x,M=e.leaveTouchDelay,P=void 0===M?1500:M,E=e.onClose,C=e.onOpen,A=e.open,D=e.placement,R=void 0===D?"bottom":D,B=e.PopperComponent,I=void 0===B?Ko:B,N=e.PopperProps,j=e.title,F=e.TransitionComponent,z=void 0===F?Sn:F,V=e.TransitionProps,U=Object(T.a)(e,["arrow","children","classes","disableFocusListener","disableHoverListener","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","id","interactive","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","title","TransitionComponent","TransitionProps"]),W=Object(Oe.a)(),H=O.useState(),X=H[0],$=H[1],q=O.useState(null),J=q[0],ee=q[1],te=O.useRef(!1),ie=O.useRef(),re=O.useRef(),ne=O.useRef(),oe=O.useRef(),se=Y({controlled:A,default:!1,name:"Tooltip",state:"open"}),ae=Object(me.a)(se,2),le=ae[0],ue=ae[1],he=le,de=Z(b);O.useEffect((function(){return function(){clearTimeout(ie.current),clearTimeout(re.current),clearTimeout(ne.current),clearTimeout(oe.current)}}),[]);var pe=function(e){clearTimeout(gl),ml=!0,ue(!0),C&&C(e)},fe=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){var i=n.props;"mouseover"===t.type&&i.onMouseOver&&e&&i.onMouseOver(t),te.current&&"touchstart"!==t.type||(X&&X.removeAttribute("title"),clearTimeout(re.current),clearTimeout(ne.current),p||ml&&m?(t.persist(),re.current=setTimeout((function(){pe(t)}),ml?m:p)):pe(t))}},ge=ce(),ve=ge.isFocusVisible,be=ge.onBlurVisible,_e=ge.ref,ye=O.useState(!1),xe=ye[0],we=ye[1],Me=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){X||$(t.currentTarget),ve(t)&&(we(!0),fe()(t));var i=n.props;i.onFocus&&e&&i.onFocus(t)}},Pe=function(e){clearTimeout(gl),gl=setTimeout((function(){ml=!1}),800+w),ue(!1),E&&E(e),clearTimeout(ie.current),ie.current=setTimeout((function(){te.current=!1}),W.transitions.duration.shortest)},Ee=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){var i=n.props;"blur"===t.type&&(i.onBlur&&e&&i.onBlur(t),xe&&(we(!1),be())),"mouseleave"===t.type&&i.onMouseLeave&&t.currentTarget===X&&i.onMouseLeave(t),clearTimeout(re.current),clearTimeout(ne.current),t.persist(),ne.current=setTimeout((function(){Pe(t)}),w)}},Se=function(e){te.current=!0;var t=n.props;t.onTouchStart&&t.onTouchStart(e)},Ce=K(_e,K($,t)),ke=O.useCallback((function(e){G(Ce,Q.findDOMNode(e))}),[Ce]),Ae=K(n.ref,ke);""===j&&(he=!1);var Te=!he&&!c,De=Object(k.a)({"aria-describedby":he?de:null,title:Te&&"string"==typeof j?j:null},U,n.props,{className:Object(L.a)(U.className,n.props.className),onTouchStart:Se,ref:Ae}),Re={};h||(De.onTouchStart=function(e){Se(e),clearTimeout(ne.current),clearTimeout(ie.current),clearTimeout(oe.current),e.persist(),oe.current=setTimeout((function(){fe()(e)}),v)},De.onTouchEnd=function(e){n.props.onTouchEnd&&n.props.onTouchEnd(e),clearTimeout(oe.current),clearTimeout(ne.current),e.persist(),ne.current=setTimeout((function(){Pe(e)}),P)}),c||(De.onMouseOver=fe(),De.onMouseLeave=Ee(),y&&(Re.onMouseOver=fe(!1),Re.onMouseLeave=Ee(!1))),a||(De.onFocus=Me(),De.onBlur=Ee(),y&&(Re.onFocus=Me(!1),Re.onBlur=Ee(!1)));var Le=O.useMemo((function(){return Object(pl.a)({popperOptions:{modifiers:{arrow:{enabled:Boolean(J),element:J}}}},N)}),[J,N]);return O.createElement(O.Fragment,null,O.cloneElement(n,De),O.createElement(I,Object(k.a)({className:Object(L.a)(o.popper,y&&o.popperInteractive,r&&o.popperArrow),placement:R,anchorEl:X,open:!!X&&he,id:De["aria-describedby"],transition:!0},Re,Le),(function(e){var t=e.placement,i=e.TransitionProps;return O.createElement(z,Object(k.a)({timeout:W.transitions.duration.shorter},i,V),O.createElement("div",{className:Object(L.a)(o.tooltip,o["tooltipPlacement".concat(S(t.split("-")[0]))],te.current&&o.touch,r&&o.tooltipArrow)},j,r?O.createElement("span",{className:o.arrow,ref:ee}):null))})))})),bl=Object(B.a)((function(e){return{popper:{zIndex:e.zIndex.tooltip,pointerEvents:"none"},popperInteractive:{pointerEvents:"auto"},popperArrow:{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.71em",marginLeft:4,marginRight:4,"&::before":{transformOrigin:"0 100%"}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.71em",marginLeft:4,marginRight:4,"&::before":{transformOrigin:"100% 0"}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.71em",height:"1em",width:"0.71em",marginTop:4,marginBottom:4,"&::before":{transformOrigin:"100% 100%"}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.71em",height:"1em",width:"0.71em",marginTop:4,marginBottom:4,"&::before":{transformOrigin:"0 0"}}},tooltip:{backgroundColor:Object(tt.d)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(10),lineHeight:"".concat(fl(1.4),"em"),maxWidth:300,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium},tooltipArrow:{position:"relative",margin:"0"},arrow:{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:Object(tt.d)(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}},touch:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:"".concat(fl(16/14),"em"),fontWeight:e.typography.fontWeightRegular},tooltipPlacementLeft:Object(Pt.a)({transformOrigin:"right center",margin:"0 24px "},e.breakpoints.up("sm"),{margin:"0 14px"}),tooltipPlacementRight:Object(Pt.a)({transformOrigin:"left center",margin:"0 24px"},e.breakpoints.up("sm"),{margin:"0 14px"}),tooltipPlacementTop:Object(Pt.a)({transformOrigin:"center bottom",margin:"24px 0"},e.breakpoints.up("sm"),{margin:"14px 0"}),tooltipPlacementBottom:Object(Pt.a)({transformOrigin:"center top",margin:"24px 0"},e.breakpoints.up("sm"),{margin:"14px 0"})}}),{name:"MuiTooltip",flip:!1})(vl);function _l(e,t){var i=t.disableHysteresis,r=void 0!==i&&i,n=t.threshold,o=void 0===n?100:n,s=t.target,a=e.current;return s&&(e.current=void 0!==s.pageYOffset?s.pageYOffset:s.scrollTop),!(!r&&void 0!==a&&e.current<a)&&e.current>o}var yl="undefined"!=typeof window?window:null;function xl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.getTrigger,i=void 0===t?_l:t,r=e.target,n=void 0===r?yl:r,o=Object(T.a)(e,["getTrigger","target"]),s=O.useRef(),a=O.useState((function(){return i(s,o)})),l=a[0],c=a[1];return O.useEffect((function(){var e=function(){c(i(s,Object(k.a)({target:n},o)))};return e(),n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}),[n,i,JSON.stringify(o)]),l}var wl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var i=e.breakpoint,r=void 0===i?"sm":i;return Ln()((function(e){return O.createElement(t,Object(k.a)({fullScreen:Dn(r,e.width)},e))}))}},Ml={entering:{transform:"none"},entered:{transform:"none"}},Pl={enter:Se.b.enteringScreen,exit:Se.b.leavingScreen},El=O.forwardRef((function(e,t){var i=e.children,r=e.disableStrictModeCompat,n=void 0!==r&&r,o=e.in,s=e.onEnter,a=e.onEntered,l=e.onEntering,c=e.onExit,u=e.onExited,h=e.onExiting,d=e.style,p=e.timeout,f=void 0===p?Pl:p,m=e.TransitionComponent,g=void 0===m?Ee:m,v=Object(T.a)(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),b=Object(Oe.a)(),_=b.unstable_strictMode&&!n,y=O.useRef(null),x=K(i.ref,t),w=K(_?y:void 0,x),M=function(e){return function(t,i){if(e){var r=_?[y.current,t]:[t,i],n=Object(me.a)(r,2),o=n[0],s=n[1];void 0===s?e(o):e(o,s)}}},P=M(l),E=M((function(e,t){Ce(e);var i=ke({style:d,timeout:f},{mode:"enter"});e.style.webkitTransition=b.transitions.create("transform",i),e.style.transition=b.transitions.create("transform",i),s&&s(e,t)})),S=M(a),C=M(h),A=M((function(e){var t=ke({style:d,timeout:f},{mode:"exit"});e.style.webkitTransition=b.transitions.create("transform",t),e.style.transition=b.transitions.create("transform",t),c&&c(e)})),D=M(u);return O.createElement(g,Object(k.a)({appear:!0,in:o,nodeRef:_?y:void 0,onEnter:E,onEntered:S,onEntering:P,onExit:A,onExited:D,onExiting:C,timeout:f},v),(function(e,t){return O.cloneElement(i,Object(k.a)({style:Object(k.a)({transform:"scale(0)",visibility:"exited"!==e||o?void 0:"hidden"},Ml[e],d,i.props.style),ref:w},t))}))}))},function(e,t,i){"use strict";t.a=function(e,t){}},function(e,t,i){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}i.d(t,"a",(function(){return r}))},,,,,,,,function(e,t,i){"use strict";var r=i(2),n=i(4),o=i(1),s=i.n(o),a=i(3),l=(i(6),i(48)),c=i.n(l),u=i(270);var h=i(41);t.a=function(e){var t=function(e){return function(t){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=o.name,h=Object(n.a)(o,["name"]),d=l,p="function"==typeof t?function(e){return{root:function(i){return t(Object(r.a)({theme:e},i))}}}:{root:t},f=Object(u.a)(p,Object(r.a)({Component:e,name:l||e.displayName,classNamePrefix:d},h));t.filterProps&&(i=t.filterProps,delete t.filterProps),t.propTypes&&(t.propTypes,delete t.propTypes);var m=s.a.forwardRef((function(t,o){var l=t.children,c=t.className,u=t.clone,h=t.component,d=Object(n.a)(t,["children","className","clone","component"]),p=f(t),m=Object(a.a)(p.root,c),g=d;if(i&&(g=function(e,t){var i={};return Object.keys(e).forEach((function(r){-1===t.indexOf(r)&&(i[r]=e[r])})),i}(g,i)),u)return s.a.cloneElement(l,Object(r.a)({className:Object(a.a)(l.props.className,m)},g));if("function"==typeof l)return l(Object(r.a)({className:m},g));var v=h||e;return s.a.createElement(v,Object(r.a)({ref:o,className:m},g),l)}));return c()(m,e),m}}(e);return function(e,i){return t(e,Object(r.a)({defaultTheme:h.a},i))}}},function(e,t,i){"use strict";function r(e){if(Array.isArray(e))return e}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i(25),i(2);var r=i(45),n=(i(6),i(47),{xs:0,sm:600,md:960,lg:1280,xl:1920}),o={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(n[e],"px)")}};function s(e,t,i){if(Array.isArray(t)){var n=e.theme.breakpoints||o;return t.reduce((function(e,r,o){return e[n.up(n.keys[o])]=i(t[o]),e}),{})}if("object"===Object(r.a)(t)){var s=e.theme.breakpoints||o;return Object.keys(t).reduce((function(e,r){return e[s.up(r)]=i(t[r]),e}),{})}return i(t)}},function(e,t,i){"use strict";function r(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";t.a={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500}},function(e,t,i){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";var r=i(1),n=i.n(r).a.createContext(null);t.a=n},function(e,t,i){"use strict";var r="function"==typeof Symbol&&Symbol.for;t.a=r?Symbol.for("mui.nested"):"__THEME_NESTED__"},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(16);class n extends r.a{get type(){return"Light"}get isLight(){return!0}constructor(e,t={}){super(e,t)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(8);function n(e={}){let t=e.xSize||1;t<0&&(console.error("negative xSize not allowed - will invert"),t*=-1);let i=e.ySize||1;i<0&&(console.error("negative ySize not allowed - will invert"),i*=-1);let n=e.zSize||1;n<0&&(console.error("negative zSize not allowed - will invert"),n*=-1);const o=e.center,s=o?o[0]:0,a=o?o[1]:0,l=o?o[2]:0,c=-t+s,u=-i+a,h=-n+l,d=t+s,p=i+a,f=n+l;return r.utils.apply(e,{positions:[d,p,f,c,p,f,c,u,f,d,u,f,d,p,f,d,u,f,d,u,h,d,p,h,d,p,f,d,p,h,c,p,h,c,p,f,c,p,f,c,p,h,c,u,h,c,u,f,c,u,h,d,u,h,d,u,f,c,u,f,d,u,h,c,u,h,c,p,h,d,p,h],normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],uv:[1,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]})}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(68),n=i(20);const o={default:{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1},defaultWhiteBG:{edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultLightBG:{edgeColor:[.2,.2,.2],edgeAlpha:1,edgeWidth:1},defaultDarkBG:{edgeColor:[.5,.5,.5],edgeAlpha:1,edgeWidth:1}};class s extends r.a{get type(){return"EdgeMaterial"}get presets(){return o}constructor(e,t={}){super(e,t),this._state=new n.a({type:"EdgeMaterial",edges:null,edgeColor:null,edgeAlpha:null,edgeWidth:null}),this._preset="default",t.preset?(this.preset=t.preset,t.edgeColor&&(this.edgeColor=t.edgeColor),void 0!==t.edgeAlpha&&(this.edgeAlpha=t.edgeAlpha),void 0!==t.edgeWidth&&(this.edgeWidth=t.edgeWidth)):(this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth),this.edges=!1!==t.edges}set edges(e){e=!1!==e,this._state.edges!==e&&(this._state.edges=e,this.glRedraw())}get edges(){return this._state.edges}set edgeColor(e){let t=this._state.edgeColor;if(t){if(e&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2])return}else t=this._state.edgeColor=new Float32Array(3);e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=.2,t[1]=.2,t[2]=.2),this.glRedraw()}get edgeColor(){return this._state.edgeColor}set edgeAlpha(e){e=null!=e?e:1,this._state.edgeAlpha!==e&&(this._state.edgeAlpha=e,this.glRedraw())}get edgeAlpha(){return this._state.edgeAlpha}set edgeWidth(e){this._state.edgeWidth=e||1,this.glRedraw()}get edgeWidth(){return this._state.edgeWidth}set preset(e){if(e=e||"default",this._preset===e)return;const t=o[e];t?(this.edgeColor=t.edgeColor,this.edgeAlpha=t.edgeAlpha,this.edgeWidth=t.edgeWidth,this._preset=e):this.error("unsupported preset: '"+e+"' - supported values are "+Object.keys(o).join(", "))}get preset(){return this._preset}destroy(){super.destroy(),this._state.destroy()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(){this.visibleLayers=[],this.sectionPlanesActivePerLayer=[],this.reset()}reset(){this.culled=!1,this.numLayers=0,this.numVisibleLayers=0,this.normalFillOpaque=!1,this.normalEdgesOpaque=!1,this.normalFillTransparent=!1,this.normalEdgesTransparent=!1,this.xrayedFillOpaque=!1,this.xrayedEdgesOpaque=!1,this.xrayedFillTransparent=!1,this.xrayedEdgesTransparent=!1,this.highlightedFillOpaque=!1,this.highlightedEdgesOpaque=!1,this.highlightedFillTransparent=!1,this.highlightedEdgesTransparent=!1,this.selectedFillOpaque=!1,this.selectedEdgesOpaque=!1,this.selectedFillTransparent=!1,this.selectedEdgesTransparent=!1}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(16),n=i(20),o=i(0);class s extends r.a{get type(){return"SectionPlane"}constructor(e,t={}){super(e,t),this._state=new n.a({active:!0,pos:o.math.vec3(),dir:o.math.vec3(),dist:0}),this.active=t.active,this.pos=t.pos,this.dir=t.dir,this.scene._sectionPlaneCreated(this)}set active(e){this._state.active=!1!==e,this.glRedraw(),this.fire("active",this._state.active)}get active(){return this._state.active}set pos(e){this._state.pos.set(e||[0,0,0]),this._state.dist=-o.math.dotVec3(this._state.pos,this._state.dir),this.fire("pos",this._state.pos)}get pos(){return this._state.pos}set dir(e){this._state.dir.set(e||[0,0,-1]),this._state.dist=-o.math.dotVec3(this._state.pos,this._state.dir),this.glRedraw(),this.fire("dir",this._state.dir)}get dir(){return this._state.dir}get dist(){return this._state.dist}flipDir(){const e=this._state.dir;e[0]*=-1,e[1]*=-1,e[2]*=-1,this._state.dist=-o.math.dotVec3(this._state.pos,this._state.dir),this.fire("dir",this._state.dir),this.glRedraw()}destroy(){this._state.destroy(),this.scene._sectionPlaneDestroyed(this),super.destroy()}}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TreeViewContextMenu=void 0;const r=i(74),n=i(0),o=n.math.vec3();t.TreeViewContextMenu=class extends r.ContextMenu{constructor(e={}){super({context:e.context,items:[[{title:"Isolate",doAction:function(e){const t=e.viewer,i=t.scene,r=[];e.treeViewPlugin.withNodeTree(e.treeViewNode,e=>{e.objectId&&r.push(e.objectId)});const s=i.getAABB(r);t.cameraControl.pivotPos=n.math.getAABB3Center(s,o),i.setObjectsXRayed(i.xrayedObjectIds,!1),i.setObjectsVisible(i.objectIds,!1),i.setObjectsPickable(i.objectIds,!1),i.setObjectsSelected(i.selectedObjectIds,!1),i.setObjectsVisible(r,!0),i.setObjectsPickable(r,!0),t.cameraFlight.flyTo({aabb:s},()=>{})}}],[{title:"View Fit",doAction:function(e){const t=e.viewer,i=t.scene,r=[];e.treeViewPlugin.withNodeTree(e.treeViewNode,e=>{e.objectId&&r.push(e.objectId)}),i.setObjectsVisible(r,!0),i.setObjectsHighlighted(r,!0);const o=i.getAABB(r);t.cameraFlight.flyTo({aabb:o,duration:.5},()=>{setTimeout((function(){i.setObjectsHighlighted(i.highlightedObjectIds,!1)}),500)}),t.cameraControl.pivotPos=n.math.getAABB3Center(o)}},{title:"View Fit All",doAction:function(e){const t=e.viewer,i=t.scene,r=i.getAABB(i.visibleObjectIds);t.cameraFlight.flyTo({aabb:r,duration:.5}),t.cameraControl.pivotPos=n.math.getAABB3Center(r)}}],[{title:"Hide",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.visible=!1)}})}},{title:"Hide Others",doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.visibleObjectIds,!1),t.setObjectsPickable(t.xrayedObjectIds,!0),t.setObjectsXRayed(t.xrayedObjectIds,!1),t.setObjectsHighlighted(t.highlightedObjectIds,!1),e.treeViewPlugin.withNodeTree(e.treeViewNode,e=>{if(e.objectId){const i=t.objects[e.objectId];i&&(i.visible=!0)}})}},{title:"Hide All",getEnabled:function(e){return e.viewer.scene.visibleObjectIds.length>0},doAction:function(e){e.viewer.scene.setObjectsVisible(e.viewer.scene.visibleObjectIds,!1)}}],[{title:"Show",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.visible=!0,i.xrayed&&(i.pickable=!0),i.xrayed=!1,i.selected=!1)}})}},{title:"Show Others",doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsPickable(t.xrayedObjectIds,!0),t.setObjectsXRayed(t.xrayedObjectIds,!1),e.treeViewPlugin.withNodeTree(e.treeViewNode,e=>{if(e.objectId){const i=t.objects[e.objectId];i&&(i.visible=!1)}})}},{title:"Show All",getEnabled:function(e){const t=e.viewer.scene;return t.numVisibleObjects<t.numObjects||e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsPickable(t.xrayedObjectIds,!0),t.setObjectsXRayed(t.xrayedObjectIds,!1)}}],[{title:"X-Ray",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.xrayed=!0,i.visible=!0,i.pickable=!1)}})}},{title:"Undo X-Ray",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.xrayed=!1,i.pickable=!0)}})}},{title:"X-Ray Others",doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsPickable(t.objectIds,!1),t.setObjectsXRayed(t.objectIds,!0),t.setObjectsHighlighted(t.highlightedObjectIds,!1),e.treeViewPlugin.withNodeTree(e.treeViewNode,e=>{if(e.objectId){const i=t.objects[e.objectId];i&&(i.xrayed=!1,i.pickable=!0)}})}},{title:"X-Ray All",doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsXRayed(t.objectIds,!0),t.setObjectsPickable(t.objectIds,!1)}},{title:"X-Ray None",getEnabled:function(e){return e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene,i=t.xrayedObjectIds;t.setObjectsPickable(i,!0),t.setObjectsXRayed(i,!1)}}],[{title:"Select",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.selected=!0,i.visible=!0)}})}},{title:"Undo Select",doAction:function(e){e.treeViewPlugin.withNodeTree(e.treeViewNode,t=>{if(t.objectId){const i=e.viewer.scene.objects[t.objectId];i&&(i.selected=!1)}})}},{title:"Select None",getEnabled:function(e){return e.viewer.scene.numSelectedObjects>0},doAction:function(e){e.viewer.scene.setObjectsSelected(e.viewer.scene.selectedObjectIds,!1)}}],[{title:"Clear Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.clearSections()}}]]})}}},function(e,t,i){"use strict";i.r(t),i.d(t,"TreeViewPlugin",(function(){return s}));const r=new(i(24).Map);class n{constructor(e,t,i,n,o){if(!o.containerElement)throw"Config expected: containerElement";const s=n.rootMetaObject;s&&(this._id=r.addItem(),this._baseId=""+this._id,this._viewer=e,this._metaModel=n,this._treeViewPlugin=t,this._rootMetaObject=s,this._containerElement=o.containerElement,this._rootElement=null,this._muteSceneEvents=!1,this._muteTreeEvents=!1,this._rootNodes=[],this._objectNodes={},this._rootName=o.rootName,this._sortNodes=o.sortNodes,this._pruneEmptyNodes=o.pruneEmptyNodes,this._showListItemElementId=null,this._containerElement.oncontextmenu=e=>{e.preventDefault()},this._onObjectVisibility=this._viewer.scene.on("objectVisibility",e=>{if(this._muteSceneEvents)return;const t=e.id,i=this._objectNodes[t];if(!i)return;const r=e.visible;if(r===i.checked)return;this._muteTreeEvents=!0,i.checked=r,r?i.numVisibleEntities++:i.numVisibleEntities--;const n=document.getElementById(i.nodeId);n&&(n.checked=r);let o=i.parent;for(;o;){o.checked=r,r?o.numVisibleEntities++:o.numVisibleEntities--;const e=document.getElementById(o.nodeId);if(e){const t=o.numVisibleEntities>0;t!==e.checked&&(e.checked=t)}o=o.parent}this._muteTreeEvents=!1}),this.switchExpandHandler=e=>{e.preventDefault(),e.stopPropagation();const t=e.target;this._expandSwitchElement(t)},this.switchCollapseHandler=e=>{e.preventDefault(),e.stopPropagation();const t=e.target;this._collapseSwitchElement(t)},this._checkboxChangeHandler=e=>{if(this._muteTreeEvents)return;this._muteSceneEvents=!0;const t=e.target,i=t.checked,r=t.id,n=this._nodeToObjectID(r),o=this._objectNodes[n],s=this._viewer.scene.objects;let a=0;this._withNodeTree(o,e=>{const t=e.objectId,r=e.nodeId,n=s[t],o=0===e.children.length;e.numVisibleEntities=i?e.numEntities:0,o&&i!==e.checked&&a++,e.checked=i;const l=document.getElementById(r);l&&(l.checked=i),n&&(n.visible=i)});let l=o.parent;for(;l;){l.checked=i;const e=document.getElementById(l.nodeId);i?l.numVisibleEntities+=a:l.numVisibleEntities-=a;const t=l.numVisibleEntities>0;t!==e.checked&&(e.checked=t),l=l.parent}this._muteSceneEvents=!1},this._hierarchy=o.hierarchy||"containment",this._autoExpandDepth=o.autoExpandDepth||0,this._createNodes())}_nodeToObjectID(e){return e.substring(this._baseId.length)}_objectToNodeID(e){return this._baseId+e}setAutoExpandDepth(e=0){this._autoExpandDepth=e}setHierarchy(e){this._hierarchy!==e&&(this._hierarchy=e,this._createNodes())}_createNodes(){switch(this._rootElement&&(this._rootElement.parentNode.removeChild(this._rootElement),this._rootElement=null),this._rootNodes=[],this._objectNodes={},this._pruneEmptyNodes&&this._findEmptyNodes(),this._hierarchy){case"storeys":this._createStoreysNodes(),0===this._rootNodes.length&&this._treeViewPlugin.error("Failed to build storeys hierarchy for model '"+this._metaModel.id+"' - perhaps this model is not an IFC model?");break;case"types":this._createTypesNodes();break;case"containment":default:this._createContainmentNodes()}this._sortNodes&&this._doSortNodes(),this._synchNodesToEntities(),this._createTrees(),this.expandToDepth(this._autoExpandDepth)}_findEmptyNodes(e=this._rootMetaObject,t=0){const i=this._treeViewPlugin.viewer.scene,r=e.children,n=e.id,o=i.objects[n];if(e._countEntities=0,o&&e._countEntities++,r)for(let t=0,i=r.length;t<i;t++){const i=r[t];i._countEntities=this._findEmptyNodes(i),e._countEntities+=i._countEntities}return e._countEntities}_createStoreysNodes(e=this._rootMetaObject,t,i,r){if(this._pruneEmptyNodes&&0===e._countEntities)return;const n=e.type,o=e.name,s=e.children,a=e.id;if("IfcBuilding"===n)t={nodeId:this._objectToNodeID(a),objectId:a,title:this._rootName||(o&&""!==o&&"Undefined"!==o&&"Default"!==o?o:n),type:n,parent:null,numEntities:0,numVisibleEntities:0,checked:!1,children:[]},this._rootNodes.push(t),this._objectNodes[t.objectId]=t;else if("IfcBuildingStorey"===n){if(!t)return void this._treeViewPlugin.error("Failed to build storeys hierarchy for model '"+this._metaModel.id+"' - model does not have an IfcBuilding object, or is not an IFC model");i={nodeId:this._objectToNodeID(a),objectId:a,title:o&&""!==o&&"Undefined"!==o&&"Default"!==o?o:n,type:n,parent:t,numEntities:0,numVisibleEntities:0,checked:!1,children:[]},t.children.push(i),this._objectNodes[i.objectId]=i,r={}}else if(i&&this._viewer.scene.objects[a]){let e=(r=r||{})[n];if(!e){const t=i.objectId+"."+n;e={nodeId:this._objectToNodeID(t),objectId:t,title:n,type:n,parent:i,numEntities:0,numVisibleEntities:0,checked:!1,children:[]},i.children.push(e),this._objectNodes[t]=e,r[n]=e}const t={nodeId:this._objectToNodeID(a),objectId:a,title:o&&""!==o&&"Undefined"!==o&&"Default"!==o?o:n,type:n,parent:e,numEntities:0,numVisibleEntities:0,checked:!1,children:[]};e.children.push(t),this._objectNodes[t.objectId]=t}if(s)for(let e=0,n=s.length;e<n;e++){const n=s[e];this._createStoreysNodes(n,t,i,r)}}_createTypesNodes(e=this._rootMetaObject,t,i){if(this._pruneEmptyNodes&&0===e._countEntities)return;const r=e.type,n=e.name,o=e.children,s=e.id;if(e.id===this._rootMetaObject.id)t={nodeId:this._objectToNodeID(s),objectId:s,title:this._rootName||(n&&""!==n&&"Undefined"!==n&&"Default"!==n?n:r),type:r,parent:null,numEntities:0,numVisibleEntities:0,checked:!1,children:[]},this._rootNodes.push(t),this._objectNodes[t.objectId]=t,i={};else if(t&&this._viewer.scene.objects[s]){let e=i[r];e||(e={nodeId:this._objectToNodeID(t.objectId+"."+r),objectId:t.objectId+"."+r,title:r,type:r,parent:t,numEntities:0,numVisibleEntities:0,checked:!1,children:[]},t.children.push(e),this._objectNodes[e.objectId]=e,i[r]=e);const o={nodeId:this._objectToNodeID(s),objectId:s,title:n&&""!==n&&"Default"!==n?n:r,type:r,parent:e,numEntities:0,numVisibleEntities:0,checked:!1,children:[]};e.children.push(o),this._objectNodes[o.objectId]=o}if(o)for(let e=0,r=o.length;e<r;e++){const r=o[e];this._createTypesNodes(r,t,i)}}_createContainmentNodes(e=this._rootMetaObject,t){if(this._pruneEmptyNodes&&0===e._countEntities)return;const i=e.type,r=e.name||i,n=e.children,o=e.id,s={nodeId:this._objectToNodeID(o),objectId:o,title:t?r&&""!==r&&"Undefined"!==r&&"Default"!==r?r:i:this._rootName||r,type:i,parent:t,numEntities:0,numVisibleEntities:0,checked:!1,children:[]};if(t?t.children.push(s):this._rootNodes.push(s),this._objectNodes[s.objectId]=s,n)for(let e=0,t=n.length;e<t;e++){const t=n[e];this._createContainmentNodes(t,s)}}_doSortNodes(){for(let e=0,t=this._rootNodes.length;e<t;e++){const t=this._rootNodes[e];this._sortChildren(t)}}_sortChildren(e){const t=e.children;if(t&&0!==t.length){"storeys"===this._hierarchy&&"IfcBuilding"===e.type?t.sort(this._getSpatialSortFunc()):t.sort(this._alphaSortFunc);for(let e=0,i=t.length;e<i;e++){const i=t[e];this._sortChildren(i)}}}_getSpatialSortFunc(){const e=this._treeViewPlugin.viewer,t=e.scene,i=t.camera,r=e.metaScene;return this._spatialSortFunc||(this._spatialSortFunc=(e,n)=>{e.aabb&&n.aabb||(e.aabb||(e.aabb=t.getAABB(r.getObjectIDsInSubtree(e.objectId))),n.aabb||(n.aabb=t.getAABB(r.getObjectIDsInSubtree(n.objectId))));let o=0;return o=i.xUp?0:i.yUp?1:2,e.aabb[o]>n.aabb[o]?-1:e.aabb[o]<n.aabb[o]?1:0})}_alphaSortFunc(e,t){const i=e.title.toUpperCase(),r=t.title.toUpperCase();return i<r?-1:i>r?1:0}_synchNodesToEntities(){const e=this._rootMetaObject.getObjectIDsInSubtree(),t=this._viewer.metaScene.metaObjects,i=this._viewer.scene.objects;for(let r=0,n=e.length;r<n;r++){const n=e[r];if(t[n]){const e=this._objectNodes[n];if(e){const t=i[n];if(t){const i=t.visible;e.numEntities=1,i?(e.numVisibleEntities=1,e.checked=!0):(e.numVisibleEntities=0,e.checked=!1);let r=e.parent;for(;r;)r.numEntities++,i&&(r.numVisibleEntities++,r.checked=!0),r=r.parent}}}}}_withNodeTree(e,t){t(e);const i=e.children;if(i)for(let e=0,r=i.length;e<r;e++)this._withNodeTree(i[e],t)}_createTrees(){if(0===this._rootNodes.length)return;const e=this._rootNodes.map(e=>this._createNodeElement(e)),t=document.createElement("ul");e.forEach(e=>{t.appendChild(e)}),this._containerElement.appendChild(t),this._rootElement=t}_createNodeElement(e){const t=document.createElement("li"),i=e.nodeId;if(t.id="node-"+i,e.children.length>0){const e="switch-"+i,r=document.createElement("a");r.href="#",r.id=e,r.textContent="+",r.classList.add("plus"),r.addEventListener("click",this.switchExpandHandler),t.appendChild(r)}const r=document.createElement("input");r.id=i,r.type="checkbox",r.checked=e.checked,r.addEventListener("change",this._checkboxChangeHandler),t.appendChild(r);const n=document.createElement("label");return n.setAttribute("for",i),n.textContent=e.title,t.appendChild(n),n.oncontextmenu=t=>{this._treeViewPlugin.fire("contextmenu",{event:t,viewer:this._viewer,treeViewPlugin:this._treeViewPlugin,treeViewNode:e}),t.preventDefault()},t}expandToDepth(e){const t=(i,r)=>{if(r===e)return;const n="switch-"+i.nodeId,o=document.getElementById(n);if(o){this._expandSwitchElement(o);const e=i.children;for(var s=0,a=e.length;s<a;s++){const i=e[s];t(i,r+1)}}};for(let e=0,i=this._rootNodes.length;e<i;e++){const i=this._rootNodes[e];t(i,0)}}collapse(){for(let e=0,t=this._rootNodes.length;e<t;e++){const t=this._rootNodes[e].objectId;this._collapseNode(t)}}showNode(e){this._showListItemElementId&&this.unShowNode();const t=this._objectNodes[e];if(!t)return;const i=t.nodeId,r="switch-"+i,n=document.getElementById(r);if(n)return this._expandSwitchElement(n),void n.scrollIntoView();const o=[];o.unshift(t);let s=t.parent;for(;s;)o.unshift(s),s=s.parent;for(let e=0,t=o.length;e<t;e++){const t="switch-"+o[e].nodeId,i=document.getElementById(t);i&&this._expandSwitchElement(i)}const a="node-"+i,l=document.getElementById(a);l.scrollIntoView({block:"center"}),l.classList.add("highlighted-node"),this._showListItemElementId=a}unShowNode(){if(!this._showListItemElementId)return;const e=document.getElementById(this._showListItemElementId);e?(e.classList.remove("highlighted-node"),this._showListItemElementId=null):this._showListItemElementId=null}_expandSwitchElement(e){const t=e.parentElement;if(t.getElementsByTagName("li")[0])return;const i=t.id.replace("node-",""),r=this._nodeToObjectID(i),n=this._objectNodes[r].children.map(e=>this._createNodeElement(e)),o=document.createElement("ul");n.forEach(e=>{o.appendChild(e)}),t.appendChild(o),e.classList.remove("plus"),e.classList.add("minus"),e.textContent="-",e.removeEventListener("click",this.switchExpandHandler),e.addEventListener("click",this.switchCollapseHandler)}_collapseNode(e){const t="switch-"+this._objectToNodeID(e),i=document.getElementById(t);this._collapseSwitchElement(i)}_collapseSwitchElement(e){if(!e)return;const t=e.parentElement;if(!t)return;const i=t.querySelector("ul");i&&(t.removeChild(i),e.classList.remove("minus"),e.classList.add("plus"),e.textContent="+",e.removeEventListener("click",this.switchCollapseHandler),e.addEventListener("click",this.switchExpandHandler))}destroy(){this._rootElement&&!this._destroyed&&(this._rootElement.parentNode.removeChild(this._rootElement),this._viewer.scene.off(this._onObjectVisibility),this._destroyed=!0,r.removeItem(this._id))}}var o=i(34);class s extends o.a{constructor(e,t={}){if(super("TreeViewPlugin",e),t.containerElement){if(this._containerElement=t.containerElement,this._modelTreeViews={},this._modelTreeViews={},this._autoAddModels=!1!==t.autoAddModels,this._autoExpandDepth=t.autoExpandDepth||0,this._sortNodes=!1!==t.sortNodes,this._pruneEmptyNodes=!1!==t.pruneEmptyNodes,this._autoAddModels){const e=Object.keys(this.viewer.scene.models);for(let t=0,i=e.length;t<i;t++){const i=e[t];this.addModel(i)}this.viewer.scene.on("modelLoaded",e=>{this.viewer.metaScene.metaModels[e]&&this.addModel(e)})}this.hierarchy=t.hierarchy}else this.error("Config expected: containerElement")}set hierarchy(e){"containment"!==(e=e||"containment")&&"storeys"!==e&&"types"!==e&&(this.error("Unsupported value for `hierarchy' - defaulting to 'containment'"),e="containment"),this._hierarchy=e;for(let e in this._modelTreeViews)this._modelTreeViews.hasOwnProperty(e)&&this._modelTreeViews[e].setHierarchy(this._hierarchy)}get hierarchy(){return this._hierarchy}addModel(e,t={}){if(!this._containerElement)return;const i=this.viewer.scene.models[e];if(!i)throw"Model not found: "+e;const r=this.viewer.metaScene.metaModels[e];r?this._modelTreeViews[e]?this.warn("Model already added: "+e):(this._modelTreeViews[e]=new n(this.viewer,this,i,r,{containerElement:this._containerElement,autoExpandDepth:this._autoExpandDepth,hierarchy:this._hierarchy,sortNodes:this._sortNodes,pruneEmptyNodes:this._pruneEmptyNodes,rootName:t.rootName}),i.on("destroyed",()=>{this.removeModel(i.id)})):this.error("MetaModel not found: "+e)}removeModel(e){if(!this._containerElement)return;const t=this._modelTreeViews[e];t?(t.destroy(),delete this._modelTreeViews[e]):this.warn("Model not added: "+e)}collapse(){for(let e in this._modelTreeViews)this._modelTreeViews.hasOwnProperty(e)&&this._modelTreeViews[e].collapse()}showNode(e){this.unShowNode();const t=this.viewer.metaScene.metaObjects[e];if(!t)return void this.error("MetaObject not found: "+e);const i=t.metaModel.id,r=this._modelTreeViews[i];r?r.showNode(e):this.error("Object not in this TreeView: "+e)}unShowNode(){for(let e in this._modelTreeViews)this._modelTreeViews.hasOwnProperty(e)&&this._modelTreeViews[e].unShowNode()}expandToDepth(e){for(let t in this._modelTreeViews)if(this._modelTreeViews.hasOwnProperty(t)){const i=this._modelTreeViews[t];i.collapse(),i.expandToDepth(e)}}withNodeTree(e,t){t(e);const i=e.children;if(i)for(let e=0,r=i.length;e<r;e++)this.withNodeTree(i[e],t)}destroy(){if(this._containerElement){for(let e in this._modelTreeViews)this._modelTreeViews.hasOwnProperty(e)&&this._modelTreeViews[e].destroy();this._modelTreeViews={},super.destroy()}}}},function(e,t,i){"use strict";(function(e){
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var i="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,r=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(i&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}(),n=i&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),r))}};function o(e){return e&&"[object Function]"==={}.toString.call(e)}function s(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function a(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=s(e),i=t.overflow,r=t.overflowX,n=t.overflowY;return/(auto|scroll|overlay)/.test(i+n+r)?e:l(a(e))}function c(e){return e&&e.referenceNode?e.referenceNode:e}var u=i&&!(!window.MSInputMethodContext||!document.documentMode),h=i&&/MSIE 10/.test(navigator.userAgent);function d(e){return 11===e?u:10===e?h:u||h}function p(e){if(!e)return document.documentElement;for(var t=d(10)?document.body:null,i=e.offsetParent||null;i===t&&e.nextElementSibling;)i=(e=e.nextElementSibling).offsetParent;var r=i&&i.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(i.nodeName)&&"static"===s(i,"position")?p(i):i:e?e.ownerDocument.documentElement:document.documentElement}function f(e){return null!==e.parentNode?f(e.parentNode):e}function m(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=i?e:t,n=i?t:e,o=document.createRange();o.setStart(r,0),o.setEnd(n,0);var s=o.commonAncestorContainer;if(e!==s&&t!==s||r.contains(n))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||p(e.firstElementChild)===e)}(s)?s:p(s);var a=f(e);return a.host?m(a.host,t):m(e,f(t).host)}function g(e){var t="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",i=e.nodeName;if("BODY"===i||"HTML"===i){var r=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||r)[t]}return e[t]}function v(e,t){var i="x"===t?"Left":"Top",r="Left"===i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"])+parseFloat(e["border"+r+"Width"])}function b(e,t,i,r){return Math.max(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],d(10)?parseInt(i["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function _(e){var t=e.body,i=e.documentElement,r=d(10)&&getComputedStyle(i);return{height:b("Height",t,i,r),width:b("Width",t,i,r)}}var y=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},x=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),w=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function P(e){return M({},e,{right:e.left+e.width,bottom:e.top+e.height})}function E(e){var t={};try{if(d(10)){t=e.getBoundingClientRect();var i=g(e,"top"),r=g(e,"left");t.top+=i,t.left+=r,t.bottom+=i,t.right+=r}else t=e.getBoundingClientRect()}catch(e){}var n={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?_(e.ownerDocument):{},a=o.width||e.clientWidth||n.width,l=o.height||e.clientHeight||n.height,c=e.offsetWidth-a,u=e.offsetHeight-l;if(c||u){var h=s(e);c-=v(h,"x"),u-=v(h,"y"),n.width-=c,n.height-=u}return P(n)}function S(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=d(10),n="HTML"===t.nodeName,o=E(e),a=E(t),c=l(e),u=s(t),h=parseFloat(u.borderTopWidth),p=parseFloat(u.borderLeftWidth);i&&n&&(a.top=Math.max(a.top,0),a.left=Math.max(a.left,0));var f=P({top:o.top-a.top-h,left:o.left-a.left-p,width:o.width,height:o.height});if(f.marginTop=0,f.marginLeft=0,!r&&n){var m=parseFloat(u.marginTop),v=parseFloat(u.marginLeft);f.top-=h-m,f.bottom-=h-m,f.left-=p-v,f.right-=p-v,f.marginTop=m,f.marginLeft=v}return(r&&!i?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(f=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=g(t,"top"),n=g(t,"left"),o=i?-1:1;return e.top+=r*o,e.bottom+=r*o,e.left+=n*o,e.right+=n*o,e}(f,t)),f}function C(e){if(!e||!e.parentElement||d())return document.documentElement;for(var t=e.parentElement;t&&"none"===s(t,"transform");)t=t.parentElement;return t||document.documentElement}function k(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o={top:0,left:0},u=n?C(e):m(e,c(t));if("viewport"===r)o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,r=S(e,i),n=Math.max(i.clientWidth,window.innerWidth||0),o=Math.max(i.clientHeight,window.innerHeight||0),s=t?0:g(i),a=t?0:g(i,"left");return P({top:s-r.top+r.marginTop,left:a-r.left+r.marginLeft,width:n,height:o})}(u,n);else{var h=void 0;"scrollParent"===r?"BODY"===(h=l(a(t))).nodeName&&(h=e.ownerDocument.documentElement):h="window"===r?e.ownerDocument.documentElement:r;var d=S(h,u,n);if("HTML"!==h.nodeName||function e(t){var i=t.nodeName;if("BODY"===i||"HTML"===i)return!1;if("fixed"===s(t,"position"))return!0;var r=a(t);return!!r&&e(r)}(u))o=d;else{var p=_(e.ownerDocument),f=p.height,v=p.width;o.top+=d.top-d.marginTop,o.bottom=f+d.top,o.left+=d.left-d.marginLeft,o.right=v+d.left}}var b="number"==typeof(i=i||0);return o.left+=b?i:i.left||0,o.top+=b?i:i.top||0,o.right-=b?i:i.right||0,o.bottom-=b?i:i.bottom||0,o}function O(e,t,i,r,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=k(i,r,o,n),a={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(a).map((function(e){return M({key:e},a[e],{area:function(e){return e.width*e.height}(a[e])})})).sort((function(e,t){return t.area-e.area})),c=l.filter((function(e){var t=e.width,r=e.height;return t>=i.clientWidth&&r>=i.clientHeight})),u=c.length>0?c[0].key:l[0].key,h=e.split("-")[1];return u+(h?"-"+h:"")}function A(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return S(i,r?C(t):m(t,c(i)),r)}function T(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+i}}function D(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function R(e,t,i){i=i.split("-")[0];var r=T(e),n={width:r.width,height:r.height},o=-1!==["right","left"].indexOf(i),s=o?"top":"left",a=o?"left":"top",l=o?"height":"width",c=o?"width":"height";return n[s]=t[s]+t[l]/2-r[l]/2,n[a]=i===a?t[a]-r[c]:t[D(a)],n}function L(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function B(e,t,i){return(void 0===i?e:e.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var r=L(e,(function(e){return e[t]===i}));return e.indexOf(r)}(e,"name",i))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=e.function||e.fn;e.enabled&&o(i)&&(t.offsets.popper=P(t.offsets.popper),t.offsets.reference=P(t.offsets.reference),t=i(t,e))})),t}function I(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function N(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var n=t[r],o=n?""+n+i:e;if(void 0!==document.body.style[o])return o}return null}function j(e){var t=e.ownerDocument;return t?t.defaultView:window}function F(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(e,t){return j(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}(this.reference,this.state))}function z(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function V(e,t){Object.keys(t).forEach((function(i){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&z(t[i])&&(r="px"),e.style[i]=t[i]+r}))}var U=i&&/Firefox/i.test(navigator.userAgent);function W(e,t,i){var r=L(e,(function(e){return e.name===t})),n=!!r&&e.some((function(e){return e.name===i&&e.enabled&&e.order<r.order}));if(!n){var o="`"+t+"`",s="`"+i+"`";console.warn(s+" modifier is required by "+o+" modifier in order to work, be sure to include it before "+o+"!")}return n}var H=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],G=H.slice(3);function X(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=G.indexOf(e),r=G.slice(i+1).concat(G.slice(0,i));return t?r.reverse():r}var Y="flip",$="clockwise",q="counterclockwise";var K={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],r=t.split("-")[1];if(r){var n=e.offsets,o=n.reference,s=n.popper,a=-1!==["bottom","top"].indexOf(i),l=a?"left":"top",c=a?"width":"height",u={start:w({},l,o[l]),end:w({},l,o[l]+o[c]-s[c])};e.offsets.popper=M({},s,u[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i,r=t.offset,n=e.placement,o=e.offsets,s=o.popper,a=o.reference,l=n.split("-")[0];return i=z(+r)?[+r,0]:function(e,t,i,r){var n=[0,0],o=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),a=s.indexOf(L(s,(function(e){return-1!==e.search(/,|\s/)})));s[a]&&-1===s[a].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==a?[s.slice(0,a).concat([s[a].split(l)[0]]),[s[a].split(l)[1]].concat(s.slice(a+1))]:[s];return(c=c.map((function(e,r){var n=(1===r?!o:o)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,r){var n=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),o=+n[1],s=n[2];if(!o)return e;if(0===s.indexOf("%")){var a=void 0;switch(s){case"%p":a=i;break;case"%":case"%r":default:a=r}return P(a)[t]/100*o}return"vh"===s||"vw"===s?("vh"===s?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*o:o}(e,n,t,i)}))}))).forEach((function(e,t){e.forEach((function(i,r){z(i)&&(n[t]+=i*("-"===e[r-1]?-1:1))}))})),n}(r,s,a,l),"left"===l?(s.top+=i[0],s.left-=i[1]):"right"===l?(s.top+=i[0],s.left+=i[1]):"top"===l?(s.left+=i[0],s.top-=i[1]):"bottom"===l&&(s.left+=i[0],s.top+=i[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||p(e.instance.popper);e.instance.reference===i&&(i=p(i));var r=N("transform"),n=e.instance.popper.style,o=n.top,s=n.left,a=n[r];n.top="",n.left="",n[r]="";var l=k(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);n.top=o,n.left=s,n[r]=a,t.boundaries=l;var c=t.priority,u=e.offsets.popper,h={primary:function(e){var i=u[e];return u[e]<l[e]&&!t.escapeWithReference&&(i=Math.max(u[e],l[e])),w({},e,i)},secondary:function(e){var i="right"===e?"left":"top",r=u[i];return u[e]>l[e]&&!t.escapeWithReference&&(r=Math.min(u[i],l[e]-("right"===e?u.width:u.height))),w({},i,r)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=M({},u,h[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,r=t.reference,n=e.placement.split("-")[0],o=Math.floor,s=-1!==["top","bottom"].indexOf(n),a=s?"right":"bottom",l=s?"left":"top",c=s?"width":"height";return i[a]<o(r[l])&&(e.offsets.popper[l]=o(r[l])-i[c]),i[l]>o(r[a])&&(e.offsets.popper[l]=o(r[a])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var i;if(!W(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var n=e.placement.split("-")[0],o=e.offsets,a=o.popper,l=o.reference,c=-1!==["left","right"].indexOf(n),u=c?"height":"width",h=c?"Top":"Left",d=h.toLowerCase(),p=c?"left":"top",f=c?"bottom":"right",m=T(r)[u];l[f]-m<a[d]&&(e.offsets.popper[d]-=a[d]-(l[f]-m)),l[d]+m>a[f]&&(e.offsets.popper[d]+=l[d]+m-a[f]),e.offsets.popper=P(e.offsets.popper);var g=l[d]+l[u]/2-m/2,v=s(e.instance.popper),b=parseFloat(v["margin"+h]),_=parseFloat(v["border"+h+"Width"]),y=g-e.offsets.popper[d]-b-_;return y=Math.max(Math.min(a[u]-m,y),0),e.arrowElement=r,e.offsets.arrow=(w(i={},d,Math.round(y)),w(i,p,""),i),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(I(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=k(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],n=D(r),o=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case Y:s=[r,n];break;case $:s=X(r);break;case q:s=X(r,!0);break;default:s=t.behavior}return s.forEach((function(a,l){if(r!==a||s.length===l+1)return e;r=e.placement.split("-")[0],n=D(r);var c=e.offsets.popper,u=e.offsets.reference,h=Math.floor,d="left"===r&&h(c.right)>h(u.left)||"right"===r&&h(c.left)<h(u.right)||"top"===r&&h(c.bottom)>h(u.top)||"bottom"===r&&h(c.top)<h(u.bottom),p=h(c.left)<h(i.left),f=h(c.right)>h(i.right),m=h(c.top)<h(i.top),g=h(c.bottom)>h(i.bottom),v="left"===r&&p||"right"===r&&f||"top"===r&&m||"bottom"===r&&g,b=-1!==["top","bottom"].indexOf(r),_=!!t.flipVariations&&(b&&"start"===o&&p||b&&"end"===o&&f||!b&&"start"===o&&m||!b&&"end"===o&&g),y=!!t.flipVariationsByContent&&(b&&"start"===o&&f||b&&"end"===o&&p||!b&&"start"===o&&g||!b&&"end"===o&&m),x=_||y;(d||v||x)&&(e.flipped=!0,(d||v)&&(r=s[l+1]),x&&(o=function(e){return"end"===e?"start":"start"===e?"end":e}(o)),e.placement=r+(o?"-"+o:""),e.offsets.popper=M({},e.offsets.popper,R(e.instance.popper,e.offsets.reference,e.placement)),e=B(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],r=e.offsets,n=r.popper,o=r.reference,s=-1!==["left","right"].indexOf(i),a=-1===["top","left"].indexOf(i);return n[s?"left":"top"]=o[i]-(a?n[s?"width":"height"]:0),e.placement=D(t),e.offsets.popper=P(n),e}},hide:{order:800,enabled:!0,fn:function(e){if(!W(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=L(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,r=t.y,n=e.offsets.popper,o=L(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==o&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s,a,l=void 0!==o?o:t.gpuAcceleration,c=p(e.instance.popper),u=E(c),h={position:n.position},d=function(e,t){var i=e.offsets,r=i.popper,n=i.reference,o=Math.round,s=Math.floor,a=function(e){return e},l=o(n.width),c=o(r.width),u=-1!==["left","right"].indexOf(e.placement),h=-1!==e.placement.indexOf("-"),d=t?u||h||l%2==c%2?o:s:a,p=t?o:a;return{left:d(l%2==1&&c%2==1&&!h&&t?r.left-1:r.left),top:p(r.top),bottom:p(r.bottom),right:d(r.right)}}(e,window.devicePixelRatio<2||!U),f="bottom"===i?"top":"bottom",m="right"===r?"left":"right",g=N("transform");if(a="bottom"===f?"HTML"===c.nodeName?-c.clientHeight+d.bottom:-u.height+d.bottom:d.top,s="right"===m?"HTML"===c.nodeName?-c.clientWidth+d.right:-u.width+d.right:d.left,l&&g)h[g]="translate3d("+s+"px, "+a+"px, 0)",h[f]=0,h[m]=0,h.willChange="transform";else{var v="bottom"===f?-1:1,b="right"===m?-1:1;h[f]=a*v,h[m]=s*b,h.willChange=f+", "+m}var _={"x-placement":e.placement};return e.attributes=M({},_,e.attributes),e.styles=M({},h,e.styles),e.arrowStyles=M({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return V(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach((function(i){!1!==t[i]?e.setAttribute(i,t[i]):e.removeAttribute(i)}))}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&V(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,r,n){var o=A(n,t,e,i.positionFixed),s=O(i.placement,o,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",s),V(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},Z=function(){function e(t,i){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=n(this.update.bind(this)),this.options=M({},e.Defaults,s),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=i&&i.jquery?i[0]:i,this.options.modifiers={},Object.keys(M({},e.Defaults.modifiers,s.modifiers)).forEach((function(t){r.options.modifiers[t]=M({},e.Defaults.modifiers[t]||{},s.modifiers?s.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return M({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&o(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return x(e,[{key:"update",value:function(){return function(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=A(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=O(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=R(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=B(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,I(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[N("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=function(e,t,i,r){i.updateBound=r,j(e).addEventListener("resize",i.updateBound,{passive:!0});var n=l(e);return function e(t,i,r,n){var o="BODY"===t.nodeName,s=o?t.ownerDocument.defaultView:t;s.addEventListener(i,r,{passive:!0}),o||e(l(s.parentNode),i,r,n),n.push(s)}(n,"scroll",i.updateBound,i.scrollParents),i.scrollElement=n,i.eventsEnabled=!0,i}(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return F.call(this)}}]),e}();Z.Utils=("undefined"!=typeof window?window:e).PopperUtils,Z.placements=H,Z.Defaults=K,t.a=Z}).call(this,i(207))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(){this.entity=null,this.primitive=null,this.primIndex=-1,this._canvasPos=new Int16Array([0,0]),this._origin=new Float64Array([0,0,0]),this._direction=new Float64Array([0,0,0]),this._indices=new Int32Array(3),this._localPos=new Float64Array([0,0,0]),this._worldPos=new Float64Array([0,0,0]),this._viewPos=new Float64Array([0,0,0]),this._bary=new Float64Array([0,0,0]),this._worldNormal=new Float64Array([0,0,0]),this._uv=new Float64Array([0,0]),this.reset()}get canvasPos(){return this._gotCanvasPos?this._canvasPos:null}set canvasPos(e){e?(this._canvasPos[0]=e[0],this._canvasPos[1]=e[1],this._gotCanvasPos=!0):this._gotCanvasPos=!1}get origin(){return this._gotOrigin?this._origin:null}set origin(e){e?(this._origin[0]=e[0],this._origin[1]=e[1],this._origin[2]=e[2],this._gotOrigin=!0):this._gotOrigin=!1}get direction(){return this._gotDirection?this._direction:null}set direction(e){e?(this._direction[0]=e[0],this._direction[1]=e[1],this._direction[2]=e[2],this._gotDirection=!0):this._gotDirection=!1}get indices(){return this.entity&&this._gotIndices?this._indices:null}set indices(e){e?(this._indices[0]=e[0],this._indices[1]=e[1],this._indices[2]=e[2],this._gotIndices=!0):this._gotIndices=!1}get localPos(){return this.entity&&this._gotLocalPos?this._localPos:null}set localPos(e){e?(this._localPos[0]=e[0],this._localPos[1]=e[1],this._localPos[2]=e[2],this._gotLocalPos=!0):this._gotLocalPos=!1}get worldPos(){return this.entity&&this._gotWorldPos?this._worldPos:null}set worldPos(e){e?(this._worldPos[0]=e[0],this._worldPos[1]=e[1],this._worldPos[2]=e[2],this._gotWorldPos=!0):this._gotWorldPos=!1}get viewPos(){return this.entity&&this._gotViewPos?this._viewPos:null}set viewPos(e){e?(this._viewPos[0]=e[0],this._viewPos[1]=e[1],this._viewPos[2]=e[2],this._gotViewPos=!0):this._gotViewPos=!1}get bary(){return this.entity&&this._gotBary?this._bary:null}set bary(e){e?(this._bary[0]=e[0],this._bary[1]=e[1],this._bary[2]=e[2],this._gotBary=!0):this._gotBary=!1}get worldNormal(){return this.entity&&this._gotWorldNormal?this._worldNormal:null}set worldNormal(e){e?(this._worldNormal[0]=e[0],this._worldNormal[1]=e[1],this._worldNormal[2]=e[2],this._gotWorldNormal=!0):this._gotWorldNormal=!1}get uv(){return this.entity&&this._gotUV?this._uv:null}set uv(e){e?(this._uv[0]=e[0],this._uv[1]=e[1],this._gotUV=!0):this._gotUV=!1}reset(){this.entity=null,this.primIndex=-1,this.primitive=null,this._gotCanvasPos=!1,this._gotOrigin=!1,this._gotDirection=!1,this._gotIndices=!1,this._gotLocalPos=!1,this._gotWorldPos=!1,this._gotViewPos=!1,this._gotBary=!1,this._gotWorldNormal=!1,this._gotUV=!1}}},function(e,t,i){"use strict";i.r(t),i.d(t,"AmbientLight",(function(){return o}));var r=i(0),n=i(94);class o extends n.a{get type(){return"AmbientLight"}constructor(e,t={}){super(e,t),this._state={type:"ambient",color:r.math.vec3([.7,.7,.7]),intensity:1},this.color=t.color,this.intensity=t.intensity,this.scene._lightCreated(this)}set color(e){this._state.color.set(e||[.7,.7,.8]),this.glRedraw()}get color(){return this._state.color}set intensity(e){this._state.intensity=void 0!==e?e:1,this.glRedraw()}get intensity(){return this._state.intensity}destroy(){super.destroy(),this.scene._lightDestroyed(this)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in i=Object(arguments[l]))n.call(i,c)&&(a[c]=i[c]);if(r){s=r(i);for(var u=0;u<s.length;u++)o.call(i,s[u])&&(a[s[u]]=i[s[u]])}}return a}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";(function(e){
/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1-lts
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
var i="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,r=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(i&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}(),n=i&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),r))}};function o(e){return e&&"[object Function]"==={}.toString.call(e)}function s(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function a(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function l(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=s(e),i=t.overflow,r=t.overflowX,n=t.overflowY;return/(auto|scroll|overlay)/.test(i+n+r)?e:l(a(e))}function c(e){return e&&e.referenceNode?e.referenceNode:e}var u=i&&!(!window.MSInputMethodContext||!document.documentMode),h=i&&/MSIE 10/.test(navigator.userAgent);function d(e){return 11===e?u:10===e?h:u||h}function p(e){if(!e)return document.documentElement;for(var t=d(10)?document.body:null,i=e.offsetParent||null;i===t&&e.nextElementSibling;)i=(e=e.nextElementSibling).offsetParent;var r=i&&i.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(i.nodeName)&&"static"===s(i,"position")?p(i):i:e?e.ownerDocument.documentElement:document.documentElement}function f(e){return null!==e.parentNode?f(e.parentNode):e}function m(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=i?e:t,n=i?t:e,o=document.createRange();o.setStart(r,0),o.setEnd(n,0);var s=o.commonAncestorContainer;if(e!==s&&t!==s||r.contains(n))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||p(e.firstElementChild)===e)}(s)?s:p(s);var a=f(e);return a.host?m(a.host,t):m(e,f(t).host)}function g(e){var t="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",i=e.nodeName;if("BODY"===i||"HTML"===i){var r=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||r)[t]}return e[t]}function v(e,t){var i="x"===t?"Left":"Top",r="Left"===i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"])+parseFloat(e["border"+r+"Width"])}function b(e,t,i,r){return Math.max(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],d(10)?parseInt(i["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function _(e){var t=e.body,i=e.documentElement,r=d(10)&&getComputedStyle(i);return{height:b("Height",t,i,r),width:b("Width",t,i,r)}}var y=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},x=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),w=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function P(e){return M({},e,{right:e.left+e.width,bottom:e.top+e.height})}function E(e){var t={};try{if(d(10)){t=e.getBoundingClientRect();var i=g(e,"top"),r=g(e,"left");t.top+=i,t.left+=r,t.bottom+=i,t.right+=r}else t=e.getBoundingClientRect()}catch(e){}var n={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},o="HTML"===e.nodeName?_(e.ownerDocument):{},a=o.width||e.clientWidth||n.width,l=o.height||e.clientHeight||n.height,c=e.offsetWidth-a,u=e.offsetHeight-l;if(c||u){var h=s(e);c-=v(h,"x"),u-=v(h,"y"),n.width-=c,n.height-=u}return P(n)}function S(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=d(10),n="HTML"===t.nodeName,o=E(e),a=E(t),c=l(e),u=s(t),h=parseFloat(u.borderTopWidth),p=parseFloat(u.borderLeftWidth);i&&n&&(a.top=Math.max(a.top,0),a.left=Math.max(a.left,0));var f=P({top:o.top-a.top-h,left:o.left-a.left-p,width:o.width,height:o.height});if(f.marginTop=0,f.marginLeft=0,!r&&n){var m=parseFloat(u.marginTop),v=parseFloat(u.marginLeft);f.top-=h-m,f.bottom-=h-m,f.left-=p-v,f.right-=p-v,f.marginTop=m,f.marginLeft=v}return(r&&!i?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(f=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=g(t,"top"),n=g(t,"left"),o=i?-1:1;return e.top+=r*o,e.bottom+=r*o,e.left+=n*o,e.right+=n*o,e}(f,t)),f}function C(e){if(!e||!e.parentElement||d())return document.documentElement;for(var t=e.parentElement;t&&"none"===s(t,"transform");)t=t.parentElement;return t||document.documentElement}function k(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o={top:0,left:0},u=n?C(e):m(e,c(t));if("viewport"===r)o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,r=S(e,i),n=Math.max(i.clientWidth,window.innerWidth||0),o=Math.max(i.clientHeight,window.innerHeight||0),s=t?0:g(i),a=t?0:g(i,"left");return P({top:s-r.top+r.marginTop,left:a-r.left+r.marginLeft,width:n,height:o})}(u,n);else{var h=void 0;"scrollParent"===r?"BODY"===(h=l(a(t))).nodeName&&(h=e.ownerDocument.documentElement):h="window"===r?e.ownerDocument.documentElement:r;var d=S(h,u,n);if("HTML"!==h.nodeName||function e(t){var i=t.nodeName;if("BODY"===i||"HTML"===i)return!1;if("fixed"===s(t,"position"))return!0;var r=a(t);return!!r&&e(r)}(u))o=d;else{var p=_(e.ownerDocument),f=p.height,v=p.width;o.top+=d.top-d.marginTop,o.bottom=f+d.top,o.left+=d.left-d.marginLeft,o.right=v+d.left}}var b="number"==typeof(i=i||0);return o.left+=b?i:i.left||0,o.top+=b?i:i.top||0,o.right-=b?i:i.right||0,o.bottom-=b?i:i.bottom||0,o}function O(e,t,i,r,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=k(i,r,o,n),a={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(a).map((function(e){return M({key:e},a[e],{area:function(e){return e.width*e.height}(a[e])})})).sort((function(e,t){return t.area-e.area})),c=l.filter((function(e){var t=e.width,r=e.height;return t>=i.clientWidth&&r>=i.clientHeight})),u=c.length>0?c[0].key:l[0].key,h=e.split("-")[1];return u+(h?"-"+h:"")}function A(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return S(i,r?C(t):m(t,c(i)),r)}function T(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+i}}function D(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function R(e,t,i){i=i.split("-")[0];var r=T(e),n={width:r.width,height:r.height},o=-1!==["right","left"].indexOf(i),s=o?"top":"left",a=o?"left":"top",l=o?"height":"width",c=o?"width":"height";return n[s]=t[s]+t[l]/2-r[l]/2,n[a]=i===a?t[a]-r[c]:t[D(a)],n}function L(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function B(e,t,i){return(void 0===i?e:e.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var r=L(e,(function(e){return e[t]===i}));return e.indexOf(r)}(e,"name",i))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var i=e.function||e.fn;e.enabled&&o(i)&&(t.offsets.popper=P(t.offsets.popper),t.offsets.reference=P(t.offsets.reference),t=i(t,e))})),t}function I(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function N(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var n=t[r],o=n?""+n+i:e;if(void 0!==document.body.style[o])return o}return null}function j(e){var t=e.ownerDocument;return t?t.defaultView:window}function F(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(e,t){return j(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}(this.reference,this.state))}function z(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function V(e,t){Object.keys(t).forEach((function(i){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&z(t[i])&&(r="px"),e.style[i]=t[i]+r}))}var U=i&&/Firefox/i.test(navigator.userAgent);function W(e,t,i){var r=L(e,(function(e){return e.name===t})),n=!!r&&e.some((function(e){return e.name===i&&e.enabled&&e.order<r.order}));if(!n){var o="`"+t+"`",s="`"+i+"`";console.warn(s+" modifier is required by "+o+" modifier in order to work, be sure to include it before "+o+"!")}return n}var H=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],G=H.slice(3);function X(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=G.indexOf(e),r=G.slice(i+1).concat(G.slice(0,i));return t?r.reverse():r}var Y="flip",$="clockwise",q="counterclockwise";var K={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],r=t.split("-")[1];if(r){var n=e.offsets,o=n.reference,s=n.popper,a=-1!==["bottom","top"].indexOf(i),l=a?"left":"top",c=a?"width":"height",u={start:w({},l,o[l]),end:w({},l,o[l]+o[c]-s[c])};e.offsets.popper=M({},s,u[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i,r=t.offset,n=e.placement,o=e.offsets,s=o.popper,a=o.reference,l=n.split("-")[0];return i=z(+r)?[+r,0]:function(e,t,i,r){var n=[0,0],o=-1!==["right","left"].indexOf(r),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),a=s.indexOf(L(s,(function(e){return-1!==e.search(/,|\s/)})));s[a]&&-1===s[a].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==a?[s.slice(0,a).concat([s[a].split(l)[0]]),[s[a].split(l)[1]].concat(s.slice(a+1))]:[s];return(c=c.map((function(e,r){var n=(1===r?!o:o)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,r){var n=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),o=+n[1],s=n[2];if(!o)return e;if(0===s.indexOf("%")){var a=void 0;switch(s){case"%p":a=i;break;case"%":case"%r":default:a=r}return P(a)[t]/100*o}return"vh"===s||"vw"===s?("vh"===s?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*o:o}(e,n,t,i)}))}))).forEach((function(e,t){e.forEach((function(i,r){z(i)&&(n[t]+=i*("-"===e[r-1]?-1:1))}))})),n}(r,s,a,l),"left"===l?(s.top+=i[0],s.left-=i[1]):"right"===l?(s.top+=i[0],s.left+=i[1]):"top"===l?(s.left+=i[0],s.top-=i[1]):"bottom"===l&&(s.left+=i[0],s.top+=i[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||p(e.instance.popper);e.instance.reference===i&&(i=p(i));var r=N("transform"),n=e.instance.popper.style,o=n.top,s=n.left,a=n[r];n.top="",n.left="",n[r]="";var l=k(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);n.top=o,n.left=s,n[r]=a,t.boundaries=l;var c=t.priority,u=e.offsets.popper,h={primary:function(e){var i=u[e];return u[e]<l[e]&&!t.escapeWithReference&&(i=Math.max(u[e],l[e])),w({},e,i)},secondary:function(e){var i="right"===e?"left":"top",r=u[i];return u[e]>l[e]&&!t.escapeWithReference&&(r=Math.min(u[i],l[e]-("right"===e?u.width:u.height))),w({},i,r)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=M({},u,h[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,r=t.reference,n=e.placement.split("-")[0],o=Math.floor,s=-1!==["top","bottom"].indexOf(n),a=s?"right":"bottom",l=s?"left":"top",c=s?"width":"height";return i[a]<o(r[l])&&(e.offsets.popper[l]=o(r[l])-i[c]),i[l]>o(r[a])&&(e.offsets.popper[l]=o(r[a])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var i;if(!W(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var n=e.placement.split("-")[0],o=e.offsets,a=o.popper,l=o.reference,c=-1!==["left","right"].indexOf(n),u=c?"height":"width",h=c?"Top":"Left",d=h.toLowerCase(),p=c?"left":"top",f=c?"bottom":"right",m=T(r)[u];l[f]-m<a[d]&&(e.offsets.popper[d]-=a[d]-(l[f]-m)),l[d]+m>a[f]&&(e.offsets.popper[d]+=l[d]+m-a[f]),e.offsets.popper=P(e.offsets.popper);var g=l[d]+l[u]/2-m/2,v=s(e.instance.popper),b=parseFloat(v["margin"+h]),_=parseFloat(v["border"+h+"Width"]),y=g-e.offsets.popper[d]-b-_;return y=Math.max(Math.min(a[u]-m,y),0),e.arrowElement=r,e.offsets.arrow=(w(i={},d,Math.round(y)),w(i,p,""),i),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(I(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=k(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],n=D(r),o=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case Y:s=[r,n];break;case $:s=X(r);break;case q:s=X(r,!0);break;default:s=t.behavior}return s.forEach((function(a,l){if(r!==a||s.length===l+1)return e;r=e.placement.split("-")[0],n=D(r);var c=e.offsets.popper,u=e.offsets.reference,h=Math.floor,d="left"===r&&h(c.right)>h(u.left)||"right"===r&&h(c.left)<h(u.right)||"top"===r&&h(c.bottom)>h(u.top)||"bottom"===r&&h(c.top)<h(u.bottom),p=h(c.left)<h(i.left),f=h(c.right)>h(i.right),m=h(c.top)<h(i.top),g=h(c.bottom)>h(i.bottom),v="left"===r&&p||"right"===r&&f||"top"===r&&m||"bottom"===r&&g,b=-1!==["top","bottom"].indexOf(r),_=!!t.flipVariations&&(b&&"start"===o&&p||b&&"end"===o&&f||!b&&"start"===o&&m||!b&&"end"===o&&g),y=!!t.flipVariationsByContent&&(b&&"start"===o&&f||b&&"end"===o&&p||!b&&"start"===o&&g||!b&&"end"===o&&m),x=_||y;(d||v||x)&&(e.flipped=!0,(d||v)&&(r=s[l+1]),x&&(o=function(e){return"end"===e?"start":"start"===e?"end":e}(o)),e.placement=r+(o?"-"+o:""),e.offsets.popper=M({},e.offsets.popper,R(e.instance.popper,e.offsets.reference,e.placement)),e=B(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],r=e.offsets,n=r.popper,o=r.reference,s=-1!==["left","right"].indexOf(i),a=-1===["top","left"].indexOf(i);return n[s?"left":"top"]=o[i]-(a?n[s?"width":"height"]:0),e.placement=D(t),e.offsets.popper=P(n),e}},hide:{order:800,enabled:!0,fn:function(e){if(!W(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=L(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,r=t.y,n=e.offsets.popper,o=L(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==o&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s,a,l=void 0!==o?o:t.gpuAcceleration,c=p(e.instance.popper),u=E(c),h={position:n.position},d=function(e,t){var i=e.offsets,r=i.popper,n=i.reference,o=Math.round,s=Math.floor,a=function(e){return e},l=o(n.width),c=o(r.width),u=-1!==["left","right"].indexOf(e.placement),h=-1!==e.placement.indexOf("-"),d=t?u||h||l%2==c%2?o:s:a,p=t?o:a;return{left:d(l%2==1&&c%2==1&&!h&&t?r.left-1:r.left),top:p(r.top),bottom:p(r.bottom),right:d(r.right)}}(e,window.devicePixelRatio<2||!U),f="bottom"===i?"top":"bottom",m="right"===r?"left":"right",g=N("transform");if(a="bottom"===f?"HTML"===c.nodeName?-c.clientHeight+d.bottom:-u.height+d.bottom:d.top,s="right"===m?"HTML"===c.nodeName?-c.clientWidth+d.right:-u.width+d.right:d.left,l&&g)h[g]="translate3d("+s+"px, "+a+"px, 0)",h[f]=0,h[m]=0,h.willChange="transform";else{var v="bottom"===f?-1:1,b="right"===m?-1:1;h[f]=a*v,h[m]=s*b,h.willChange=f+", "+m}var _={"x-placement":e.placement};return e.attributes=M({},_,e.attributes),e.styles=M({},h,e.styles),e.arrowStyles=M({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return V(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach((function(i){!1!==t[i]?e.setAttribute(i,t[i]):e.removeAttribute(i)}))}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&V(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,r,n){var o=A(n,t,e,i.positionFixed),s=O(i.placement,o,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",s),V(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},Z=function(){function e(t,i){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=n(this.update.bind(this)),this.options=M({},e.Defaults,s),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=i&&i.jquery?i[0]:i,this.options.modifiers={},Object.keys(M({},e.Defaults.modifiers,s.modifiers)).forEach((function(t){r.options.modifiers[t]=M({},e.Defaults.modifiers[t]||{},s.modifiers?s.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return M({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&o(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return x(e,[{key:"update",value:function(){return function(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=A(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=O(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=R(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=B(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,I(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[N("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=function(e,t,i,r){i.updateBound=r,j(e).addEventListener("resize",i.updateBound,{passive:!0});var n=l(e);return function e(t,i,r,n){var o="BODY"===t.nodeName,s=o?t.ownerDocument.defaultView:t;s.addEventListener(i,r,{passive:!0}),o||e(l(s.parentNode),i,r,n),n.push(s)}(n,"scroll",i.updateBound,i.scrollParents),i.scrollElement=n,i.eventsEnabled=!0,i}(this.reference,this.options,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return F.call(this)}}]),e}();Z.Utils=("undefined"!=typeof window?window:e).PopperUtils,Z.placements=H,Z.Defaults=K,t.a=Z}).call(this,i(207))},function(e,t,i){"use strict";i.d(t,"a",(function(){return Te}));var r=i(27),n=Date.now(),o="fnValues"+n,s="fnStyle"+ ++n,a=i(2),l="@global",c="@global ",u=function(){function e(e,t,i){for(var n in this.type="global",this.at=l,this.rules=void 0,this.options=void 0,this.key=void 0,this.isProcessed=!1,this.key=e,this.options=i,this.rules=new r.a(Object(a.a)({},i,{parent:this})),t)this.rules.add(n,t[n]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.addRule=function(e,t,i){var r=this.rules.add(e,t,i);return r&&this.options.jss.plugins.onProcessRule(r),r},t.indexOf=function(e){return this.rules.indexOf(e)},t.toString=function(){return this.rules.toString()},e}(),h=function(){function e(e,t,i){this.type="global",this.at=l,this.options=void 0,this.rule=void 0,this.isProcessed=!1,this.key=void 0,this.key=e,this.options=i;var r=e.substr(c.length);this.rule=i.jss.createRule(r,t,Object(a.a)({},i,{parent:this}))}return e.prototype.toString=function(e){return this.rule?this.rule.toString(e):""},e}(),d=/\s*,\s*/g;function p(e,t){for(var i=e.split(d),r="",n=0;n<i.length;n++)r+=t+" "+i[n].trim(),i[n+1]&&(r+=", ");return r}var f=/\s*,\s*/g,m=/&/g,g=/\$([\w-]+)/g,v=function(){function e(e,t){return function(i,r){var n=e.getRule(r)||t&&t.getRule(r);return n?(n=n).selector:r}}function t(e,t){for(var i=t.split(f),r=e.split(f),n="",o=0;o<i.length;o++)for(var s=i[o],a=0;a<r.length;a++){var l=r[a];n&&(n+=", "),n+=-1!==l.indexOf("&")?l.replace(m,s):s+" "+l}return n}function i(e,t,i){if(i)return Object(a.a)({},i,{index:i.index+1});var r=e.options.nestingLevel;r=void 0===r?1:r+1;var n=Object(a.a)({},e.options,{nestingLevel:r,index:t.indexOf(e)+1});return delete n.name,n}return{onProcessStyle:function(r,n,o){if("style"!==n.type)return r;var s,l,c=n,u=c.options.parent;for(var h in r){var d=-1!==h.indexOf("&"),p="@"===h[0];if(d||p){if(s=i(c,u,s),d){var f=t(h,c.selector);l||(l=e(u,o)),f=f.replace(g,l),u.addRule(f,r[h],Object(a.a)({},s,{selector:f}))}else p&&u.addRule(h,{},s).addRule(c.key,r[h],{selector:c.selector});delete r[h]}}return r}}},b=/[A-Z]/g,_=/^ms-/,y={};function x(e){return"-"+e.toLowerCase()}var w=function(e){if(y.hasOwnProperty(e))return y[e];var t=e.replace(b,x);return y[e]=_.test(t)?"-"+t:t};function M(e){var t={};for(var i in e)t[0===i.indexOf("--")?i:w(i)]=e[i];return e.fallbacks&&(Array.isArray(e.fallbacks)?t.fallbacks=e.fallbacks.map(M):t.fallbacks=M(e.fallbacks)),t}var P=r.f&&CSS?CSS.px:"px",E=r.f&&CSS?CSS.ms:"ms",S=r.f&&CSS?CSS.percent:"%";function C(e){var t=/(-[a-z])/g,i=function(e){return e[1].toUpperCase()},r={};for(var n in e)r[n]=e[n],r[n.replace(t,i)]=e[n];return r}var k=C({"animation-delay":E,"animation-duration":E,"background-position":P,"background-position-x":P,"background-position-y":P,"background-size":P,border:P,"border-bottom":P,"border-bottom-left-radius":P,"border-bottom-right-radius":P,"border-bottom-width":P,"border-left":P,"border-left-width":P,"border-radius":P,"border-right":P,"border-right-width":P,"border-top":P,"border-top-left-radius":P,"border-top-right-radius":P,"border-top-width":P,"border-width":P,"border-block":P,"border-block-end":P,"border-block-end-width":P,"border-block-start":P,"border-block-start-width":P,"border-block-width":P,"border-inline":P,"border-inline-end":P,"border-inline-end-width":P,"border-inline-start":P,"border-inline-start-width":P,"border-inline-width":P,"border-start-start-radius":P,"border-start-end-radius":P,"border-end-start-radius":P,"border-end-end-radius":P,margin:P,"margin-bottom":P,"margin-left":P,"margin-right":P,"margin-top":P,"margin-block":P,"margin-block-end":P,"margin-block-start":P,"margin-inline":P,"margin-inline-end":P,"margin-inline-start":P,padding:P,"padding-bottom":P,"padding-left":P,"padding-right":P,"padding-top":P,"padding-block":P,"padding-block-end":P,"padding-block-start":P,"padding-inline":P,"padding-inline-end":P,"padding-inline-start":P,"mask-position-x":P,"mask-position-y":P,"mask-size":P,height:P,width:P,"min-height":P,"max-height":P,"min-width":P,"max-width":P,bottom:P,left:P,top:P,right:P,inset:P,"inset-block":P,"inset-block-end":P,"inset-block-start":P,"inset-inline":P,"inset-inline-end":P,"inset-inline-start":P,"box-shadow":P,"text-shadow":P,"column-gap":P,"column-rule":P,"column-rule-width":P,"column-width":P,"font-size":P,"font-size-delta":P,"letter-spacing":P,"text-decoration-thickness":P,"text-indent":P,"text-stroke":P,"text-stroke-width":P,"word-spacing":P,motion:P,"motion-offset":P,outline:P,"outline-offset":P,"outline-width":P,perspective:P,"perspective-origin-x":S,"perspective-origin-y":S,"transform-origin":S,"transform-origin-x":S,"transform-origin-y":S,"transform-origin-z":S,"transition-delay":E,"transition-duration":E,"vertical-align":P,"flex-basis":P,"shape-margin":P,size:P,gap:P,grid:P,"grid-gap":P,"row-gap":P,"grid-row-gap":P,"grid-column-gap":P,"grid-template-rows":P,"grid-template-columns":P,"grid-auto-rows":P,"grid-auto-columns":P,"box-shadow-x":P,"box-shadow-y":P,"box-shadow-blur":P,"box-shadow-spread":P,"font-line-height":P,"text-shadow-x":P,"text-shadow-y":P,"text-shadow-blur":P});function O(e,t,i){if(null==t)return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]=O(e,t[r],i);else if("object"==typeof t)if("fallbacks"===e)for(var n in t)t[n]=O(n,t[n],i);else for(var o in t)t[o]=O(e+"-"+o,t[o],i);else if("number"==typeof t&&!Number.isNaN(t)){var s=i[e]||k[e];return!s||0===t&&s===P?t.toString():"function"==typeof s?s(t).toString():""+t+s}return t}var A=function(e){void 0===e&&(e={});var t=C(e);return{onProcessStyle:function(e,i){if("style"!==i.type)return e;for(var r in e)e[r]=O(r,e[r],t);return e},onChangeValue:function(e,i){return O(i,e,t)}}},T=i(54),D=i(25),R="",L="",B="",I="",N=T.a&&"ontouchstart"in document.documentElement;if(T.a){var j={Moz:"-moz-",ms:"-ms-",O:"-o-",Webkit:"-webkit-"},F=document.createElement("p").style;for(var z in j)if(z+"Transform"in F){R=z,L=j[z];break}"Webkit"===R&&"msHyphens"in F&&(R="ms",L=j.ms,I="edge"),"Webkit"===R&&"-apple-trailing-word"in F&&(B="apple")}var V=R,U=L,W=B,H=I,G=N,X={noPrefill:["appearance"],supportedProperty:function(e){return"appearance"===e&&("ms"===V?"-webkit-"+e:U+e)}},Y={noPrefill:["color-adjust"],supportedProperty:function(e){return"color-adjust"===e&&("Webkit"===V?U+"print-"+e:e)}},$=/[-\s]+(.)?/g;function q(e,t){return t?t.toUpperCase():""}function K(e){return e.replace($,q)}function Z(e){return K("-"+e)}var Q,J={noPrefill:["mask"],supportedProperty:function(e,t){if(!/^mask/.test(e))return!1;if("Webkit"===V){if(K("mask-image")in t)return e;if(V+Z("mask-image")in t)return U+e}return e}},ee={noPrefill:["text-orientation"],supportedProperty:function(e){return"text-orientation"===e&&("apple"!==W||G?e:U+e)}},te={noPrefill:["transform"],supportedProperty:function(e,t,i){return"transform"===e&&(i.transform?e:U+e)}},ie={noPrefill:["transition"],supportedProperty:function(e,t,i){return"transition"===e&&(i.transition?e:U+e)}},re={noPrefill:["writing-mode"],supportedProperty:function(e){return"writing-mode"===e&&("Webkit"===V||"ms"===V&&"edge"!==H?U+e:e)}},ne={noPrefill:["user-select"],supportedProperty:function(e){return"user-select"===e&&("Moz"===V||"ms"===V||"apple"===W?U+e:e)}},oe={supportedProperty:function(e,t){return!!/^break-/.test(e)&&("Webkit"===V?"WebkitColumn"+Z(e)in t&&U+"column-"+e:"Moz"===V&&"page"+Z(e)in t&&"page-"+e)}},se={supportedProperty:function(e,t){if(!/^(border|margin|padding)-inline/.test(e))return!1;if("Moz"===V)return e;var i=e.replace("-inline","");return V+Z(i)in t&&U+i}},ae={supportedProperty:function(e,t){return K(e)in t&&e}},le={supportedProperty:function(e,t){var i=Z(e);return"-"===e[0]||"-"===e[0]&&"-"===e[1]?e:V+i in t?U+e:"Webkit"!==V&&"Webkit"+i in t&&"-webkit-"+e}},ce={supportedProperty:function(e){return"scroll-snap"===e.substring(0,11)&&("ms"===V?""+U+e:e)}},ue={supportedProperty:function(e){return"overscroll-behavior"===e&&("ms"===V?U+"scroll-chaining":e)}},he={"flex-grow":"flex-positive","flex-shrink":"flex-negative","flex-basis":"flex-preferred-size","justify-content":"flex-pack",order:"flex-order","align-items":"flex-align","align-content":"flex-line-pack"},de={supportedProperty:function(e,t){var i=he[e];return!!i&&V+Z(i)in t&&U+i}},pe={flex:"box-flex","flex-grow":"box-flex","flex-direction":["box-orient","box-direction"],order:"box-ordinal-group","align-items":"box-align","flex-flow":["box-orient","box-direction"],"justify-content":"box-pack"},fe=Object.keys(pe),me=function(e){return U+e},ge=[X,Y,J,ee,te,ie,re,ne,oe,se,ae,le,ce,ue,de,{supportedProperty:function(e,t,i){var r=i.multiple;if(fe.indexOf(e)>-1){var n=pe[e];if(!Array.isArray(n))return V+Z(n)in t&&U+n;if(!r)return!1;for(var o=0;o<n.length;o++)if(!(V+Z(n[0])in t))return!1;return n.map(me)}return!1}}],ve=ge.filter((function(e){return e.supportedProperty})).map((function(e){return e.supportedProperty})),be=ge.filter((function(e){return e.noPrefill})).reduce((function(e,t){return e.push.apply(e,Object(D.a)(t.noPrefill)),e}),[]),_e={};if(T.a){Q=document.createElement("p");var ye=window.getComputedStyle(document.documentElement,"");for(var xe in ye)isNaN(xe)||(_e[ye[xe]]=ye[xe]);be.forEach((function(e){return delete _e[e]}))}function we(e,t){if(void 0===t&&(t={}),!Q)return e;if(null!=_e[e])return _e[e];"transition"!==e&&"transform"!==e||(t[e]=e in Q.style);for(var i=0;i<ve.length&&(_e[e]=ve[i](e,Q.style,t),!_e[e]);i++);try{Q.style[e]=""}catch(e){return!1}return _e[e]}var Me,Pe={},Ee={transition:1,"transition-property":1,"-webkit-transition":1,"-webkit-transition-property":1},Se=/(^\s*[\w-]+)|, (\s*[\w-]+)(?![^()]*\))/g;function Ce(e,t,i){return"var"===t?"var":"all"===t?"all":"all"===i?", all":(t?we(t):", "+we(i))||t||i}function ke(e,t){var i=t;if(!Me||"content"===e)return t;if("string"!=typeof i||!isNaN(parseInt(i,10)))return i;var r=e+i;if(null!=Pe[r])return Pe[r];try{Me.style[e]=i}catch(e){return Pe[r]=!1,!1}if(Ee[e])i=i.replace(Se,Ce);else if(""===Me.style[e]&&("-ms-flex"===(i=U+i)&&(Me.style[e]="-ms-flexbox"),Me.style[e]=i,""===Me.style[e]))return Pe[r]=!1,!1;return Me.style[e]="",Pe[r]=i,Pe[r]}T.a&&(Me=document.createElement("p"));var Oe=function(){function e(t){for(var i in t){var n=t[i];if("fallbacks"===i&&Array.isArray(n))t[i]=n.map(e);else{var o=!1,s=we(i);s&&s!==i&&(o=!0);var a=!1,l=ke(s,Object(r.g)(n));l&&l!==n&&(a=!0),(o||a)&&(o&&delete t[i],t[s||i]=l||n)}}return t}return{onProcessRule:function(e){if("keyframes"===e.type){var t=e;t.at=function(e){return"-"===e[1]||"ms"===V?e:"@"+U+"keyframes"+e.substr(10)}(t.at)}},onProcessStyle:function(t,i){return"style"!==i.type?t:e(t)},onChangeValue:function(e,t){return ke(t,Object(r.g)(e))||e}}},Ae=function(){var e=function(e,t){return e.length===t.length?e>t?1:-1:e.length-t.length};return{onProcessStyle:function(t,i){if("style"!==i.type)return t;for(var r={},n=Object.keys(t).sort(e),o=0;o<n.length;o++)r[n[o]]=t[n[o]];return r}}};function Te(){return{plugins:[{onCreateRule:function(e,t,i){if("function"!=typeof t)return null;var n=Object(r.d)(e,{},i);return n[s]=t,n},onProcessStyle:function(e,t){if(o in t||s in t)return e;var i={};for(var r in e){var n=e[r];"function"==typeof n&&(delete e[r],i[r]=n)}return t[o]=i,e},onUpdate:function(e,t,i,r){var n=t,a=n[s];a&&(n.style=a(e)||{});var l=n[o];if(l)for(var c in l)n.prop(c,l[c](e),r)}},{onCreateRule:function(e,t,i){if(!e)return null;if(e===l)return new u(e,t,i);if("@"===e[0]&&e.substr(0,c.length)===c)return new h(e,t,i);var r=i.parent;return r&&("global"===r.type||r.options.parent&&"global"===r.options.parent.type)&&(i.scoped=!1),!1===i.scoped&&(i.selector=e),null},onProcessRule:function(e,t){"style"===e.type&&t&&(function(e,t){var i=e.options,r=e.style,n=r?r[l]:null;if(n){for(var o in n)t.addRule(o,n[o],Object(a.a)({},i,{selector:p(o,e.selector)}));delete r[l]}}(e,t),function(e,t){var i=e.options,r=e.style;for(var n in r)if("@"===n[0]&&n.substr(0,l.length)===l){var o=p(n.substr(l.length),e.selector);t.addRule(o,r[n],Object(a.a)({},i,{selector:o})),delete r[n]}}(e,t))}},v(),{onProcessStyle:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)e[t]=M(e[t]);return e}return M(e)},onChangeValue:function(e,t,i){if(0===t.indexOf("--"))return e;var r=w(t);return t===r?e:(i.prop(r,e),null)}},A(),"undefined"==typeof window?null:Oe(),Ae()]}}},,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(1),n=i(19),o=i(220),s=i(249),a=i(250),l=i(44),c=new s.Server({dataDir:"./public/data"});n.render(r.createElement(class extends r.Component{constructor(e){super(e),this.bimViewer=r.createRef(),this.requestParams=this.getRequestParams(),this.projectId=this.requestParams.projectId,this.projectId||console.error("No project ID provided");const t=this.requestParams.tab;t&&(this.defaultTab=t),this.enableEditModels="true"===this.requestParams.enableEditModels}componentDidMount(){if(!this.bimViewer.current)return void console.log("No BIM Viewer");window.bimViewer=this.bimViewer.current,this.bimViewer.current.setConfigs({});const e=this.requestParams.configs;if(e){const t=e.split(",");for(let e=0,i=t.length;e<i;e++){const i=t[e].split(":"),r=i[0],n=i[1];this.bimViewer.current.setConfig(r,n)}}this.bimViewer.current.loadProject(this.projectId,()=>{const e=this.requestParams.modelId;e&&this.bimViewer.current.loadModel(e),window.setInterval(function(){var e="";return function(){const t=window.location.hash;t!==e&&(this.parseHashParams(),e=t)}}(),200)},e=>{console.error(e)})}getRequestParams(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(t,i,r)=>(e[i]=r,r)),e}parseHashParams(){const e=this.getHashParams(),t=e.actions;if(!t)return;const i=t.split(",");if(0!==i.length)for(var r=0,n=i.length;r<n;r++){const t=i[r];switch(t){case"focusObject":const i=e.objectId;if(!i){console.error("Param expected for `focusObject` action: 'objectId'");break}this.bimViewer.current.setAllObjectsSelected(!1),this.bimViewer.current.setObjectsSelected([i],!0),this.bimViewer.current.flyToObject(i,()=>{});break;case"focusObjects":const r=e.objectIds;if(!r){console.error("Param expected for `focusObjects` action: 'objectIds'");break}const n=r.split(",");this.bimViewer.current.setAllObjectsSelected(!1),this.bimViewer.current.setObjectsSelected(n,!0),this.bimViewer.current.viewFitObjects(n,()=>{});break;case"clearFocusObjects":this.bimViewer.current.setAllObjectsSelected(!1),this.bimViewer.current.viewFitAll();break;case"openTab":const o=e.tabId;if(!o){console.error("Param expected for `openTab` action: 'tabId'");break}this.defaultTab=o;break;default:console.error("Action not supported: '"+t+"'")}}}getHashParams(){const e={};let t;const i=/\+/g,r=/([^&;=]+)=?([^&;]*)/g,n=function(e){return decodeURIComponent(e.replace(i," "))},o=window.location.hash.substring(1);for(;t=r.exec(o);)e[n(t[1])]=n(t[2]);return e}render(){return r.createElement(l.MuiThemeProvider,{theme:a.styleTheme},r.createElement(o.default,{defaultTab:this.defaultTab,server:c,enableEditModels:this.enableEditModels,ref:this.bimViewer}))}},null),document.getElementById("app-root"))},function(e,t,i){"use strict";
/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=i(206),n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,l=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,h=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function y(e,t,i){this.props=e,this.context=t,this.refs=_,this.updater=i||b}function x(){}function w(e,t,i){this.props=e,this.context=t,this.refs=_,this.updater=i||b}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(v(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=y.prototype;var M=w.prototype=new x;M.constructor=w,r(M,y.prototype),M.isPureReactComponent=!0;var P={current:null},E=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,i){var r,n={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,r)&&!S.hasOwnProperty(r)&&(n[r]=t[r]);var l=arguments.length-2;if(1===l)n.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===n[r]&&(n[r]=l[r]);return{$$typeof:o,type:e,key:s,ref:a,props:n,_owner:P.current}}function k(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var O=/\/+/g,A=[];function T(e,t,i,r){if(A.length){var n=A.pop();return n.result=e,n.keyPrefix=t,n.func=i,n.context=r,n.count=0,n}return{result:e,keyPrefix:t,func:i,context:r,count:0}}function D(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>A.length&&A.push(e)}function R(e,t,i){return null==e?0:function e(t,i,r,n){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case o:case s:l=!0}}if(l)return r(n,t,""===i?"."+L(t,0):i),1;if(l=0,i=""===i?".":i+":",Array.isArray(t))for(var c=0;c<t.length;c++){var u=i+L(a=t[c],c);l+=e(a,u,r,n)}else if("function"==typeof(u=null===t||"object"!=typeof t?null:"function"==typeof(u=g&&t[g]||t["@@iterator"])?u:null))for(t=u.call(t),c=0;!(a=t.next()).done;)l+=e(a=a.value,u=i+L(a,c++),r,n);else if("object"===a)throw r=""+t,Error(v(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return l}(e,"",t,i)}function L(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function B(e,t){e.func.call(e.context,t,e.count++)}function I(e,t,i){var r=e.result,n=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?N(e,r,i,(function(e){return e})):null!=e&&(k(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,n+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(O,"$&/")+"/")+i)),r.push(e))}function N(e,t,i,r,n){var o="";null!=i&&(o=(""+i).replace(O,"$&/")+"/"),R(e,I,t=T(t,o,r,n)),D(t)}var j={current:null};function F(){var e=j.current;if(null===e)throw Error(v(321));return e}var z={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:P,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,i){if(null==e)return e;var r=[];return N(e,r,null,t,i),r},forEach:function(e,t,i){if(null==e)return e;R(e,B,t=T(null,null,t,i)),D(t)},count:function(e){return R(e,(function(){return null}),null)},toArray:function(e){var t=[];return N(e,t,null,(function(e){return e})),t},only:function(e){if(!k(e))throw Error(v(143));return e}},t.Component=y,t.Fragment=a,t.Profiler=c,t.PureComponent=w,t.StrictMode=l,t.Suspense=p,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,t.cloneElement=function(e,t,i){if(null==e)throw Error(v(267,e));var n=r({},e.props),s=e.key,a=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,l=P.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)E.call(t,u)&&!S.hasOwnProperty(u)&&(n[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)n.children=i;else if(1<u){c=Array(u);for(var h=0;h<u;h++)c[h]=arguments[h+2];n.children=c}return{$$typeof:o,type:e.type,key:s,ref:a,props:n,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:h,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return F().useCallback(e,t)},t.useContext=function(e,t){return F().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return F().useEffect(e,t)},t.useImperativeHandle=function(e,t,i){return F().useImperativeHandle(e,t,i)},t.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},t.useMemo=function(e,t){return F().useMemo(e,t)},t.useReducer=function(e,t,i){return F().useReducer(e,t,i)},t.useRef=function(e){return F().useRef(e)},t.useState=function(e){return F().useState(e)},t.version="16.14.0"},function(e,t,i){"use strict";
/** @license React v16.14.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=i(1),n=i(206),o=i(218);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var a=!1,l=null,c=!1,u=null,h={onError:function(e){a=!0,l=e}};function d(e,t,i,r,n,o,s,c,u){a=!1,l=null,function(e,t,i,r,n,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(e){this.onError(e)}}.apply(h,arguments)}var p=null,f=null,m=null;function g(e,t,i){var r=e.type||"unknown-event";e.currentTarget=m(i),function(e,t,i,r,n,o,h,p,f){if(d.apply(this,arguments),a){if(!a)throw Error(s(198));var m=l;a=!1,l=null,c||(c=!0,u=m)}}(r,t,void 0,e),e.currentTarget=null}var v=null,b={};function _(){if(v)for(var e in b){var t=b[e],i=v.indexOf(e);if(!(-1<i))throw Error(s(96,e));if(!x[i]){if(!t.extractEvents)throw Error(s(97,e));for(var r in x[i]=t,i=t.eventTypes){var n=void 0,o=i[r],a=t,l=r;if(w.hasOwnProperty(l))throw Error(s(99,l));w[l]=o;var c=o.phasedRegistrationNames;if(c){for(n in c)c.hasOwnProperty(n)&&y(c[n],a,l);n=!0}else o.registrationName?(y(o.registrationName,a,l),n=!0):n=!1;if(!n)throw Error(s(98,r,e))}}}}function y(e,t,i){if(M[e])throw Error(s(100,e));M[e]=t,P[e]=t.eventTypes[i].dependencies}var x=[],w={},M={},P={};function E(e){var t,i=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(s(102,t));b[t]=r,i=!0}}i&&_()}var S=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),C=null,k=null,O=null;function A(e){if(e=f(e)){if("function"!=typeof C)throw Error(s(280));var t=e.stateNode;t&&(t=p(t),C(e.stateNode,e.type,t))}}function T(e){k?O?O.push(e):O=[e]:k=e}function D(){if(k){var e=k,t=O;if(O=k=null,A(e),t)for(e=0;e<t.length;e++)A(t[e])}}function R(e,t){return e(t)}function L(e,t,i,r,n){return e(t,i,r,n)}function B(){}var I=R,N=!1,j=!1;function F(){null===k&&null===O||(B(),D())}function z(e,t,i){if(j)return e(t,i);j=!0;try{return I(e,t,i)}finally{j=!1,F()}}var V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,U=Object.prototype.hasOwnProperty,W={},H={};function G(e,t,i,r,n,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=o}var X={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){X[e]=new G(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];X[t]=new G(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){X[e]=new G(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){X[e]=new G(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){X[e]=new G(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){X[e]=new G(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){X[e]=new G(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){X[e]=new G(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){X[e]=new G(e,5,!1,e.toLowerCase(),null,!1)}));var Y=/[\-:]([a-z])/g;function $(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Y,$);X[t]=new G(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Y,$);X[t]=new G(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Y,$);X[t]=new G(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){X[e]=new G(e,1,!1,e.toLowerCase(),null,!1)})),X.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){X[e]=new G(e,1,!1,e.toLowerCase(),null,!0)}));var q=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function K(e,t,i,r){var n=X.hasOwnProperty(t)?X[t]:null;(null!==n?0===n.type:!r&&2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))||(function(e,t,i,r){if(null==t||function(e,t,i,r){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,r))return!0;if(r)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,n,r)&&(i=null),r||null===n?function(e){return!!U.call(H,e)||!U.call(W,e)&&(V.test(e)?H[e]=!0:(W[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):n.mustUseProperty?e[n.propertyName]=null===i?3!==n.type&&"":i:(t=n.attributeName,r=n.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(n=n.type)||4===n&&!0===i?"":""+i,r?e.setAttributeNS(r,t,i):e.setAttribute(t,i))))}q.hasOwnProperty("ReactCurrentDispatcher")||(q.ReactCurrentDispatcher={current:null}),q.hasOwnProperty("ReactCurrentBatchConfig")||(q.ReactCurrentBatchConfig={suspense:null});var Z=/^(.*)[\\\/]/,Q="function"==typeof Symbol&&Symbol.for,J=Q?Symbol.for("react.element"):60103,ee=Q?Symbol.for("react.portal"):60106,te=Q?Symbol.for("react.fragment"):60107,ie=Q?Symbol.for("react.strict_mode"):60108,re=Q?Symbol.for("react.profiler"):60114,ne=Q?Symbol.for("react.provider"):60109,oe=Q?Symbol.for("react.context"):60110,se=Q?Symbol.for("react.concurrent_mode"):60111,ae=Q?Symbol.for("react.forward_ref"):60112,le=Q?Symbol.for("react.suspense"):60113,ce=Q?Symbol.for("react.suspense_list"):60120,ue=Q?Symbol.for("react.memo"):60115,he=Q?Symbol.for("react.lazy"):60116,de=Q?Symbol.for("react.block"):60121,pe="function"==typeof Symbol&&Symbol.iterator;function fe(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=pe&&e[pe]||e["@@iterator"])?e:null}function me(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case te:return"Fragment";case ee:return"Portal";case re:return"Profiler";case ie:return"StrictMode";case le:return"Suspense";case ce:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case oe:return"Context.Consumer";case ne:return"Context.Provider";case ae:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ue:return me(e.type);case de:return me(e.render);case he:if(e=1===e._status?e._result:null)return me(e)}return null}function ge(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var i="";break e;default:var r=e._debugOwner,n=e._debugSource,o=me(e.type);i=null,r&&(i=me(r.type)),r=o,o="",n?o=" (at "+n.fileName.replace(Z,"")+":"+n.lineNumber+")":i&&(o=" (created by "+i+")"),i="\n    in "+(r||"Unknown")+o}t+=i,e=e.return}while(e);return t}function ve(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function _e(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var n=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ye(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==i&&(t.setValue(e),!0)}function xe(e,t){var i=t.checked;return n({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function we(e,t){var i=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;i=ve(null!=t.value?t.value:i),e._wrapperState={initialChecked:r,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Me(e,t){null!=(t=t.checked)&&K(e,"checked",t,!1)}function Pe(e,t){Me(e,t);var i=ve(t.value),r=t.type;if(null!=i)"number"===r?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Se(e,t.type,i):t.hasOwnProperty("defaultValue")&&Se(e,t.type,ve(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ee(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function Se(e,t,i){"number"===t&&e.ownerDocument.activeElement===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function Ce(e,t){return e=n({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ke(e,t,i,r){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&r&&(e[i].defaultSelected=!0)}else{for(i=""+ve(i),t=null,n=0;n<e.length;n++){if(e[n].value===i)return e[n].selected=!0,void(r&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function Oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return n({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ae(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(s(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(s(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:ve(i)}}function Te(e,t){var i=ve(t.value),r=ve(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=r&&(e.defaultValue=""+r)}function De(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function Re(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Re(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Be,Ie=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,i,r,n){MSApp.execUnsafeLocalFunction((function(){return e(t,i)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((Be=Be||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Be.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function Ne(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}function je(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Fe={animationend:je("Animation","AnimationEnd"),animationiteration:je("Animation","AnimationIteration"),animationstart:je("Animation","AnimationStart"),transitionend:je("Transition","TransitionEnd")},ze={},Ve={};function Ue(e){if(ze[e])return ze[e];if(!Fe[e])return e;var t,i=Fe[e];for(t in i)if(i.hasOwnProperty(t)&&t in Ve)return ze[e]=i[t];return e}S&&(Ve=document.createElement("div").style,"AnimationEvent"in window||(delete Fe.animationend.animation,delete Fe.animationiteration.animation,delete Fe.animationstart.animation),"TransitionEvent"in window||delete Fe.transitionend.transition);var We=Ue("animationend"),He=Ue("animationiteration"),Ge=Ue("animationstart"),Xe=Ue("transitionend"),Ye="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$e=new("function"==typeof WeakMap?WeakMap:Map);function qe(e){var t=$e.get(e);return void 0===t&&(t=new Map,$e.set(e,t)),t}function Ke(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Qe(e){if(Ke(e)!==e)throw Error(s(188))}function Je(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(s(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(null===n)break;var o=n.alternate;if(null===o){if(null!==(r=n.return)){i=r;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===i)return Qe(n),e;if(o===r)return Qe(n),t;o=o.sibling}throw Error(s(188))}if(i.return!==r.return)i=n,r=o;else{for(var a=!1,l=n.child;l;){if(l===i){a=!0,i=n,r=o;break}if(l===r){a=!0,r=n,i=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===i){a=!0,i=o,r=n;break}if(l===r){a=!0,r=o,i=n;break}l=l.sibling}if(!a)throw Error(s(189))}}if(i.alternate!==r)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){if(null==t)throw Error(s(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function tt(e,t,i){Array.isArray(e)?e.forEach(t,i):e&&t.call(i,e)}var it=null;function rt(e){if(e){var t=e._dispatchListeners,i=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)g(e,t[r],i[r]);else t&&g(e,t,i);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function nt(e){if(null!==e&&(it=et(it,e)),e=it,it=null,e){if(tt(e,rt),it)throw Error(s(95));if(c)throw e=u,c=!1,u=null,e}}function ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function st(e){if(!S)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var at=[];function lt(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>at.length&&at.push(e)}function ct(e,t,i,r){if(at.length){var n=at.pop();return n.topLevelType=e,n.eventSystemFlags=r,n.nativeEvent=t,n.targetInst=i,n}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:i,ancestors:[]}}function ut(e){var t=e.targetInst,i=t;do{if(!i){e.ancestors.push(i);break}var r=i;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=i.tag)&&6!==t||e.ancestors.push(i),i=xi(r)}while(i);for(i=0;i<e.ancestors.length;i++){t=e.ancestors[i];var n=ot(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,s=e.eventSystemFlags;0===i&&(s|=64);for(var a=null,l=0;l<x.length;l++){var c=x[l];c&&(c=c.extractEvents(r,t,o,n,s))&&(a=et(a,c))}nt(a)}}function ht(e,t,i){if(!i.has(e)){switch(e){case"scroll":Gt(t,"scroll",!0);break;case"focus":case"blur":Gt(t,"focus",!0),Gt(t,"blur",!0),i.set("blur",null),i.set("focus",null);break;case"cancel":case"close":st(e)&&Gt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Ye.indexOf(e)&&Ht(e,t)}i.set(e,null)}}var dt,pt,ft,mt=!1,gt=[],vt=null,bt=null,_t=null,yt=new Map,xt=new Map,wt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Pt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Et(e,t,i,r,n){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|i,nativeEvent:n,container:r}}function St(e,t){switch(e){case"focus":case"blur":vt=null;break;case"dragenter":case"dragleave":bt=null;break;case"mouseover":case"mouseout":_t=null;break;case"pointerover":case"pointerout":yt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xt.delete(t.pointerId)}}function Ct(e,t,i,r,n,o){return null===e||e.nativeEvent!==o?(e=Et(t,i,r,n,o),null!==t&&null!==(t=wi(t))&&pt(t),e):(e.eventSystemFlags|=r,e)}function kt(e){var t=xi(e.target);if(null!==t){var i=Ke(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ze(i)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){ft(i)}))}else if(3===t&&i.stateNode.hydrate)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;var t=Yt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var i=wi(t);return null!==i&&pt(i),e.blockedOn=t,!1}return!0}function At(e,t,i){Ot(e)&&i.delete(t)}function Tt(){for(mt=!1;0<gt.length;){var e=gt[0];if(null!==e.blockedOn){null!==(e=wi(e.blockedOn))&&dt(e);break}var t=Yt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:gt.shift()}null!==vt&&Ot(vt)&&(vt=null),null!==bt&&Ot(bt)&&(bt=null),null!==_t&&Ot(_t)&&(_t=null),yt.forEach(At),xt.forEach(At)}function Dt(e,t){e.blockedOn===t&&(e.blockedOn=null,mt||(mt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Tt)))}function Rt(e){function t(t){return Dt(t,e)}if(0<gt.length){Dt(gt[0],e);for(var i=1;i<gt.length;i++){var r=gt[i];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==vt&&Dt(vt,e),null!==bt&&Dt(bt,e),null!==_t&&Dt(_t,e),yt.forEach(t),xt.forEach(t),i=0;i<wt.length;i++)(r=wt[i]).blockedOn===e&&(r.blockedOn=null);for(;0<wt.length&&null===(i=wt[0]).blockedOn;)kt(i),null===i.blockedOn&&wt.shift()}var Lt={},Bt=new Map,It=new Map,Nt=["abort","abort",We,"animationEnd",He,"animationIteration",Ge,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Xe,"transitionEnd","waiting","waiting"];function jt(e,t){for(var i=0;i<e.length;i+=2){var r=e[i],n=e[i+1],o="on"+(n[0].toUpperCase()+n.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},It.set(r,t),Bt.set(r,o),Lt[n]=o}}jt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),jt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),jt(Nt,2);for(var Ft="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),zt=0;zt<Ft.length;zt++)It.set(Ft[zt],0);var Vt=o.unstable_UserBlockingPriority,Ut=o.unstable_runWithPriority,Wt=!0;function Ht(e,t){Gt(t,e,!1)}function Gt(e,t,i){var r=It.get(t);switch(void 0===r?2:r){case 0:r=function(e,t,i,r){N||B();var n=Xt,o=N;N=!0;try{L(n,e,t,i,r)}finally{(N=o)||F()}}.bind(null,t,1,e);break;case 1:r=function(e,t,i,r){Ut(Vt,Xt.bind(null,e,t,i,r))}.bind(null,t,1,e);break;default:r=Xt.bind(null,t,1,e)}i?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Xt(e,t,i,r){if(Wt)if(0<gt.length&&-1<Mt.indexOf(e))e=Et(null,e,t,i,r),gt.push(e);else{var n=Yt(e,t,i,r);if(null===n)St(e,r);else if(-1<Mt.indexOf(e))e=Et(n,e,t,i,r),gt.push(e);else if(!function(e,t,i,r,n){switch(t){case"focus":return vt=Ct(vt,e,t,i,r,n),!0;case"dragenter":return bt=Ct(bt,e,t,i,r,n),!0;case"mouseover":return _t=Ct(_t,e,t,i,r,n),!0;case"pointerover":var o=n.pointerId;return yt.set(o,Ct(yt.get(o)||null,e,t,i,r,n)),!0;case"gotpointercapture":return o=n.pointerId,xt.set(o,Ct(xt.get(o)||null,e,t,i,r,n)),!0}return!1}(n,e,t,i,r)){St(e,r),e=ct(e,r,null,t);try{z(ut,e)}finally{lt(e)}}}}function Yt(e,t,i,r){if(null!==(i=xi(i=ot(r)))){var n=Ke(i);if(null===n)i=null;else{var o=n.tag;if(13===o){if(null!==(i=Ze(n)))return i;i=null}else if(3===o){if(n.stateNode.hydrate)return 3===n.tag?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null)}}e=ct(e,r,i,t);try{z(ut,e)}finally{lt(e)}return null}var $t={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qt=["Webkit","ms","Moz","O"];function Kt(e,t,i){return null==t||"boolean"==typeof t||""===t?"":i||"number"!=typeof t||0===t||$t.hasOwnProperty(e)&&$t[e]?(""+t).trim():t+"px"}function Zt(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var r=0===i.indexOf("--"),n=Kt(i,t[i],r);"float"===i&&(i="cssFloat"),r?e.setProperty(i,n):e[i]=n}}Object.keys($t).forEach((function(e){qt.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),$t[t]=$t[e]}))}));var Qt=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jt(e,t){if(t){if(Qt[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62,""))}}function ei(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ti="http://www.w3.org/1999/xhtml";function ii(e,t){var i=qe(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=P[t];for(var r=0;r<t.length;r++)ht(t[r],e,i)}function ri(){}function ni(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function oi(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function si(e,t){var i,r=oi(e);for(e=0;r;){if(3===r.nodeType){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=oi(r)}}function ai(){for(var e=window,t=ni();t instanceof e.HTMLIFrameElement;){try{var i="string"==typeof t.contentWindow.location.href}catch(e){i=!1}if(!i)break;t=ni((e=t.contentWindow).document)}return t}function li(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ci=null,ui=null;function hi(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function di(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var pi="function"==typeof setTimeout?setTimeout:void 0,fi="function"==typeof clearTimeout?clearTimeout:void 0;function mi(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function gi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var vi=Math.random().toString(36).slice(2),bi="__reactInternalInstance$"+vi,_i="__reactEventHandlers$"+vi,yi="__reactContainere$"+vi;function xi(e){var t=e[bi];if(t)return t;for(var i=e.parentNode;i;){if(t=i[yi]||i[bi]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=gi(e);null!==e;){if(i=e[bi])return i;e=gi(e)}return t}i=(e=i).parentNode}return null}function wi(e){return!(e=e[bi]||e[yi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Mi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Pi(e){return e[_i]||null}function Ei(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Si(e,t){var i=e.stateNode;if(!i)return null;var r=p(i);if(!r)return null;i=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(i&&"function"!=typeof i)throw Error(s(231,t,typeof i));return i}function Ci(e,t,i){(t=Si(e,i.dispatchConfig.phasedRegistrationNames[t]))&&(i._dispatchListeners=et(i._dispatchListeners,t),i._dispatchInstances=et(i._dispatchInstances,e))}function ki(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,i=[];t;)i.push(t),t=Ei(t);for(t=i.length;0<t--;)Ci(i[t],"captured",e);for(t=0;t<i.length;t++)Ci(i[t],"bubbled",e)}}function Oi(e,t,i){e&&i&&i.dispatchConfig.registrationName&&(t=Si(e,i.dispatchConfig.registrationName))&&(i._dispatchListeners=et(i._dispatchListeners,t),i._dispatchInstances=et(i._dispatchInstances,e))}function Ai(e){e&&e.dispatchConfig.registrationName&&Oi(e._targetInst,null,e)}function Ti(e){tt(e,ki)}var Di=null,Ri=null,Li=null;function Bi(){if(Li)return Li;var e,t,i=Ri,r=i.length,n="value"in Di?Di.value:Di.textContent,o=n.length;for(e=0;e<r&&i[e]===n[e];e++);var s=r-e;for(t=1;t<=s&&i[r-t]===n[o-t];t++);return Li=n.slice(e,1<t?1-t:void 0)}function Ii(){return!0}function Ni(){return!1}function ji(e,t,i,r){for(var n in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=i,e=this.constructor.Interface)e.hasOwnProperty(n)&&((t=e[n])?this[n]=t(i):"target"===n?this.target=r:this[n]=i[n]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Ii:Ni,this.isPropagationStopped=Ni,this}function Fi(e,t,i,r){if(this.eventPool.length){var n=this.eventPool.pop();return this.call(n,e,t,i,r),n}return new this(e,t,i,r)}function zi(e){if(!(e instanceof this))throw Error(s(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Vi(e){e.eventPool=[],e.getPooled=Fi,e.release=zi}n(ji.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ii)},persist:function(){this.isPersistent=Ii},isPersistent:Ni,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Ni,this._dispatchInstances=this._dispatchListeners=null}}),ji.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},ji.extend=function(e){function t(){}function i(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return n(o,i.prototype),i.prototype=o,i.prototype.constructor=i,i.Interface=n({},r.Interface,e),i.extend=r.extend,Vi(i),i},Vi(ji);var Ui=ji.extend({data:null}),Wi=ji.extend({data:null}),Hi=[9,13,27,32],Gi=S&&"CompositionEvent"in window,Xi=null;S&&"documentMode"in document&&(Xi=document.documentMode);var Yi=S&&"TextEvent"in window&&!Xi,$i=S&&(!Gi||Xi&&8<Xi&&11>=Xi),qi=String.fromCharCode(32),Ki={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Zi=!1;function Qi(e,t){switch(e){case"keyup":return-1!==Hi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Ji(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var er=!1,tr={eventTypes:Ki,extractEvents:function(e,t,i,r){var n;if(Gi)e:{switch(e){case"compositionstart":var o=Ki.compositionStart;break e;case"compositionend":o=Ki.compositionEnd;break e;case"compositionupdate":o=Ki.compositionUpdate;break e}o=void 0}else er?Qi(e,i)&&(o=Ki.compositionEnd):"keydown"===e&&229===i.keyCode&&(o=Ki.compositionStart);return o?($i&&"ko"!==i.locale&&(er||o!==Ki.compositionStart?o===Ki.compositionEnd&&er&&(n=Bi()):(Ri="value"in(Di=r)?Di.value:Di.textContent,er=!0)),o=Ui.getPooled(o,t,i,r),(n||null!==(n=Ji(i)))&&(o.data=n),Ti(o),n=o):n=null,(e=Yi?function(e,t){switch(e){case"compositionend":return Ji(t);case"keypress":return 32!==t.which?null:(Zi=!0,qi);case"textInput":return(e=t.data)===qi&&Zi?null:e;default:return null}}(e,i):function(e,t){if(er)return"compositionend"===e||!Gi&&Qi(e,t)?(e=Bi(),Li=Ri=Di=null,er=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $i&&"ko"!==t.locale?null:t.data;default:return null}}(e,i))?((t=Wi.getPooled(Ki.beforeInput,t,i,r)).data=e,Ti(t)):t=null,null===n?t:null===t?n:[n,t]}},ir={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!ir[e.type]:"textarea"===t}var nr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function or(e,t,i){return(e=ji.getPooled(nr.change,e,t,i)).type="change",T(i),Ti(e),e}var sr=null,ar=null;function lr(e){nt(e)}function cr(e){if(ye(Mi(e)))return e}function ur(e,t){if("change"===e)return t}var hr=!1;function dr(){sr&&(sr.detachEvent("onpropertychange",pr),ar=sr=null)}function pr(e){if("value"===e.propertyName&&cr(ar))if(e=or(ar,e,ot(e)),N)nt(e);else{N=!0;try{R(lr,e)}finally{N=!1,F()}}}function fr(e,t,i){"focus"===e?(dr(),ar=i,(sr=t).attachEvent("onpropertychange",pr)):"blur"===e&&dr()}function mr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return cr(ar)}function gr(e,t){if("click"===e)return cr(t)}function vr(e,t){if("input"===e||"change"===e)return cr(t)}S&&(hr=st("input")&&(!document.documentMode||9<document.documentMode));var br={eventTypes:nr,_isInputEventSupported:hr,extractEvents:function(e,t,i,r){var n=t?Mi(t):window,o=n.nodeName&&n.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===n.type)var s=ur;else if(rr(n))if(hr)s=vr;else{s=mr;var a=fr}else(o=n.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===n.type||"radio"===n.type)&&(s=gr);if(s&&(s=s(e,t)))return or(s,i,r);a&&a(e,n,t),"blur"===e&&(e=n._wrapperState)&&e.controlled&&"number"===n.type&&Se(n,"number",n.value)}},_r=ji.extend({view:null,detail:null}),yr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=yr[e])&&!!t[e]}function wr(){return xr}var Mr=0,Pr=0,Er=!1,Sr=!1,Cr=_r.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:wr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Mr;return Mr=e.screenX,Er?"mousemove"===e.type?e.screenX-t:0:(Er=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Pr;return Pr=e.screenY,Sr?"mousemove"===e.type?e.screenY-t:0:(Sr=!0,0)}}),kr=Cr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Or={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Ar={eventTypes:Or,extractEvents:function(e,t,i,r,n){var o="mouseover"===e||"pointerover"===e,s="mouseout"===e||"pointerout"===e;if(o&&0==(32&n)&&(i.relatedTarget||i.fromElement)||!s&&!o)return null;if(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,s?(s=t,null!==(t=(t=i.relatedTarget||i.toElement)?xi(t):null)&&(t!==Ke(t)||5!==t.tag&&6!==t.tag)&&(t=null)):s=null,s===t)return null;if("mouseout"===e||"mouseover"===e)var a=Cr,l=Or.mouseLeave,c=Or.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(a=kr,l=Or.pointerLeave,c=Or.pointerEnter,u="pointer");if(e=null==s?o:Mi(s),o=null==t?o:Mi(t),(l=a.getPooled(l,s,i,r)).type=u+"leave",l.target=e,l.relatedTarget=o,(i=a.getPooled(c,t,i,r)).type=u+"enter",i.target=o,i.relatedTarget=e,u=t,(r=s)&&u)e:{for(c=u,s=0,e=a=r;e;e=Ei(e))s++;for(e=0,t=c;t;t=Ei(t))e++;for(;0<s-e;)a=Ei(a),s--;for(;0<e-s;)c=Ei(c),e--;for(;s--;){if(a===c||a===c.alternate)break e;a=Ei(a),c=Ei(c)}a=null}else a=null;for(c=a,a=[];r&&r!==c&&(null===(s=r.alternate)||s!==c);)a.push(r),r=Ei(r);for(r=[];u&&u!==c&&(null===(s=u.alternate)||s!==c);)r.push(u),u=Ei(u);for(u=0;u<a.length;u++)Oi(a[u],"bubbled",l);for(u=r.length;0<u--;)Oi(r[u],"captured",i);return 0==(64&n)?[l]:[l,i]}},Tr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Dr=Object.prototype.hasOwnProperty;function Rr(e,t){if(Tr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++)if(!Dr.call(t,i[r])||!Tr(e[i[r]],t[i[r]]))return!1;return!0}var Lr=S&&"documentMode"in document&&11>=document.documentMode,Br={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Ir=null,Nr=null,jr=null,Fr=!1;function zr(e,t){var i=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Fr||null==Ir||Ir!==ni(i)?null:(i="selectionStart"in(i=Ir)&&li(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},jr&&Rr(jr,i)?null:(jr=i,(e=ji.getPooled(Br.select,Nr,e,t)).type="select",e.target=Ir,Ti(e),e))}var Vr={eventTypes:Br,extractEvents:function(e,t,i,r,n,o){if(!(o=!(n=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{n=qe(n),o=P.onSelect;for(var s=0;s<o.length;s++)if(!n.has(o[s])){n=!1;break e}n=!0}o=!n}if(o)return null;switch(n=t?Mi(t):window,e){case"focus":(rr(n)||"true"===n.contentEditable)&&(Ir=n,Nr=t,jr=null);break;case"blur":jr=Nr=Ir=null;break;case"mousedown":Fr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Fr=!1,zr(i,r);case"selectionchange":if(Lr)break;case"keydown":case"keyup":return zr(i,r)}return null}},Ur=ji.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Wr=ji.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hr=_r.extend({relatedTarget:null});function Gr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Xr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$r=_r.extend({key:function(e){if(e.key){var t=Xr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Yr[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:wr,charCode:function(e){return"keypress"===e.type?Gr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),qr=Cr.extend({dataTransfer:null}),Kr=_r.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:wr}),Zr=ji.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Qr=Cr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),Jr={eventTypes:Lt,extractEvents:function(e,t,i,r){var n=Bt.get(e);if(!n)return null;switch(e){case"keypress":if(0===Gr(i))return null;case"keydown":case"keyup":e=$r;break;case"blur":case"focus":e=Hr;break;case"click":if(2===i.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Cr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=qr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=Kr;break;case We:case He:case Ge:e=Ur;break;case Xe:e=Zr;break;case"scroll":e=_r;break;case"wheel":e=Qr;break;case"copy":case"cut":case"paste":e=Wr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=kr;break;default:e=ji}return Ti(t=e.getPooled(n,t,i,r)),t}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),_(),p=Pi,f=wi,m=Mi,E({SimpleEventPlugin:Jr,EnterLeaveEventPlugin:Ar,ChangeEventPlugin:br,SelectEventPlugin:Vr,BeforeInputEventPlugin:tr});var en=[],tn=-1;function rn(e){0>tn||(e.current=en[tn],en[tn]=null,tn--)}function nn(e,t){en[++tn]=e.current,e.current=t}var on={},sn={current:on},an={current:!1},ln=on;function cn(e,t){var i=e.type.contextTypes;if(!i)return on;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var n,o={};for(n in i)o[n]=t[n];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function un(e){return null!==(e=e.childContextTypes)&&void 0!==e}function hn(){rn(an),rn(sn)}function dn(e,t,i){if(sn.current!==on)throw Error(s(168));nn(sn,t),nn(an,i)}function pn(e,t,i){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return i;for(var o in r=r.getChildContext())if(!(o in e))throw Error(s(108,me(t)||"Unknown",o));return n({},i,{},r)}function fn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||on,ln=sn.current,nn(sn,e),nn(an,an.current),!0}function mn(e,t,i){var r=e.stateNode;if(!r)throw Error(s(169));i?(e=pn(e,t,ln),r.__reactInternalMemoizedMergedChildContext=e,rn(an),rn(sn),nn(sn,e)):rn(an),nn(an,i)}var gn=o.unstable_runWithPriority,vn=o.unstable_scheduleCallback,bn=o.unstable_cancelCallback,_n=o.unstable_requestPaint,yn=o.unstable_now,xn=o.unstable_getCurrentPriorityLevel,wn=o.unstable_ImmediatePriority,Mn=o.unstable_UserBlockingPriority,Pn=o.unstable_NormalPriority,En=o.unstable_LowPriority,Sn=o.unstable_IdlePriority,Cn={},kn=o.unstable_shouldYield,On=void 0!==_n?_n:function(){},An=null,Tn=null,Dn=!1,Rn=yn(),Ln=1e4>Rn?yn:function(){return yn()-Rn};function Bn(){switch(xn()){case wn:return 99;case Mn:return 98;case Pn:return 97;case En:return 96;case Sn:return 95;default:throw Error(s(332))}}function In(e){switch(e){case 99:return wn;case 98:return Mn;case 97:return Pn;case 96:return En;case 95:return Sn;default:throw Error(s(332))}}function Nn(e,t){return e=In(e),gn(e,t)}function jn(e,t,i){return e=In(e),vn(e,t,i)}function Fn(e){return null===An?(An=[e],Tn=vn(wn,Vn)):An.push(e),Cn}function zn(){if(null!==Tn){var e=Tn;Tn=null,bn(e)}Vn()}function Vn(){if(!Dn&&null!==An){Dn=!0;var e=0;try{var t=An;Nn(99,(function(){for(;e<t.length;e++){var i=t[e];do{i=i(!0)}while(null!==i)}})),An=null}catch(t){throw null!==An&&(An=An.slice(e+1)),vn(wn,zn),t}finally{Dn=!1}}}function Un(e,t,i){return 1073741821-(1+((1073741821-e+t/10)/(i/=10)|0))*i}function Wn(e,t){if(e&&e.defaultProps)for(var i in t=n({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}var Hn={current:null},Gn=null,Xn=null,Yn=null;function $n(){Yn=Xn=Gn=null}function qn(e){var t=Hn.current;rn(Hn),e.type._context._currentValue=t}function Kn(e,t){for(;null!==e;){var i=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==i&&i.childExpirationTime<t&&(i.childExpirationTime=t);else{if(!(null!==i&&i.childExpirationTime<t))break;i.childExpirationTime=t}e=e.return}}function Zn(e,t){Gn=e,Yn=Xn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Es=!0),e.firstContext=null)}function Qn(e,t){if(Yn!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Yn=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Xn){if(null===Gn)throw Error(s(308));Xn=t,Gn.dependencies={expirationTime:0,firstContext:t,responders:null}}else Xn=Xn.next=t;return e._currentValue}var Jn=!1;function eo(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function to(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function io(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function ro(e,t){if(null!==(e=e.updateQueue)){var i=(e=e.shared).pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}}function no(e,t){var i=e.alternate;null!==i&&to(i,e),null===(i=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=i.next,i.next=t)}function oo(e,t,i,r){var o=e.updateQueue;Jn=!1;var s=o.baseQueue,a=o.shared.pending;if(null!==a){if(null!==s){var l=s.next;s.next=a.next,a.next=l}s=a,o.shared.pending=null,null!==(l=e.alternate)&&null!==(l=l.updateQueue)&&(l.baseQueue=a)}if(null!==s){l=s.next;var c=o.baseState,u=0,h=null,d=null,p=null;if(null!==l)for(var f=l;;){if((a=f.expirationTime)<r){var m={expirationTime:f.expirationTime,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null};null===p?(d=p=m,h=c):p=p.next=m,a>u&&(u=a)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null}),el(a,f.suspenseConfig);e:{var g=e,v=f;switch(a=t,m=i,v.tag){case 1:if("function"==typeof(g=v.payload)){c=g.call(m,c,a);break e}c=g;break e;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null===(a="function"==typeof(g=v.payload)?g.call(m,c,a):g)||void 0===a)break e;c=n({},c,a);break e;case 2:Jn=!0}}null!==f.callback&&(e.effectTag|=32,null===(a=o.effects)?o.effects=[f]:a.push(f))}if(null===(f=f.next)||f===l){if(null===(a=o.shared.pending))break;f=s.next=a.next,a.next=l,o.baseQueue=s=a,o.shared.pending=null}}null===p?h=c:p.next=d,o.baseState=h,o.baseQueue=p,tl(u),e.expirationTime=u,e.memoizedState=c}}function so(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],n=r.callback;if(null!==n){if(r.callback=null,r=n,n=i,"function"!=typeof r)throw Error(s(191,r));r.call(n)}}}var ao=q.ReactCurrentBatchConfig,lo=(new r.Component).refs;function co(e,t,i,r){i=null===(i=i(r,t=e.memoizedState))||void 0===i?t:n({},t,i),e.memoizedState=i,0===e.expirationTime&&(e.updateQueue.baseState=i)}var uo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Ke(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternalFiber;var r=Ua(),n=ao.suspense;(n=io(r=Wa(r,e,n),n)).payload=t,null!=i&&(n.callback=i),ro(e,n),Ha(e,r)},enqueueReplaceState:function(e,t,i){e=e._reactInternalFiber;var r=Ua(),n=ao.suspense;(n=io(r=Wa(r,e,n),n)).tag=1,n.payload=t,null!=i&&(n.callback=i),ro(e,n),Ha(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var i=Ua(),r=ao.suspense;(r=io(i=Wa(i,e,r),r)).tag=2,null!=t&&(r.callback=t),ro(e,r),Ha(e,i)}};function ho(e,t,i,r,n,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!(t.prototype&&t.prototype.isPureReactComponent&&Rr(i,r)&&Rr(n,o))}function po(e,t,i){var r=!1,n=on,o=t.contextType;return"object"==typeof o&&null!==o?o=Qn(o):(n=un(t)?ln:sn.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?cn(e,n):on),t=new t(i,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=uo,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=o),t}function fo(e,t,i,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&uo.enqueueReplaceState(t,t.state,null)}function mo(e,t,i,r){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs=lo,eo(e);var o=t.contextType;"object"==typeof o&&null!==o?n.context=Qn(o):(o=un(t)?ln:sn.current,n.context=cn(e,o)),oo(e,i,n,r),n.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(co(e,t,o,i),n.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(t=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&uo.enqueueReplaceState(n,n.state,null),oo(e,i,n,r),n.state=e.memoizedState),"function"==typeof n.componentDidMount&&(e.effectTag|=4)}var go=Array.isArray;function vo(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(s(309));var r=i.stateNode}if(!r)throw Error(s(147,e));var n=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===n?t.ref:((t=function(e){var t=r.refs;t===lo&&(t=r.refs={}),null===e?delete t[n]:t[n]=e})._stringRef=n,t)}if("string"!=typeof e)throw Error(s(284));if(!i._owner)throw Error(s(290,e))}return e}function bo(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function _o(e){function t(t,i){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i,i.nextEffect=null,i.effectTag=8}}function i(i,r){if(!e)return null;for(;null!==r;)t(i,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=bl(e,t)).index=0,e.sibling=null,e}function o(t,i,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<i?(t.effectTag=2,i):r:(t.effectTag=2,i):i}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,i,r){return null===t||6!==t.tag?((t=xl(i,e.mode,r)).return=e,t):((t=n(t,i)).return=e,t)}function c(e,t,i,r){return null!==t&&t.elementType===i.type?((r=n(t,i.props)).ref=vo(e,t,i),r.return=e,r):((r=_l(i.type,i.key,i.props,null,e.mode,r)).ref=vo(e,t,i),r.return=e,r)}function u(e,t,i,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=wl(i,e.mode,r)).return=e,t):((t=n(t,i.children||[])).return=e,t)}function h(e,t,i,r,o){return null===t||7!==t.tag?((t=yl(i,e.mode,r,o)).return=e,t):((t=n(t,i)).return=e,t)}function d(e,t,i){if("string"==typeof t||"number"==typeof t)return(t=xl(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case J:return(i=_l(t.type,t.key,t.props,null,e.mode,i)).ref=vo(e,null,t),i.return=e,i;case ee:return(t=wl(t,e.mode,i)).return=e,t}if(go(t)||fe(t))return(t=yl(t,e.mode,i,null)).return=e,t;bo(e,t)}return null}function p(e,t,i,r){var n=null!==t?t.key:null;if("string"==typeof i||"number"==typeof i)return null!==n?null:l(e,t,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case J:return i.key===n?i.type===te?h(e,t,i.props.children,r,n):c(e,t,i,r):null;case ee:return i.key===n?u(e,t,i,r):null}if(go(i)||fe(i))return null!==n?null:h(e,t,i,r,null);bo(e,i)}return null}function f(e,t,i,r,n){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(i)||null,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case J:return e=e.get(null===r.key?i:r.key)||null,r.type===te?h(t,e,r.props.children,n,r.key):c(t,e,r,n);case ee:return u(t,e=e.get(null===r.key?i:r.key)||null,r,n)}if(go(r)||fe(r))return h(t,e=e.get(i)||null,r,n,null);bo(t,r)}return null}function m(n,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(n,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(n,h),s=o(v,s,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===a.length)return i(n,h),c;if(null===h){for(;m<a.length;m++)null!==(h=d(n,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return c}for(h=r(n,h);m<a.length;m++)null!==(g=f(h,n,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(n,e)})),c}function g(n,a,l,c){var u=fe(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,v=null,b=l.next();null!==m&&!b.done;g++,b=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=p(n,m,b.value,c);if(null===_){null===m&&(m=v);break}e&&m&&null===_.alternate&&t(n,m),a=o(_,a,g),null===h?u=_:h.sibling=_,h=_,m=v}if(b.done)return i(n,m),u;if(null===m){for(;!b.done;g++,b=l.next())null!==(b=d(n,b.value,c))&&(a=o(b,a,g),null===h?u=b:h.sibling=b,h=b);return u}for(m=r(n,m);!b.done;g++,b=l.next())null!==(b=f(m,n,g,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),a=o(b,a,g),null===h?u=b:h.sibling=b,h=b);return e&&m.forEach((function(e){return t(n,e)})),u}return function(e,r,o,l){var c="object"==typeof o&&null!==o&&o.type===te&&null===o.key;c&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case J:e:{for(u=o.key,c=r;null!==c;){if(c.key===u){switch(c.tag){case 7:if(o.type===te){i(e,c.sibling),(r=n(c,o.props.children)).return=e,e=r;break e}break;default:if(c.elementType===o.type){i(e,c.sibling),(r=n(c,o.props)).ref=vo(e,c,o),r.return=e,e=r;break e}}i(e,c);break}t(e,c),c=c.sibling}o.type===te?((r=yl(o.props.children,e.mode,l,o.key)).return=e,e=r):((l=_l(o.type,o.key,o.props,null,e.mode,l)).ref=vo(e,r,o),l.return=e,e=l)}return a(e);case ee:e:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){i(e,r.sibling),(r=n(r,o.children||[])).return=e,e=r;break e}i(e,r);break}t(e,r),r=r.sibling}(r=wl(o,e.mode,l)).return=e,e=r}return a(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(i(e,r.sibling),(r=n(r,o)).return=e,e=r):(i(e,r),(r=xl(o,e.mode,l)).return=e,e=r),a(e);if(go(o))return m(e,r,o,l);if(fe(o))return g(e,r,o,l);if(u&&bo(e,o),void 0===o&&!c)switch(e.tag){case 1:case 0:throw e=e.type,Error(s(152,e.displayName||e.name||"Component"))}return i(e,r)}}var yo=_o(!0),xo=_o(!1),wo={},Mo={current:wo},Po={current:wo},Eo={current:wo};function So(e){if(e===wo)throw Error(s(174));return e}function Co(e,t){switch(nn(Eo,t),nn(Po,e),nn(Mo,wo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Le(null,"");break;default:t=Le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}rn(Mo),nn(Mo,t)}function ko(){rn(Mo),rn(Po),rn(Eo)}function Oo(e){So(Eo.current);var t=So(Mo.current),i=Le(t,e.type);t!==i&&(nn(Po,e),nn(Mo,i))}function Ao(e){Po.current===e&&(rn(Mo),rn(Po))}var To={current:0};function Do(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Ro(e,t){return{responder:e,props:t}}var Lo=q.ReactCurrentDispatcher,Bo=q.ReactCurrentBatchConfig,Io=0,No=null,jo=null,Fo=null,zo=!1;function Vo(){throw Error(s(321))}function Uo(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Tr(e[i],t[i]))return!1;return!0}function Wo(e,t,i,r,n,o){if(Io=o,No=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Lo.current=null===e||null===e.memoizedState?ds:ps,e=i(r,n),t.expirationTime===Io){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(s(301));o+=1,Fo=jo=null,t.updateQueue=null,Lo.current=fs,e=i(r,n)}while(t.expirationTime===Io)}if(Lo.current=hs,t=null!==jo&&null!==jo.next,Io=0,Fo=jo=No=null,zo=!1,t)throw Error(s(300));return e}function Ho(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Fo?No.memoizedState=Fo=e:Fo=Fo.next=e,Fo}function Go(){if(null===jo){var e=No.alternate;e=null!==e?e.memoizedState:null}else e=jo.next;var t=null===Fo?No.memoizedState:Fo.next;if(null!==t)Fo=t,jo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(jo=e).memoizedState,baseState:jo.baseState,baseQueue:jo.baseQueue,queue:jo.queue,next:null},null===Fo?No.memoizedState=Fo=e:Fo=Fo.next=e}return Fo}function Xo(e,t){return"function"==typeof t?t(e):t}function Yo(e){var t=Go(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var r=jo,n=r.baseQueue,o=i.pending;if(null!==o){if(null!==n){var a=n.next;n.next=o.next,o.next=a}r.baseQueue=n=o,i.pending=null}if(null!==n){n=n.next,r=r.baseState;var l=a=o=null,c=n;do{var u=c.expirationTime;if(u<Io){var h={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(a=l=h,o=r):l=l.next=h,u>No.expirationTime&&(No.expirationTime=u,tl(u))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),el(u,c.suspenseConfig),r=c.eagerReducer===e?c.eagerState:e(r,c.action);c=c.next}while(null!==c&&c!==n);null===l?o=r:l.next=a,Tr(r,t.memoizedState)||(Es=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,i.lastRenderedState=r}return[t.memoizedState,i.dispatch]}function $o(e){var t=Go(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,o=t.memoizedState;if(null!==n){i.pending=null;var a=n=n.next;do{o=e(o,a.action),a=a.next}while(a!==n);Tr(o,t.memoizedState)||(Es=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,r]}function qo(e){var t=Ho();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e}).dispatch=us.bind(null,No,e),[t.memoizedState,e]}function Ko(e,t,i,r){return e={tag:e,create:t,destroy:i,deps:r,next:null},null===(t=No.updateQueue)?(t={lastEffect:null},No.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e),e}function Zo(){return Go().memoizedState}function Qo(e,t,i,r){var n=Ho();No.effectTag|=e,n.memoizedState=Ko(1|t,i,void 0,void 0===r?null:r)}function Jo(e,t,i,r){var n=Go();r=void 0===r?null:r;var o=void 0;if(null!==jo){var s=jo.memoizedState;if(o=s.destroy,null!==r&&Uo(r,s.deps))return void Ko(t,i,o,r)}No.effectTag|=e,n.memoizedState=Ko(1|t,i,o,r)}function es(e,t){return Qo(516,4,e,t)}function ts(e,t){return Jo(516,4,e,t)}function is(e,t){return Jo(4,2,e,t)}function rs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ns(e,t,i){return i=null!=i?i.concat([e]):null,Jo(4,2,rs.bind(null,t,e),i)}function os(){}function ss(e,t){return Ho().memoizedState=[e,void 0===t?null:t],e}function as(e,t){var i=Go();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&Uo(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function ls(e,t){var i=Go();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&Uo(t,r[1])?r[0]:(e=e(),i.memoizedState=[e,t],e)}function cs(e,t,i){var r=Bn();Nn(98>r?98:r,(function(){e(!0)})),Nn(97<r?97:r,(function(){var r=Bo.suspense;Bo.suspense=void 0===t?null:t;try{e(!1),i()}finally{Bo.suspense=r}}))}function us(e,t,i){var r=Ua(),n=ao.suspense;n={expirationTime:r=Wa(r,e,n),suspenseConfig:n,action:i,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?n.next=n:(n.next=o.next,o.next=n),t.pending=n,o=e.alternate,e===No||null!==o&&o===No)zo=!0,n.expirationTime=Io,No.expirationTime=Io;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,i);if(n.eagerReducer=o,n.eagerState=a,Tr(a,s))return}catch(e){}Ha(e,r)}}var hs={readContext:Qn,useCallback:Vo,useContext:Vo,useEffect:Vo,useImperativeHandle:Vo,useLayoutEffect:Vo,useMemo:Vo,useReducer:Vo,useRef:Vo,useState:Vo,useDebugValue:Vo,useResponder:Vo,useDeferredValue:Vo,useTransition:Vo},ds={readContext:Qn,useCallback:ss,useContext:Qn,useEffect:es,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,Qo(4,2,rs.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Qo(4,2,e,t)},useMemo:function(e,t){var i=Ho();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var r=Ho();return t=void 0!==i?i(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=us.bind(null,No,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ho().memoizedState=e},useState:qo,useDebugValue:os,useResponder:Ro,useDeferredValue:function(e,t){var i=qo(e),r=i[0],n=i[1];return es((function(){var i=Bo.suspense;Bo.suspense=void 0===t?null:t;try{n(e)}finally{Bo.suspense=i}}),[e,t]),r},useTransition:function(e){var t=qo(!1),i=t[0];return t=t[1],[ss(cs.bind(null,t,e),[t,e]),i]}},ps={readContext:Qn,useCallback:as,useContext:Qn,useEffect:ts,useImperativeHandle:ns,useLayoutEffect:is,useMemo:ls,useReducer:Yo,useRef:Zo,useState:function(){return Yo(Xo)},useDebugValue:os,useResponder:Ro,useDeferredValue:function(e,t){var i=Yo(Xo),r=i[0],n=i[1];return ts((function(){var i=Bo.suspense;Bo.suspense=void 0===t?null:t;try{n(e)}finally{Bo.suspense=i}}),[e,t]),r},useTransition:function(e){var t=Yo(Xo),i=t[0];return t=t[1],[as(cs.bind(null,t,e),[t,e]),i]}},fs={readContext:Qn,useCallback:as,useContext:Qn,useEffect:ts,useImperativeHandle:ns,useLayoutEffect:is,useMemo:ls,useReducer:$o,useRef:Zo,useState:function(){return $o(Xo)},useDebugValue:os,useResponder:Ro,useDeferredValue:function(e,t){var i=$o(Xo),r=i[0],n=i[1];return ts((function(){var i=Bo.suspense;Bo.suspense=void 0===t?null:t;try{n(e)}finally{Bo.suspense=i}}),[e,t]),r},useTransition:function(e){var t=$o(Xo),i=t[0];return t=t[1],[as(cs.bind(null,t,e),[t,e]),i]}},ms=null,gs=null,vs=!1;function bs(e,t){var i=gl(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=t,i.return=e,i.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function _s(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function ys(e){if(vs){var t=gs;if(t){var i=t;if(!_s(e,t)){if(!(t=mi(i.nextSibling))||!_s(e,t))return e.effectTag=-1025&e.effectTag|2,vs=!1,void(ms=e);bs(ms,i)}ms=e,gs=mi(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,vs=!1,ms=e}}function xs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ms=e}function ws(e){if(e!==ms)return!1;if(!vs)return xs(e),vs=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!di(t,e.memoizedProps))for(t=gs;t;)bs(e,t),t=mi(t.nextSibling);if(xs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){gs=mi(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}gs=null}}else gs=ms?mi(e.stateNode.nextSibling):null;return!0}function Ms(){gs=ms=null,vs=!1}var Ps=q.ReactCurrentOwner,Es=!1;function Ss(e,t,i,r){t.child=null===e?xo(t,null,i,r):yo(t,e.child,i,r)}function Cs(e,t,i,r,n){i=i.render;var o=t.ref;return Zn(t,n),r=Wo(e,t,i,r,o,n),null===e||Es?(t.effectTag|=1,Ss(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=n&&(e.expirationTime=0),Hs(e,t,n))}function ks(e,t,i,r,n,o){if(null===e){var s=i.type;return"function"!=typeof s||vl(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=_l(i.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Os(e,t,s,r,n,o))}return s=e.child,n<o&&(n=s.memoizedProps,(i=null!==(i=i.compare)?i:Rr)(n,r)&&e.ref===t.ref)?Hs(e,t,o):(t.effectTag|=1,(e=bl(s,r)).ref=t.ref,e.return=t,t.child=e)}function Os(e,t,i,r,n,o){return null!==e&&Rr(e.memoizedProps,r)&&e.ref===t.ref&&(Es=!1,n<o)?(t.expirationTime=e.expirationTime,Hs(e,t,o)):Ts(e,t,i,r,o)}function As(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.effectTag|=128)}function Ts(e,t,i,r,n){var o=un(i)?ln:sn.current;return o=cn(t,o),Zn(t,n),i=Wo(e,t,i,r,o,n),null===e||Es?(t.effectTag|=1,Ss(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=n&&(e.expirationTime=0),Hs(e,t,n))}function Ds(e,t,i,r,n){if(un(i)){var o=!0;fn(t)}else o=!1;if(Zn(t,n),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),po(t,i,r),mo(t,i,r,n),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=i.contextType;c="object"==typeof c&&null!==c?Qn(c):cn(t,c=un(i)?ln:sn.current);var u=i.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&fo(t,s,r,c),Jn=!1;var d=t.memoizedState;s.state=d,oo(t,r,s,n),l=t.memoizedState,a!==r||d!==l||an.current||Jn?("function"==typeof u&&(co(t,i,u,r),l=t.memoizedState),(a=Jn||ho(t,i,a,r,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.effectTag|=4)):("function"==typeof s.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"==typeof s.componentDidMount&&(t.effectTag|=4),r=!1)}else s=t.stateNode,to(e,t),a=t.memoizedProps,s.props=t.type===t.elementType?a:Wn(t.type,a),l=s.context,c="object"==typeof(c=i.contextType)&&null!==c?Qn(c):cn(t,c=un(i)?ln:sn.current),(h="function"==typeof(u=i.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==c)&&fo(t,s,r,c),Jn=!1,l=t.memoizedState,s.state=l,oo(t,r,s,n),d=t.memoizedState,a!==r||l!==d||an.current||Jn?("function"==typeof u&&(co(t,i,u,r),d=t.memoizedState),(u=Jn||ho(t,i,a,r,l,d,c))?(h||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,c)),"function"==typeof s.componentDidUpdate&&(t.effectTag|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=d),s.props=r,s.state=d,s.context=c,r=u):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),r=!1);return Rs(e,t,i,r,o,n)}function Rs(e,t,i,r,n,o){As(e,t);var s=0!=(64&t.effectTag);if(!r&&!s)return n&&mn(t,i,!1),Hs(e,t,o);r=t.stateNode,Ps.current=t;var a=s&&"function"!=typeof i.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&s?(t.child=yo(t,e.child,null,o),t.child=yo(t,null,a,o)):Ss(e,t,a,o),t.memoizedState=r.state,n&&mn(t,i,!0),t.child}function Ls(e){var t=e.stateNode;t.pendingContext?dn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&dn(0,t.context,!1),Co(e,t.containerInfo)}var Bs,Is,Ns,js,Fs={dehydrated:null,retryTime:0};function zs(e,t,i){var r,n=t.mode,o=t.pendingProps,s=To.current,a=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&s)&&(null===e||null!==e.memoizedState)),r?(a=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(s|=1),nn(To,1&s),null===e){if(void 0!==o.fallback&&ys(t),a){if(a=o.fallback,(o=yl(null,n,0,null)).return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(i=yl(a,n,i,null)).return=t,o.sibling=i,t.memoizedState=Fs,t.child=o,i}return n=o.children,t.memoizedState=null,t.child=xo(t,null,n,i)}if(null!==e.memoizedState){if(n=(e=e.child).sibling,a){if(o=o.fallback,(i=bl(e,e.pendingProps)).return=t,0==(2&t.mode)&&(a=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(i.child=a;null!==a;)a.return=i,a=a.sibling;return(n=bl(n,o)).return=t,i.sibling=n,i.childExpirationTime=0,t.memoizedState=Fs,t.child=i,n}return i=yo(t,e.child,o.children,i),t.memoizedState=null,t.child=i}if(e=e.child,a){if(a=o.fallback,(o=yl(null,n,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(i=yl(a,n,i,null)).return=t,o.sibling=i,i.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Fs,t.child=o,i}return t.memoizedState=null,t.child=yo(t,e,o.children,i)}function Vs(e,t){e.expirationTime<t&&(e.expirationTime=t);var i=e.alternate;null!==i&&i.expirationTime<t&&(i.expirationTime=t),Kn(e.return,t)}function Us(e,t,i,r,n,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailExpiration:0,tailMode:n,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=i,s.tailExpiration=0,s.tailMode=n,s.lastEffect=o)}function Ws(e,t,i){var r=t.pendingProps,n=r.revealOrder,o=r.tail;if(Ss(e,t,r.children,i),0!=(2&(r=To.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,i);else if(19===e.tag)Vs(e,i);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(nn(To,r),0==(2&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;null!==i;)null!==(e=i.alternate)&&null===Do(e)&&(n=i),i=i.sibling;null===(i=n)?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),Us(t,!1,n,i,o,t.lastEffect);break;case"backwards":for(i=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===Do(e)){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}Us(t,!0,i,null,o,t.lastEffect);break;case"together":Us(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Hs(e,t,i){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&tl(r),t.childExpirationTime<i)return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(i=bl(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=bl(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Gs(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xs(e,t,i){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return un(t.type)&&hn(),null;case 3:return ko(),rn(an),rn(sn),(i=t.stateNode).pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||!ws(t)||(t.effectTag|=4),Is(t),null;case 5:Ao(t),i=So(Eo.current);var o=t.type;if(null!==e&&null!=t.stateNode)Ns(e,t,o,r,i),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=So(Mo.current),ws(t)){r=t.stateNode,o=t.type;var a=t.memoizedProps;switch(r[bi]=t,r[_i]=a,o){case"iframe":case"object":case"embed":Ht("load",r);break;case"video":case"audio":for(e=0;e<Ye.length;e++)Ht(Ye[e],r);break;case"source":Ht("error",r);break;case"img":case"image":case"link":Ht("error",r),Ht("load",r);break;case"form":Ht("reset",r),Ht("submit",r);break;case"details":Ht("toggle",r);break;case"input":we(r,a),Ht("invalid",r),ii(i,"onChange");break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ht("invalid",r),ii(i,"onChange");break;case"textarea":Ae(r,a),Ht("invalid",r),ii(i,"onChange")}for(var l in Jt(o,a),e=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?r.textContent!==c&&(e=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(e=["children",""+c]):M.hasOwnProperty(l)&&null!=c&&ii(i,l)}switch(o){case"input":_e(r),Ee(r,a,!0);break;case"textarea":_e(r),De(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=ri)}i=e,t.updateQueue=i,null!==i&&(t.effectTag|=4)}else{switch(l=9===i.nodeType?i:i.ownerDocument,e===ti&&(e=Re(o)),e===ti?"script"===o?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(o,{is:r.is}):(e=l.createElement(o),"select"===o&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,o),e[bi]=t,e[_i]=r,Bs(e,t,!1,!1),t.stateNode=e,l=ei(o,r),o){case"iframe":case"object":case"embed":Ht("load",e),c=r;break;case"video":case"audio":for(c=0;c<Ye.length;c++)Ht(Ye[c],e);c=r;break;case"source":Ht("error",e),c=r;break;case"img":case"image":case"link":Ht("error",e),Ht("load",e),c=r;break;case"form":Ht("reset",e),Ht("submit",e),c=r;break;case"details":Ht("toggle",e),c=r;break;case"input":we(e,r),c=xe(e,r),Ht("invalid",e),ii(i,"onChange");break;case"option":c=Ce(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},c=n({},r,{value:void 0}),Ht("invalid",e),ii(i,"onChange");break;case"textarea":Ae(e,r),c=Oe(e,r),Ht("invalid",e),ii(i,"onChange");break;default:c=r}Jt(o,c);var u=c;for(a in u)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?Zt(e,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&Ie(e,h):"children"===a?"string"==typeof h?("textarea"!==o||""!==h)&&Ne(e,h):"number"==typeof h&&Ne(e,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(M.hasOwnProperty(a)?null!=h&&ii(i,a):null!=h&&K(e,a,h,l))}switch(o){case"input":_e(e),Ee(e,r,!1);break;case"textarea":_e(e),De(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ve(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ke(e,!!r.multiple,i,!1):null!=r.defaultValue&&ke(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof c.onClick&&(e.onclick=ri)}hi(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)js(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));i=So(Eo.current),So(Mo.current),ws(t)?(i=t.stateNode,r=t.memoizedProps,i[bi]=t,i.nodeValue!==r&&(t.effectTag|=4)):((i=(9===i.nodeType?i:i.ownerDocument).createTextNode(r))[bi]=t,t.stateNode=i)}return null;case 13:return rn(To),r=t.memoizedState,0!=(64&t.effectTag)?(t.expirationTime=i,t):(i=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&ws(t):(r=null!==(o=e.memoizedState),i||null===o||null!==(o=e.child.sibling)&&(null!==(a=t.firstEffect)?(t.firstEffect=o,o.nextEffect=a):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),i&&!r&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&To.current)?Ma===ga&&(Ma=va):(Ma!==ga&&Ma!==va||(Ma=ba),0!==ka&&null!==ya&&(Pl(ya,wa),El(ya,ka)))),(i||r)&&(t.effectTag|=4),null);case 4:return ko(),Is(t),null;case 10:return qn(t),null;case 17:return un(t.type)&&hn(),null;case 19:if(rn(To),null===(r=t.memoizedState))return null;if(o=0!=(64&t.effectTag),null===(a=r.rendering)){if(o)Gs(r,!1);else if(Ma!==ga||null!==e&&0!=(64&e.effectTag))for(a=t.child;null!==a;){if(null!==(e=Do(a))){for(t.effectTag|=64,Gs(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)a=i,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=a,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,a=e.dependencies,o.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),r=r.sibling;return nn(To,1&To.current|2),t.child}a=a.sibling}}else{if(!o)if(null!==(e=Do(a))){if(t.effectTag|=64,o=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.effectTag|=4),Gs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ln()-r.renderingStartTime>r.tailExpiration&&1<i&&(t.effectTag|=64,o=!0,Gs(r,!1),t.expirationTime=t.childExpirationTime=i-1);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(i=r.last)?i.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Ln()+500),i=r.tail,r.rendering=i,r.tail=i.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ln(),i.sibling=null,t=To.current,nn(To,o?1&t|2:1&t),i):null}throw Error(s(156,t.tag))}function Ys(e){switch(e.tag){case 1:un(e.type)&&hn();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(ko(),rn(an),rn(sn),0!=(64&(t=e.effectTag)))throw Error(s(285));return e.effectTag=-4097&t|64,e;case 5:return Ao(e),null;case 13:return rn(To),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return rn(To),null;case 4:return ko(),null;case 10:return qn(e),null;default:return null}}function $s(e,t){return{value:e,source:t,stack:ge(t)}}Bs=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Is=function(){},Ns=function(e,t,i,r,o){var s=e.memoizedProps;if(s!==r){var a,l,c=t.stateNode;switch(So(Mo.current),e=null,i){case"input":s=xe(c,s),r=xe(c,r),e=[];break;case"option":s=Ce(c,s),r=Ce(c,r),e=[];break;case"select":s=n({},s,{value:void 0}),r=n({},r,{value:void 0}),e=[];break;case"textarea":s=Oe(c,s),r=Oe(c,r),e=[];break;default:"function"!=typeof s.onClick&&"function"==typeof r.onClick&&(c.onclick=ri)}for(a in Jt(i,r),i=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(l in c=s[a])c.hasOwnProperty(l)&&(i||(i={}),i[l]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(M.hasOwnProperty(a)?e||(e=[]):(e=e||[]).push(a,null));for(a in r){var u=r[a];if(c=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&u!==c&&(null!=u||null!=c))if("style"===a)if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(i||(i={}),i[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(i||(i={}),i[l]=u[l])}else i||(e||(e=[]),e.push(a,i)),i=u;else"dangerouslySetInnerHTML"===a?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(e=e||[]).push(a,u)):"children"===a?c===u||"string"!=typeof u&&"number"!=typeof u||(e=e||[]).push(a,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(M.hasOwnProperty(a)?(null!=u&&ii(o,a),e||c===u||(e=[])):(e=e||[]).push(a,u))}i&&(e=e||[]).push("style",i),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},js=function(e,t,i,r){i!==r&&(t.effectTag|=4)};var qs="function"==typeof WeakSet?WeakSet:Set;function Ks(e,t){var i=t.source,r=t.stack;null===r&&null!==i&&(r=ge(i)),null!==i&&me(i.type),t=t.value,null!==e&&1===e.tag&&me(e.type);try{console.error(t)}catch(e){setTimeout((function(){throw e}))}}function Zs(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){dl(e,t)}else t.current=null}function Qs(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.effectTag&&null!==e){var i=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?i:Wn(t.type,i),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(s(163))}function Js(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var r=i.destroy;i.destroy=void 0,void 0!==r&&r()}i=i.next}while(i!==t)}}function ea(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var r=i.create;i.destroy=r()}i=i.next}while(i!==t)}}function ta(e,t,i){switch(i.tag){case 0:case 11:case 15:case 22:return void ea(3,i);case 1:if(e=i.stateNode,4&i.effectTag)if(null===t)e.componentDidMount();else{var r=i.elementType===i.type?t.memoizedProps:Wn(i.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=i.updateQueue)&&so(i,t,e));case 3:if(null!==(t=i.updateQueue)){if(e=null,null!==i.child)switch(i.child.tag){case 5:e=i.child.stateNode;break;case 1:e=i.child.stateNode}so(i,t,e)}return;case 5:return e=i.stateNode,void(null===t&&4&i.effectTag&&hi(i.type,i.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===i.memoizedState&&(i=i.alternate,null!==i&&(i=i.memoizedState,null!==i&&(i=i.dehydrated,null!==i&&Rt(i)))));case 19:case 17:case 20:case 21:return}throw Error(s(163))}function ia(e,t,i){switch("function"==typeof ml&&ml(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Nn(97<i?97:i,(function(){var e=r;do{var i=e.destroy;if(void 0!==i){var n=t;try{i()}catch(e){dl(n,e)}}e=e.next}while(e!==r)}))}break;case 1:Zs(t),"function"==typeof(i=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){dl(e,t)}}(t,i);break;case 5:Zs(t);break;case 4:sa(e,t,i)}}function ra(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&ra(t)}function na(e){return 5===e.tag||3===e.tag||4===e.tag}function oa(e){e:{for(var t=e.return;null!==t;){if(na(t)){var i=t;break e}t=t.return}throw Error(s(160))}switch(t=i.stateNode,i.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&i.effectTag&&(Ne(t,""),i.effectTag&=-17);e:t:for(i=e;;){for(;null===i.sibling;){if(null===i.return||na(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.effectTag)continue t;if(null===i.child||4===i.tag)continue t;i.child.return=i,i=i.child}if(!(2&i.effectTag)){i=i.stateNode;break e}}r?function e(t,i,r){var n=t.tag,o=5===n||6===n;if(o)t=o?t.stateNode:t.stateNode.instance,i?8===r.nodeType?r.parentNode.insertBefore(t,i):r.insertBefore(t,i):(8===r.nodeType?(i=r.parentNode).insertBefore(t,r):(i=r).appendChild(t),null!=(r=r._reactRootContainer)||null!==i.onclick||(i.onclick=ri));else if(4!==n&&null!==(t=t.child))for(e(t,i,r),t=t.sibling;null!==t;)e(t,i,r),t=t.sibling}(e,i,t):function e(t,i,r){var n=t.tag,o=5===n||6===n;if(o)t=o?t.stateNode:t.stateNode.instance,i?r.insertBefore(t,i):r.appendChild(t);else if(4!==n&&null!==(t=t.child))for(e(t,i,r),t=t.sibling;null!==t;)e(t,i,r),t=t.sibling}(e,i,t)}function sa(e,t,i){for(var r,n,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:n=!1;break e;case 3:case 4:r=r.containerInfo,n=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag){e:for(var l=e,c=o,u=i,h=c;;)if(ia(l,h,u),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===c)break e;for(;null===h.sibling;){if(null===h.return||h.return===c)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}n?(l=r,c=o.stateNode,8===l.nodeType?l.parentNode.removeChild(c):l.removeChild(c)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,n=!0,o.child.return=o,o=o.child;continue}}else if(ia(e,o,i),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function aa(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Js(3,t);case 1:return;case 5:var i=t.stateNode;if(null!=i){var r=t.memoizedProps,n=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(i[_i]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Me(i,r),ei(e,n),t=ei(e,r),n=0;n<o.length;n+=2){var a=o[n],l=o[n+1];"style"===a?Zt(i,l):"dangerouslySetInnerHTML"===a?Ie(i,l):"children"===a?Ne(i,l):K(i,a,l,t)}switch(e){case"input":Pe(i,r);break;case"textarea":Te(i,r);break;case"select":t=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?ke(i,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?ke(i,!!r.multiple,r.defaultValue,!0):ke(i,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Rt(t.containerInfo)));case 12:return;case 13:if(i=t,null===t.memoizedState?r=!1:(r=!0,i=t.child,Aa=Ln()),null!==i)e:for(e=i;;){if(5===e.tag)o=e.stateNode,r?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,n=void 0!==(n=e.memoizedProps.style)&&null!==n&&n.hasOwnProperty("display")?n.display:null,o.style.display=Kt("display",n));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===i)break;for(;null===e.sibling;){if(null===e.return||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void la(t);case 19:return void la(t);case 17:return}throw Error(s(163))}function la(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new qs),t.forEach((function(t){var r=function(e,t){var i=e.stateNode;null!==i&&i.delete(t),0==(t=0)&&(t=Wa(t=Ua(),e,null)),null!==(e=Ga(e,t))&&Ya(e)}.bind(null,e,t);i.has(t)||(i.add(t),t.then(r,r))}))}}var ca="function"==typeof WeakMap?WeakMap:Map;function ua(e,t,i){(i=io(i,null)).tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){Da||(Da=!0,Ra=r),Ks(e,t)},i}function ha(e,t,i){(i=io(i,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var n=t.value;i.payload=function(){return Ks(e,t),r(n)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(i.callback=function(){"function"!=typeof r&&(null===La?La=new Set([this]):La.add(this),Ks(e,t));var i=t.stack;this.componentDidCatch(t.value,{componentStack:null!==i?i:""})}),i}var da,pa=Math.ceil,fa=q.ReactCurrentDispatcher,ma=q.ReactCurrentOwner,ga=0,va=3,ba=4,_a=0,ya=null,xa=null,wa=0,Ma=ga,Pa=null,Ea=1073741823,Sa=1073741823,Ca=null,ka=0,Oa=!1,Aa=0,Ta=null,Da=!1,Ra=null,La=null,Ba=!1,Ia=null,Na=90,ja=null,Fa=0,za=null,Va=0;function Ua(){return 0!=(48&_a)?1073741821-(Ln()/10|0):0!==Va?Va:Va=1073741821-(Ln()/10|0)}function Wa(e,t,i){if(0==(2&(t=t.mode)))return 1073741823;var r=Bn();if(0==(4&t))return 99===r?1073741823:1073741822;if(0!=(16&_a))return wa;if(null!==i)e=Un(e,0|i.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=Un(e,150,100);break;case 97:case 96:e=Un(e,5e3,250);break;case 95:e=2;break;default:throw Error(s(326))}return null!==ya&&e===wa&&--e,e}function Ha(e,t){if(50<Fa)throw Fa=0,za=null,Error(s(185));if(null!==(e=Ga(e,t))){var i=Bn();1073741823===t?0!=(8&_a)&&0==(48&_a)?$a(e):(Ya(e),0===_a&&zn()):Ya(e),0==(4&_a)||98!==i&&99!==i||(null===ja?ja=new Map([[e,t]]):(void 0===(i=ja.get(e))||i>t)&&ja.set(e,t))}}function Ga(e,t){e.expirationTime<t&&(e.expirationTime=t);var i=e.alternate;null!==i&&i.expirationTime<t&&(i.expirationTime=t);var r=e.return,n=null;if(null===r&&3===e.tag)n=e.stateNode;else for(;null!==r;){if(i=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==i&&i.childExpirationTime<t&&(i.childExpirationTime=t),null===r.return&&3===r.tag){n=r.stateNode;break}r=r.return}return null!==n&&(ya===n&&(tl(t),Ma===ba&&Pl(n,wa)),El(n,t)),n}function Xa(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Ml(e,t=e.firstPendingTime))return t;var i=e.lastPingedTime;return 2>=(e=i>(e=e.nextKnownPendingLevel)?i:e)&&t!==e?0:e}function Ya(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Fn($a.bind(null,e));else{var t=Xa(e),i=e.callbackNode;if(0===t)null!==i&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=Ua();if(r=1073741823===t?99:1===t||2===t?95:0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==i){var n=e.callbackPriority;if(e.callbackExpirationTime===t&&n>=r)return;i!==Cn&&bn(i)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?Fn($a.bind(null,e)):jn(r,function e(t,i){if(Va=0,i)return Sl(t,i=Ua()),Ya(t),null;var r=Xa(t);if(0!==r){if(i=t.callbackNode,0!=(48&_a))throw Error(s(327));if(cl(),t===ya&&r===wa||Za(t,r),null!==xa){var n=_a;_a|=16;for(var o=Ja();;)try{rl();break}catch(e){Qa(t,e)}if($n(),_a=n,fa.current=o,1===Ma)throw i=Pa,Za(t,r),Pl(t,r),Ya(t),i;if(null===xa)switch(o=t.finishedWork=t.current.alternate,t.finishedExpirationTime=r,n=Ma,ya=null,n){case ga:case 1:throw Error(s(345));case 2:Sl(t,2<r?2:r);break;case va:if(Pl(t,r),r===(n=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=sl(o)),1073741823===Ea&&10<(o=Aa+500-Ln())){if(Oa){var a=t.lastPingedTime;if(0===a||a>=r){t.lastPingedTime=r,Za(t,r);break}}if(0!==(a=Xa(t))&&a!==r)break;if(0!==n&&n!==r){t.lastPingedTime=n;break}t.timeoutHandle=pi(al.bind(null,t),o);break}al(t);break;case ba:if(Pl(t,r),r===(n=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=sl(o)),Oa&&(0===(o=t.lastPingedTime)||o>=r)){t.lastPingedTime=r,Za(t,r);break}if(0!==(o=Xa(t))&&o!==r)break;if(0!==n&&n!==r){t.lastPingedTime=n;break}if(1073741823!==Sa?n=10*(1073741821-Sa)-Ln():1073741823===Ea?n=0:(n=10*(1073741821-Ea)-5e3,0>(n=(o=Ln())-n)&&(n=0),(r=10*(1073741821-r)-o)<(n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*pa(n/1960))-n)&&(n=r)),10<n){t.timeoutHandle=pi(al.bind(null,t),n);break}al(t);break;case 5:if(1073741823!==Ea&&null!==Ca){a=Ea;var l=Ca;if(0>=(n=0|l.busyMinDurationMs)?n=0:(o=0|l.busyDelayMs,n=(a=Ln()-(10*(1073741821-a)-(0|l.timeoutMs||5e3)))<=o?0:o+n-a),10<n){Pl(t,r),t.timeoutHandle=pi(al.bind(null,t),n);break}}al(t);break;default:throw Error(s(329))}if(Ya(t),t.callbackNode===i)return e.bind(null,t)}}return null}.bind(null,e),{timeout:10*(1073741821-t)-Ln()}),e.callbackNode=t}}}function $a(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,0!=(48&_a))throw Error(s(327));if(cl(),e===ya&&t===wa||Za(e,t),null!==xa){var i=_a;_a|=16;for(var r=Ja();;)try{il();break}catch(t){Qa(e,t)}if($n(),_a=i,fa.current=r,1===Ma)throw i=Pa,Za(e,t),Pl(e,t),Ya(e),i;if(null!==xa)throw Error(s(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,ya=null,al(e),Ya(e)}return null}function qa(e,t){var i=_a;_a|=1;try{return e(t)}finally{0===(_a=i)&&zn()}}function Ka(e,t){var i=_a;_a&=-2,_a|=8;try{return e(t)}finally{0===(_a=i)&&zn()}}function Za(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,fi(i)),null!==xa)for(i=xa.return;null!==i;){var r=i;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&hn();break;case 3:ko(),rn(an),rn(sn);break;case 5:Ao(r);break;case 4:ko();break;case 13:case 19:rn(To);break;case 10:qn(r)}i=i.return}ya=e,xa=bl(e.current,null),wa=t,Ma=ga,Pa=null,Sa=Ea=1073741823,Ca=null,ka=0,Oa=!1}function Qa(e,t){for(;;){try{if($n(),Lo.current=hs,zo)for(var i=No.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}if(Io=0,Fo=jo=No=null,zo=!1,null===xa||null===xa.return)return Ma=1,Pa=t,xa=null;e:{var n=e,o=xa.return,s=xa,a=t;if(t=wa,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var l=a;if(0==(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.expirationTime=c.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var u=0!=(1&To.current),h=o;do{var d;if(d=13===h.tag){var p=h.memoizedState;if(null!==p)d=null!==p.dehydrated;else{var f=h.memoizedProps;d=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!u)}}if(d){var m=h.updateQueue;if(null===m){var g=new Set;g.add(l),h.updateQueue=g}else m.add(l);if(0==(2&h.mode)){if(h.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var v=io(1073741823,null);v.tag=2,ro(s,v)}s.expirationTime=1073741823;break e}a=void 0,s=t;var b=n.pingCache;if(null===b?(b=n.pingCache=new ca,a=new Set,b.set(l,a)):void 0===(a=b.get(l))&&(a=new Set,b.set(l,a)),!a.has(s)){a.add(s);var _=pl.bind(null,n,l,s);l.then(_,_)}h.effectTag|=4096,h.expirationTime=t;break e}h=h.return}while(null!==h);a=Error((me(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ge(s))}5!==Ma&&(Ma=2),a=$s(a,s),h=o;do{switch(h.tag){case 3:l=a,h.effectTag|=4096,h.expirationTime=t,no(h,ua(h,l,t));break e;case 1:l=a;var y=h.type,x=h.stateNode;if(0==(64&h.effectTag)&&("function"==typeof y.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===La||!La.has(x)))){h.effectTag|=4096,h.expirationTime=t,no(h,ha(h,l,t));break e}}h=h.return}while(null!==h)}xa=ol(xa)}catch(e){t=e;continue}break}}function Ja(){var e=fa.current;return fa.current=hs,null===e?hs:e}function el(e,t){e<Ea&&2<e&&(Ea=e),null!==t&&e<Sa&&2<e&&(Sa=e,Ca=t)}function tl(e){e>ka&&(ka=e)}function il(){for(;null!==xa;)xa=nl(xa)}function rl(){for(;null!==xa&&!kn();)xa=nl(xa)}function nl(e){var t=da(e.alternate,e,wa);return e.memoizedProps=e.pendingProps,null===t&&(t=ol(e)),ma.current=null,t}function ol(e){xa=e;do{var t=xa.alternate;if(e=xa.return,0==(2048&xa.effectTag)){if(t=Xs(t,xa,wa),1===wa||1!==xa.childExpirationTime){for(var i=0,r=xa.child;null!==r;){var n=r.expirationTime,o=r.childExpirationTime;n>i&&(i=n),o>i&&(i=o),r=r.sibling}xa.childExpirationTime=i}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=xa.firstEffect),null!==xa.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=xa.firstEffect),e.lastEffect=xa.lastEffect),1<xa.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=xa:e.firstEffect=xa,e.lastEffect=xa))}else{if(null!==(t=Ys(xa)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=xa.sibling))return t;xa=e}while(null!==xa);return Ma===ga&&(Ma=5),null}function sl(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function al(e){var t=Bn();return Nn(99,function(e,t){do{cl()}while(null!==Ia);if(0!=(48&_a))throw Error(s(327));var i=e.finishedWork,r=e.finishedExpirationTime;if(null===i)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,i===e.current)throw Error(s(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var n=sl(i);if(e.firstPendingTime=n,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===ya&&(xa=ya=null,wa=0),1<i.effectTag?null!==i.lastEffect?(i.lastEffect.nextEffect=i,n=i.firstEffect):n=i:n=i.firstEffect,null!==n){var o=_a;_a|=32,ma.current=null,ci=Wt;var a=ai();if(li(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{var c=(l=(l=a.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(c&&0!==c.rangeCount){l=c.anchorNode;var u=c.anchorOffset,h=c.focusNode;c=c.focusOffset;try{l.nodeType,h.nodeType}catch(e){l=null;break e}var d=0,p=-1,f=-1,m=0,g=0,v=a,b=null;t:for(;;){for(var _;v!==l||0!==u&&3!==v.nodeType||(p=d+u),v!==h||0!==c&&3!==v.nodeType||(f=d+c),3===v.nodeType&&(d+=v.nodeValue.length),null!==(_=v.firstChild);)b=v,v=_;for(;;){if(v===a)break t;if(b===l&&++m===u&&(p=d),b===h&&++g===c&&(f=d),null!==(_=v.nextSibling))break;b=(v=b).parentNode}v=_}l=-1===p||-1===f?null:{start:p,end:f}}else l=null}l=l||{start:0,end:0}}else l=null;ui={activeElementDetached:null,focusedElem:a,selectionRange:l},Wt=!1,Ta=n;do{try{ll()}catch(e){if(null===Ta)throw Error(s(330));dl(Ta,e),Ta=Ta.nextEffect}}while(null!==Ta);Ta=n;do{try{for(a=e,l=t;null!==Ta;){var y=Ta.effectTag;if(16&y&&Ne(Ta.stateNode,""),128&y){var x=Ta.alternate;if(null!==x){var w=x.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&y){case 2:oa(Ta),Ta.effectTag&=-3;break;case 6:oa(Ta),Ta.effectTag&=-3,aa(Ta.alternate,Ta);break;case 1024:Ta.effectTag&=-1025;break;case 1028:Ta.effectTag&=-1025,aa(Ta.alternate,Ta);break;case 4:aa(Ta.alternate,Ta);break;case 8:sa(a,u=Ta,l),ra(u)}Ta=Ta.nextEffect}}catch(e){if(null===Ta)throw Error(s(330));dl(Ta,e),Ta=Ta.nextEffect}}while(null!==Ta);if(w=ui,x=ai(),y=w.focusedElem,l=w.selectionRange,x!==y&&y&&y.ownerDocument&&function e(t,i){return!(!t||!i)&&(t===i||(!t||3!==t.nodeType)&&(i&&3===i.nodeType?e(t,i.parentNode):"contains"in t?t.contains(i):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(i))))}(y.ownerDocument.documentElement,y)){null!==l&&li(y)&&(x=l.start,void 0===(w=l.end)&&(w=x),"selectionStart"in y?(y.selectionStart=x,y.selectionEnd=Math.min(w,y.value.length)):(w=(x=y.ownerDocument||document)&&x.defaultView||window).getSelection&&(w=w.getSelection(),u=y.textContent.length,a=Math.min(l.start,u),l=void 0===l.end?a:Math.min(l.end,u),!w.extend&&a>l&&(u=l,l=a,a=u),u=si(y,a),h=si(y,l),u&&h&&(1!==w.rangeCount||w.anchorNode!==u.node||w.anchorOffset!==u.offset||w.focusNode!==h.node||w.focusOffset!==h.offset)&&((x=x.createRange()).setStart(u.node,u.offset),w.removeAllRanges(),a>l?(w.addRange(x),w.extend(h.node,h.offset)):(x.setEnd(h.node,h.offset),w.addRange(x))))),x=[];for(w=y;w=w.parentNode;)1===w.nodeType&&x.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof y.focus&&y.focus(),y=0;y<x.length;y++)(w=x[y]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Wt=!!ci,ui=ci=null,e.current=i,Ta=n;do{try{for(y=e;null!==Ta;){var M=Ta.effectTag;if(36&M&&ta(y,Ta.alternate,Ta),128&M){x=void 0;var P=Ta.ref;if(null!==P){var E=Ta.stateNode;switch(Ta.tag){case 5:x=E;break;default:x=E}"function"==typeof P?P(x):P.current=x}}Ta=Ta.nextEffect}}catch(e){if(null===Ta)throw Error(s(330));dl(Ta,e),Ta=Ta.nextEffect}}while(null!==Ta);Ta=null,On(),_a=o}else e.current=i;if(Ba)Ba=!1,Ia=e,Na=t;else for(Ta=n;null!==Ta;)t=Ta.nextEffect,Ta.nextEffect=null,Ta=t;if(0===(t=e.firstPendingTime)&&(La=null),1073741823===t?e===za?Fa++:(Fa=0,za=e):Fa=0,"function"==typeof fl&&fl(i.stateNode,r),Ya(e),Da)throw Da=!1,e=Ra,Ra=null,e;return 0!=(8&_a)||zn(),null}.bind(null,e,t)),null}function ll(){for(;null!==Ta;){var e=Ta.effectTag;0!=(256&e)&&Qs(Ta.alternate,Ta),0==(512&e)||Ba||(Ba=!0,jn(97,(function(){return cl(),null}))),Ta=Ta.nextEffect}}function cl(){if(90!==Na){var e=97<Na?97:Na;return Na=90,Nn(e,ul)}}function ul(){if(null===Ia)return!1;var e=Ia;if(Ia=null,0!=(48&_a))throw Error(s(331));var t=_a;for(_a|=32,e=e.current.firstEffect;null!==e;){try{var i=e;if(0!=(512&i.effectTag))switch(i.tag){case 0:case 11:case 15:case 22:Js(5,i),ea(5,i)}}catch(t){if(null===e)throw Error(s(330));dl(e,t)}i=e.nextEffect,e.nextEffect=null,e=i}return _a=t,zn(),!0}function hl(e,t,i){ro(e,t=ua(e,t=$s(i,t),1073741823)),null!==(e=Ga(e,1073741823))&&Ya(e)}function dl(e,t){if(3===e.tag)hl(e,e,t);else for(var i=e.return;null!==i;){if(3===i.tag){hl(i,e,t);break}if(1===i.tag){var r=i.stateNode;if("function"==typeof i.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===La||!La.has(r))){ro(i,e=ha(i,e=$s(t,e),1073741823)),null!==(i=Ga(i,1073741823))&&Ya(i);break}}i=i.return}}function pl(e,t,i){var r=e.pingCache;null!==r&&r.delete(t),ya===e&&wa===i?Ma===ba||Ma===va&&1073741823===Ea&&Ln()-Aa<500?Za(e,wa):Oa=!0:Ml(e,i)&&(0!==(t=e.lastPingedTime)&&t<i||(e.lastPingedTime=i,Ya(e)))}da=function(e,t,i){var r=t.expirationTime;if(null!==e){var n=t.pendingProps;if(e.memoizedProps!==n||an.current)Es=!0;else{if(r<i){switch(Es=!1,t.tag){case 3:Ls(t),Ms();break;case 5:if(Oo(t),4&t.mode&&1!==i&&n.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:un(t.type)&&fn(t);break;case 4:Co(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,n=t.type._context,nn(Hn,n._currentValue),n._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=i?zs(e,t,i):(nn(To,1&To.current),null!==(t=Hs(e,t,i))?t.sibling:null);nn(To,1&To.current);break;case 19:if(r=t.childExpirationTime>=i,0!=(64&e.effectTag)){if(r)return Ws(e,t,i);t.effectTag|=64}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null),nn(To,To.current),!r)return null}return Hs(e,t,i)}Es=!1}}else Es=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,n=cn(t,sn.current),Zn(t,i),n=Wo(null,t,r,e,n,i),t.effectTag|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(r)){var o=!0;fn(t)}else o=!1;t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,eo(t);var a=r.getDerivedStateFromProps;"function"==typeof a&&co(t,r,a,e),n.updater=uo,t.stateNode=n,n._reactInternalFiber=t,mo(t,r,e,i),t=Rs(null,t,r,!0,o,i)}else t.tag=0,Ss(null,t,n,i),t=t.child;return t;case 16:e:{if(n=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(n),1!==n._status)throw n._result;switch(n=n._result,t.type=n,o=t.tag=function(e){if("function"==typeof e)return vl(e)?1:0;if(null!=e){if((e=e.$$typeof)===ae)return 11;if(e===ue)return 14}return 2}(n),e=Wn(n,e),o){case 0:t=Ts(null,t,n,e,i);break e;case 1:t=Ds(null,t,n,e,i);break e;case 11:t=Cs(null,t,n,e,i);break e;case 14:t=ks(null,t,n,Wn(n.type,e),r,i);break e}throw Error(s(306,n,""))}return t;case 0:return r=t.type,n=t.pendingProps,Ts(e,t,r,n=t.elementType===r?n:Wn(r,n),i);case 1:return r=t.type,n=t.pendingProps,Ds(e,t,r,n=t.elementType===r?n:Wn(r,n),i);case 3:if(Ls(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,n=null!==(n=t.memoizedState)?n.element:null,to(e,t),oo(t,r,null,i),(r=t.memoizedState.element)===n)Ms(),t=Hs(e,t,i);else{if((n=t.stateNode.hydrate)&&(gs=mi(t.stateNode.containerInfo.firstChild),ms=t,n=vs=!0),n)for(i=xo(t,null,r,i),t.child=i;i;)i.effectTag=-3&i.effectTag|1024,i=i.sibling;else Ss(e,t,r,i),Ms();t=t.child}return t;case 5:return Oo(t),null===e&&ys(t),r=t.type,n=t.pendingProps,o=null!==e?e.memoizedProps:null,a=n.children,di(r,n)?a=null:null!==o&&di(r,o)&&(t.effectTag|=16),As(e,t),4&t.mode&&1!==i&&n.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Ss(e,t,a,i),t=t.child),t;case 6:return null===e&&ys(t),null;case 13:return zs(e,t,i);case 4:return Co(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=yo(t,null,r,i):Ss(e,t,r,i),t.child;case 11:return r=t.type,n=t.pendingProps,Cs(e,t,r,n=t.elementType===r?n:Wn(r,n),i);case 7:return Ss(e,t,t.pendingProps,i),t.child;case 8:case 12:return Ss(e,t,t.pendingProps.children,i),t.child;case 10:e:{r=t.type._context,n=t.pendingProps,a=t.memoizedProps,o=n.value;var l=t.type._context;if(nn(Hn,l._currentValue),l._currentValue=o,null!==a)if(l=a.value,0==(o=Tr(l,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(a.children===n.children&&!an.current){t=Hs(e,t,i);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){a=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&0!=(u.observedBits&o)){1===l.tag&&((u=io(i,null)).tag=2,ro(l,u)),l.expirationTime<i&&(l.expirationTime=i),null!==(u=l.alternate)&&u.expirationTime<i&&(u.expirationTime=i),Kn(l.return,i),c.expirationTime<i&&(c.expirationTime=i);break}u=u.next}}else a=10===l.tag&&l.type===t.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===t){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Ss(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,r=(o=t.pendingProps).children,Zn(t,i),r=r(n=Qn(n,o.unstable_observedBits)),t.effectTag|=1,Ss(e,t,r,i),t.child;case 14:return o=Wn(n=t.type,t.pendingProps),ks(e,t,n,o=Wn(n.type,o),r,i);case 15:return Os(e,t,t.type,t.pendingProps,r,i);case 17:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:Wn(r,n),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,un(r)?(e=!0,fn(t)):e=!1,Zn(t,i),po(t,r,n),mo(t,r,n,i),Rs(null,t,r,!0,e,i);case 19:return Ws(e,t,i)}throw Error(s(156,t.tag))};var fl=null,ml=null;function gl(e,t,i,r){return new function(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}(e,t,i,r)}function vl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function bl(e,t){var i=e.alternate;return null===i?((i=gl(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.effectTag=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childExpirationTime=e.childExpirationTime,i.expirationTime=e.expirationTime,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function _l(e,t,i,r,n,o){var a=2;if(r=e,"function"==typeof e)vl(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case te:return yl(i.children,n,o,t);case se:a=8,n|=7;break;case ie:a=8,n|=1;break;case re:return(e=gl(12,i,t,8|n)).elementType=re,e.type=re,e.expirationTime=o,e;case le:return(e=gl(13,i,t,n)).type=le,e.elementType=le,e.expirationTime=o,e;case ce:return(e=gl(19,i,t,n)).elementType=ce,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case ne:a=10;break e;case oe:a=9;break e;case ae:a=11;break e;case ue:a=14;break e;case he:a=16,r=null;break e;case de:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=gl(a,i,t,n)).elementType=e,t.type=r,t.expirationTime=o,t}function yl(e,t,i,r){return(e=gl(7,e,r,t)).expirationTime=i,e}function xl(e,t,i){return(e=gl(6,e,null,t)).expirationTime=i,e}function wl(e,t,i){return(t=gl(4,null!==e.children?e.children:[],e.key,t)).expirationTime=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ml(e,t){var i=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==i&&i>=t&&e<=t}function Pl(e,t){var i=e.firstSuspendedTime,r=e.lastSuspendedTime;i<t&&(e.firstSuspendedTime=t),(r>t||0===i)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function El(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var i=e.firstSuspendedTime;0!==i&&(t>=i?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Sl(e,t){var i=e.lastExpiredTime;(0===i||i>t)&&(e.lastExpiredTime=t)}function Cl(e,t,i,r){var n=t.current,o=Ua(),a=ao.suspense;o=Wa(o,n,a);e:if(i){t:{if(Ke(i=i._reactInternalFiber)!==i||1!==i.tag)throw Error(s(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(un(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(s(171))}if(1===i.tag){var c=i.type;if(un(c)){i=pn(i,c,l);break e}}i=l}else i=on;return null===t.context?t.context=i:t.pendingContext=i,(t=io(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ro(n,t),Ha(n,o),o}function kl(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Ol(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Al(e,t){Ol(e,t),(e=e.alternate)&&Ol(e,t)}function Tl(e,t,i){var r=new function(e,t,i){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}(e,t,i=null!=i&&!0===i.hydrate),n=gl(3,null,null,2===t?7:1===t?3:0);r.current=n,n.stateNode=r,eo(n),e[yi]=r.current,i&&0!==t&&function(e,t){var i=qe(t);Mt.forEach((function(e){ht(e,t,i)})),Pt.forEach((function(e){ht(e,t,i)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Dl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Rl(e,t,i,r,n){var o=i._reactRootContainer;if(o){var s=o._internalRoot;if("function"==typeof n){var a=n;n=function(){var e=kl(s);a.call(e)}}Cl(t,s,e,n)}else{if(o=i._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var i;i=e.lastChild;)e.removeChild(i);return new Tl(e,0,t?{hydrate:!0}:void 0)}(i,r),s=o._internalRoot,"function"==typeof n){var l=n;n=function(){var e=kl(s);l.call(e)}}Ka((function(){Cl(t,s,e,n)}))}return kl(s)}function Ll(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Dl(t))throw Error(s(200));return function(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ee,key:null==r?null:""+r,children:e,containerInfo:t,implementation:i}}(e,t,null,i)}Tl.prototype.render=function(e){Cl(e,this._internalRoot,null,null)},Tl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Cl(null,e,null,(function(){t[yi]=null}))},dt=function(e){if(13===e.tag){var t=Un(Ua(),150,100);Ha(e,t),Al(e,t)}},pt=function(e){13===e.tag&&(Ha(e,3),Al(e,3))},ft=function(e){if(13===e.tag){var t=Ua();Ha(e,t=Wa(t,e,null)),Al(e,t)}},C=function(e,t,i){switch(t){case"input":if(Pe(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var r=i[t];if(r!==e&&r.form===e.form){var n=Pi(r);if(!n)throw Error(s(90));ye(r),Pe(r,n)}}}break;case"textarea":Te(e,i);break;case"select":null!=(t=i.value)&&ke(e,!!i.multiple,t,!1)}},R=qa,L=function(e,t,i,r,n){var o=_a;_a|=4;try{return Nn(98,e.bind(null,t,i,r,n))}finally{0===(_a=o)&&zn()}},B=function(){0==(49&_a)&&(function(){if(null!==ja){var e=ja;ja=null,e.forEach((function(e,t){Sl(t,e),Ya(t)})),zn()}}(),cl())},I=function(e,t){var i=_a;_a|=2;try{return e(t)}finally{0===(_a=i)&&zn()}};var Bl={Events:[wi,Mi,Pi,E,w,Ti,function(e){tt(e,Ai)},T,D,Xt,nt,cl,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;!function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var i=t.inject(e);fl=function(e){try{t.onCommitFiberRoot(i,e,void 0,64==(64&e.current.effectTag))}catch(e){}},ml=function(e){try{t.onCommitFiberUnmount(i,e)}catch(e){}}}catch(e){}}(n({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Je(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:xi,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bl,t.createPortal=Ll,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return null===(e=Je(t))?null:e.stateNode},t.flushSync=function(e,t){if(0!=(48&_a))throw Error(s(187));var i=_a;_a|=1;try{return Nn(99,e.bind(null,t))}finally{_a=i,zn()}},t.hydrate=function(e,t,i){if(!Dl(t))throw Error(s(200));return Rl(null,e,t,!0,i)},t.render=function(e,t,i){if(!Dl(t))throw Error(s(200));return Rl(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Dl(e))throw Error(s(40));return!!e._reactRootContainer&&(Ka((function(){Rl(null,null,e,!1,(function(){e._reactRootContainer=null,e[yi]=null}))})),!0)},t.unstable_batchedUpdates=qa,t.unstable_createPortal=function(e,t){return Ll(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,i,r){if(!Dl(i))throw Error(s(200));if(null==e||void 0===e._reactInternalFiber)throw Error(s(38));return Rl(e,t,i,!1,r)},t.version="16.14.0"},function(e,t,i){"use strict";e.exports=i(219)},function(e,t,i){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r,n,o,s,a;if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,u=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(e){throw setTimeout(u,0),e}},h=Date.now();t.unstable_now=function(){return Date.now()-h},r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(u,0))},n=function(e,t){c=setTimeout(e,t)},o=function(){clearTimeout(c)},s=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var d=window.performance,p=window.Date,f=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var g=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof d&&"function"==typeof d.now)t.unstable_now=function(){return d.now()};else{var v=p.now();t.unstable_now=function(){return p.now()-v}}var b=!1,_=null,y=-1,x=5,w=0;s=function(){return t.unstable_now()>=w},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):x=0<e?Math.floor(1e3/e):5};var M=new MessageChannel,P=M.port2;M.port1.onmessage=function(){if(null!==_){var e=t.unstable_now();w=e+x;try{_(!0,e)?P.postMessage(null):(b=!1,_=null)}catch(e){throw P.postMessage(null),e}}else b=!1},r=function(e){_=e,b||(b=!0,P.postMessage(null))},n=function(e,i){y=f((function(){e(t.unstable_now())}),i)},o=function(){m(y),y=-1}}function E(e,t){var i=e.length;e.push(t);e:for(;;){var r=i-1>>>1,n=e[r];if(!(void 0!==n&&0<k(n,t)))break e;e[r]=t,e[i]=n,i=r}}function S(e){return void 0===(e=e[0])?null:e}function C(e){var t=e[0];if(void 0!==t){var i=e.pop();if(i!==t){e[0]=i;e:for(var r=0,n=e.length;r<n;){var o=2*(r+1)-1,s=e[o],a=o+1,l=e[a];if(void 0!==s&&0>k(s,i))void 0!==l&&0>k(l,s)?(e[r]=l,e[a]=i,r=a):(e[r]=s,e[o]=i,r=o);else{if(!(void 0!==l&&0>k(l,i)))break e;e[r]=l,e[a]=i,r=a}}}return t}return null}function k(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}var O=[],A=[],T=1,D=null,R=3,L=!1,B=!1,I=!1;function N(e){for(var t=S(A);null!==t;){if(null===t.callback)C(A);else{if(!(t.startTime<=e))break;C(A),t.sortIndex=t.expirationTime,E(O,t)}t=S(A)}}function j(e){if(I=!1,N(e),!B)if(null!==S(O))B=!0,r(F);else{var t=S(A);null!==t&&n(j,t.startTime-e)}}function F(e,i){B=!1,I&&(I=!1,o()),L=!0;var r=R;try{for(N(i),D=S(O);null!==D&&(!(D.expirationTime>i)||e&&!s());){var a=D.callback;if(null!==a){D.callback=null,R=D.priorityLevel;var l=a(D.expirationTime<=i);i=t.unstable_now(),"function"==typeof l?D.callback=l:D===S(O)&&C(O),N(i)}else C(O);D=S(O)}if(null!==D)var c=!0;else{var u=S(A);null!==u&&n(j,u.startTime-i),c=!1}return c}finally{D=null,R=r,L=!1}}function z(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var V=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){B||L||(B=!0,r(F))},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_getFirstCallbackNode=function(){return S(O)},t.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var i=R;R=t;try{return e()}finally{R=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=V,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=R;R=e;try{return t()}finally{R=i}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();if("object"==typeof s&&null!==s){var l=s.delay;l="number"==typeof l&&0<l?a+l:a,s="number"==typeof s.timeout?s.timeout:z(e)}else s=z(e),l=a;return e={id:T++,callback:i,priorityLevel:e,startTime:l,expirationTime:s=l+s,sortIndex:-1},l>a?(e.sortIndex=l,E(A,e),null===S(O)&&e===S(A)&&(I?o():I=!0,n(j,l-a))):(e.sortIndex=s,E(O,e),B||L||(B=!0,r(F))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();N(e);var i=S(O);return i!==D&&null!==D&&null!==i&&null!==i.callback&&i.startTime<=e&&i.expirationTime<D.expirationTime||s()},t.unstable_wrapCallback=function(e){var t=R;return function(){var i=R;R=t;try{return e.apply(this,arguments)}finally{R=i}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIMViewer=void 0;const r=i(75),n=i(44),o=i(1),s=i(256),a=i(257),l=i(227),c=i(228),u=i(229),h=i(230),d=i(231),p=i(233),f=i(234),m=i(235),g=i(236),v=i(237),b=i(238),_=i(239),y=i(240),x=i(241),w=i(242),M=i(244),P=i(246),E=i(247),S=i(248),C=i(251),k=i(129),O=i(38),A=i(0),T=i(24),D=i(252),R=A.math.vec3();class L extends o.Component{constructor(e){super(e),this.handleShowAllObjects=e=>{this.setAllObjectsVisible(!0),this.setAllObjectsXRayed(!1),e.preventDefault()},this.handleHideAllObjects=e=>{this.setAllObjectsVisible(!1),e.preventDefault()},this.handleLoadAllModels=e=>{this.setControlsEnabled(!1),this.loadAllModels(),e.preventDefault()},this.handleUnloadAllModels=e=>{this.setControlsEnabled(!1),this.unloadAllModels(),e.preventDefault()},this.handleAddModel=e=>{this._enableAddModels&&(this.fire("addModel",{}),e.preventDefault())},this.modelsExplorerLoaded=e=>{this.getNumModelsLoaded()>0&&this.setControlsEnabled(!0),this.fire("modelLoaded",e)},this.modelsExplorerUnloaded=e=>{0===this.getNumModelsLoaded()&&(this.setControlsEnabled(!1),this.setState({activeTab:"models"})),this.fire("modelUnloaded",e)},this.handleTabChange=(e,t)=>{"storeys"==t&&this.storeysExplorerRef.current&&this.storeysExplorerRef.current.clearStoreySelection(),this.setState({activeTab:t})},this.canvasElementRef=o.createRef(),this.explorerElementRef=o.createRef(),this.modelsExplorerRef=o.createRef(),this.objectsExplorerRef=o.createRef(),this.classesExplorerRef=o.createRef(),this.storeysExplorerRef=o.createRef(),this.toolbarElementRef=o.createRef(),this.navCubeCanvasElementRef=o.createRef(),this.busyModelBackdropElementRef=o.createRef(),this.server=e.server,this._children=[],this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0,this._enabled=null,this._active=null,this._configs={},this._enableAddModels=!!e.enableEditModels,this.state={modelsInfo:null,numModels:0,projectId:null,activeTab:e.defaultTab,showObjectProperties:null,numModelsLoaded:0}}componentDidMount(){const e=this.canvasElementRef.current,t=this.explorerElementRef.current,i=this.toolbarElementRef.current,r=this.navCubeCanvasElementRef.current,n=this.busyModelBackdropElementRef.current;this.viewer=new D.Viewer({canvasElement:e,transparent:!0}),this._xktLoader=new C.XKTLoaderPlugin(this.viewer,{objectDefaults:m.ModelIFCObjectColors}),t.oncontextmenu=e=>{e.preventDefault()},i.oncontextmenu=e=>{e.preventDefault()},r.oncontextmenu=e=>{e.preventDefault()},this._customizeViewer(),this._initCanvasContextMenus(),this._initConfigs(),a.default("[data-tippy-content]",{appendTo:function(){return document.querySelector("#myViewer")}}),this._resetAction=new w.ResetAction(this,{buttonElement:i.querySelector(".xeokit-reset"),active:!1}),this._fitAction=new b.FitAction(this,{buttonElement:i.querySelector(".xeokit-fit"),active:!1});const o=new function(e){let t=!1,i=!1;this.setThreeDModeActive=i=>{i?(e._firstPersonMode.setActive(!1),e.viewer.cameraControl.navMode="orbit"):(e._firstPersonMode.setActive(!1),e.viewer.cameraControl.navMode="planView"),t=i},this.setFirstPersonModeActive=r=>{e.viewer.cameraControl.navMode=r?"firstPerson":t?"orbit":"planView",i=r}}(this);this._threeDMode=new E.ThreeDMode(this,{buttonElement:i.querySelector(".xeokit-threeD"),cameraControlNavModeMediator:o,active:!1}),this._firstPersonMode=new v.FirstPersonMode(this,{buttonElement:i.querySelector(".xeokit-firstPerson"),cameraControlNavModeMediator:o,active:!1}),this._hideTool=new _.HideTool(this,{buttonElement:i.querySelector(".xeokit-hide"),active:!1}),this._selectionTool=new P.SelectionTool(this,{buttonElement:i.querySelector(".xeokit-select"),active:!1}),this._queryTool=new x.QueryTool(this,{buttonElement:i.querySelector(".xeokit-query"),active:!1}),this._sectionTool=new M.SectionTool(this,{buttonElement:i.querySelector(".xeokit-section"),counterElement:i.querySelector(".xeokit-section-counter"),menuButtonElement:i.querySelector(".xeokit-section-menu-button"),menuButtonArrowElement:i.querySelector(".xeokit-section-menu-button-arrow"),active:!1}),this._navCubeMode=new y.NavCubeMode(this,{navCubeCanvasElement:r,active:!0}),this._busyModal=new l.BusyModal(this,{busyModalBackdropElement:n}),this._threeDMode.setActive(!0),this._firstPersonMode.setActive(!1),this._navCubeMode.setActive(!0),this._queryTool.on("queryPicked",e=>{this.fire("queryPicked",e)}),this._queryTool.on("queryNotPicked",()=>{this.fire("queryNotPicked",!0)}),this._queryTool.on("objectSelected",e=>{this.showObjectPropertes(e)}),this._selectionTool.on("objectSelected",e=>{this.showObjectPropertes(e)}),this._resetAction.on("reset",()=>{this.fire("reset",!0)}),this._mutexActivation([this._queryTool,this._hideTool,this._selectionTool,this._sectionTool]),this._bcfViewpointsPlugin=new S.BCFViewpointsPlugin(this.viewer,{})}_customizeViewer(){const e=this.viewer.scene;e.xrayMaterial.fill=!1,e.xrayMaterial.fillAlpha=.1,e.xrayMaterial.fillColor=[0,0,0],e.xrayMaterial.edges=!0,e.xrayMaterial.edgeAlpha=.3,e.xrayMaterial.edgeColor=[0,0,0],e.highlightMaterial.edges=!0,e.highlightMaterial.edgeColor=[.5,.5,0],e.highlightMaterial.edgeAlpha=.9,e.highlightMaterial.fill=!0,e.highlightMaterial.fillAlpha=.1,e.highlightMaterial.fillColor=[1,0,0],e.clearLights(),new k.AmbientLight(e,{color:[.3,.3,.3],intensity:1}),new O.DirLight(e,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"world"}),new O.DirLight(e,{dir:[-.8,-.4,.4],color:[1,1,1],intensity:1,space:"world"}),new O.DirLight(e,{dir:[.2,-.8,.8],color:[.6,.6,.6],intensity:1,space:"world"}),this.viewer.cameraControl.panRightClick=!0,this.viewer.cameraControl.followPointer=!0,this.viewer.cameraControl.doublePickFlyTo=!0,this.viewer.cameraControl.smartPivot=!0,this.viewer.cameraControl.keyboardDollyRate=100,this.viewer.cameraControl.mouseWheelDollyRate=100,this.viewer.cameraControl.dollyInertia=0,this.viewer.cameraControl.dollyMinSpeed=.04,this.viewer.cameraControl.dollyProximityThreshold=30;const t=document.createRange().createContextualFragment("<div class='xeokit-camera-pivot-marker'></div>").firstChild;document.body.appendChild(t),this.viewer.cameraControl.pivotElement=t,e.camera.perspective.near=.01,e.camera.perspective.far=3e3,e.camera.ortho.near=.01,e.camera.ortho.far=3e3;const i=e.sao;i.enabled=!1,i.bias=.5,i.intensity=.2,i.scale=1200,i.kernelRadius=100;var r=200,n=!1;e.camera.on("matrix",()=>{if(this._configs.saoInteractive)return;const t=this._configs.saoInteractiveDelay;r=null!=t?this._configs.saoInteractiveDelay:200,n&&(e.sao.enabled=!1,n=!1)}),e.on("tick",t=>{this._configs.saoInteractive?n||(e.sao.enabled=!!this._configs.saoEnabled,n=!0):n||(r-=t.deltaTime)<=0&&(n||(e.sao.enabled=!!this._configs.saoEnabled,n=!0))})}_initCanvasContextMenus(){this._canvasContextMenu=new c.CanvasContextMenu,this._objectContextMenu=new u.ObjectContextMenu,this.viewer.cameraControl.on("rightClick",e=>{const t=e.event,i=this.viewer.scene.pick({canvasPos:[t.offsetX,t.offsetY]});i&&i.entity.isObject?(this._canvasContextMenu.hide(),this._objectContextMenu.context={viewer:this.viewer,bimViewer:this,showObjectInExplorers:e=>{const t=this.state.activeTab;"objects"!==t&&"classes"!==t&&"storeys"!==t&&this.setState({activeTab:"objects"}),this.showObjectInExplorers(e)},showObjectProperties:e=>{this.showObjectPropertes(e)},entity:i.entity},this._objectContextMenu.show(t.pageX,t.pageY)):(this._objectContextMenu.hide(),this._canvasContextMenu.context={viewer:this.viewer,bimViewer:this},this._canvasContextMenu.show(t.pageX,t.pageY))})}_initConfigs(){this.setConfigs({cameraNear:"0.05",cameraFar:"3000.0",smartPivot:"true",saoEnabled:"false",saoBias:"0.5",saoIntensity:"0.5",saoScale:"1200.0",saoKernelRadius:"100",xrayContext:!0,backgroundColor:[1,1,1],saoInteractive:!0,saoInteractiveDelay:200,objectColorSource:"model"})}setConfigs(e){for(let t in e)if(e.hasOwnProperty(t)){const i=e[t];this.setConfig(t,i)}}setConfig(e,t){function i(e){return!0===e||"true"===e}try{switch(e){case"backgroundColor":const n=t;this.setBackgroundColor(n),this._configs[e]=n;break;case"cameraNear":const o=parseFloat(t);this.viewer.scene.camera.perspective.near=o,this.viewer.scene.camera.ortho.near=o,this._configs[e]=o;break;case"cameraFar":const s=parseFloat(t);this.viewer.scene.camera.perspective.far=s,this.viewer.scene.camera.ortho.far=s,this._configs[e]=s;break;case"smartPivot":this.viewer.cameraControl.smartPivot=this._configs[e]=i(t);break;case"saoEnabled":this.viewer.scene.sao.enabled=this._configs[e]=i(t);break;case"saoBias":this.viewer.scene.sao.bias=parseFloat(t);break;case"saoIntensity":this.viewer.scene.sao.intensity=parseFloat(t);break;case"saoScale":this.viewer.scene.sao.scale=this._configs[e]=parseFloat(t);break;case"saoKernelRadius":this.viewer.scene.sao.kernelRadius=this._configs[e]=parseFloat(t);break;case"saoBlur":this.viewer.scene.sao.blur=this._configs[e]=i(t);break;case"viewFitFOV":this.viewer.cameraFlight.fitFOV=this._configs[e]=parseFloat(t);break;case"viewFitDuration":this.viewer.cameraFlight.duration=this._configs[e]=parseFloat(t);break;case"perspectiveFOV":this.viewer.camera.perspective.fov=this._configs[e]=parseFloat(t);break;case"excludeUnclassifiedObjects":this._configs[e]=i(t);break;case"objectColorSource":this.setObjectColorSource(t),this._configs[e]=t;break;case"xrayContext":this._configs[e]=t;break;case"saoInteractive":this._configs.saoInteractive=i(t);break;case"saoInteractiveDelay":var r=parseFloat(t);r<0&&(this.error("setConfig() - saoInteractiveDelay cannot be less than zero - clamping to zero"),r=0),this._configs.saoInteractiveDelay=parseFloat(t);break;default:this.error("setConfig() - unsupported configuration: '"+e+"'")}}catch(t){this.error("setConfig() - failed to configure '"+e+"': "+t)}}getConfig(e){return this._configs[e]}getProjectsInfo(e,t){e?this.server.getProjects(e,e=>{this.error("getProjectsInfo() - "+e),t&&t(e)}):this.error("getProjectsInfo() - Argument expected: 'done'")}getProjectInfo(e,t,i){e?t?this.server.getProject(e,t,e=>{this.error("getProjectInfo() - "+e),i&&i(e)}):this.error("getProjectInfo() - Argument expected: 'done'"):this.error("getProjectInfo() - Argument expected: projectId")}getObjectInfo(e,t,i,r,n){e?t?i?r?this.server.getObjectInfo(e,t,i,r,e=>{n&&n(e)}):this.error("getProjectInfo() - Argument expected: 'done'"):this.error("getObjectInfo() - Argument expected: objectId"):this.error("getObjectInfo() - Argument expected: modelId"):this.error("getObjectInfo() - Argument expected: projectId")}loadProject(e,t,i){e?this.props.server.getProject(e,i=>{this.unloadProject(),this.setState({projectId:e,modelsInfo:null,numModels:0}),this.parseProject(i,t),this.state.numModelsLoaded<this.state.numModels&&this.setState({loadModelsEnabled:!0}),this.state.numModelsLoaded>0&&this.setState({unloadModelsEnabled:!0}),this._enableAddModels&&this.setState({addModelEnabled:!0})},e=>{this.error(e),i&&i(e)}):this.error("loadProject() - Argument expected: objectId")}unloadProject(){if(!this.state.projectId)return;const e=this.viewer.scene.models;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();this.setState({numModelsLoaded:0}),this.setState({loadModelsEnabled:!1,unloadModelsEnabled:!1}),this._enableAddModels&&this.setState({addModelEnabled:!1}),this.state.projectId,this.setState({projectId:null,activeTab:"models"}),this.setControlsEnabled(!1)}getLoadedProjectId(){return this.state.projectId}getModelIds(){return Object.keys(this.state.modelsInfo)}loadModel(e,t,i){if(!e)return void this.error("loadModel() - Argument expected: modelId");if(!this.state.projectId){const e="No project currently loaded";return this.error(e),void(i&&i(e))}const r=this.state.modelsInfo[e];if(!r){const e="Model not in currently loaded project";return this.error(e),void(i&&i(e))}this._busyModal.show("Loading: "+r.name),this.props.server.getMetadata(this.state.projectId,e,n=>{this.props.server.getGeometry(this.state.projectId,e,i=>{const o="model"===(r.objectColorSource||this.getObjectColorSource())?m.ModelIFCObjectColors:g.ViewerIFCObjectColors;this._xktLoader.load({id:e,metaModelData:n,xkt:i,objectDefaults:o,excludeUnclassifiedObjects:!0,position:r.position,scale:r.scale,rotation:r.rotation,matrix:r.matrix,edges:!1!==r.edges,saoEnabled:r.saoEnabled}).on("loaded",()=>{const i=this.viewer.scene,r=i.getAABB(i.visibleObjectIds);this.setState({numModelsLoaded:this.state.numModelsLoaded+1,unloadModelsEnabled:!0,loadModelsEnabled:this.state.numModelsLoaded<this.state.numModels}),1===this.state.numModelsLoaded?(this.viewer.cameraFlight.jumpTo({aabb:r}),this.viewer.cameraControl.pivotPos=A.math.getAABB3Center(r,R),this.modelsExplorerLoaded(e),this._busyModal.hide(),t&&t()):(this.modelsExplorerLoaded(e),this._busyModal.hide(),t&&t())})},e=>{this._busyModal.hide(),this.error(e),i&&i(e)})},e=>{this._busyModal.hide(),this.error(e),i&&i(e)})}loadAllModels(e=function(){}){const t=this.getModelIds(),i=(e,r)=>{if(e>=t.length)r();else{const n=t[e];this.isModelLoaded(n)?i(e+1,r):this.loadModel(n,()=>{i(e+1,r)},t=>{this.error("loadAllModels() - "+t),i(e+1,r)})}};i(0,e)}parseProject(e,t){const i=e.models||{},r={};for(const e of Object.keys(i)){const t=i[e];r[t.id]=t}this.setState({modelsInfo:r,numModels:i.length}),this.parseViewerConfigs(e),this.parseViewerContent(e,()=>{this.parseViewerState(e,()=>{t()})})}parseViewerConfigs(e){const t=e.viewerConfigs;t&&this.setConfigs(t)}parseViewerContent(e,t){const i=e.viewerContent;i?this.parseModelsLoaded(i,()=>{t()}):t()}parseModelsLoaded(e,t){const i=e.modelsLoaded;i&&0!==i.length?this.loadNextModel(i.slice(0),t):t()}loadNextModel(e,t){if(0===e.length)return void t();const i=e.pop();this.loadModel(i,()=>{this.loadNextModel(e,t)},()=>{this.loadNextModel(e,t)})}parseViewerState(e,t){const i=e.viewerState;i?this.setViewerState(i,t):t()}getNumModelsLoaded(){return this.state.numModelsLoaded}getModelsInfo(){return this.state.modelsInfo}getModelInfo(e){return this.state.modelsInfo[e]}getLoadedModelIds(){return Object.keys(this.viewer.scene.models)}isModelLoaded(e){if(e)return!!this.viewer.scene.models[e];this.error("unloadModel() - Argument expected: modelId")}unloadModel(e){if(!e)return void this.error("unloadModel() - Argument expected: modelId");const t=this.viewer.scene.models[e];t?(t.destroy(),this.setState({numModelsLoaded:this.state.numModelsLoaded-1,unloadModelsEnabled:this.state.numModelsLoaded>0,loadModelsEnabled:this.state.numModelsLoaded<this.state.numModels}),this.modelsExplorerUnloaded(e)):this.error("Model not loaded: "+e)}unloadAllModels(){const e=this.viewer.scene.models,t=Object.keys(e);for(var i=0,r=t.length;i<r;i++){const e=t[i];this.unloadModel(e)}}editModel(e){this.fire("editModel",{modelId:e})}deleteModel(e){this.fire("deleteModel",{modelId:e})}addModel(){this.fire("addModel",{})}setBackgroundColor(e){this.viewer.scene.canvas.canvas.style.background="rgba("+255*e[0]+","+255*e[1]+","+255*e[2]+", 1.0)"}setObjectColorSource(e){switch(e){case"model":case"viewer":break;default:return e="model",void this.error("setObjectColorSource() - Unsupported value - accepted values are 'model' and 'viewer' - defaulting to 'model'")}this._objectColorSource=e}getObjectColorSource(){return this._objectColorSource||"model"}setViewerState(e,t=(()=>{})){e.tabOpen&&!this.state.activeTab&&this.setState({activeTab:e.tabOpen}),e.expandObjectsTree&&this.objectsExplorerRef.current&&this.objectsExplorerRef.current.expandTreeViewToDepth(e.expandObjectsTree),e.expandClassesTree&&this.classesExplorerRef.current&&this.classesExplorerRef.current.expandTreeViewToDepth(e.expandClassesTree),e.expandStoreysTree&&this.storeysExplorerRef.current&&this.storeysExplorerRef.current.expandTreeViewToDepth(e.expandStoreysTree),e.setCamera&&this.setCamera(e.setCamera),this._parseSelectedStorey(e,()=>{this._parseThreeDMode(e,()=>{t()})})}_parseSelectedStorey(e,t){e.selectedStorey?(this.selectStorey(e.selectedStorey),t()):t()}_parseThreeDMode(e,t){const i=!1!==e.threeDActive;this.set3DEnabled(i,t)}showObjectInExplorers(e){e?(this.objectsExplorerRef.current&&this.objectsExplorerRef.current.showNodeInTreeView(e),this.classesExplorerRef.current&&this.classesExplorerRef.current.showNodeInTreeView(e),this.storeysExplorerRef.current&&this.storeysExplorerRef.current.showNodeInTreeView(e)):this.error("showObjectInExplorers() - Argument expected: objectId")}unShowObjectInExplorers(){this.objectsExplorerRef.current&&this.objectsExplorerRef.current.unShowNodeInTreeView(),this.classesExplorerRef.current&&this.classesExplorerRef.current.unShowNodeInTreeView(),this.storeysExplorerRef.current&&this.storeysExplorerRef.current.unShowNodeInTreeView()}setObjectsVisible(e,t){this._withObjectsInSubtree(e,e=>{e.visible=t})}setAllObjectsVisible(e){e?this.viewer.scene.setObjectsVisible(this.viewer.scene.objectIds,!0):this.viewer.scene.setObjectsVisible(this.viewer.scene.visibleObjectIds,!1)}setObjectsXRayed(e,t){this._withObjectsInSubtree(e,e=>{e.xrayed=t})}setAllObjectsXRayed(e){e?this.viewer.scene.setObjectsXRayed(this.viewer.scene.objectIds,!0):this.viewer.scene.setObjectsXRayed(this.viewer.scene.xrayedObjectIds,!1)}setObjectsSelected(e,t){this._withObjectsInSubtree(e,e=>{e.selected=t})}setAllObjectsSelected(e){e?this.viewer.scene.setObjectsSelected(this.viewer.scene.objectIds,!0):this.viewer.scene.setObjectsSelected(this.viewer.scene.selectedObjectIds,!1)}_withObjectsInSubtree(e,t){if(e)for(let i=0,r=e.length;i<r;i++){const r=e[i];this.viewer.metaScene.withMetaObjectsInSubtree(r,e=>{const i=this.viewer.scene.objects[e.id];i&&t(i)})}else this.error("Argument expected: objectIds")}flyToObject(e,t){if(!e)return void this.error("flyToObject() - Argument expected: objectId");const i=this.viewer,r=i.scene,n=[];if(this.viewer.metaScene.withMetaObjectsInSubtree(e,e=>{r.objects[e.id]&&n.push(e.id)}),0===n.length)return this.error("Object not found in viewer: '"+e+"'"),void(t&&t());r.setObjectsVisible(n,!0),r.setObjectsHighlighted(n,!0);const o=r.getAABB(n);i.cameraFlight.flyTo({aabb:o},()=>{t&&t(),setTimeout((function(){r.setObjectsHighlighted(r.highlightedObjectIds,!1)}),500)}),i.cameraControl.pivotPos=A.math.getAABB3Center(o)}viewFitObjects(e,t){if(!e)return void this.error("flyToObject() - Argument expected: objectIds");const i=this.viewer,r=i.scene,n=[];for(var o=0,s=e.length;o<s;o++){const t=e[o];this.viewer.metaScene.withMetaObjectsInSubtree(t,e=>{r.objects[e.id]&&n.push(e.id)})}if(0===n.length)return void(t&&t());r.setObjectsVisible(n,!0),r.setObjectsHighlighted(n,!0);const a=r.getAABB(n);i.cameraFlight.flyTo({aabb:a},()=>{t&&t(),setTimeout((function(){r.setObjectsHighlighted(r.highlightedObjectIds,!1)}),500)}),i.cameraControl.pivotPos=A.math.getAABB3Center(a)}viewFitAll(e){const t=this.viewer,i=t.scene.getAABB(void 0);t.cameraFlight.flyTo({aabb:i},()=>{e&&e()}),t.cameraControl.pivotPos=A.math.getAABB3Center(i)}jumpToObject(e){if(!e)return void this.error("jumpToObject() - Argument expected: objectId");const t=this.viewer,i=t.scene,r=[];if(this.viewer.metaScene.withMetaObjectsInSubtree(e,e=>{i.objects[e.id]&&r.push(e.id)}),0===r.length)return void this.error("Object not found in viewer: '"+e+"'");i.setObjectsVisible(r,!0);const n=i.getAABB(r);t.cameraFlight.jumpTo({aabb:n}),t.cameraControl.pivotPos=A.math.getAABB3Center(n)}setCamera(e){const t=this.viewer.scene.camera;e.eye&&(t.eye=e.eye),e.look&&(t.look=e.look),e.up&&(t.up=e.up)}viewFitModels(e,t){if(!e)return void this.error("viewFitModels() - Argument expected: modelIds");const i=this.viewer,r=i.scene,n=A.math.AABB3();A.math.collapseAABB3(n);for(var o=0,s=e.length;o<s;o++){const t=e[o],i=r.models[t];i?(i.visible=!0,i.highlighted=!0,A.math.expandAABB3(n,i.aabb)):this.error("Model not found in viewer: '"+t+"'")}t?i.cameraFlight.flyTo({aabb:n},()=>{t(),setTimeout((function(){r.setObjectsHighlighted(r.highlightedObjectIds,!1)}),500)}):(i.cameraFlight.jumpTo({aabb:n}),setTimeout((function(){r.setObjectsHighlighted(r.highlightedObjectIds,!1)}),500)),i.cameraControl.pivotPos=A.math.getAABB3Center(n)}set3DEnabled(e,t){this._threeDMode.setActive(e,t)}get3DEnabled(){return this._threeDMode.getActive()}selectStorey(e,t){const i=this.viewer.metaScene.metaObjects[e];i?"IfcBuildingStorey"===i.type?this.storeysExplorerRef.current&&this.storeysExplorerRef.current.selectStorey(e,t):this.error("selectStorey() - Object is not an IfcBuildingStorey: '"+e+"'"):this.error("selectStorey() - Object is not found: '"+e+"'")}saveBCFViewpoint(e){return this._bcfViewpointsPlugin.getViewpoint(e)}loadBCFViewpoint(e,t){e?this._bcfViewpointsPlugin.setViewpoint(e,t):this.error("loadBCFViewpoint() - Argument expected: bcfViewpoint")}resetView(){this._resetAction.reset()}setControlsEnabled(e){this.objectsExplorerRef.current&&this.objectsExplorerRef.current.setEnabled(e),this.classesExplorerRef.current&&this.classesExplorerRef.current.setEnabled(e),this.storeysExplorerRef.current&&this.storeysExplorerRef.current.setEnabled(e),this._resetAction.setEnabled(e),this._fitAction.setEnabled(e),this._threeDMode.setEnabled(e),this._firstPersonMode.setEnabled(e),this._queryTool.setEnabled(e),this._hideTool.setEnabled(e),this._selectionTool.setEnabled(e),this._sectionTool.setEnabled(e)}setKeyboardEnabled(e){this.viewer.scene.input.keyboardEnabled=e}getKeyboardEnabled(){return this.viewer.scene.input.keyboardEnabled}clearSections(){this._sectionTool.clear()}flipSections(){this._sectionTool.flipSections()}hideSectionEditControl(){this._sectionTool.hideControl()}getNumSections(){return this._sectionTool.getNumSections()}fire(e,t,i=!1){this._events||(this._events={}),this._eventSubs||(this._eventSubs={}),!0!==i&&(this._events[e]=t||!0);const r=this._eventSubs[e];let n;if(r)for(const i in r)r.hasOwnProperty(i)&&(n=r[i],this._eventCallDepth++,this._eventCallDepth<300?n.callback.call(n.scope,t):this.error("fire: potential stack overflow from recursive event '"+e+"' - dropping this event"),this._eventCallDepth--)}on(e,t,i=this){this._events||(this._events={}),this._subIdMap||(this._subIdMap=new T.Map),this._subIdEvents||(this._subIdEvents={}),this._eventSubs||(this._eventSubs={});let r=this._eventSubs[e];r||(r={},this._eventSubs[e]=r);const n=this._subIdMap.addItem();r[n]={callback:t,scope:i||this},this._subIdEvents[n]=e;const o=this._events[e];return void 0!==o&&t.call(i||this,o),n}off(e){if(null==e)return;if(!this._subIdEvents)return;const t=this._subIdEvents[e];if(t){delete this._subIdEvents[e];const i=this._eventSubs[t];i&&delete i[e],this._subIdMap.removeItem(e)}}once(e,t,i=this){const r=this,n=this.on(e,(function(e){r.off(n),t.call(i||this,e)}),i)}log(e){e="[LOG] "+e,window.console.log(e)}warn(e){e="[WARN] "+e,window.console.warn(e)}error(e){e="[ERROR] "+e,window.console.error(e)}_mutexActivation(e){const t=e.length;for(let i=0;i<t;i++)e[i].on("active",function(){const r=i;return function(i){if(i)for(let i=0;i<t;i++)i!==r&&e[i].setActive(!1)}}())}setEnabled(e){this._enabled!==e&&(this._enabled=e,this.fire("enabled",this._enabled))}getEnabled(){return this._enabled}setActive(e){this._active!==e&&(this._active=e,this.fire("active",this._active))}getActive(){return this._active}destroy(){if(!this._destroyed){this.viewer.destroy(),this._bcfViewpointsPlugin.destroy(),this._xktLoader.destroy(),this._canvasContextMenu.destroy(),this._objectContextMenu.destroy(),this.fire("destroyed",this._destroyed=!0),this._subIdMap=null,this._subIdEvents=null,this._eventSubs=null,this._events=null,this._eventCallDepth=0;for(let e=0,t=this._children.length;e<t;e++)this._children[e].destroy();this._children=[]}}showObjectPropertes(e){const t={id:e,hierarchy:null,modelAuthor:null,modelCreatedApp:null,modelCreatedAt:null,modelId:null,modelRevisionId:null,name:null,projectId:null,type:null};if(this.viewer.metaScene.metaObjects[e]){const i=this.viewer.metaScene.metaObjects[e];t.type=i.type,t.name=i.name,t.projectId=i.metaModel.projectId.toString(),t.modelRevisionId=i.metaModel.revisionId.toString(),t.modelId=i.metaModel.id,t.modelAuthor=i.metaModel.author,t.modelCreatedAt=i.metaModel.createdAt,t.modelCreatedApp=i.metaModel.creatingApplication;const r=[i.name];let n=i.parent;for(;null!=n;)n.name&&"Default"!=n.name?r.push(n.name):n.type&&r.push(n.type),n=n.parent;t.hierarchy=r.reverse()}this.setState({showObjectProperties:t})}render(){var e,t,i,n,a,l,c,u;const{classes:m}=this.props;return o.createElement(o.Fragment,null,o.createElement("div",{id:"myViewer",className:"xeokit-busy-modal-backdrop",ref:this.busyModelBackdropElementRef},o.createElement(s.default,{className:m.explorerSidePane,style:{position:"relative"},split:"vertical",primary:"first",minSize:400,defaultSize:localStorage.getItem("paneWidth")?parseInt(localStorage.getItem("paneWidth"),10):"20%",onChange:e=>localStorage.setItem("paneWidth",e.toString())},o.createElement("div",{id:"myExplorer",className:m.myExplorer,ref:this.explorerElementRef},o.createElement(s.default,{className:m.explorerSubPane,style:{position:"relative"},split:"horizontal",primary:"second",defaultSize:localStorage.getItem("objectPropertyHeight")?parseInt(localStorage.getItem("objectPropertyHeight"),10):"200px",onChange:e=>localStorage.setItem("objectPropertyHeight",e.toString())},o.createElement("div",{className:m.tabsContainer},o.createElement("div",{className:m.contentTabs},o.createElement(r.Tabs,{variant:"fullWidth",value:this.state.activeTab,onChange:this.handleTabChange,indicatorColor:"primary",classes:{indicator:m.tabIndicator}},o.createElement(r.Tab,{label:"Models",classes:{root:m.tabRoot,selected:m.tabSelected},value:"models"}),o.createElement(r.Tab,{label:"Objects",classes:{root:m.tabRoot,selected:m.tabSelected},value:"objects"}),o.createElement(r.Tab,{label:"Classes",classes:{root:m.tabRoot,selected:m.tabSelected},value:"classes"}),o.createElement(r.Tab,{label:"Levels",classes:{root:m.tabRoot,selected:m.tabSelected},value:"storeys"}))),null!=this.viewer&&null!=this.state.modelsInfo&&o.createElement(o.Fragment,null,o.createElement(d.default,{modelsInfo:this.state.modelsInfo,activeTab:"models"===this.state.activeTab,bimViewer:this,viewer:this.viewer,server:this.server,numModelsLoaded:this.state.numModelsLoaded,enableEditModels:this._enableAddModels,ref:this.modelsExplorerRef,loadModel:e=>this.loadModel(e),unloadModel:e=>this.unloadModel(e),error:this.error,destroy:()=>{this.destroy()},loadAll:this.handleLoadAllModels,unloadAll:this.handleUnloadAllModels,addModel:this.handleAddModel}),o.createElement(p.default,{activeTab:"objects"===this.state.activeTab,bimViewer:this,viewer:this.viewer,ref:this.objectsExplorerRef,error:this.error,destroy:()=>{this.destroy()},showAll:this.handleShowAllObjects,hideAll:this.handleHideAllObjects}),o.createElement(h.default,{activeTab:"classes"===this.state.activeTab,bimViewer:this,viewer:this.viewer,ref:this.classesExplorerRef,error:this.error,destroy:()=>{this.destroy()},showAll:this.handleShowAllObjects,hideAll:this.handleHideAllObjects}),o.createElement(f.default,{activeTab:"storeys"===this.state.activeTab,bimViewer:this,viewer:this.viewer,ref:this.storeysExplorerRef,error:this.error,destroy:()=>{this.destroy()},showAll:this.handleShowAllObjects,hideAll:this.handleHideAllObjects}))),o.createElement("div",{className:m.objectPane},o.createElement("div",{className:m.textTitle},o.createElement("b",null,"Object Properties:")),this.state.showObjectProperties&&o.createElement("div",{className:m.objectContent},o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"ID:"),o.createElement("div",{className:m.textValue},this.state.showObjectProperties.id)),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Name:"),o.createElement("div",{className:m.textValue},null!==(e=this.state.showObjectProperties.name)&&void 0!==e?e:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Type:"),o.createElement("div",{className:m.textValue},null!==(t=this.state.showObjectProperties.type)&&void 0!==t?t:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Hierarchy:"),o.createElement("div",{className:m.textValue},this.state.showObjectProperties.hierarchy?this.state.showObjectProperties.hierarchy.join(" > "):"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Project ID:"),o.createElement("div",{className:m.textValue},null!==(i=this.state.showObjectProperties.projectId)&&void 0!==i?i:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Model ID:"),o.createElement("div",{className:m.textValue},null!==(n=this.state.showObjectProperties.modelId)&&void 0!==n?n:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Model Revision ID:"),o.createElement("div",{className:m.textValue},null!==(a=this.state.showObjectProperties.modelRevisionId)&&void 0!==a?a:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Model Author:"),o.createElement("div",{className:m.textValue},null!==(l=this.state.showObjectProperties.modelAuthor)&&void 0!==l?l:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Model Created:"),o.createElement("div",{className:m.textValue},null!==(c=this.state.showObjectProperties.modelCreatedAt)&&void 0!==c?c:"None")),o.createElement("div",{className:m.textRow},o.createElement("div",{className:m.textLabel},"Model Creation App:"),o.createElement("div",{className:m.textValue},null!==(u=this.state.showObjectProperties.modelCreatedApp)&&void 0!==u?u:"None")))))),o.createElement("div",{id:"myContent",className:m.myContent},o.createElement("div",{id:"myToolbar",ref:this.toolbarElementRef},o.createElement("div",{className:"xeokit-toolbar"},o.createElement("div",{className:"xeokit-btn-group"},o.createElement("button",{type:"button",className:"xeokit-reset xeokit-btn fa fa-home fa-2x disabled","data-tippy-content":"Reset view"})),o.createElement("div",{className:"xeokit-btn-group",role:"group"},o.createElement("button",{type:"button",className:"xeokit-threeD xeokit-btn fa fa-cube fa-2x","data-tippy-content":"Toggle 2D/3D"}),o.createElement("button",{type:"button",className:"xeokit-fit xeokit-btn fa fa-crop fa-2x disabled","data-tippy-content":"View fit"}),o.createElement("button",{type:"button",className:"xeokit-firstPerson xeokit-btn fa fa-male fa-2x disabled","data-tippy-content":"First person"})),o.createElement("div",{className:"xeokit-btn-group",role:"group"},o.createElement("button",{type:"button",className:"xeokit-hide xeokit-btn fa fa-eraser fa-2x disabled","data-tippy-content":"Hide objects"}),o.createElement("button",{type:"button",className:"xeokit-select xeokit-btn fa fa-mouse-pointer fa-2x disabled","data-tippy-content":"Select objects"}),o.createElement("button",{type:"button",className:"xeokit-query xeokit-btn fa fa-info-circle fa-2x disabled","data-tippy-content":"Query objects"}),o.createElement("button",{type:"button",className:"xeokit-section xeokit-btn fa fa-cut fa-2x disabled","data-tippy-content":"Slice objects"},o.createElement("div",{className:"xeokit-section-menu-button"},o.createElement("span",{className:"xeokit-arrow-down xeokit-section-menu-button-arrow"})),o.createElement("div",{className:"xeokit-section-counter","data-tippy-content":"Number of existing slices"}))))),o.createElement("canvas",{id:"myCanvas",ref:this.canvasElementRef})))),o.createElement("canvas",{id:"myNavCubeCanvas",ref:this.navCubeCanvasElementRef}))}}t.BIMViewer=L,t.default=n.withStyles(e=>({root:{},content:{flex:1,display:"flex",overflow:"hidden",flexDirection:"column",justifyContent:"center",padding:"1vw",backgroundColor:"#fff"},contentPage:{height:"100%",minWidth:"100%",display:"flex",flexDirection:"column"},explorerSidePane:{height:"100%","& > .Pane":{display:"flex",overflow:"auto",minWidth:"400px"},"& .Resizer":{background:"#6d6d6d",opacity:.2,zIndex:1,MozBoxSizing:"border-box",WebkitBoxSizing:"border-box",boxSizing:"border-box",MozBackgroundClip:"padding",WebkitBackgroundClip:"padding",backgroundClip:"padding-box"},"& .Resizer:hover":{WebkitTransition:"all 2s ease",transition:"all 2s ease"},"& .Resizer.vertical":{width:"11px",margin:"0 -5px",borderLeft:"4px solid rgba(255, 255, 255, 0)",borderRight:"4px solid rgba(255, 255, 255, 0)",cursor:"col-resize"},"& .Resizer.vertical:hover":{borderLeft:"4px solid rgba(0, 0, 0, 0.5)",borderRight:"4px solid rgba(0, 0, 0, 0.5)"},"& .Resizer.horizontal":{height:"11px",margin:"-5px 0px",borderTop:"4px solid rgba(255, 255, 255, 0)",borderBottom:"4px solid rgba(255, 255, 255, 0)",cursor:"row-resize",width:"100%"},"& .Resizer.horizontal:hover":{borderTop:"4px solid rgba(0, 0, 0, 0.5)",borderBottom:"4px solid rgba(0, 0, 0, 0.5)"}},splitPaneStyle:{position:"relative"},pane:{flex:1,display:"flex",flexDirection:"column"},leftPane:{flex:1,paddingRight:"1vw",display:"flex",flexDirection:"column"},rightPane:{flex:1,paddingLeft:"1vw",display:"flex",flexDirection:"column"},explorerSubPane:{height:"100%","& > .Pane":{display:"flex",overflow:"auto"},"& .Resizer":{background:"#6d6d6d",opacity:.2,zIndex:1,MozBoxSizing:"border-box",WebkitBoxSizing:"border-box",boxSizing:"border-box",MozBackgroundClip:"padding",WebkitBackgroundClip:"padding",backgroundClip:"padding-box"},"& .Resizer:hover":{WebkitTransition:"all 2s ease",transition:"all 2s ease"},"& .Resizer.vertical":{width:"11px",margin:"0 -5px",borderLeft:"4px solid rgba(255, 255, 255, 0)",borderRight:"4px solid rgba(255, 255, 255, 0)",cursor:"col-resize"},"& .Resizer.vertical:hover":{borderLeft:"4px solid rgba(0, 0, 0, 0.5)",borderRight:"4px solid rgba(0, 0, 0, 0.5)"},"& .Resizer.horizontal":{height:"11px",margin:"-5px 0px",borderTop:"4px solid rgba(255, 255, 255, 0)",borderBottom:"4px solid rgba(255, 255, 255, 0)",cursor:"row-resize",width:"100%"},"& .Resizer.horizontal:hover":{borderTop:"4px solid rgba(0, 0, 0, 0.5)",borderBottom:"4px solid rgba(0, 0, 0, 0.5)"}},myExplorer:{width:"100%",height:"100%",background:"#03103F",color:"#fff",transition:"all 0.3s",padding:"0",overflowY:"hidden","&.active":{marginLeft:"0"},"& .explorer-toolbar":{padding:"0",background:"#03103F"},"& ul.components":{padding:"20px 0",borderBottom:"1px solid #47748b"},"& ul p":{color:"#CFCFCF",padding:"10px"},"& ul li a":{padding:"0",fontSize:"14px",display:"block"},"& ul li a:hover":{color:"#477dca"},"& ul li.active > a":{color:"#fff",background:"#03103F"},'& a[aria-expanded="true"]':{color:"#fff",background:"#03103F"},'& input[type="checkbox"]':{backgroundColor:"initial",cursor:"default",WebkitAppearance:"checkbox",boxSizing:"border-box",margin:"3px 4px 3px 8px",padding:"initial",border:"initial"}},tabsContainer:{width:"100%",display:"flex",flexDirection:"column"},contentTabs:{backgroundColor:"white"},tabRoot:{minWidth:"72px !important",color:e.palette.primary.main,fontWeight:"bold","&:hover":{color:e.palette.secondary.main}},tabSelected:{backgroundColor:e.palette.primary.main,color:"white","&:hover":{color:"white"}},tabIndicator:{display:"none"},myContent:{width:"100%",height:"100%",background:"#f2f2f2"},objectPane:{display:"flex",flexDirection:"column",overflow:"auto"},objectContent:{overflow:"auto",padding:"0px 10px 10px 10px"},textTitle:{padding:"10px"},textRow:{paddingBottom:"5px"},textLabel:{width:"40%",fontWeight:"bold",display:"inline-block",verticalAlign:"top"},textValue:{display:"inline-block",width:"60%",wordBreak:"break-word"}}))(L)},function(e,t,i){"use strict";var r=i(222);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,i,n,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var i={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return i.PropTypes=i,i}},function(e,t,i){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,i){"use strict";e.exports=i(224)},function(e,t,i){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,l=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,h=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,v=r?Symbol.for("react.lazy"):60116,b=r?Symbol.for("react.block"):60121,_=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,x=r?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case h:case d:case s:case l:case a:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case v:case g:case c:return e;default:return t}}case o:return t}}}function M(e){return w(e)===d}t.AsyncMode=h,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=c,t.Element=n,t.ForwardRef=p,t.Fragment=s,t.Lazy=v,t.Memo=g,t.Portal=o,t.Profiler=l,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return M(e)||w(e)===h},t.isConcurrentMode=M,t.isContextConsumer=function(e){return w(e)===u},t.isContextProvider=function(e){return w(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===s},t.isLazy=function(e){return w(e)===v},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===l},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===d||e===l||e===a||e===f||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===_||e.$$typeof===y||e.$$typeof===x||e.$$typeof===b)},t.typeOf=w},function(e,t,i){"use strict";
/** @license React v17.0.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=60103,n=60106,o=60107,s=60108,a=60114,l=60109,c=60110,u=60112,h=60113,d=60120,p=60115,f=60116,m=60121,g=60122,v=60117,b=60129,_=60131;if("function"==typeof Symbol&&Symbol.for){var y=Symbol.for;r=y("react.element"),n=y("react.portal"),o=y("react.fragment"),s=y("react.strict_mode"),a=y("react.profiler"),l=y("react.provider"),c=y("react.context"),u=y("react.forward_ref"),h=y("react.suspense"),d=y("react.suspense_list"),p=y("react.memo"),f=y("react.lazy"),m=y("react.block"),g=y("react.server.block"),v=y("react.fundamental"),b=y("react.debug_trace_mode"),_=y("react.legacy_hidden")}function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case o:case a:case s:case h:case d:return e;default:switch(e=e&&e.$$typeof){case c:case u:case f:case p:case l:return e;default:return t}}case n:return t}}}var w=l,M=r,P=u,E=o,S=f,C=p,k=n,O=a,A=s,T=h;t.ContextConsumer=c,t.ContextProvider=w,t.Element=M,t.ForwardRef=P,t.Fragment=E,t.Lazy=S,t.Memo=C,t.Portal=k,t.Profiler=O,t.StrictMode=A,t.Suspense=T,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return x(e)===c},t.isContextProvider=function(e){return x(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return x(e)===u},t.isFragment=function(e){return x(e)===o},t.isLazy=function(e){return x(e)===f},t.isMemo=function(e){return x(e)===p},t.isPortal=function(e){return x(e)===n},t.isProfiler=function(e){return x(e)===a},t.isStrictMode=function(e){return x(e)===s},t.isSuspense=function(e){return x(e)===h},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===a||e===b||e===s||e===h||e===d||e===_||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===p||e.$$typeof===l||e.$$typeof===c||e.$$typeof===u||e.$$typeof===v||e.$$typeof===m||e[0]===g)},t.typeOf=x},function(e,t){e.exports=["alignContent","MozAlignContent","WebkitAlignContent","MSAlignContent","OAlignContent","alignItems","MozAlignItems","WebkitAlignItems","MSAlignItems","OAlignItems","alignSelf","MozAlignSelf","WebkitAlignSelf","MSAlignSelf","OAlignSelf","all","MozAll","WebkitAll","MSAll","OAll","animation","MozAnimation","WebkitAnimation","MSAnimation","OAnimation","animationDelay","MozAnimationDelay","WebkitAnimationDelay","MSAnimationDelay","OAnimationDelay","animationDirection","MozAnimationDirection","WebkitAnimationDirection","MSAnimationDirection","OAnimationDirection","animationDuration","MozAnimationDuration","WebkitAnimationDuration","MSAnimationDuration","OAnimationDuration","animationFillMode","MozAnimationFillMode","WebkitAnimationFillMode","MSAnimationFillMode","OAnimationFillMode","animationIterationCount","MozAnimationIterationCount","WebkitAnimationIterationCount","MSAnimationIterationCount","OAnimationIterationCount","animationName","MozAnimationName","WebkitAnimationName","MSAnimationName","OAnimationName","animationPlayState","MozAnimationPlayState","WebkitAnimationPlayState","MSAnimationPlayState","OAnimationPlayState","animationTimingFunction","MozAnimationTimingFunction","WebkitAnimationTimingFunction","MSAnimationTimingFunction","OAnimationTimingFunction","backfaceVisibility","MozBackfaceVisibility","WebkitBackfaceVisibility","MSBackfaceVisibility","OBackfaceVisibility","background","MozBackground","WebkitBackground","MSBackground","OBackground","backgroundAttachment","MozBackgroundAttachment","WebkitBackgroundAttachment","MSBackgroundAttachment","OBackgroundAttachment","backgroundBlendMode","MozBackgroundBlendMode","WebkitBackgroundBlendMode","MSBackgroundBlendMode","OBackgroundBlendMode","backgroundClip","MozBackgroundClip","WebkitBackgroundClip","MSBackgroundClip","OBackgroundClip","backgroundColor","MozBackgroundColor","WebkitBackgroundColor","MSBackgroundColor","OBackgroundColor","backgroundImage","MozBackgroundImage","WebkitBackgroundImage","MSBackgroundImage","OBackgroundImage","backgroundOrigin","MozBackgroundOrigin","WebkitBackgroundOrigin","MSBackgroundOrigin","OBackgroundOrigin","backgroundPosition","MozBackgroundPosition","WebkitBackgroundPosition","MSBackgroundPosition","OBackgroundPosition","backgroundRepeat","MozBackgroundRepeat","WebkitBackgroundRepeat","MSBackgroundRepeat","OBackgroundRepeat","backgroundSize","MozBackgroundSize","WebkitBackgroundSize","MSBackgroundSize","OBackgroundSize","blockSize","MozBlockSize","WebkitBlockSize","MSBlockSize","OBlockSize","border","MozBorder","WebkitBorder","MSBorder","OBorder","borderBlockEnd","MozBorderBlockEnd","WebkitBorderBlockEnd","MSBorderBlockEnd","OBorderBlockEnd","borderBlockEndColor","MozBorderBlockEndColor","WebkitBorderBlockEndColor","MSBorderBlockEndColor","OBorderBlockEndColor","borderBlockEndStyle","MozBorderBlockEndStyle","WebkitBorderBlockEndStyle","MSBorderBlockEndStyle","OBorderBlockEndStyle","borderBlockEndWidth","MozBorderBlockEndWidth","WebkitBorderBlockEndWidth","MSBorderBlockEndWidth","OBorderBlockEndWidth","borderBlockStart","MozBorderBlockStart","WebkitBorderBlockStart","MSBorderBlockStart","OBorderBlockStart","borderBlockStartColor","MozBorderBlockStartColor","WebkitBorderBlockStartColor","MSBorderBlockStartColor","OBorderBlockStartColor","borderBlockStartStyle","MozBorderBlockStartStyle","WebkitBorderBlockStartStyle","MSBorderBlockStartStyle","OBorderBlockStartStyle","borderBlockStartWidth","MozBorderBlockStartWidth","WebkitBorderBlockStartWidth","MSBorderBlockStartWidth","OBorderBlockStartWidth","borderBottom","MozBorderBottom","WebkitBorderBottom","MSBorderBottom","OBorderBottom","borderBottomColor","MozBorderBottomColor","WebkitBorderBottomColor","MSBorderBottomColor","OBorderBottomColor","borderBottomLeftRadius","MozBorderBottomLeftRadius","WebkitBorderBottomLeftRadius","MSBorderBottomLeftRadius","OBorderBottomLeftRadius","borderBottomRightRadius","MozBorderBottomRightRadius","WebkitBorderBottomRightRadius","MSBorderBottomRightRadius","OBorderBottomRightRadius","borderBottomStyle","MozBorderBottomStyle","WebkitBorderBottomStyle","MSBorderBottomStyle","OBorderBottomStyle","borderBottomWidth","MozBorderBottomWidth","WebkitBorderBottomWidth","MSBorderBottomWidth","OBorderBottomWidth","borderCollapse","MozBorderCollapse","WebkitBorderCollapse","MSBorderCollapse","OBorderCollapse","borderColor","MozBorderColor","WebkitBorderColor","MSBorderColor","OBorderColor","borderImage","MozBorderImage","WebkitBorderImage","MSBorderImage","OBorderImage","borderImageOutset","MozBorderImageOutset","WebkitBorderImageOutset","MSBorderImageOutset","OBorderImageOutset","borderImageRepeat","MozBorderImageRepeat","WebkitBorderImageRepeat","MSBorderImageRepeat","OBorderImageRepeat","borderImageSlice","MozBorderImageSlice","WebkitBorderImageSlice","MSBorderImageSlice","OBorderImageSlice","borderImageSource","MozBorderImageSource","WebkitBorderImageSource","MSBorderImageSource","OBorderImageSource","borderImageWidth","MozBorderImageWidth","WebkitBorderImageWidth","MSBorderImageWidth","OBorderImageWidth","borderInlineEnd","MozBorderInlineEnd","WebkitBorderInlineEnd","MSBorderInlineEnd","OBorderInlineEnd","borderInlineEndColor","MozBorderInlineEndColor","WebkitBorderInlineEndColor","MSBorderInlineEndColor","OBorderInlineEndColor","borderInlineEndStyle","MozBorderInlineEndStyle","WebkitBorderInlineEndStyle","MSBorderInlineEndStyle","OBorderInlineEndStyle","borderInlineEndWidth","MozBorderInlineEndWidth","WebkitBorderInlineEndWidth","MSBorderInlineEndWidth","OBorderInlineEndWidth","borderInlineStart","MozBorderInlineStart","WebkitBorderInlineStart","MSBorderInlineStart","OBorderInlineStart","borderInlineStartColor","MozBorderInlineStartColor","WebkitBorderInlineStartColor","MSBorderInlineStartColor","OBorderInlineStartColor","borderInlineStartStyle","MozBorderInlineStartStyle","WebkitBorderInlineStartStyle","MSBorderInlineStartStyle","OBorderInlineStartStyle","borderInlineStartWidth","MozBorderInlineStartWidth","WebkitBorderInlineStartWidth","MSBorderInlineStartWidth","OBorderInlineStartWidth","borderLeft","MozBorderLeft","WebkitBorderLeft","MSBorderLeft","OBorderLeft","borderLeftColor","MozBorderLeftColor","WebkitBorderLeftColor","MSBorderLeftColor","OBorderLeftColor","borderLeftStyle","MozBorderLeftStyle","WebkitBorderLeftStyle","MSBorderLeftStyle","OBorderLeftStyle","borderLeftWidth","MozBorderLeftWidth","WebkitBorderLeftWidth","MSBorderLeftWidth","OBorderLeftWidth","borderRadius","MozBorderRadius","WebkitBorderRadius","MSBorderRadius","OBorderRadius","borderRight","MozBorderRight","WebkitBorderRight","MSBorderRight","OBorderRight","borderRightColor","MozBorderRightColor","WebkitBorderRightColor","MSBorderRightColor","OBorderRightColor","borderRightStyle","MozBorderRightStyle","WebkitBorderRightStyle","MSBorderRightStyle","OBorderRightStyle","borderRightWidth","MozBorderRightWidth","WebkitBorderRightWidth","MSBorderRightWidth","OBorderRightWidth","borderSpacing","MozBorderSpacing","WebkitBorderSpacing","MSBorderSpacing","OBorderSpacing","borderStyle","MozBorderStyle","WebkitBorderStyle","MSBorderStyle","OBorderStyle","borderTop","MozBorderTop","WebkitBorderTop","MSBorderTop","OBorderTop","borderTopColor","MozBorderTopColor","WebkitBorderTopColor","MSBorderTopColor","OBorderTopColor","borderTopLeftRadius","MozBorderTopLeftRadius","WebkitBorderTopLeftRadius","MSBorderTopLeftRadius","OBorderTopLeftRadius","borderTopRightRadius","MozBorderTopRightRadius","WebkitBorderTopRightRadius","MSBorderTopRightRadius","OBorderTopRightRadius","borderTopStyle","MozBorderTopStyle","WebkitBorderTopStyle","MSBorderTopStyle","OBorderTopStyle","borderTopWidth","MozBorderTopWidth","WebkitBorderTopWidth","MSBorderTopWidth","OBorderTopWidth","borderWidth","MozBorderWidth","WebkitBorderWidth","MSBorderWidth","OBorderWidth","bottom","MozBottom","WebkitBottom","MSBottom","OBottom","boxDecorationBreak","MozBoxDecorationBreak","WebkitBoxDecorationBreak","MSBoxDecorationBreak","OBoxDecorationBreak","boxShadow","MozBoxShadow","WebkitBoxShadow","MSBoxShadow","OBoxShadow","boxSizing","MozBoxSizing","WebkitBoxSizing","MSBoxSizing","OBoxSizing","breakAfter","MozBreakAfter","WebkitBreakAfter","MSBreakAfter","OBreakAfter","breakBefore","MozBreakBefore","WebkitBreakBefore","MSBreakBefore","OBreakBefore","breakInside","MozBreakInside","WebkitBreakInside","MSBreakInside","OBreakInside","captionSide","MozCaptionSide","WebkitCaptionSide","MSCaptionSide","OCaptionSide","caretColor","MozCaretColor","WebkitCaretColor","MSCaretColor","OCaretColor","ch","MozCh","WebkitCh","MSCh","OCh","clear","MozClear","WebkitClear","MSClear","OClear","clip","MozClip","WebkitClip","MSClip","OClip","clipPath","MozClipPath","WebkitClipPath","MSClipPath","OClipPath","cm","MozCm","WebkitCm","MSCm","OCm","color","MozColor","WebkitColor","MSColor","OColor","columnCount","MozColumnCount","WebkitColumnCount","MSColumnCount","OColumnCount","columnFill","MozColumnFill","WebkitColumnFill","MSColumnFill","OColumnFill","columnGap","MozColumnGap","WebkitColumnGap","MSColumnGap","OColumnGap","columnRule","MozColumnRule","WebkitColumnRule","MSColumnRule","OColumnRule","columnRuleColor","MozColumnRuleColor","WebkitColumnRuleColor","MSColumnRuleColor","OColumnRuleColor","columnRuleStyle","MozColumnRuleStyle","WebkitColumnRuleStyle","MSColumnRuleStyle","OColumnRuleStyle","columnRuleWidth","MozColumnRuleWidth","WebkitColumnRuleWidth","MSColumnRuleWidth","OColumnRuleWidth","columnSpan","MozColumnSpan","WebkitColumnSpan","MSColumnSpan","OColumnSpan","columnWidth","MozColumnWidth","WebkitColumnWidth","MSColumnWidth","OColumnWidth","columns","MozColumns","WebkitColumns","MSColumns","OColumns","content","MozContent","WebkitContent","MSContent","OContent","counterIncrement","MozCounterIncrement","WebkitCounterIncrement","MSCounterIncrement","OCounterIncrement","counterReset","MozCounterReset","WebkitCounterReset","MSCounterReset","OCounterReset","cursor","MozCursor","WebkitCursor","MSCursor","OCursor","deg","MozDeg","WebkitDeg","MSDeg","ODeg","direction","MozDirection","WebkitDirection","MSDirection","ODirection","display","MozDisplay","WebkitDisplay","MSDisplay","ODisplay","dpcm","MozDpcm","WebkitDpcm","MSDpcm","ODpcm","dpi","MozDpi","WebkitDpi","MSDpi","ODpi","dppx","MozDppx","WebkitDppx","MSDppx","ODppx","em","MozEm","WebkitEm","MSEm","OEm","emptyCells","MozEmptyCells","WebkitEmptyCells","MSEmptyCells","OEmptyCells","ex","MozEx","WebkitEx","MSEx","OEx","filter","MozFilter","WebkitFilter","MSFilter","OFilter","flexBasis","MozFlexBasis","WebkitFlexBasis","MSFlexBasis","OFlexBasis","flexDirection","MozFlexDirection","WebkitFlexDirection","MSFlexDirection","OFlexDirection","flexFlow","MozFlexFlow","WebkitFlexFlow","MSFlexFlow","OFlexFlow","flexGrow","MozFlexGrow","WebkitFlexGrow","MSFlexGrow","OFlexGrow","flexShrink","MozFlexShrink","WebkitFlexShrink","MSFlexShrink","OFlexShrink","flexWrap","MozFlexWrap","WebkitFlexWrap","MSFlexWrap","OFlexWrap","float","MozFloat","WebkitFloat","MSFloat","OFloat","font","MozFont","WebkitFont","MSFont","OFont","fontFamily","MozFontFamily","WebkitFontFamily","MSFontFamily","OFontFamily","fontFeatureSettings","MozFontFeatureSettings","WebkitFontFeatureSettings","MSFontFeatureSettings","OFontFeatureSettings","fontKerning","MozFontKerning","WebkitFontKerning","MSFontKerning","OFontKerning","fontLanguageOverride","MozFontLanguageOverride","WebkitFontLanguageOverride","MSFontLanguageOverride","OFontLanguageOverride","fontSize","MozFontSize","WebkitFontSize","MSFontSize","OFontSize","fontSizeAdjust","MozFontSizeAdjust","WebkitFontSizeAdjust","MSFontSizeAdjust","OFontSizeAdjust","fontStretch","MozFontStretch","WebkitFontStretch","MSFontStretch","OFontStretch","fontStyle","MozFontStyle","WebkitFontStyle","MSFontStyle","OFontStyle","fontSynthesis","MozFontSynthesis","WebkitFontSynthesis","MSFontSynthesis","OFontSynthesis","fontVariant","MozFontVariant","WebkitFontVariant","MSFontVariant","OFontVariant","fontVariantAlternates","MozFontVariantAlternates","WebkitFontVariantAlternates","MSFontVariantAlternates","OFontVariantAlternates","fontVariantCaps","MozFontVariantCaps","WebkitFontVariantCaps","MSFontVariantCaps","OFontVariantCaps","fontVariantEastAsian","MozFontVariantEastAsian","WebkitFontVariantEastAsian","MSFontVariantEastAsian","OFontVariantEastAsian","fontVariantLigatures","MozFontVariantLigatures","WebkitFontVariantLigatures","MSFontVariantLigatures","OFontVariantLigatures","fontVariantNumeric","MozFontVariantNumeric","WebkitFontVariantNumeric","MSFontVariantNumeric","OFontVariantNumeric","fontVariantPosition","MozFontVariantPosition","WebkitFontVariantPosition","MSFontVariantPosition","OFontVariantPosition","fontWeight","MozFontWeight","WebkitFontWeight","MSFontWeight","OFontWeight","fr","MozFr","WebkitFr","MSFr","OFr","grad","MozGrad","WebkitGrad","MSGrad","OGrad","grid","MozGrid","WebkitGrid","MSGrid","OGrid","gridArea","MozGridArea","WebkitGridArea","MSGridArea","OGridArea","gridAutoColumns","MozGridAutoColumns","WebkitGridAutoColumns","MSGridAutoColumns","OGridAutoColumns","gridAutoFlow","MozGridAutoFlow","WebkitGridAutoFlow","MSGridAutoFlow","OGridAutoFlow","gridAutoRows","MozGridAutoRows","WebkitGridAutoRows","MSGridAutoRows","OGridAutoRows","gridColumn","MozGridColumn","WebkitGridColumn","MSGridColumn","OGridColumn","gridColumnEnd","MozGridColumnEnd","WebkitGridColumnEnd","MSGridColumnEnd","OGridColumnEnd","gridColumnGap","MozGridColumnGap","WebkitGridColumnGap","MSGridColumnGap","OGridColumnGap","gridColumnStart","MozGridColumnStart","WebkitGridColumnStart","MSGridColumnStart","OGridColumnStart","gridGap","MozGridGap","WebkitGridGap","MSGridGap","OGridGap","gridRow","MozGridRow","WebkitGridRow","MSGridRow","OGridRow","gridRowEnd","MozGridRowEnd","WebkitGridRowEnd","MSGridRowEnd","OGridRowEnd","gridRowGap","MozGridRowGap","WebkitGridRowGap","MSGridRowGap","OGridRowGap","gridRowStart","MozGridRowStart","WebkitGridRowStart","MSGridRowStart","OGridRowStart","gridTemplate","MozGridTemplate","WebkitGridTemplate","MSGridTemplate","OGridTemplate","gridTemplateAreas","MozGridTemplateAreas","WebkitGridTemplateAreas","MSGridTemplateAreas","OGridTemplateAreas","gridTemplateColumns","MozGridTemplateColumns","WebkitGridTemplateColumns","MSGridTemplateColumns","OGridTemplateColumns","gridTemplateRows","MozGridTemplateRows","WebkitGridTemplateRows","MSGridTemplateRows","OGridTemplateRows","height","MozHeight","WebkitHeight","MSHeight","OHeight","hyphens","MozHyphens","WebkitHyphens","MSHyphens","OHyphens","hz","MozHz","WebkitHz","MSHz","OHz","imageOrientation","MozImageOrientation","WebkitImageOrientation","MSImageOrientation","OImageOrientation","imageRendering","MozImageRendering","WebkitImageRendering","MSImageRendering","OImageRendering","imageResolution","MozImageResolution","WebkitImageResolution","MSImageResolution","OImageResolution","imeMode","MozImeMode","WebkitImeMode","MSImeMode","OImeMode","in","MozIn","WebkitIn","MSIn","OIn","inherit","MozInherit","WebkitInherit","MSInherit","OInherit","initial","MozInitial","WebkitInitial","MSInitial","OInitial","inlineSize","MozInlineSize","WebkitInlineSize","MSInlineSize","OInlineSize","isolation","MozIsolation","WebkitIsolation","MSIsolation","OIsolation","justifyContent","MozJustifyContent","WebkitJustifyContent","MSJustifyContent","OJustifyContent","khz","MozKhz","WebkitKhz","MSKhz","OKhz","left","MozLeft","WebkitLeft","MSLeft","OLeft","letterSpacing","MozLetterSpacing","WebkitLetterSpacing","MSLetterSpacing","OLetterSpacing","lineBreak","MozLineBreak","WebkitLineBreak","MSLineBreak","OLineBreak","lineHeight","MozLineHeight","WebkitLineHeight","MSLineHeight","OLineHeight","listStyle","MozListStyle","WebkitListStyle","MSListStyle","OListStyle","listStyleImage","MozListStyleImage","WebkitListStyleImage","MSListStyleImage","OListStyleImage","listStylePosition","MozListStylePosition","WebkitListStylePosition","MSListStylePosition","OListStylePosition","listStyleType","MozListStyleType","WebkitListStyleType","MSListStyleType","OListStyleType","margin","MozMargin","WebkitMargin","MSMargin","OMargin","marginBlockEnd","MozMarginBlockEnd","WebkitMarginBlockEnd","MSMarginBlockEnd","OMarginBlockEnd","marginBlockStart","MozMarginBlockStart","WebkitMarginBlockStart","MSMarginBlockStart","OMarginBlockStart","marginBottom","MozMarginBottom","WebkitMarginBottom","MSMarginBottom","OMarginBottom","marginInlineEnd","MozMarginInlineEnd","WebkitMarginInlineEnd","MSMarginInlineEnd","OMarginInlineEnd","marginInlineStart","MozMarginInlineStart","WebkitMarginInlineStart","MSMarginInlineStart","OMarginInlineStart","marginLeft","MozMarginLeft","WebkitMarginLeft","MSMarginLeft","OMarginLeft","marginRight","MozMarginRight","WebkitMarginRight","MSMarginRight","OMarginRight","marginTop","MozMarginTop","WebkitMarginTop","MSMarginTop","OMarginTop","mask","MozMask","WebkitMask","MSMask","OMask","maskClip","MozMaskClip","WebkitMaskClip","MSMaskClip","OMaskClip","maskComposite","MozMaskComposite","WebkitMaskComposite","MSMaskComposite","OMaskComposite","maskImage","MozMaskImage","WebkitMaskImage","MSMaskImage","OMaskImage","maskMode","MozMaskMode","WebkitMaskMode","MSMaskMode","OMaskMode","maskOrigin","MozMaskOrigin","WebkitMaskOrigin","MSMaskOrigin","OMaskOrigin","maskPosition","MozMaskPosition","WebkitMaskPosition","MSMaskPosition","OMaskPosition","maskRepeat","MozMaskRepeat","WebkitMaskRepeat","MSMaskRepeat","OMaskRepeat","maskSize","MozMaskSize","WebkitMaskSize","MSMaskSize","OMaskSize","maskType","MozMaskType","WebkitMaskType","MSMaskType","OMaskType","maxHeight","MozMaxHeight","WebkitMaxHeight","MSMaxHeight","OMaxHeight","maxWidth","MozMaxWidth","WebkitMaxWidth","MSMaxWidth","OMaxWidth","minBlockSize","MozMinBlockSize","WebkitMinBlockSize","MSMinBlockSize","OMinBlockSize","minHeight","MozMinHeight","WebkitMinHeight","MSMinHeight","OMinHeight","minInlineSize","MozMinInlineSize","WebkitMinInlineSize","MSMinInlineSize","OMinInlineSize","minWidth","MozMinWidth","WebkitMinWidth","MSMinWidth","OMinWidth","mixBlendMode","MozMixBlendMode","WebkitMixBlendMode","MSMixBlendMode","OMixBlendMode","mm","MozMm","WebkitMm","MSMm","OMm","ms","MozMs","WebkitMs","MSMs","OMs","objectFit","MozObjectFit","WebkitObjectFit","MSObjectFit","OObjectFit","objectPosition","MozObjectPosition","WebkitObjectPosition","MSObjectPosition","OObjectPosition","offsetBlockEnd","MozOffsetBlockEnd","WebkitOffsetBlockEnd","MSOffsetBlockEnd","OOffsetBlockEnd","offsetBlockStart","MozOffsetBlockStart","WebkitOffsetBlockStart","MSOffsetBlockStart","OOffsetBlockStart","offsetInlineEnd","MozOffsetInlineEnd","WebkitOffsetInlineEnd","MSOffsetInlineEnd","OOffsetInlineEnd","offsetInlineStart","MozOffsetInlineStart","WebkitOffsetInlineStart","MSOffsetInlineStart","OOffsetInlineStart","opacity","MozOpacity","WebkitOpacity","MSOpacity","OOpacity","order","MozOrder","WebkitOrder","MSOrder","OOrder","orphans","MozOrphans","WebkitOrphans","MSOrphans","OOrphans","outline","MozOutline","WebkitOutline","MSOutline","OOutline","outlineColor","MozOutlineColor","WebkitOutlineColor","MSOutlineColor","OOutlineColor","outlineOffset","MozOutlineOffset","WebkitOutlineOffset","MSOutlineOffset","OOutlineOffset","outlineStyle","MozOutlineStyle","WebkitOutlineStyle","MSOutlineStyle","OOutlineStyle","outlineWidth","MozOutlineWidth","WebkitOutlineWidth","MSOutlineWidth","OOutlineWidth","overflow","MozOverflow","WebkitOverflow","MSOverflow","OOverflow","overflowWrap","MozOverflowWrap","WebkitOverflowWrap","MSOverflowWrap","OOverflowWrap","overflowX","MozOverflowX","WebkitOverflowX","MSOverflowX","OOverflowX","overflowY","MozOverflowY","WebkitOverflowY","MSOverflowY","OOverflowY","padding","MozPadding","WebkitPadding","MSPadding","OPadding","paddingBlockEnd","MozPaddingBlockEnd","WebkitPaddingBlockEnd","MSPaddingBlockEnd","OPaddingBlockEnd","paddingBlockStart","MozPaddingBlockStart","WebkitPaddingBlockStart","MSPaddingBlockStart","OPaddingBlockStart","paddingBottom","MozPaddingBottom","WebkitPaddingBottom","MSPaddingBottom","OPaddingBottom","paddingInlineEnd","MozPaddingInlineEnd","WebkitPaddingInlineEnd","MSPaddingInlineEnd","OPaddingInlineEnd","paddingInlineStart","MozPaddingInlineStart","WebkitPaddingInlineStart","MSPaddingInlineStart","OPaddingInlineStart","paddingLeft","MozPaddingLeft","WebkitPaddingLeft","MSPaddingLeft","OPaddingLeft","paddingRight","MozPaddingRight","WebkitPaddingRight","MSPaddingRight","OPaddingRight","paddingTop","MozPaddingTop","WebkitPaddingTop","MSPaddingTop","OPaddingTop","pageBreakAfter","MozPageBreakAfter","WebkitPageBreakAfter","MSPageBreakAfter","OPageBreakAfter","pageBreakBefore","MozPageBreakBefore","WebkitPageBreakBefore","MSPageBreakBefore","OPageBreakBefore","pageBreakInside","MozPageBreakInside","WebkitPageBreakInside","MSPageBreakInside","OPageBreakInside","pc","MozPc","WebkitPc","MSPc","OPc","perspective","MozPerspective","WebkitPerspective","MSPerspective","OPerspective","perspectiveOrigin","MozPerspectiveOrigin","WebkitPerspectiveOrigin","MSPerspectiveOrigin","OPerspectiveOrigin","pointerEvents","MozPointerEvents","WebkitPointerEvents","MSPointerEvents","OPointerEvents","position","MozPosition","WebkitPosition","MSPosition","OPosition","pt","MozPt","WebkitPt","MSPt","OPt","px","MozPx","WebkitPx","MSPx","OPx","q","MozQ","WebkitQ","MSQ","OQ","quotes","MozQuotes","WebkitQuotes","MSQuotes","OQuotes","rad","MozRad","WebkitRad","MSRad","ORad","rem","MozRem","WebkitRem","MSRem","ORem","resize","MozResize","WebkitResize","MSResize","OResize","revert","MozRevert","WebkitRevert","MSRevert","ORevert","right","MozRight","WebkitRight","MSRight","ORight","rubyAlign","MozRubyAlign","WebkitRubyAlign","MSRubyAlign","ORubyAlign","rubyMerge","MozRubyMerge","WebkitRubyMerge","MSRubyMerge","ORubyMerge","rubyPosition","MozRubyPosition","WebkitRubyPosition","MSRubyPosition","ORubyPosition","s","MozS","WebkitS","MSS","OS","scrollBehavior","MozScrollBehavior","WebkitScrollBehavior","MSScrollBehavior","OScrollBehavior","scrollSnapCoordinate","MozScrollSnapCoordinate","WebkitScrollSnapCoordinate","MSScrollSnapCoordinate","OScrollSnapCoordinate","scrollSnapDestination","MozScrollSnapDestination","WebkitScrollSnapDestination","MSScrollSnapDestination","OScrollSnapDestination","scrollSnapType","MozScrollSnapType","WebkitScrollSnapType","MSScrollSnapType","OScrollSnapType","shapeImageThreshold","MozShapeImageThreshold","WebkitShapeImageThreshold","MSShapeImageThreshold","OShapeImageThreshold","shapeMargin","MozShapeMargin","WebkitShapeMargin","MSShapeMargin","OShapeMargin","shapeOutside","MozShapeOutside","WebkitShapeOutside","MSShapeOutside","OShapeOutside","tabSize","MozTabSize","WebkitTabSize","MSTabSize","OTabSize","tableLayout","MozTableLayout","WebkitTableLayout","MSTableLayout","OTableLayout","textAlign","MozTextAlign","WebkitTextAlign","MSTextAlign","OTextAlign","textAlignLast","MozTextAlignLast","WebkitTextAlignLast","MSTextAlignLast","OTextAlignLast","textCombineUpright","MozTextCombineUpright","WebkitTextCombineUpright","MSTextCombineUpright","OTextCombineUpright","textDecoration","MozTextDecoration","WebkitTextDecoration","MSTextDecoration","OTextDecoration","textDecorationColor","MozTextDecorationColor","WebkitTextDecorationColor","MSTextDecorationColor","OTextDecorationColor","textDecorationLine","MozTextDecorationLine","WebkitTextDecorationLine","MSTextDecorationLine","OTextDecorationLine","textDecorationStyle","MozTextDecorationStyle","WebkitTextDecorationStyle","MSTextDecorationStyle","OTextDecorationStyle","textEmphasis","MozTextEmphasis","WebkitTextEmphasis","MSTextEmphasis","OTextEmphasis","textEmphasisColor","MozTextEmphasisColor","WebkitTextEmphasisColor","MSTextEmphasisColor","OTextEmphasisColor","textEmphasisPosition","MozTextEmphasisPosition","WebkitTextEmphasisPosition","MSTextEmphasisPosition","OTextEmphasisPosition","textEmphasisStyle","MozTextEmphasisStyle","WebkitTextEmphasisStyle","MSTextEmphasisStyle","OTextEmphasisStyle","textIndent","MozTextIndent","WebkitTextIndent","MSTextIndent","OTextIndent","textOrientation","MozTextOrientation","WebkitTextOrientation","MSTextOrientation","OTextOrientation","textOverflow","MozTextOverflow","WebkitTextOverflow","MSTextOverflow","OTextOverflow","textRendering","MozTextRendering","WebkitTextRendering","MSTextRendering","OTextRendering","textShadow","MozTextShadow","WebkitTextShadow","MSTextShadow","OTextShadow","textTransform","MozTextTransform","WebkitTextTransform","MSTextTransform","OTextTransform","textUnderlinePosition","MozTextUnderlinePosition","WebkitTextUnderlinePosition","MSTextUnderlinePosition","OTextUnderlinePosition","top","MozTop","WebkitTop","MSTop","OTop","touchAction","MozTouchAction","WebkitTouchAction","MSTouchAction","OTouchAction","transform","MozTransform","WebkitTransform","msTransform","OTransform","transformBox","MozTransformBox","WebkitTransformBox","MSTransformBox","OTransformBox","transformOrigin","MozTransformOrigin","WebkitTransformOrigin","MSTransformOrigin","OTransformOrigin","transformStyle","MozTransformStyle","WebkitTransformStyle","MSTransformStyle","OTransformStyle","transition","MozTransition","WebkitTransition","MSTransition","OTransition","transitionDelay","MozTransitionDelay","WebkitTransitionDelay","MSTransitionDelay","OTransitionDelay","transitionDuration","MozTransitionDuration","WebkitTransitionDuration","MSTransitionDuration","OTransitionDuration","transitionProperty","MozTransitionProperty","WebkitTransitionProperty","MSTransitionProperty","OTransitionProperty","transitionTimingFunction","MozTransitionTimingFunction","WebkitTransitionTimingFunction","MSTransitionTimingFunction","OTransitionTimingFunction","turn","MozTurn","WebkitTurn","MSTurn","OTurn","unicodeBidi","MozUnicodeBidi","WebkitUnicodeBidi","MSUnicodeBidi","OUnicodeBidi","unset","MozUnset","WebkitUnset","MSUnset","OUnset","verticalAlign","MozVerticalAlign","WebkitVerticalAlign","MSVerticalAlign","OVerticalAlign","vh","MozVh","WebkitVh","MSVh","OVh","visibility","MozVisibility","WebkitVisibility","MSVisibility","OVisibility","vmax","MozVmax","WebkitVmax","MSVmax","OVmax","vmin","MozVmin","WebkitVmin","MSVmin","OVmin","vw","MozVw","WebkitVw","MSVw","OVw","whiteSpace","MozWhiteSpace","WebkitWhiteSpace","MSWhiteSpace","OWhiteSpace","widows","MozWidows","WebkitWidows","MSWidows","OWidows","width","MozWidth","WebkitWidth","MSWidth","OWidth","willChange","MozWillChange","WebkitWillChange","MSWillChange","OWillChange","wordBreak","MozWordBreak","WebkitWordBreak","MSWordBreak","OWordBreak","wordSpacing","MozWordSpacing","WebkitWordSpacing","MSWordSpacing","OWordSpacing","wordWrap","MozWordWrap","WebkitWordWrap","MSWordWrap","OWordWrap","writingMode","MozWritingMode","WebkitWritingMode","MSWritingMode","OWritingMode","zIndex","MozZIndex","WebkitZIndex","MSZIndex","OZIndex","fontSize","MozFontSize","WebkitFontSize","MSFontSize","OFontSize","flex","MozFlex","WebkitFlex","MSFlex","OFlex","fr","MozFr","WebkitFr","MSFr","OFr","overflowScrolling","MozOverflowScrolling","WebkitOverflowScrolling","MSOverflowScrolling","OOverflowScrolling","userSelect","MozUserSelect","WebkitUserSelect","MSUserSelect","OUserSelect"]},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BusyModal=void 0;const r=i(40);t.BusyModal=class extends r.Controller{constructor(e,t={}){super(e,t);const i=t.busyModalBackdropElement||document.body;if(!i)throw"Missing config: busyModalBackdropElement";this._modal=document.createElement("div"),this._modal.classList.add("xeokit-busy-modal"),this._modal.innerHTML='<div class="xeokit-busy-modal-content"><div class="xeokit-busy-modal-body"><div class="xeokit-busy-modal-message">Default text</div></div></div>',i.appendChild(this._modal),this._modalVisible=!1,this._modal.style.display="hidden"}show(e){this._modalVisible=!0,this._modal.querySelector(".xeokit-busy-modal-message").innerText=e,this._modal.style.display="block"}hide(){this._modalVisible=!1,this._modal.style.display="none"}destroy(){super.destroy(),this._modal&&(this._modal.parentNode.removeChild(this._modal),this._modal=null)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasContextMenu=void 0;const r=i(74),n=i(0);t.CanvasContextMenu=class extends r.ContextMenu{constructor(e={}){super({context:e.context,items:[[{title:"Hide All",getEnabled:function(e){return e.viewer.scene.numVisibleObjects>0},doAction:function(e){e.viewer.scene.setObjectsVisible(e.viewer.scene.visibleObjectIds,!1)}},{title:"Show all",getEnabled:function(e){const t=e.viewer.scene;return t.numVisibleObjects<t.numObjects||e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsXRayed(t.xrayedObjectIds,!1)}}],[{title:"View Fit All",doAction:function(e){const t=e.viewer,i=t.scene,r=i.getAABB(i.visibleObjectIds);t.cameraFlight.flyTo({aabb:r,duration:.5}),t.cameraControl.pivotPos=n.math.getAABB3Center(r)}}],[{title:"X-Ray All",getEnabled:function(e){const t=e.viewer.scene;return t.numXRayedObjects<t.numObjects},doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsXRayed(t.objectIds,!0),t.setObjectsPickable(t.objectIds,!1)}},{title:"X-Ray None",getEnabled:function(e){return e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene.xrayedObjectIds;e.viewer.scene.setObjectsPickable(t,!0),e.viewer.scene.setObjectsXRayed(t,!1)}}],[{title:"Select None",getEnabled:function(e){return e.viewer.scene.numSelectedObjects>0},doAction:function(e){e.viewer.scene.setObjectsSelected(e.viewer.scene.selectedObjectIds,!1)}}],[{title:"Reset View",doAction:function(e){e.bimViewer.resetView()}}],[{title:"Clear Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.clearSections()}}]]})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectContextMenu=void 0;const r=i(74),n=i(0);t.ObjectContextMenu=class extends r.ContextMenu{constructor(e={}){super({context:e.context,items:[[{title:"View Fit",doAction:function(e){const t=e.viewer,i=t.scene,r=e.entity;t.cameraFlight.flyTo({aabb:r.aabb,duration:.5},()=>{setTimeout((function(){i.setObjectsHighlighted(i.highlightedObjectIds,!1)}),500)}),t.cameraControl.pivotPos=n.math.getAABB3Center(r.aabb)}},{title:"View Fit All",doAction:function(e){const t=e.viewer,i=t.scene,r=i.getAABB(i.visibleObjectIds);t.cameraFlight.flyTo({aabb:r,duration:.5}),t.cameraControl.pivotPos=n.math.getAABB3Center(r)}},{title:"Show in Tree",doAction:function(e){const t=e.entity.id;e.showObjectInExplorers(t)}},{title:"Show properties",doAction:function(e){const t=e.entity.id;e.showObjectProperties(t)}}],[{title:"Hide",getEnabled:function(e){return e.entity.visible},doAction:function(e){e.entity.visible=!1}},{title:"Hide Others",doAction:function(e){const t=e.viewer,i=t.scene,r=e.entity,n=t.metaScene.metaObjects[r.id];n&&(i.setObjectsVisible(i.visibleObjectIds,!1),i.setObjectsHighlighted(i.highlightedObjectIds,!1),n.withMetaObjectsInSubtree(e=>{const t=i.objects[e.id];t&&(t.visible=!0)}))}},{title:"Hide All",getEnabled:function(e){return e.viewer.scene.numVisibleObjects>0},doAction:function(e){e.viewer.scene.setObjectsVisible(e.viewer.scene.visibleObjectIds,!1)}},{title:"Show All",getEnabled:function(e){const t=e.viewer.scene;return t.numVisibleObjects<t.numObjects||e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsPickable(t.xrayedObjectIds,!0),t.setObjectsXRayed(t.xrayedObjectIds,!1)}}],[{title:"X-Ray",getEnabled:function(e){return!e.entity.xrayed},doAction:function(e){const t=e.entity;t.xrayed=!0,t.pickable=!1}},{title:"X-Ray Others",doAction:function(e){const t=e.viewer,i=t.scene,r=e.entity,n=t.metaScene.metaObjects[r.id];n&&(i.setObjectsVisible(i.objectIds,!0),i.setObjectsXRayed(i.objectIds,!0),i.setObjectsPickable(i.objectIds,!1),i.setObjectsHighlighted(i.highlightedObjectIds,!1),n.withMetaObjectsInSubtree(e=>{const t=i.objects[e.id];t&&(t.xrayed=!1,t.pickable=!0)}))}},{title:"X-Ray All",getEnabled:function(e){const t=e.viewer.scene;return t.numXRayedObjects<t.numObjects},doAction:function(e){const t=e.viewer.scene;t.setObjectsVisible(t.objectIds,!0),t.setObjectsPickable(t.objectIds,!1),t.setObjectsXRayed(t.objectIds,!0)}},{title:"X-Ray None",getEnabled:function(e){return e.viewer.scene.numXRayedObjects>0},doAction:function(e){const t=e.viewer.scene,i=t.xrayedObjectIds;t.setObjectsPickable(i,!0),t.setObjectsXRayed(i,!1)}}],[{title:"Select",getEnabled:function(e){return!e.entity.selected},doAction:function(e){e.entity.selected=!0}},{title:"Undo Select",getEnabled:function(e){return e.entity.selected},doAction:function(e){e.entity.selected=!1}},{title:"Select None",getEnabled:function(e){return e.viewer.scene.numSelectedObjects>0},doAction:function(e){e.viewer.scene.setObjectsSelected(e.viewer.scene.selectedObjectIds,!1)}}],[{title:"Clear Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.clearSections()}}]]})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClassesExplorer=void 0;const r=i(1),n=i(44),o=i(125),s=i(126),a=i(75);class l extends r.Component{constructor(e){super(e),this.modelsRef=r.createRef(),this.state={tabEnabled:!0,showClassesEnabled:!0,hideClassesEnabled:!0}}componentDidMount(){this._treeView=new s.TreeViewPlugin(this.props.viewer,{containerElement:this.modelsRef.current,hierarchy:"types",autoAddModels:!1,pruneEmptyNodes:!0}),this._treeViewContextMenu=new o.TreeViewContextMenu,this._treeView.on("contextmenu",e=>{this._treeViewContextMenu.context={bimViewer:this.props.bimViewer,viewer:e.viewer,treeViewPlugin:e.treeViewPlugin,treeViewNode:e.treeViewNode},this._treeViewContextMenu.show(e.event.pageX,e.event.pageY)}),this._onModelLoaded=this.props.viewer.scene.on("modelLoaded",e=>{if(this.props.viewer.metaScene.metaModels[e]){const t=this.props.bimViewer.getModelInfo(e);if(!t)return;this._treeView.addModel(e,{rootName:t.name})}}),this._onModelUnloaded=this.props.viewer.scene.on("modelUnloaded",e=>{this.props.viewer.metaScene.metaModels[e]&&this._treeView.removeModel(e)}),this.props.bimViewer.on("reset",()=>{this._treeView.collapse()})}setEnabled(e){this.setState({tabEnabled:e,showClassesEnabled:e,hideClassesEnabled:e})}expandTreeViewToDepth(e){this._treeView.expandToDepth(e)}showNodeInTreeView(e){this._treeView.collapse(),this._treeView.showNode(e)}unShowNodeInTreeView(){this._treeView.unShowNode()}destroy(){this.props.destroy(),this._treeView.destroy(),this._treeViewContextMenu.destroy(),this.props.viewer.scene.off(this._onModelLoaded),this.props.viewer.scene.off(this._onModelUnloaded)}render(){const{classes:e}=this.props;return r.createElement("div",{className:e.root+(this.props.activeTab?"":" "+e.rootHidden),hidden:!this.props.activeTab},r.createElement("div",{className:e.buttonRow},r.createElement(a.ButtonGroup,{color:"default",className:e.buttonGroup},r.createElement(a.Button,{variant:"contained",onClick:this.props.showAll,className:e.button,disabled:!this.state.showClassesEnabled},"Show All"),r.createElement(a.Button,{variant:"contained",onClick:this.props.hideAll,className:e.button,disabled:!this.state.hideClassesEnabled},"Hide All"))),r.createElement("div",{className:e.content,ref:this.modelsRef}))}}t.ClassesExplorer=l,t.default=n.withStyles(e=>({root:{flex:"1 1 100%",display:"flex",flexDirection:"column",overflow:"auto","& ul":{listStyle:"none",paddingLeft:"1.75em"},"& ul li":{margin:"2px 0",position:"relative",lineHeight:"3ex"},"& ul li a":{backgroundColor:"#eee",borderRadius:"50%",color:"#000",display:"inline-block",height:"1.5em",left:"-1.5em",position:"absolute",textAlign:"center",textDecoration:"none",width:"1.5em"},"& ul li a.plus":{backgroundColor:"#ded"},"& ul li a.minus":{backgroundColor:"#eee"},"& ul li a:active":{top:"1px"},"& ul li input":{verticalAlign:"middle"},"& ul li span":{display:"inline-block",paddingLeft:"2px",verticalAlign:"middle"},"ul li span:hover":{color:"white",cursor:"pointer",background:"rgba(255, 255, 255, 0.2)",paddingLeft:"2px",verticalAlign:"middle"},"& .top-right":{fontSize:"small",position:"fixed",right:"1em",top:"1em"},"& .highlighted-node":{border:"black solid 1px",background:"yellow",color:"black",paddingLeft:"1px",paddingRight:"5px"}},rootHidden:{display:"none"},content:{padding:"0px 20px 20px 20px",overflow:"auto"},buttonRow:{textAlign:"center",marginTop:"20px",marginBottom:"10px"},buttonGroup:{margin:"0px 10px 10px 10px"},button:{color:e.palette.primary.main,backgroundColor:"white","&:hover":{color:e.palette.secondary.main,backgroundColor:"white"}},selectedButton:{color:"white",backgroundColor:e.palette.secondary.main,"&:hover":{color:"white",backgroundColor:e.palette.secondary.main}}}))(l)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelsExplorer=void 0;const r=i(1),n=i(44),o=i(232),s=i(75);class a extends r.Component{constructor(e){super(e),this.modelsRef=r.createRef(),this._enableAddModels=!!e.enableEditModels,this._modelsContextMenu=new o.ModelsContextMenu({enableEditModels:this.props.enableEditModels}),this.state={addModelEnabled:!0,unloadModelsEnabled:!0,loadModelsEnabled:!0,tabEnabled:!0}}componentDidMount(){this._buildModelsMenu(this.props.modelsInfo)}componentDidUpdate(e){if(e.numModelsLoaded!=this.props.numModelsLoaded)for(const e of Object.keys(this.props.modelsInfo)){const t=this.props.modelsInfo[e].id,i=document.getElementById(t);i&&(i.checked=this.props.viewer.scene.models[t])}}_buildModelsMenu(e){var t="";for(const i of Object.keys(e)){const r=e[i];t+="<div class='xeokit-form-check'>",t+="<input id='"+r.id+"' type='checkbox' value=''><label id='span-"+r.id+"' for='"+r.id+"' class='disabled'>"+r.name+"</span>",t+="</div>"}this.modelsRef.current.innerHTML=t;for(const t of Object.keys(e)){const i=e[t],r=i.id,n=document.getElementById(r),o=document.getElementById("span-"+r);n.addEventListener("click",()=>{n.checked?this.props.loadModel(r):this.props.unloadModel(i.id)}),o.oncontextmenu=e=>{this._modelsContextMenu.context={bimViewer:this.props.bimViewer,viewer:this.props.viewer,modelId:r},this._modelsContextMenu.show(e.pageX,e.pageY),e.preventDefault()}}}setEnabled(e){this.setState({tabEnabled:e,unloadModelsEnabled:e})}destroy(){this.props.destroy()}render(){const{classes:e}=this.props;return r.createElement("div",{className:e.root+(this.props.activeTab?"":" "+e.rootHidden),hidden:!this.props.activeTab},r.createElement("div",{className:e.buttonRow},r.createElement(s.ButtonGroup,{color:"default",className:e.buttonGroup},r.createElement(s.Button,{variant:"contained",onClick:this.props.loadAll,className:e.button,disabled:!this.state.loadModelsEnabled},"Load All"),r.createElement(s.Button,{variant:"contained",onClick:this.props.unloadAll,className:e.button,disabled:!this.state.unloadModelsEnabled},"Unload All")),this.props.enableEditModels&&r.createElement(s.Button,{variant:"contained",onClick:this.props.addModel,className:e.button,disabled:!this.state.addModelEnabled},"Add")),r.createElement("div",{className:e.content,ref:this.modelsRef}))}}t.ModelsExplorer=a,t.default=n.withStyles(e=>({root:{flex:"1 1 100%",display:"flex",flexDirection:"column",overflow:"auto","& .xeokit-form-check":{padding:"2px 0 2px 15px",lineHeight:"3ex"},"& .xeokit-form-check input":{verticalAlign:"middle"},"& .xeokit-form-check span":{display:"inline-block",color:"#ffff",backgroundColor:"#03103F",paddingLeft:"3px",width:"calc(100% - 30px)",verticalAlign:"middle"},"& .xeokit-form-check span.disabled":{color:"#99A4AD",backgroundColor:"#03103F"},"& .xeokit-form-check span:hover":{color:"#ffffff",cursor:"pointer",background:"rgba(255, 255, 255, 0.2)",paddingLeft:"3px"},"& .xeokit-form-check span.disabled:hover":{color:"#99A4AD",backgroundColor:"#03103F",cursor:"default"}},rootHidden:{display:"none"},buttonRow:{textAlign:"center",marginTop:"20px",marginBottom:"10px"},content:{padding:"0px 20px 20px 20px",overflow:"auto"},buttonGroup:{margin:"0px 10px 10px 10px"},button:{color:e.palette.primary.main,backgroundColor:"white","&:hover":{color:e.palette.secondary.main,backgroundColor:"white"}},selectedButton:{color:"white",backgroundColor:e.palette.secondary.main,"&:hover":{color:"white",backgroundColor:e.palette.secondary.main}}}))(a)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelsContextMenu=void 0;const r=i(74);t.ModelsContextMenu=class extends r.ContextMenu{constructor(e={}){const t=[[{title:"Load",getEnabled:function(e){return!e.bimViewer.isModelLoaded(e.modelId)},doAction:function(e){e.bimViewer.loadModel(e.modelId)}},{title:"Unload",getEnabled:function(e){return e.bimViewer.isModelLoaded(e.modelId)},doAction:function(e){e.bimViewer.unloadModel(e.modelId)}}]];!!e.enableEditModels&&t.push([{title:"Edit",getEnabled:function(e){return!0},doAction:function(e){e.bimViewer.editModel(e.modelId)}},{title:"Delete",getEnabled:function(e){return!0},doAction:function(e){e.bimViewer.deleteModel(e.modelId)}}]),t.push([{title:"Load All",getEnabled:function(e){const t=e.bimViewer,i=t.getModelIds();return t.getLoadedModelIds().length<i.length},doAction:function(e){e.bimViewer.loadAllModels()}},{title:"Unload All",getEnabled:function(e){return e.bimViewer.getLoadedModelIds().length>0},doAction:function(e){e.bimViewer.unloadAllModels()}}]),t.push([{title:"Clear Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.clearSections()}}]),super({context:e.context,items:t})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectsExplorer=void 0;const r=i(1),n=i(44),o=i(125),s=i(126),a=i(75);class l extends r.Component{constructor(e){super(e),this.modelsRef=r.createRef(),this.state={tabEnabled:!0,showObjectsEnabled:!0,hideObjectsEnabled:!0}}componentDidMount(){this._treeView=new s.TreeViewPlugin(this.props.viewer,{containerElement:this.modelsRef.current,hierarchy:"containment",autoAddModels:!1,pruneEmptyNodes:!0}),this._treeViewContextMenu=new o.TreeViewContextMenu,this._treeView.on("contextmenu",e=>{this._treeViewContextMenu.context={bimViewer:this.props.bimViewer,viewer:e.viewer,treeViewPlugin:e.treeViewPlugin,treeViewNode:e.treeViewNode},this._treeViewContextMenu.show(e.event.pageX,e.event.pageY)}),this._onModelLoaded=this.props.viewer.scene.on("modelLoaded",e=>{if(this.props.viewer.metaScene.metaModels[e]){const t=this.props.bimViewer.getModelInfo(e);if(!t)return;this._treeView.addModel(e,{rootName:t.name})}}),this._onModelUnloaded=this.props.viewer.scene.on("modelUnloaded",e=>{this.props.viewer.metaScene.metaModels[e]&&this._treeView.removeModel(e)}),this.props.bimViewer.on("reset",()=>{this._treeView.collapse()})}setEnabled(e){this.setState({tabEnabled:e,showObjectsEnabled:e,hideObjectsEnabled:e})}expandTreeViewToDepth(e){this._treeView.expandToDepth(e)}showNodeInTreeView(e){this._treeView.collapse(),this._treeView.showNode(e)}unShowNodeInTreeView(){this._treeView.unShowNode()}destroy(){this.props.destroy(),this._treeView.destroy(),this._treeViewContextMenu.destroy(),this.props.viewer.scene.off(this._onModelLoaded),this.props.viewer.scene.off(this._onModelUnloaded)}render(){const{classes:e}=this.props;return r.createElement("div",{className:e.root+(this.props.activeTab?"":" "+e.rootHidden),hidden:!this.props.activeTab},r.createElement("div",{className:e.buttonRow},r.createElement(a.ButtonGroup,{color:"default",className:e.buttonGroup},r.createElement(a.Button,{variant:"contained",onClick:this.props.showAll,className:e.button,disabled:!this.state.showObjectsEnabled},"Show All"),r.createElement(a.Button,{variant:"contained",onClick:this.props.hideAll,className:e.button,disabled:!this.state.hideObjectsEnabled},"Hide All"))),r.createElement("div",{className:e.content,ref:this.modelsRef}))}}t.ObjectsExplorer=l,t.default=n.withStyles(e=>({root:{flex:"1 1 100%",display:"flex",flexDirection:"column",overflow:"auto","& ul":{listStyle:"none",paddingLeft:"1.75em"},"& ul li":{margin:"2px 0",position:"relative",lineHeight:"3ex"},"& ul li a":{backgroundColor:"#eee",borderRadius:"50%",color:"#000",display:"inline-block",height:"1.5em",left:"-1.5em",position:"absolute",textAlign:"center",textDecoration:"none",width:"1.5em"},"& ul li a.plus":{backgroundColor:"#ded"},"& ul li a.minus":{backgroundColor:"#eee"},"& ul li a:active":{top:"1px"},"& ul li input":{verticalAlign:"middle"},"& ul li span":{display:"inline-block",paddingLeft:"2px",verticalAlign:"middle"},"& ul li span:hover":{color:"#ffffff",cursor:"pointer",background:"rgba(255, 255, 255, 0.2)",paddingLeft:"2px",verticalAlign:"middle"},"& .top-right":{fontSize:"small",position:"fixed",right:"1em",top:"1em"},"& .highlighted-node":{border:"black solid 1px",background:"yellow",color:"black",paddingLeft:"1px",paddingRight:"5px"}},rootHidden:{display:"none"},content:{padding:"0px 20px 20px 20px",overflow:"auto"},buttonRow:{textAlign:"center",marginTop:"20px",marginBottom:"10px"},buttonGroup:{margin:"0px 10px 10px 10px"},button:{color:e.palette.primary.main,backgroundColor:"white","&:hover":{color:e.palette.secondary.main,backgroundColor:"white"}},selectedButton:{color:"white",backgroundColor:e.palette.secondary.main,"&:hover":{color:"white",backgroundColor:e.palette.secondary.main}}}))(l)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreysExplorer=void 0;const r=i(1),n=i(44),o=i(125),s=i(0),a=i(126),l=i(75),c=i(254),u=s.math.vec3();class h extends r.Component{constructor(e){super(e),this.clearStoreySelection=()=>{this.setState({selectedStorey:null})},this.handleShowAll=e=>{this.clearStoreySelection(),this.props.showAll(e)},this.handleHideAll=e=>{this.clearStoreySelection(),this.props.hideAll(e)},this.handleSelectStory=(e,t)=>{if(t.length>0)for(const e of t)this._storeyViewsPlugin.showStoreyObjects(e,{hideOthers:e==t[0],useObjectStates:!1});this.setState({selectedStorey:e})},this.modelsRef=r.createRef(),this.state={tabEnabled:!0,showStoreysEnabled:!0,hideStoreysEnabled:!0,selectedStorey:null,advancedMode:!1}}componentDidMount(){this._storeyViewsPlugin=new c.StoreyViewsPlugin(this.props.viewer),this._treeView=new a.TreeViewPlugin(this.props.viewer,{containerElement:this.modelsRef.current,autoAddModels:!1,hierarchy:"storeys",autoExpandDepth:1}),this._treeViewContextMenu=new o.TreeViewContextMenu,this._treeView.on("contextmenu",e=>{this._treeViewContextMenu.context={bimViewer:this.props.bimViewer,viewer:e.viewer,treeViewPlugin:e.treeViewPlugin,treeViewNode:e.treeViewNode,pruneEmptyNodes:!0},this._treeViewContextMenu.show(e.event.pageX,e.event.pageY)}),this._onModelLoaded=this.props.viewer.scene.on("modelLoaded",e=>{const t=this.props.bimViewer.getModelInfo(e);t&&this._treeView.addModel(e,{rootName:t.name})}),this._onModelUnloaded=this.props.viewer.scene.on("modelUnloaded",e=>{this.props.viewer.metaScene.metaModels[e]&&this._treeView.removeModel(e)}),this.props.bimViewer.on("reset",()=>{this._treeView.collapse(),this._treeView.expandToDepth(1)})}getStoreys(){const e={};if(this.props.viewer.metaScene.metaObjectsByType.IfcBuildingStorey)for(const t in this.props.viewer.metaScene.metaObjectsByType.IfcBuildingStorey){const i=this.props.viewer.metaScene.metaObjectsByType.IfcBuildingStorey[t].name;e[i]?e[i].push(t):e[i]=[t]}return e}setEnabled(e){this.setState({tabEnabled:e,showStoreysEnabled:e,hideStoreysEnabled:e})}expandTreeViewToDepth(e){this._treeView.expandToDepth(e)}showNodeInTreeView(e){this._treeView.collapse(),this._treeView.showNode(e)}unShowNodeInTreeView(){this._treeView.unShowNode()}selectStorey(e,t){const i=this.props.viewer.metaScene.metaObjects[e];if(!i)return void this.props.error("selectStorey() - object is not found: '"+e+"'");if("IfcBuildingStorey"!==i.type)return void this.props.error("selectStorey() - object is not found: '"+e+"'");const r=i.getObjectIDsInSubtree();this._selectObjects(r,t)}_selectObjects(e,t){const i=this.props.viewer.scene,r=i.getAABB(e);this.props.viewer.cameraControl.pivotPos=s.math.getAABB3Center(r,u),t?(i.setObjectsXRayed(i.objectIds,!0),i.setObjectsVisible(i.objectIds,!0),i.setObjectsPickable(i.objectIds,!1),i.setObjectsSelected(i.selectedObjectIds,!1),i.setObjectsXRayed(e,!1),i.setObjectsVisible(e,!0),i.setObjectsPickable(e,!0),this.props.viewer.cameraFlight.flyTo({aabb:r},()=>{setTimeout((function(){i.setObjectsVisible(i.xrayedObjectIds,!1),i.setObjectsXRayed(i.xrayedObjectIds,!1)}),500),t()})):(i.setObjectsVisible(i.objectIds,!1),i.setObjectsPickable(i.xrayedObjectIds,!0),i.setObjectsXRayed(i.xrayedObjectIds,!1),i.setObjectsSelected(i.selectedObjectIds,!1),i.setObjectsVisible(e,!0),this.props.viewer.cameraFlight.jumpTo({aabb:r}))}destroy(){this.props.destroy(),this._treeView.destroy(),this._treeViewContextMenu.destroy(),this.props.viewer.scene.off(this._onModelLoaded),this.props.viewer.scene.off(this._onModelUnloaded)}render(){const{classes:e}=this.props,t=this.getStoreys();return r.createElement("div",{className:e.root+(this.props.activeTab?"":" "+e.rootHidden)},r.createElement("div",{className:e.buttonRow},r.createElement(l.ButtonGroup,{color:"default",className:e.buttonGroup},r.createElement(l.Button,{variant:"contained",onClick:()=>{this.state.advancedMode&&(this.clearStoreySelection(),this.setState({advancedMode:!1}))},className:this.state.advancedMode?e.button:e.selectedButton},"Simple"),r.createElement(l.Button,{variant:"contained",onClick:()=>this.setState({advancedMode:!0}),className:this.state.advancedMode?e.selectedButton:e.button},"Advanced")),r.createElement(l.ButtonGroup,{color:"default",className:e.buttonGroup},r.createElement(l.Button,{variant:"contained",onClick:this.handleShowAll,className:e.button,disabled:!this.state.showStoreysEnabled},"Show All"),r.createElement(l.Button,{variant:"contained",onClick:this.handleHideAll,className:e.button,disabled:!this.state.hideStoreysEnabled},"Hide All"))),r.createElement("div",{className:e.content+(this.state.advancedMode?"":" hidden"),ref:this.modelsRef}),!this.state.advancedMode&&r.createElement(l.List,{className:e.storeyList},Object.keys(t).sort().map(e=>r.createElement(l.ListItem,{key:t[e].join(),button:!0,selected:this.state.selectedStorey===e,onClick:()=>this.handleSelectStory(e,t[e])},e))))}}t.StoreysExplorer=h,t.default=n.withStyles(e=>({root:{flex:"1 1 100%",display:"flex",flexDirection:"column",overflow:"auto","& ul":{listStyle:"none",paddingLeft:"1.75em"},"& ul li":{margin:"2px 0",position:"relative",lineHeight:"3ex"},"& ul li a":{backgroundColor:"#eee",borderRadius:"50%",color:"#000",display:"inline-block",height:"1.5em",left:"-1.5em",position:"absolute",textAlign:"center",textDecoration:"none",width:"1.5em"},"ul li a.plus":{backgroundColor:"#ded"},"& ul li a.minus":{backgroundColor:"#eee"},"& ul li a:active":{top:"1px"},"& ul li input":{verticalAlign:"middle"},"& ul li span":{display:"inline-block",paddingLeft:"2px",verticalAlign:"middle"},"& ul li span:hover":{color:"white",cursor:"pointer",background:"rgba(255, 255, 255, 0.2)",paddingLeft:"2px"},"& .top-right":{fontSize:"small",position:"fixed",right:"1em",top:"1em"},"& .highlighted-node":{border:"black solid 1px",background:"yellow",color:"black",paddingLeft:"1px",paddingRight:"5px"}},rootHidden:{display:"none"},content:{padding:"0px 20px 20px 20px",overflow:"auto"},storeyList:{marginRight:"30px"},buttonRow:{textAlign:"center",marginTop:"20px",marginBottom:"10px"},buttonGroup:{margin:"0px 10px 10px 10px"},button:{color:e.palette.primary.main,backgroundColor:"white","&:hover":{color:e.palette.secondary.main,backgroundColor:"white"}},selectedButton:{color:"white",backgroundColor:e.palette.secondary.main,"&:hover":{color:"white",backgroundColor:e.palette.secondary.main}}}))(h)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelIFCObjectColors=void 0,t.ModelIFCObjectColors={IfcSpace:{opacity:.3},IfcWindow:{opacity:.4},IfcOpeningElement:{opacity:.3},IfcPlate:{opacity:.3}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerIFCObjectColors=void 0,t.ViewerIFCObjectColors={IfcRoof:{colorize:[.837255,.203922,.270588],priority:0},IfcSlab:{colorize:[.637255,.603922,.670588],priority:0},IfcWall:{colorize:[.537255,.337255,.237255],priority:0},IfcWallStandardCase:{colorize:[.537255,.337255,.237255],priority:0},IfcCovering:{colorize:[.8470588235,.427450980392,0],priority:0},IfcDoor:{colorize:[.637255,.603922,.670588],priority:1},IfcStair:{colorize:[.637255,.603922,.670588],priority:2},IfcStairFlight:{colorize:[.637255,.603922,.670588],priority:2},IfcProxy:{colorize:[.137255,.403922,.870588],priority:2},IfcRamp:{colorize:[.8470588235,.427450980392,0],priority:2},IfcColumn:{colorize:[.137255,.403922,.870588],priority:3},IfcBeam:{colorize:[.137255,.403922,.870588],priority:3},IfcCurtainWall:{colorize:[.137255,.403922,.870588],priority:3},IfcPlate:{colorize:[.8470588235,.427450980392,0,.5],opacity:.5,priority:3},IfcTransportElement:{colorize:[.8470588235,.427450980392,0],priority:3},IfcFooting:{colorize:[.8470588235,.427450980392,0],priority:3},IfcRailing:{colorize:[.137255,.403922,.870588],priority:4},IfcFurnishingElement:{colorize:[.137255,.403922,.870588],priority:4},IfcFurniture:{colorize:[.8470588235,.427450980392,0],priority:4},IfcSystemFurnitureElement:{colorize:[.8470588235,.427450980392,0],priority:4},IfcFlowSegment:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowitting:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowTerminal:{colorize:[.137255,.403922,.870588],priority:5},IfcFlowController:{colorize:[.8470588235,.427450980392,0],priority:5},IfcFlowFitting:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDuctSegment:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDistributionFlowElement:{colorize:[.8470588235,.427450980392,0],priority:5},IfcDuctFitting:{colorize:[.8470588235,.427450980392,0],priority:5},IfcLightFixture:{colorize:[.8470588235,.8470588235,.870588],priority:5},IfcAirTerminal:{colorize:[.8470588235,.427450980392,0],priority:6},IfcOpeningElement:{colorize:[.137255,.403922,.870588],opacity:.3,priority:6},IfcSpace:{colorize:[.137255,.403922,.870588],opacity:.5,priority:6},IfcWindow:{colorize:[.137255,.403922,.870588],opacity:.4,priority:6},IfcBuildingElementProxy:{colorize:[.5,.5,.5]},IfcSite:{colorize:[.137255,.403922,.870588]},IfcMember:{colorize:[.8470588235,.427450980392,0]},DEFAULT:{colorize:[.5,.5,.5],priority:10}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPersonMode=void 0;const r=i(40);t.FirstPersonMode=class extends r.Controller{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement,r=this.viewer.cameraControl,n=t.cameraControlNavModeMediator;r.navMode="orbit",r.followPointer=!0,this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{e?i.classList.add("active"):i.classList.remove("active")}),this.on("active",e=>{n.setFirstPersonModeActive(e),e?(r.followPointer=!0,r.pivoting=!1):r.pivoting=!0}),i.addEventListener("click",e=>{if(!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.bimViewer.on("reset",()=>{this.setActive(!1)})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FitAction=void 0;const r=i(40),n=i(0),o=n.math.vec3();t.FitAction=class extends r.Controller{constructor(e,t={}){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{e?i.classList.add("active"):i.classList.remove("active")}),i.addEventListener("click",e=>{this.getEnabled()&&this.fit(),e.preventDefault()})}fit(){const e=this.viewer.scene,t=e.getAABB(e.visibleObjectIds);this.viewer.cameraFlight.flyTo({aabb:t}),this.viewer.cameraControl.pivotPos=n.math.getAABB3Center(t,o)}set fov(e){this.viewer.scene.cameraFlight.fitFOV=e}get fov(){return this.viewer.scene.cameraFlight.fitFOV}set duration(e){this.viewer.scene.cameraFlight.duration=e}get duration(){return this.viewer.scene.cameraFlight.duration}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HideTool=void 0;const r=i(40),n=i(0);t.HideTool=class extends r.Controller{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{e?(i.classList.add("active"),this.viewer.cameraControl.doublePickFlyTo=!1):(i.classList.remove("active"),this.viewer.cameraControl.doublePickFlyTo=!0)}),i.addEventListener("click",e=>{if(!this.getEnabled())return;this.bimViewer._sectionTool.hideControl();const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.bimViewer.on("reset",()=>{this.setActive(!1)}),this._init()}_init(){var e=null;this._onHover=this.viewer.cameraControl.on("hover",t=>{this.getActive()&&this.getEnabled()&&(e&&(e.highlighted=!1,e=null),t.entity&&t.entity.isObject&&((e=t.entity).highlighted=!0))}),this._onHoverOff=this.viewer.cameraControl.on("hoverOff",t=>{this.getActive()&&this.getEnabled()&&e&&(e.highlighted=!1,e=null)});const t=n.math.vec2(),i=this.viewer.scene.input;this._onMousedown=i.on("mousedown",e=>{!i.mouseDownLeft||i.mouseDownRight||i.mouseDownMiddle||(t[0]=e[0],t[1]=e[1])}),this._onMouseup=i.on("mouseup",i=>{if(this.getActive()&&this.getEnabled()&&e){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(t,i))return void(e=null);e.visible=!1,e.highlighted=!1,e=null}})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavCubeMode=void 0;const r=i(40),n=i(255);t.NavCubeMode=class extends r.Controller{constructor(e,t){if(super(e,t),!t.navCubeCanvasElement)throw"Missing config: navCubeCanvasElement";const i=t.navCubeCanvasElement;this._navCube=new n.NavCubePlugin(this.viewer,{canvasElement:i,fitVisible:!0,color:"#CFCFCF"}),this._navCube.setVisible(this._active),this.on("active",e=>{this._navCube.setVisible(e)})}destroy(){this._navCube.destroy(),super.destroy()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryTool=void 0;const r=i(40),n=i(0);t.QueryTool=class extends r.Controller{constructor(e,t){if(super(e),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{e?i.classList.add("active"):i.classList.remove("active")}),i.addEventListener("click",e=>{if(this.bimViewer._sectionTool.hideControl(),!this.getEnabled())return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.bimViewer.on("reset",()=>{this.setActive(!1)}),this._init()}_init(){const e=this.viewer,t=e.cameraControl;var i=null;this._onHover=t.on("hover",e=>{this.getActive()&&this.getEnabled()&&(i&&(i.highlighted=!1,i=null),e.entity&&e.entity.isObject&&((i=e.entity).highlighted=!0))}),this._onHoverOff=t.on("hoverOff",e=>{this.getActive()&&this.getEnabled()&&i&&(i.highlighted=!1,i=null)});const r=n.math.vec2(),o=e.scene.input;this._onMousedown=o.on("mousedown",e=>{this.getActive()&&this.getEnabled()&&(!o.mouseDownLeft||o.mouseDownRight||o.mouseDownMiddle||(r[0]=e[0],r[1]=e[1]))}),this._onMouseup=o.on("mouseup",t=>{if(this.getActive()&&this.getEnabled())if(i){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(r,t))return void(i=null);this.fire("objectSelected",i.id);const n=i.model;if(!n)return;const o=this.bimViewer.getLoadedProjectId();if(!o)return void this.error("Query tool: should be a project loaded - ignoring query-pick");const s=n.id,a=i.id,l=e.metaScene.metaObjects[a];if(!l)return;const c={projectId:o,modelId:s,objectId:a,objectName:l.name,objectType:l.type};this.fire("queryPicked",c),i=null}else this.fire("queryNotPicked",!1)})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResetAction=void 0;const r=i(40),n=i(0),o=i(243),s=n.math.vec3();t.ResetAction=class extends r.Controller{constructor(e,t={}){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement,r=this.viewer.camera;this._modelMementos={},r.eye=[.577,.577,.577],r.look=[0,0,0],r.up=[-1,1,-1],this.bimViewer.on("modelLoaded",e=>{this._saveModelMemento(e)}),this.bimViewer.on("modelUnloaded",e=>{this._destroyModelMemento(e)}),this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{e?i.classList.add("active"):i.classList.remove("active")}),i.addEventListener("click",e=>{this.getEnabled()&&this.reset(),e.preventDefault()})}_saveModelMemento(e){const t=this.viewer.metaScene.metaModels[e];if(!t)return;const i=new o.ModelMemento;i.saveObjects(this.viewer.scene,t,{visible:!0,edges:!0,xrayed:!0,highlighted:!0,selected:!0,clippable:!0,pickable:!0,colorize:!0,opacity:!1}),this._modelMementos[e]=i}_restoreModelMemento(e){const t=this.viewer.metaScene.metaModels[e];t&&this._modelMementos[e].restoreObjects(this.viewer.scene,t)}_destroyModelMemento(e){delete this._modelMementos[e]}reset(){const e=this.viewer.scene.modelIds;for(var t=0,i=e.length;t<i;t++){const i=e[t];this._restoreModelMemento(i)}this.bimViewer.unShowObjectInExplorers(),this.fire("reset",!0),this._resetCamera()}_resetCamera(){const e=this.viewer,t=e.scene,i=t.getAABB(t.visibleObjectIds),r=n.math.getAABB3Diag(i),o=n.math.getAABB3Center(i,s),a=Math.abs(r/Math.tan(32.5)),l=t.camera,c=l.yUp?[-1,-1,-1]:[1,1,1],u=l.yUp?[-1,1,-1]:[-1,1,1];e.cameraControl.pivotPos=o,e.cameraControl.planView=!1,e.cameraFlight.flyTo({look:o,eye:[o[0]-a*c[0],o[1]-a*c[1],o[2]-a*c[2]],up:u,orthoScale:1.3*r,projection:"perspective",duration:1})}}},function(e,t,i){"use strict";i.r(t),i.d(t,"ModelMemento",(function(){return s}));var r=i(0),n=i(8);const o=r.math.vec3();class s{constructor(e){if(this.objectsVisible=[],this.objectsEdges=[],this.objectsXrayed=[],this.objectsHighlighted=[],this.objectsSelected=[],this.objectsClippable=[],this.objectsPickable=[],this.objectsColorize=[],this.objectsOpacity=[],this.numObjects=0,e){const t=e.metaScene.scene;this.saveObjects(t,e)}}saveObjects(e,t,i){const r=t.rootMetaObject;if(!r)return;const o=r.getObjectIDsInSubtree();this.numObjects=0,this._mask=i?n.utils.apply(i,{}):null;const s=e.objects,a=!i||i.visible,l=!i||i.edges,c=!i||i.xrayed,u=!i||i.highlighted,h=!i||i.selected,d=!i||i.clippable,p=!i||i.pickable,f=!i||i.colorize,m=!i||i.opacity;for(var g=0,v=o.length;g<v;g++){const e=s[o[g]];if(e){if(a&&(this.objectsVisible[g]=e.visible),l&&(this.objectsEdges[g]=e.edges),c&&(this.objectsXrayed[g]=e.xrayed),u&&(this.objectsHighlighted[g]=e.highlighted),h&&(this.objectsSelected[g]=e.selected),d&&(this.objectsClippable[g]=e.clippable),p&&(this.objectsPickable[g]=e.pickable),f){const t=e.colorize;this.objectsColorize[3*g+0]=t[0],this.objectsColorize[3*g+1]=t[1],this.objectsColorize[3*g+2]=t[2]}m&&(this.objectsOpacity[g]=e.opacity),this.numObjects++}}}restoreObjects(e,t){const i=t.rootMetaObject;if(!i)return;const r=i.getObjectIDsInSubtree(),n=this._mask,s=!n||n.visible,a=!n||n.edges,l=!n||n.xrayed,c=!n||n.highlighted,u=!n||n.selected,h=!n||n.clippable,d=!n||n.pickable,p=!n||n.colorize,f=!n||n.opacity,m=e.objects;for(var g=0,v=r.length;g<v;g++){const e=m[r[g]];e&&(s&&(e.visible=this.objectsVisible[g]),a&&(e.edges=this.objectsEdges[g]),l&&(e.xrayed=this.objectsXrayed[g]),c&&(e.highlighted=this.objectsHighlighted[g]),u&&(e.selected=this.objectsSelected[g]),h&&(e.clippable=this.objectsClippable[g]),d&&(e.pickable=this.objectsPickable[g]),p&&(o[0]=this.objectsColorize[3*g+0],o[1]=this.objectsColorize[3*g+1],o[2]=this.objectsColorize[3*g+2],e.colorize=o),f&&(e.opacity=this.objectsOpacity[g]))}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SectionTool=void 0;const r=i(245),n=i(40),o=i(253),s=i(0);t.SectionTool=class extends n.Controller{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";if(!t.menuButtonElement)throw"Missing config: menuButtonElement";this._buttonElement=t.buttonElement,this._counterElement=t.counterElement,this._menuButtonElement=t.menuButtonElement,this._menuButtonArrowElement=t.menuButtonArrowElement,this._sectionPlanesPlugin=new o.SectionPlanesPlugin(this.viewer,{}),this._sectionToolContextMenu=new r.SectionToolContextMenu({sectionPlanesPlugin:this._sectionPlanesPlugin,hideOnMouseDown:!1}),this._sectionPlanesPlugin.setOverviewVisible(!1),this.on("enabled",e=>{e?(this._buttonElement.classList.remove("disabled"),this._counterElement&&this._counterElement.classList.remove("disabled"),this._menuButtonElement.classList.remove("disabled"),this._menuButtonArrowElement.classList.remove("disabled")):(this._buttonElement.classList.add("disabled"),this._counterElement&&this._counterElement.classList.add("disabled"),this._menuButtonElement.classList.add("disabled"),this._menuButtonArrowElement.classList.add("disabled"))}),this.on("active",e=>{e?(this._buttonElement.classList.add("active"),this._counterElement&&this._counterElement.classList.add("active"),this._menuButtonElement.classList.add("active"),this._menuButtonArrowElement.classList.add("active")):(this._buttonElement.classList.remove("active"),this._counterElement&&this._counterElement.classList.remove("active"),this._menuButtonElement.classList.remove("active"),this._menuButtonArrowElement.classList.remove("active"))}),this.on("active",e=>{e||this._sectionPlanesPlugin.hideControl()}),this._buttonElement.addEventListener("click",e=>{if(!this.getEnabled())return;if(e.target===this._menuButtonElement||e.target.parentNode===this._menuButtonElement)return;const t=this.getActive();this.setActive(!t),e.preventDefault()}),document.addEventListener("mousedown",e=>{if(!e.target.classList.contains("xeokit-context-menu-item"))if(e.target===this._menuButtonElement||e.target.parentNode===this._menuButtonElement)if(e.preventDefault(),this._sectionToolContextMenu.shown)this._sectionToolContextMenu.hide();else{this._sectionToolContextMenu.context={bimViewer:this.bimViewer,viewer:this.viewer,sectionTool:this};const e=this._menuButtonElement.getBoundingClientRect();this._sectionToolContextMenu.show(e.left,e.bottom+5)}else this._sectionToolContextMenu.hide()}),this._sectionToolContextMenu.on("shown",()=>{this._menuButtonArrowElement.classList.remove("xeokit-arrow-down"),this._menuButtonArrowElement.classList.add("xeokit-arrow-up")}),this._sectionToolContextMenu.on("hidden",()=>{this._menuButtonArrowElement.classList.remove("xeokit-arrow-up"),this._menuButtonArrowElement.classList.add("xeokit-arrow-down")}),this.bimViewer.on("reset",()=>{this.clear(),this.setActive(!1)}),this._initSectionMode()}_initSectionMode(){this.viewer.scene.input.on("mouseclicked",e=>{if(!this.getActive()||!this.getEnabled())return;const t=this.viewer.scene.pick({canvasPos:e,pickSurface:!0});if(t){const e=this._sectionPlanesPlugin.createSectionPlane({pos:t.worldPos,dir:s.math.mulVec3Scalar(t.worldNormal,-1)});e.on("destroyed",()=>{this._updateSectionPlanesCount()}),this._sectionPlanesPlugin.showControl(e.id),this._updateSectionPlanesCount()}}),this._updateSectionPlanesCount()}_updateSectionPlanesCount(){this._counterElement&&(this._counterElement.innerText=""+this.getNumSections())}getNumSections(){return Object.keys(this._sectionPlanesPlugin.sectionPlanes).length}clear(){this._sectionPlanesPlugin.clear(),this._updateSectionPlanesCount()}flipSections(){this._sectionPlanesPlugin.flipSectionPlanes()}hideControl(){this._sectionPlanesPlugin.hideControl()}destroy(){this._sectionPlanesPlugin.destroy(),this._sectionToolContextMenu.destroy(),super.destroy()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SectionToolContextMenu=void 0;const r=i(74),n=i(0),o=i(8),s=n.math.AABB3(),a=n.math.vec3();t.SectionToolContextMenu=class extends r.ContextMenu{constructor(e={}){if(!e.sectionPlanesPlugin)throw"Missing config: sectionPlanesPlugin";super(o.utils.apply({},e)),this._sectionPlanesPlugin=e.sectionPlanesPlugin,this._viewer=this._sectionPlanesPlugin.viewer,this._onSceneSectionPlaneCreated=this._viewer.scene.on("sectionPlaneCreated",()=>{this._buildMenu()}),this._onSceneSectionPlaneDestroyed=this._viewer.scene.on("sectionPlaneDestroyed",()=>{this._buildMenu()}),this._buildMenu()}_buildMenu(){const e=this._sectionPlanesPlugin,t=Object.values(e.sectionPlanes),i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];i.push({getTitle:()=>"Slice #"+(r+1),doHoverEnter(t){e.hideControl(),e.showControl(o.id)},doHoverLeave(t){e.hideControl()},items:[[{getTitle:e=>"Edit",doAction:t=>{e.hideControl(),e.showControl(o.id);const i=o.pos;s.set(this._viewer.scene.aabb),n.math.getAABB3Center(s,a),s[0]+=i[0]-a[0],s[1]+=i[1]-a[1],s[2]+=i[2]-a[2],s[3]+=i[0]-a[0],s[4]+=i[1]-a[1],s[5]+=i[2]-a[2],this._viewer.cameraFlight.flyTo({aabb:s,fitFOV:65})}},{getTitle:e=>"Flip",doAction:e=>{o.flipDir()}},{getTitle:e=>"Delete",doAction:e=>{o.destroy()}}]]})}this.items=[[{title:"Clear Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.clearSections()}},{title:"Flip Slices",getEnabled:function(e){return e.bimViewer.getNumSections()>0},doAction:function(e){e.bimViewer.flipSections()}}],i]}destroy(){super.destroy();const e=this._viewer.scene;e.off(this._onSceneSectionPlaneCreated),e.off(this._onSceneSectionPlaneDestroyed)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionTool=void 0;const r=i(40),n=i(0);t.SelectionTool=class extends r.Controller{constructor(e,t){if(super(e),!t.buttonElement)throw"Missing config: buttonElement";const i=t.buttonElement;this.on("enabled",e=>{e?i.classList.remove("disabled"):i.classList.add("disabled")}),this.on("active",e=>{if(e)i.classList.add("active");else{i.classList.remove("active");const e=this.viewer.scene;e.setObjectsHighlighted(e.highlightedObjectIds,!1)}}),i.addEventListener("click",e=>{if(!this.getEnabled())return;this.bimViewer._sectionTool.hideControl();const t=this.getActive();this.setActive(!t),e.preventDefault()}),this.bimViewer.on("reset",()=>{this.setActive(!1)}),this._initSectionMode()}_initSectionMode(){const e=this.viewer,t=e.cameraControl;var i=null;this._onHover=t.on("hover",e=>{this.getActive()&&this.getEnabled()&&(i&&(i.highlighted=!1,i=null),e.entity&&e.entity.isObject&&((i=e.entity).highlighted=!0))}),this._onHoverOff=t.on("hoverOff",e=>{this.getActive()&&this.getEnabled()&&i&&(i.highlighted=!1,i=null)});const r=n.math.vec2(),o=e.scene.input;this._onMousedown=o.on("mousedown",e=>{this.getActive()&&this.getEnabled()&&(!o.mouseDownLeft||o.mouseDownRight||o.mouseDownMiddle||(r[0]=e[0],r[1]=e[1]))}),this._onMouseup=o.on("mouseup",e=>{if(this.getActive()&&this.getEnabled()&&i){if(!function(e,t){return Math.abs(e[0]-t[0])<4&&Math.abs(e[1]-t[1])<4}(r,e))return void(i=null);this.fire("objectSelected",i.id),i.selected=!i.selected,i=null}})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreeDMode=void 0;const r=i(40),n=i(0),o=n.math.vec3();t.ThreeDMode=class extends r.Controller{constructor(e,t){if(super(e,t),!t.buttonElement)throw"Missing config: buttonElement";this._buttonElement=t.buttonElement,this._cameraControlNavModeMediator=t.cameraControlNavModeMediator,this._active=!1,this.on("enabled",e=>{e?this._buttonElement.classList.remove("disabled"):this._buttonElement.classList.add("disabled")}),this._buttonElement.addEventListener("click",e=>{this.bimViewer._sectionTool.hideControl(),this.setActive(!this.getActive(),()=>{}),e.preventDefault()}),this.bimViewer.on("reset",()=>{this.setActive(!0,()=>{})})}setActive(e,t){this._active!==e?(this._active=e,e?(this._buttonElement.classList.add("active"),t?this._enterThreeDMode(()=>{this.fire("active",this._active),t()}):(this._enterThreeDMode(),this.fire("active",this._active))):(this._buttonElement.classList.remove("active"),t?this._exitThreeDMode(()=>{this.fire("active",this._active),t()}):(this._exitThreeDMode(),this.fire("active",this._active)))):t&&t()}_enterThreeDMode(e){const t=this.viewer,i=t.scene,r=i.getAABB(i.visibleObjectIds),s=n.math.getAABB3Diag(r),a=n.math.getAABB3Center(r,o),l=Math.abs(s/Math.tan(32.5)),c=i.camera,u=c.yUp?[-1,-1,-1]:[1,1,1],h=c.yUp?[-1,1,-1]:[-1,1,1];t.cameraControl.pivotPos=a,this.bimViewer._navCubeMode.setActive(!0),this.bimViewer._firstPersonMode.setEnabled(!0),this._cameraControlNavModeMediator.setThreeDModeActive(!0),this.bimViewer._sectionTool.setEnabled(!0),e?t.cameraFlight.flyTo({look:a,eye:[a[0]-l*u[0],a[1]-l*u[1],a[2]-l*u[2]],up:h,orthoScale:1.3*s,projection:"perspective",duration:1},()=>{e()}):t.cameraFlight.jumpTo({look:a,eye:[a[0]-l*u[0],a[1]-l*u[1],a[2]-l*u[2]],up:h,orthoScale:1.3*s,projection:"perspective"})}_exitThreeDMode(e){const t=this.viewer,i=t.scene,r=i.camera,s=i.getAABB(i.visibleObjectIds),a=n.math.getAABB3Center(s),l=n.math.getAABB3Diag(s),c=Math.abs(l/Math.tan(45*n.math.DEGTORAD)),u=1.3*l,h=o;h[0]=a[0]+r.worldUp[0]*c,h[1]=a[1]+r.worldUp[1]*c,h[2]=a[2]+r.worldUp[2]*c;const d=n.math.mulVec3Scalar(r.worldForward,-1,[]);this.bimViewer._sectionTool.setActive(!1),this.bimViewer._firstPersonMode.setEnabled(!1),this._cameraControlNavModeMediator.setThreeDModeActive(!1),e?t.cameraFlight.flyTo({eye:h,look:a,up:d,orthoScale:u,projection:"ortho"},()=>{this.bimViewer._navCubeMode.setActive(!1)}):(t.cameraFlight.jumpTo({eye:h,look:a,up:d,orthoScale:u,projection:"ortho"}),this.bimViewer._navCubeMode.setActive(!1))}}},function(e,t,i){"use strict";i.r(t),i.d(t,"BCFViewpointsPlugin",(function(){return a}));var r=i(34),n=i(98),o=i(0);const s=o.math.vec3();class a extends r.a{constructor(e,t={}){super("BCFViewpoints",e,t),this.originatingSystem=t.originatingSystem||"xeokit.io",this.authoringTool=t.authoringTool||"xeokit.io"}getViewpoint(e={}){const t=this.viewer.scene,i=t.camera,r=t.realWorldOffset,n=!0===e.reverseClippingPlanes;let s={},a=o.math.normalizeVec3(o.math.subVec3(i.look,i.eye,o.math.vec3())),c=i.eye,h=i.up;i.yUp&&(a=u(a),c=u(c),h=u(h));const d=l(o.math.addVec3(c,r));"ortho"===i.projection?s.orthogonal_camera={camera_view_point:d,camera_direction:l(a),camera_up_vector:l(h),view_to_world_scale:i.ortho.scale}:s.perspective_camera={camera_view_point:d,camera_direction:l(a),camera_up_vector:l(h),field_of_view:i.perspective.fov};const p=t.sectionPlanes;for(let e in p)if(p.hasOwnProperty(e)){let t,a=p[e],c=a.pos;t=n?o.math.negateVec3(a.dir,o.math.vec3()):a.dir,i.yUp&&(c=u(c),t=u(t)),o.math.addVec3(c,r),c=l(c),t=l(t),s.clipping_planes||(s.clipping_planes=[]),s.clipping_planes.push({location:c,direction:t})}s.components={visibility:{view_setup_hints:{spaces_visible:!!e.spacesVisible,space_boundaries_visible:!!e.spaceBoundariesVisible,openings_visible:!!e.openingsVisible}}};const f=new Set(t.opacityObjectIds),m=new Set(t.xrayedObjectIds),g=new Set(t.colorizedObjectIds),v=Object.values(t.objects).filter(e=>f.has(e.id)||g.has(e.id)||m.has(e.id)).reduce((e,i)=>{let r,n=function(e){let t="";return t+=Math.round(255*e[0]).toString(16).padStart(2,"0"),t+=Math.round(255*e[1]).toString(16).padStart(2,"0"),t+Math.round(255*e[2]).toString(16).padStart(2,"0")}(i.colorize);i.xrayed?(r=0===t.xrayMaterial.fillAlpha&&0!==t.xrayMaterial.edgeAlpha?.1:t.xrayMaterial.fillAlpha,n=(r=Math.round(255*r).toString(16).padStart(2,"0"))+n):f.has(i.id)&&(n=(r=Math.round(255*i.opacity).toString(16).padStart(2,"0"))+n),e[n]||(e[n]=[]);const o=i.id,s=i.originalSystemId,a={ifc_guid:s,originating_system:this.originatingSystem};return s!==o&&(a.authoring_tool_id=o),e[n].push(a),e},{}),b=Object.entries(v).map(([e,t])=>({color:e,components:t}));s.components.coloring=b;const _=t.objectIds,y=t.visibleObjects,x=t.visibleObjectIds,w=_.filter(e=>!y[e]),M=t.selectedObjectIds;return e.defaultInvisible||x.length<w.length?(s.components.visibility.exceptions=this._createBCFComponents(x),s.components.visibility.default_visibility=!1):(s.components.visibility.exceptions=this._createBCFComponents(w),s.components.visibility.default_visibility=!0),s.components.selection=this._createBCFComponents(M),!1!==e.snapshot&&(s.snapshot={snapshot_type:"png",snapshot_data:this.viewer.getSnapshot({format:"png"})}),s}_createBCFComponents(e){const t=this.viewer.scene,i=[];for(let r=0,n=e.length;r<n;r++){const n=e[r],o=t.objects[n];if(o){const e={ifc_guid:o.originalSystemId,originating_system:this.originatingSystem};o.originalSystemId!==n&&(e.authoring_tool_id=n),i.push(e)}}return i}setViewpoint(e,t={}){if(!e)return;const i=this.viewer,r=i.scene,a=r.camera,l=!1!==t.rayCast,u=!1!==t.immediate,d=!1!==t.reset,p=r.realWorldOffset,f=!0===t.reverseClippingPlanes;if(r.clearSectionPlanes(),e.clipping_planes&&e.clipping_planes.forEach((function(e){let t=c(e.location,s),i=c(e.direction,s);f&&o.math.negateVec3(i),o.math.subVec3(t,p),a.yUp&&(t=h(t),i=h(i)),new n.a(r,{pos:t,dir:i})})),d&&(r.setObjectsXRayed(r.xrayedObjectIds,!1),r.setObjectsHighlighted(r.highlightedObjectIds,!1),r.setObjectsSelected(r.selectedObjectIds,!1)),e.components){if(e.components.visibility){e.components.visibility.default_visibility?(r.setObjectsVisible(r.objectIds,!0),e.components.visibility.exceptions&&e.components.visibility.exceptions.forEach(e=>this._withBCFComponent(t,e,e=>e.visible=!1))):(r.setObjectsVisible(r.objectIds,!1),e.components.visibility.exceptions&&e.components.visibility.exceptions.forEach(e=>this._withBCFComponent(t,e,e=>e.visible=!0)));const n=e.components.visibility.view_setup_hints;n&&(!1===n.spaces_visible&&r.setObjectsVisible(i.metaScene.getObjectIDsByType("IfcSpace"),!1),!1===n.openings_visible&&r.setObjectsVisible(i.metaScene.getObjectIDsByType("IfcOpening"),!1),n.space_boundaries_visible)}e.components.selection&&(r.setObjectsSelected(r.selectedObjectIds,!1),e.components.selection.forEach(e=>this._withBCFComponent(t,e,e=>e.selected=!0))),e.components.coloring&&e.components.coloring.forEach(e=>{let i=e.color,r=0,n=!1;8===i.length&&((r=parseInt(i.substring(0,2),16)/256)<=1&&r>=.95&&(r=1),i=i.substring(2),n=!0);const o=[parseInt(i.substring(0,2),16)/256,parseInt(i.substring(2,4),16)/256,parseInt(i.substring(4,6),16)/256];e.components.map(e=>this._withBCFComponent(t,e,e=>{e.colorize=o,n&&(e.opacity=r)}))})}if(e.perspective_camera||e.orthogonal_camera){let n,d,f,m;if(e.perspective_camera?(n=c(e.perspective_camera.camera_view_point,s),d=c(e.perspective_camera.camera_direction,s),f=c(e.perspective_camera.camera_up_vector,s),a.perspective.fov=e.perspective_camera.field_of_view,m="perspective"):(n=c(e.orthogonal_camera.camera_view_point,s),d=c(e.orthogonal_camera.camera_direction,s),f=c(e.orthogonal_camera.camera_up_vector,s),a.ortho.scale=e.orthogonal_camera.view_to_world_scale,m="ortho"),o.math.subVec3(n,p),a.yUp&&(n=h(n),d=h(d),f=h(f)),l){const e=r.pick({pickSurface:!0,origin:n,direction:d});d=e?e.worldPos:o.math.addVec3(n,d,s)}else d=o.math.addVec3(n,d,s);u?(a.eye=n,a.look=d,a.up=f,a.projection=m):i.cameraFlight.flyTo({eye:n,look:d,up:f,duration:t.duration,projection:m})}}_withBCFComponent(e,t,i){const r=this.viewer,n=r.scene;if(t.authoring_tool_id&&t.originating_system===this.originatingSystem){const o=t.authoring_tool_id,s=n.objects[o];if(s)return void i(s);if(e.updateCompositeObjects&&r.metaScene.metaObjects[o])return void n.withObjects(r.metaScene.getObjectIDsInSubtree(o),i)}if(t.ifc_guid){const s=t.ifc_guid,a=n.objects[s];if(a)return void i(a);if(e.updateCompositeObjects&&r.metaScene.metaObjects[s])return void n.withObjects(r.metaScene.getObjectIDsInSubtree(s),i);Object.keys(n.models).forEach(t=>{const a=o.math.globalizeObjectId(t,s),l=n.objects[a];if(l)i(l);else if(e.updateCompositeObjects&&r.metaScene.metaObjects[a])return void n.withObjects(r.metaScene.getObjectIDsInSubtree(a),i)})}}destroy(){super.destroy()}}function l(e){return{x:e[0],y:e[1],z:e[2]}}function c(e,t){return(t=new Float64Array(3))[0]=e.x,t[1]=e.y,t[2]=e.z,t}function u(e){return new Float64Array([e[0],-e[2],e[1]])}function h(e){return new Float64Array([e[0],e[2],-e[1]])}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Server=void 0;const r=i(8);t.Server=class{constructor(e={}){this._dataDir=e.dataDir||""}getProjects(e,t){const i=this._dataDir+"/projects/index.json";r.utils.loadJSON(i,e,t)}getProject(e,t,i){const n=this._dataDir+"/projects/"+e+"/index.json";r.utils.loadJSON(n,t,i)}getMetadata(e,t,i,n){const o=this._dataDir+"/projects/"+e+"/models/"+t+"/metadata.json";r.utils.loadJSON(o,i,n)}getGeometry(e,t,i,n){const o=this._dataDir+"/projects/"+e+"/models/"+t+"/geometry.xkt";r.utils.loadArraybuffer(o,i,n)}getObjectInfo(e,t,i,n,o){const s=this._dataDir+"/projects/"+e+"/models/"+t+"/objects/"+i+"/properties.json";r.utils.loadJSON(s,n,o)}getIssues(e,t,i,n){const o=this._dataDir+"/projects/"+e+"/models/"+t+"/issues.json";r.utils.loadJSON(o,i,n)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sizeTheme=t.styleTheme=void 0;const r=i(44);t.styleTheme=r.createMuiTheme({palette:{primary:{main:"#03103F"},secondary:{light:"#477dca",main:"#477dca",dark:"#477dca"},background:{default:"#fff"},text:{primary:"#333",secondary:"#707070"},type:"dark"},typography:{h4:{fontSize:"1rem"},h3:{fontSize:"1.2rem",fontWeight:"bold"},h2:{fontSize:"1.5rem"},h1:{fontSize:"2rem"}}}),t.sizeTheme={toolbarLarge:"40px",toolbarSmall:"35px",iconLarge:"32px",iconMedium:"30px",iconSmall:"27px",small:"@media (max-width: 639px)",portrait:"@media (max-width: 768px)",mobile:"@media (max-width: 813px)",medium:"@media (max-width: 1047px)",large:"@media (min-width: 1048px)"}},function(e,t,i){"use strict";i.r(t),i.d(t,"XKTLoaderPlugin",(function(){return ni}));var r=i(8),n=i(16),o=i(0),s=i(67),a=i(7);class l{constructor(e,t,i,r,n=null,s=0){this.model=e,this.object=null,this.parent=null,this.id=t,this.pickId=this.model.scene._renderer.getPickID(this),this.aabb=o.math.AABB3(),this._layer=n,this._portionId=s,this._color=[i[0],i[1],i[2],r],this._colorize=[i[0],i[1],i[2],r],this._colorizing=!1,this._transparent=r<255,this.numTriangles=0,this.rtcCenter=null}_finalize(e){this._layer.initFlags(this._portionId,e,this._transparent)}_setVisible(e){this._layer.setVisible(this._portionId,e,this._transparent)}_setColor(e){this._color[0]=e[0],this._color[1]=e[1],this._color[2]=e[2],this._colorizing||this._layer.setColor(this._portionId,this._color,!1)}_setColorize(e){e?(this._colorize[0]=e[0],this._colorize[1]=e[1],this._colorize[2]=e[2],this._layer.setColor(this._portionId,this._colorize,!1),this._colorizing=!0):(this._layer.setColor(this._portionId,this._color,!1),this._colorizing=!1)}_setOpacity(e,t){const i=e<255,r=this._transparent!==i;this._color[3]=e,this._colorize[3]=e,this._transparent=i,this._colorizing?this._layer.setColor(this._portionId,this._colorize):this._layer.setColor(this._portionId,this._color),r&&this._layer.setTransparent(this._portionId,t,i)}_setOffset(e){this._layer.setOffset(this._portionId,e)}_setHighlighted(e){this._layer.setHighlighted(this._portionId,e,this._transparent)}_setXRayed(e){this._layer.setXRayed(this._portionId,e,this._transparent)}_setSelected(e){this._layer.setSelected(this._portionId,e,this._transparent)}_setEdges(e){this._layer.setEdges(this._portionId,e,this._transparent)}_setClippable(e){this._layer.setClippable(this._portionId,e,this._transparent)}_setCollidable(e){this._layer.setCollidable(this._portionId,e)}_setPickable(e){this._layer.setPickable(this._portionId,e,this._transparent)}_setCulled(e){this._layer.setCulled(this._portionId,e,this._transparent)}canPickTriangle(){return!1}drawPickTriangles(e){}pickTriangleSurface(e){}canPickWorldPos(){return!0}drawPickDepths(e){this.model.drawPickDepths(e)}drawPickNormals(e){this.model.drawPickNormals(e)}delegatePickedEntity(){return this.parent}_destroy(){this.model.scene._renderer.putPickID(this.pickId)}}const c=1,u=4,h=8,d=16,p=32,f=256,m=512,g=1024,v=2048,b=new Float32Array([0,0,0]),_=new Uint16Array([0,0,0]);class y{constructor(e,t,i,r,n,s){this._isObject=t,this.scene=e.scene,this.model=e,this.meshes=r,this._numTriangles=0;for(var a=0,l=this.meshes.length;a<l;a++){const e=this.meshes[a];e.parent=this,this._numTriangles+=e.numTriangles}this.id=i,this.originalSystemId=o.math.unglobalizeObjectId(e.id,i),this._flags=n,this._aabb=s,this._offsetAABB=o.math.AABB3(s),this._offset=o.math.vec3(),this._isObject&&e.scene._registerObject(this)}get isEntity(){return!0}get isModel(){return!1}get isObject(){return this._isObject}get aabb(){return this._offsetAABB}get numTriangles(){return this._numTriangles}set visible(e){if(!!(this._flags&c)!==e){this._flags=e?this._flags|c:this._flags&~c;for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setVisible(this._flags);this._isObject&&this.model.scene._objectVisibilityUpdated(this),this.model.glRedraw()}}get visible(){return this._getFlag(c)}_getFlag(e){return!!(this._flags&e)}set highlighted(e){if(!!(this._flags&m)!==e){this._flags=e?this._flags|m:this._flags&~m;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setHighlighted(this._flags);this._isObject&&this.model.scene._objectHighlightedUpdated(this),this.model.glRedraw()}}get highlighted(){return this._getFlag(m)}set xrayed(e){if(!!(this._flags&f)!==e){this._flags=e?this._flags|f:this._flags&~f;for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setXRayed(this._flags);this._isObject&&this.model.scene._objectXRayedUpdated(this),this.model.glRedraw()}}get xrayed(){return this._getFlag(f)}set selected(e){if(!!(this._flags&g)!==e){this._flags=e?this._flags|g:this._flags&~g;for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setSelected(this._flags);this._isObject&&this.model.scene._objectSelectedUpdated(this),this.model.glRedraw()}}get selected(){return this._getFlag(g)}set edges(e){if(!!(this._flags&v)!==e){this._flags=e?this._flags|v:this._flags&~v;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setEdges(this._flags);this.model.glRedraw()}}get edges(){return this._getFlag(v)}set culled(e){if(!!(this._flags&u)!==e){this._flags=e?this._flags|u:this._flags&~u;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setCulled(this._flags);this.model.glRedraw()}}get culled(){return this._getFlag(u)}set clippable(e){if(!!(this._flags&d)!==e){this._flags=e?this._flags|d:this._flags&~d;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setClippable(this._flags);this.model.glRedraw()}}get clippable(){return this._getFlag(d)}set collidable(e){if(!!(this._flags&p)!==e){this._flags=e?this._flags|p:this._flags&~p;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setCollidable(this._flags)}}get collidable(){return this._getFlag(p)}set pickable(e){if(!!(this._flags&h)!==e){this._flags=e?this._flags|h:this._flags&~h;for(var t=0,i=this.meshes.length;t<i;t++)this.meshes[t]._setPickable(this._flags)}}get pickable(){return this._getFlag(h)}set colorize(e){if(e){_[0]=Math.floor(255*e[0]),_[1]=Math.floor(255*e[1]),_[2]=Math.floor(255*e[2]);for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setColorize(_)}else for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setColorize(null);if(this._isObject){const t=!!e;this.scene._objectColorizeUpdated(this,t)}this.model.glRedraw()}get colorize(){if(0===this.meshes.length)return null;const e=this.meshes[0]._colorize;return b[0]=e[0]/255,b[1]=e[1]/255,b[2]=e[2]/255,b}set opacity(e){if(0===this.meshes.length)return;const t=null!=e,i=this.meshes[0]._colorize[3];let r=255;if(t){if(e<0?e=0:e>1&&(e=1),i===(r=Math.floor(255*e)))return}else if(i===(r=255))return;for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setOpacity(r,this._flags);this._isObject&&this.scene._objectOpacityUpdated(this,t),this.model.glRedraw()}get opacity(){return this.meshes.length>0?this.meshes[0]._colorize[3]/255:1}set offset(e){e?(this._offset[0]=e[0],this._offset[1]=e[1],this._offset[2]=e[2]):(this._offset[0]=0,this._offset[1]=0,this._offset[2]=0);for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._setOffset(this._offset);this._offsetAABB[0]=this._aabb[0]+this._offset[0],this._offsetAABB[1]=this._aabb[1]+this._offset[1],this._offsetAABB[2]=this._aabb[2]+this._offset[2],this._offsetAABB[3]=this._aabb[3]+this._offset[0],this._offsetAABB[4]=this._aabb[4]+this._offset[1],this._offsetAABB[5]=this._aabb[5]+this._offset[2],this.scene._aabbDirty=!0,this.scene._objectOffsetUpdated(this,e),this.model._aabbDirty=!0,this.model.glRedraw()}get offset(){return this._offset}set castsShadow(e){}get castsShadow(){return!1}set receivesShadow(e){}get receivesShadow(){return!1}get saoEnabled(){return this.model.saoEnabled}_finalize(){const e=this.model.scene;this._isObject&&(this.visible&&e._objectVisibilityUpdated(this),this.highlighted&&e._objectHighlightedUpdated(this),this.xrayed&&e._objectXRayedUpdated(this),this.selected&&e._objectSelectedUpdated(this));for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._finalize(this._flags)}_destroy(){const e=this.model.scene;this._isObject&&(e._deregisterObject(this),this.visible&&e._objectVisibilityUpdated(this,!1),this.xrayed&&e._objectXRayedUpdated(this),this.selected&&e._objectSelectedUpdated(this),this.highlighted&&e._objectHighlightedUpdated(this),this.scene._objectColorizeUpdated(this,!1),this.scene._objectOpacityUpdated(this,!1),this.scene._objectOffsetUpdated(this,!1));for(let e=0,t=this.meshes.length;e<t;e++)this.meshes[e]._destroy();e._aabbDirty=!0}}const x=new class{constructor(){this._uint8Arrays={},this._float32Arrays={}}_clear(){this._uint8Arrays={},this._float32Arrays={}}getUInt8Array(e){let t=this._uint8Arrays[e];return t||(t=new Uint8Array(e),this._uint8Arrays[e]=t),t}getFloat32Array(e){let t=this._float32Arrays[e];return t||(t=new Float32Array(e),this._float32Arrays[e]=t),t}},w=0,M=1,P=2,E=3,S=4,C=5,k=6,O=7,A=8,T=9,D=10,R=11;var L=i(20),B=i(14),I=i(21),N=i(11);const j=function(e,t){this.vertex=function(e){const t=e._sectionPlanesState,i=e._lightsState,r=t.sectionPlanes.length>0;let n,o,s;const l=[];for(l.push("// Batched geometry drawing vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("#extension GL_EXT_frag_depth : enable"),l.push("uniform int renderPass;"),l.push("attribute vec3 position;"),l.push("attribute vec3 normal;"),l.push("attribute vec4 color;"),l.push("attribute vec4 flags;"),l.push("attribute vec4 flags2;"),e.entityOffsetsEnabled&&l.push("attribute vec3 offset;"),l.push("uniform mat4 worldMatrix;"),l.push("uniform mat4 worldNormalMatrix;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform mat4 viewNormalMatrix;"),l.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(l.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("varying float vFragDepth;")),l.push("uniform vec4 lightAmbient;"),n=0,o=i.lights.length;n<o;n++)"ambient"!==(s=i.lights[n]).type&&(l.push("uniform vec4 lightColor"+n+";"),"dir"===s.type&&l.push("uniform vec3 lightDir"+n+";"),"point"===s.type&&l.push("uniform vec3 lightPos"+n+";"),"spot"===s.type&&(l.push("uniform vec3 lightPos"+n+";"),l.push("uniform vec3 lightDir"+n+";")));for(l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"),r&&(l.push("varying vec4 vWorldPosition;"),l.push("varying vec4 vFlags2;")),l.push("varying vec4 vColor;"),l.push("void main(void) {"),l.push("if (int(flags.x) != renderPass) {"),l.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),l.push("} else {"),l.push("vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&l.push("worldPosition.xyz = worldPosition.xyz + offset;"),l.push("vec4 viewPosition  = viewMatrix * worldPosition; "),l.push("vec4 worldNormal =  worldNormalMatrix * vec4(octDecode(normal.xy), 0.0); "),l.push("vec3 viewNormal = normalize((viewNormalMatrix * worldNormal).xyz);"),l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),n=0,o=i.lights.length;n<o;n++)if("ambient"!==(s=i.lights[n]).type){if("dir"===s.type)"view"===s.space?l.push("viewLightDir = normalize(lightDir"+n+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+n+", 0.0)).xyz);");else if("point"===s.type)"view"===s.space?l.push("viewLightDir = normalize(lightPos"+n+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightPos"+n+", 0.0)).xyz);");else{if("spot"!==s.type)continue;"view"===s.space?l.push("viewLightDir = normalize(lightDir"+n+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+n+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+n+".rgb * lightColor"+n+".a);")}return l.push("vec3 rgb = (vec3(float(color.r) / 255.0, float(color.g) / 255.0, float(color.b) / 255.0));"),l.push("vColor =  vec4((lightAmbient.rgb * lightAmbient.a * rgb) + (reflectedColor * rgb), float(color.a) / 255.0);"),r&&(l.push("vWorldPosition = worldPosition;"),l.push("vFlags2 = flags2;")),l.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?l.push("vFragDepth = 1.0 + clipPos.w;"):(l.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),l.push("clipPos.z *= clipPos.w;"))),l.push("gl_Position = clipPos;"),l.push("}"),l.push("}"),l}(e),this.fragment=function(e,t){const i=e._sectionPlanesState;let r,n;const o=i.sectionPlanes.length>0,s=[];if(s.push("// Batched geometry drawing fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),s.push("precision highp float;"),s.push("precision highp int;"),s.push("#else"),s.push("precision mediump float;"),s.push("precision mediump int;"),s.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(s.push("uniform float logDepthBufFC;"),s.push("varying float vFragDepth;")),t&&(s.push("uniform sampler2D uOcclusionTexture;"),s.push("uniform vec4      uSAOParams;"),s.push("const float       packUpscale = 256. / 255.;"),s.push("const float       unpackDownScale = 255. / 256.;"),s.push("const vec3        packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );"),s.push("const vec4        unPackFactors = unpackDownScale / vec4( packFactors, 1. );"),s.push("float unpackRGBAToDepth( const in vec4 v ) {"),s.push("    return dot( v, unPackFactors );"),s.push("}")),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),r=0,n=i.sectionPlanes.length;r<n;r++)s.push("uniform bool sectionPlaneActive"+r+";"),s.push("uniform vec3 sectionPlanePos"+r+";"),s.push("uniform vec3 sectionPlaneDir"+r+";");if(s.push("varying vec4 vColor;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),r=0,n=i.sectionPlanes.length;r<n;r++)s.push("if (sectionPlaneActive"+r+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+r+".xyz, vWorldPosition.xyz - sectionPlanePos"+r+".xyz), 0.0, 1000.0);"),s.push("}");s.push("  if (dist > 0.0) { discard; }"),s.push("}")}return t?(s.push("   float viewportWidth     = uSAOParams[0];"),s.push("   float viewportHeight    = uSAOParams[1];"),s.push("   float blendCutoff       = uSAOParams[2];"),s.push("   float blendFactor       = uSAOParams[3];"),s.push("   vec2 uv                 = vec2(gl_FragCoord.x / viewportWidth, gl_FragCoord.y / viewportHeight);"),s.push("   float ambient           = smoothstep(blendCutoff, 1.0, unpackRGBAToDepth(texture2D(uOcclusionTexture, uv))) * blendFactor;"),s.push("   gl_FragColor            = vec4(vColor.rgb * ambient, vColor.a);")):s.push("   gl_FragColor            = vColor;"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),s.push("}"),s}(e,t)};var F=i(9);const z=o.math.vec4(),V=o.math.vec3();class U{constructor(e,t){this._scene=e,this._withSAO=t,this._hash=this._getHash(),this._shaderSource=new j(this._scene,this._withSAO),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){const e=this._scene;return[e._lightsState.getHash(),e._sectionPlanesState.getHash(),this._withSAO?"sao":"nosao"].join(";")}drawLayer(e,t,i){const r=this._scene,n=r.camera,o=t.model,s=r.canvas.gl,a=t._state,l=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,l?Object(F.a)(n.viewMatrix,l):n.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,n.viewNormalMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,o.worldMatrix),s.uniformMatrix4fv(this._uWorldNormalMatrix,!1,o.worldNormalMatrix);const c=r._sectionPlanesState.sectionPlanes.length;if(c>0){const e=r._sectionPlanesState.sectionPlanes,i=t.layerIndex*c,n=o.renderFlags;for(let t=0;t<c;t++){const r=this._uSectionPlanes[t],o=n.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,o?1:0),o){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,V);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aNormal&&this._aNormal.bindArrayBuffer(a.normalsBuf),this._aColor&&this._aColor.bindArrayBuffer(a.colorsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._lightsState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uWorldNormalMatrix=r.getLocation("worldNormalMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uViewNormalMatrix=r.getLocation("viewNormalMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uLightAmbient=r.getLocation("lightAmbient"),this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];const n=i.lights;let o;for(let e=0,t=n.length;e<t;e++)switch((o=n[e]).type){case"dir":this._uLightColor[e]=r.getLocation("lightColor"+e),this._uLightPos[e]=null,this._uLightDir[e]=r.getLocation("lightDir"+e);break;case"point":this._uLightColor[e]=r.getLocation("lightColor"+e),this._uLightPos[e]=r.getLocation("lightPos"+e),this._uLightDir[e]=null,this._uLightAttenuation[e]=r.getLocation("lightAttenuation"+e);break;case"spot":this._uLightColor[e]=r.getLocation("lightColor"+e),this._uLightPos[e]=r.getLocation("lightPos"+e),this._uLightDir[e]=r.getLocation("lightDir"+e),this._uLightAttenuation[e]=r.getLocation("lightAttenuation"+e)}this._uSectionPlanes=[];for(let t=0,i=e._sectionPlanesState.sectionPlanes.length;t<i;t++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+t),pos:r.getLocation("sectionPlanePos"+t),dir:r.getLocation("sectionPlaneDir"+t)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aNormal=r.getAttribute("normal"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._withSAO&&(this._uOcclusionTexture="uOcclusionTexture",this._uSAOParams=r.getLocation("uSAOParams")),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(e){const t=this._scene,i=t.canvas.gl,r=this._program,n=t._lightsState.lights,o=t.camera.project;if(r.bind(),i.uniformMatrix4fv(this._uProjMatrix,!1,o.matrix),this._uLightAmbient){const e=t._lightsState.getAmbientColor();i.uniform4f(this._uLightAmbient,e[0],e[1],e[2],1)}for(let e=0,t=n.length;e<t;e++){const t=n[e];this._uLightColor[e]&&i.uniform4f(this._uLightColor[e],t.color[0],t.color[1],t.color[2],t.intensity),this._uLightPos[e]&&(i.uniform3fv(this._uLightPos[e],t.pos),this._uLightAttenuation[e]&&i.uniform1f(this._uLightAttenuation[e],t.attenuation)),this._uLightDir[e]&&i.uniform3fv(this._uLightDir[e],t.dir)}if(this._withSAO){const r=t.sao;if(r.possible){const t=i.drawingBufferWidth,n=i.drawingBufferHeight;z[0]=t,z[1]=n,z[2]=r.blendCutoff,z[3]=r.blendFactor,i.uniform4fv(this._uSAOParams,z),this._program.bindTexture(this._uOcclusionTexture,e.occlusionTexture,0)}}if(t.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.far+1)/Math.LN2);i.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const W=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched fill vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),i.push("uniform vec4 color;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.y) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState;let i,r;const n=t.sectionPlanes.length>0,o=[];if(o.push("// Batched fill fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("#extension GL_EXT_frag_depth : enable"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(o.push("uniform float logDepthBufFC;"),o.push("varying float vFragDepth;")),n)for(o.push("varying vec4 vWorldPosition;"),o.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("uniform bool sectionPlaneActive"+i+";"),o.push("uniform vec3 sectionPlanePos"+i+";"),o.push("uniform vec3 sectionPlaneDir"+i+";");if(o.push("uniform vec4 color;"),o.push("void main(void) {"),n){for(o.push("  bool clippable = (float(vFlags2.x) > 0.0);"),o.push("  if (clippable) {"),o.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("if (sectionPlaneActive"+i+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),o.push("}");o.push("  if (dist > 0.0) { discard; }"),o.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),o.push("gl_FragColor = color;"),o.push("}"),o}(e)},H=new Float32Array([1,1,1]),G=o.math.vec3();class X{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new W(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),i===C){const e=n.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===E){const e=n.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===S){const e=n.selectedMaterial._state,t=e.fillColor,i=e.fillAlpha;s.uniform4f(this._uColor,t[0],t[1],t[2],i)}else s.uniform4fv(this._uColor,H);const c=l?Object(F.a)(o.viewMatrix,l):o.viewMatrix;s.uniformMatrix4fv(this._uViewMatrix,!1,c),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const u=n._sectionPlanesState.sectionPlanes.length;if(u>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*u,o=r.renderFlags;for(let t=0;t<u;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,G);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uColor=i.getLocation("color"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const Y=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry edges drawing vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("uniform vec4 color;"),i.push("void main(void) {"),i.push("if (int(flags.z) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("  vWorldPosition = worldPosition;"),i.push("  vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry edges drawing fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("uniform vec4 color;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("if (sectionPlaneActive"+e+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),r.push("}");r.push("  if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("gl_FragColor = color;"),r.push("}"),r}(e)},$=o.math.vec3();class q{constructor(e){this._scene=e,this._shaderSource=new Y(this._scene),this._allocate(),this._hash=this._getHash()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,l?Object(F.a)(o.viewMatrix,l):o.viewMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const c=n._sectionPlanesState.sectionPlanes.length;if(c>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*c,o=r.renderFlags;for(let t=0;t<c;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,$);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}let u;const h=(u=i===D?n.xrayMaterial._state:i===A?n.highlightMaterial._state:i===T?n.selectedMaterial._state:n.edgeMaterial._state).edgeColor,d=u.edgeAlpha;s.uniform4f(this._uColor,h[0],h[1],h[2],d),e.lineWidth!==u.edgeWidth&&(s.lineWidth(u.edgeWidth),e.lineWidth=u.edgeWidth),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.edgeIndicesBuf.bind(),s.drawElements(s.LINES,a.edgeIndicesBuf.numItems,a.edgeIndicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uColor=i.getLocation("color"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=this._program,r=e.camera.project;if(i.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,r.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(r.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class K{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry picking vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 pickColor;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec4 vPickColor;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("      vPickColor = vec4(float(pickColor.r) / 255.0, float(pickColor.g) / 255.0, float(pickColor.b) / 255.0, float(pickColor.a) / 255.0);"),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry picking fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("varying vec4 vPickColor;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("   gl_FragColor = vPickColor; "),r.push("}"),r}(e)}}const Z=o.math.vec3();class Q{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new K(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const c=e.pickViewMatrix||o.viewMatrix,u=l?Object(F.a)(c,l):c;if(s.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,u),n.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.project.far+1)/Math.LN2);s.uniform1f(this._uLogDepthBufFC,e)}const h=n._sectionPlanesState.sectionPlanes.length;if(h>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*h,o=r.renderFlags;for(let t=0;t<h;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,Z);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),this._aPickColor&&this._aPickColor.bindArrayBuffer(a.pickColorsBuf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPickInvisible=i.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aPickColor=i.getAttribute("pickColor"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(e){const t=this._scene.canvas.gl;this._program.bind(),t.uniform1i(this._uPickInvisible,e.pickInvisible)}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class J{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry depth vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("vViewPosition = viewPosition;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry depth fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),r.push("uniform float pickZNear;"),r.push("uniform float pickZFar;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("varying vec4 vViewPosition;"),r.push("vec4 packDepth(const in float depth) {"),r.push("  const vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);"),r.push("  const vec4 bitMask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);"),r.push("  vec4 res = fract(depth * bitShift);"),r.push("  res -= res.xxyz * bitMask;"),r.push("  return res;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    float zNormalizedDepth = abs((pickZNear + vViewPosition.z) / (pickZFar - pickZNear));"),r.push("    gl_FragColor = packDepth(zNormalizedDepth); "),r.push("}"),r}(e)}}const ee=o.math.vec3();class te{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new J(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;this._program||this._allocate(),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniform1i(this._uPickInvisible,e.pickInvisible);const c=e.pickViewMatrix||o.viewMatrix,u=l?Object(F.a)(c,l):c;if(s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,u),s.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),s.uniform1f(this._uPickZNear,e.pickZNear),s.uniform1f(this._uPickZFar,e.pickZFar),n.logarithmicDepthBufferEnabled){const t=2/(Math.log(e.pickZFar+1)/Math.LN2);s.uniform1f(this._uLogDepthBufFC,t)}const h=n._sectionPlanesState.sectionPlanes.length;if(h>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*h,o=r.renderFlags;for(let t=0;t<h;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,ee);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPickInvisible=i.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),this._uPickZNear=i.getLocation("pickZNear"),this._uPickZFar=i.getLocation("pickZFar"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){this._program.bind()}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class ie{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry normals vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec3 normal;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec3 vWorldNormal;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("      vec3 worldNormal =  octDecode(normal.xy); "),i.push("      vWorldNormal = worldNormal;"),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry normals fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("varying vec3 vWorldNormal;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    gl_FragColor = vec4((vWorldNormal * 0.5) + 0.5, 1.0);"),r.push("}"),r}(e)}}const re=o.math.vec3();class ne{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new ie(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;this._program||this._allocate(t),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniform1i(this._uPickInvisible,e.pickInvisible),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const c=e.pickViewMatrix||o.viewMatrix,u=l?Object(F.a)(c,l):c;if(s.uniformMatrix4fv(this._uViewMatrix,!1,u),s.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),n.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.project.far+1)/Math.LN2);s.uniform1f(this._uLogDepthBufFC,e)}const h=n._sectionPlanesState.sectionPlanes.length;if(h>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*h,o=r.renderFlags;for(let t=0;t<h;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,re);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aNormal&&this._aNormal.bindArrayBuffer(a.normalsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPickInvisible=i.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aNormal=i.getAttribute("normal"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){this._program.bind()}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class oe{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched occlusion vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched occlusion fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("      if (sectionPlaneActive"+e+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),r.push("}"),r}(e)}}const se=o.math.vec3();class ae{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new oe(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.canvas.gl,s=t._state,a=n.camera,l=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),o.uniform1i(this._uRenderPass,i),o.uniformMatrix4fv(this._uViewMatrix,!1,l?Object(F.a)(a.viewMatrix,l):a.viewMatrix),o.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const c=n._sectionPlanesState.sectionPlanes.length;if(c>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*c,s=r.renderFlags;for(let t=0;t<c;t++){const r=this._uSectionPlanes[t],n=s.sectionPlanesActivePerLayer[i+t];if(o.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,se);o.uniform3fv(r.pos,e)}else o.uniform3fv(r.pos,i.pos);o.uniform3fv(r.dir,i.dir)}}}o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(s.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(s.offsetsBuf),this._aColor&&this._aColor.bindArrayBuffer(s.colorsBuf),this._aFlags.bindArrayBuffer(s.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(s.flags2Buf),s.indicesBuf.bind(),o.drawElements(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aColor=i.getAttribute("color"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}var le=i(15);class ce{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry depth vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry depth fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("const float   packUpScale = 256. / 255.;"),r.push("const float   unpackDownscale = 255. / 256.;"),r.push("const vec3    packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );"),r.push("const vec4    unpackFactors = unpackDownscale / vec4( packFactors, 1. );"),r.push("const float   shiftRight8 = 1. / 256.;"),r.push("vec4 packDepthToRGBA( const in float v ) {"),r.push("    vec4 r = vec4( fract( v * packFactors ), v );"),r.push("    r.yzw -= r.xyz * shiftRight8;"),r.push("    return r * packUpScale;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    gl_FragColor = packDepthToRGBA(gl_FragCoord.z); "),r.push("}"),r}(e)}}const ue=o.math.vec3();class he{constructor(e){this._scene=e,this._shaderSource=new ce(this._scene),this._allocate(this._scene),this._hash=this._getHash()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,l?Object(F.a)(o.viewMatrix,l):o.viewMatrix);const c=n._sectionPlanesState.sectionPlanes.length;if(c>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*c,o=r.renderFlags;for(let t=0;t<c;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,ue);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null,le.a.memory.programs--}}class de{constructor(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry normals vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec3 normal;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 worldNormalMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 viewNormalMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec3 vViewNormal;"),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = worldMatrix * (positionsDecodeMatrix * vec4(position, 1.0)); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition   = viewMatrix * worldPosition; "),i.push("      vec4 worldNormal    = worldNormalMatrix * vec4(octDecode(normal.xy), 0.0); "),i.push("      vec3 viewNormal     = normalize((viewNormalMatrix * worldNormal).xyz);"),t&&(i.push("      vWorldPosition  = worldPosition;"),i.push("      vFlags2         = flags2;")),i.push("      vViewNormal = viewNormal;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry normals fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("varying vec3 vViewNormal;"),r.push("vec3 packNormalToRGB( const in vec3 normal ) {"),r.push("    return normalize( normal ) * 0.5 + 0.5;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    gl_FragColor = vec4(packNormalToRGB(vViewNormal), 1.0); "),r.push("}"),r}(e)}}const pe=o.math.vec3();class fe{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new de(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(t)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,l?Object(F.a)(o.viewMatrix,l):o.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,o.viewNormalMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uWorldNormalMatrix,!1,r.worldNormalMatrix);const c=n._sectionPlanesState.sectionPlanes.length;if(c>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*c,o=r.renderFlags;for(let t=0;t<c;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,pe);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset.bindArrayBuffer(a.offsetsBuf),this._aNormal.bindArrayBuffer(a.normalsBuf),this._aColor.bindArrayBuffer(a.colorsBuf),this._aFlags.bindArrayBuffer(a.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(a.flags2Buf),a.indicesBuf.bind(),s.drawElements(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uWorldNormalMatrix=i.getLocation("worldNormalMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uViewNormalMatrix=i.getLocation("viewNormalMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aNormal=i.getAttribute("normal"),this._aColor=i.getAttribute("color"),this._aFlags=i.getAttribute("flags"),this._aFlags2&&(this._aFlags2=i.getAttribute("flags2")),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const me=function(e,t){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Batched geometry shadow vertex shader"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("uniform mat4 shadowViewMatrix;"),i.push("uniform mat4 shadowProjMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("  bool visible        = (float(flags.x) > 0.0);"),i.push("  bool transparent    = ((float(color.a) / 255.0) < 1.0);"),i.push("  if (!visible || transparent) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("  } else {"),i.push("      vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("      vec4 viewPosition  = shadowViewMatrix * worldPosition; "),t&&(i.push("      vWorldPosition = worldPosition;"),i.push("      vFlags2 = flags2;")),i.push("      vViewPosition = viewPosition;"),i.push("      gl_Position = shadowProjMatrix * viewPosition;"),i.push("  }"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry shadow fragment shader"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("varying vec4 vViewPosition;"),r.push("vec4 encodeFloat( const in float v ) {"),r.push("  const vec4 bitShift = vec4(256 * 256 * 256, 256 * 256, 256, 1.0);"),r.push("  const vec4 bitMask = vec4(0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);"),r.push("  vec4 comp = fract(v * bitShift);"),r.push("  comp -= comp.xxyz * bitMask;"),r.push("  return comp;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("      float dist = 0.0;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("      if (sectionPlaneActive"+n+") {"),r.push("          dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("      }");r.push("      if (dist > 0.0) { discard; }"),r.push("  }")}return r.push("    gl_FragColor = encodeFloat( gl_FragCoord.z); "),r.push("}"),r}(e)},ge=o.math.vec3();class ve{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new me(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t){const i=this._scene,r=i.canvas.gl,n=t._state;this._program||this._allocate(),e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),r.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),i.logarithmicDepthBufferEnabled&&r.uniform1f(this._uZFar,i.camera.project.far),this._aPosition.bindArrayBuffer(n.positionsBuf),this._aColor&&this._aColor.bindArrayBuffer(n.colorsBuf),this._aFlags&&this._aFlags.bindArrayBuffer(n.flagsBuf),this._aFlags2&&this._aFlags2.bindArrayBuffer(n.flags2Buf),this._aOffset&&this._aOffset.bindArrayBuffer(n.offsetsBuf),n.indicesBuf.bind();const o=i._sectionPlanesState.sectionPlanes.length;if(o>0){const e=i._sectionPlanesState.sectionPlanes,n=t.layerIndex*o,s=model.renderFlags,a=t._state.rtcCenter;for(let t=0;t<o;t++){const i=this._uSectionPlanes[t],o=s.sectionPlanesActivePerLayer[n+t];if(r.uniform1i(i.active,o?1:0),o){const n=e[t];if(a){const e=Object(F.b)(n.dist,n.dir,a,ge);r.uniform3fv(i.pos,e)}else r.uniform3fv(i.pos,n.pos);r.uniform3fv(i.dir,n.dir)}}}r.drawElements(n.primitive,n.indicesBuf.numItems,n.indicesBuf.itemType,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uShadowViewMatrix=r.getLocation("shadowViewMatrix"),this._uShadowProjMatrix=r.getLocation("shadowProjMatrix"),e.logarithmicDepthBufferEnabled&&(this._uZFar=r.getLocation("zFar")),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2")}_bindProgram(e){const t=this._scene.canvas.gl;this._program.bind(),t.uniformMatrix4fv(this._uShadowViewMatrix,!1,e.shadowViewMatrix),t.uniformMatrix4fv(this._uShadowProjMatrix,!1,e.shadowProjMatrix),this._lastLightId=null}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class be{constructor(e){this._scene=e}_compile(){this.drawRenderer&&!this.drawRenderer.getValid()&&(this.drawRenderer.destroy(),this.drawRenderer=null),this.drawRendererWithSAO&&!this.drawRendererWithSAO.getValid()&&(this.drawRendererWithSAO.destroy(),this.drawRendererWithSAO=null),this.depthRenderer&&!this.depthRenderer.getValid()&&(this.depthRenderer.destroy(),this.depthRenderer=null),this.normalsRenderer&&!this.normalsRenderer.getValid()&&(this.normalsRenderer.destroy(),this.normalsRenderer=null),this.fillRenderer&&!this.fillRenderer.getValid()&&(this.fillRenderer.destroy(),this.fillRenderer=null),this.edgesRenderer&&!this.edgesRenderer.getValid()&&(this.edgesRenderer.destroy(),this.edgesRenderer=null),this.pickMeshRenderer&&!this.pickMeshRenderer.getValid()&&(this.pickMeshRenderer.destroy(),this.pickMeshRenderer=null),this.pickDepthRenderer&&!this.pickDepthRenderer.getValid()&&(this.pickDepthRenderer.destroy(),this.pickDepthRenderer=null),this.pickNormalsRenderer&&!1===this.pickNormalsRenderer.getValid()&&(this.pickNormalsRenderer.destroy(),this.pickNormalsRenderer=null),this.occlusionRenderer&&!1===this.occlusionRenderer.getValid()&&(this.occlusionRenderer.destroy(),this.occlusionRenderer=null),this.shadowRenderer&&!this.shadowRenderer.getValid()&&(this.shadowRenderer.destroy(),this.shadowRenderer=null),this._createRenderers()}_createRenderers(){if(this.drawRenderer||(this.drawRenderer=new U(this._scene)),!this.drawRendererWithSAO){const e=!0;this.drawRendererWithSAO=new U(this._scene,e)}this.fillRenderer||(this.fillRenderer=new X(this._scene)),this.edgesRenderer||(this.edgesRenderer=new q(this._scene)),this.pickMeshRenderer||(this.pickMeshRenderer=new Q(this._scene)),this.pickDepthRenderer||(this.pickDepthRenderer=new te(this._scene)),this.pickNormalsRenderer||(this.pickNormalsRenderer=new ne(this._scene)),this.occlusionRenderer||(this.occlusionRenderer=new ae(this._scene)),this.depthRenderer||(this.depthRenderer=new he(this._scene)),this.normalsRenderer||(this.normalsRenderer=new fe(this._scene)),this.shadowRenderer||(this.shadowRenderer=new ve(this._scene))}_destroy(){this.drawRenderer&&this.drawRenderer.destroy(),this.drawRendererWithSAO&&this.drawRendererWithSAO.destroy(),this.depthRenderer&&this.depthRenderer.destroy(),this.normalsRenderer&&this.normalsRenderer.destroy(),this.fillRenderer&&this.fillRenderer.destroy(),this.edgesRenderer&&this.edgesRenderer.destroy(),this.pickMeshRenderer&&this.pickMeshRenderer.destroy(),this.pickDepthRenderer&&this.pickDepthRenderer.destroy(),this.pickNormalsRenderer&&this.pickNormalsRenderer.destroy(),this.occlusionRenderer&&this.occlusionRenderer.destroy(),this.shadowRenderer&&this.shadowRenderer.destroy()}}const _e={},ye=a.a.SUPPORTED_EXTENSIONS.OES_element_index_uint?5e6:65530,xe=3*ye;class we{constructor(){this.maxVerts=ye,this.maxIndices=xe,this.positions=[],this.colors=[],this.normals=[],this.pickColors=[],this.flags=[],this.flags2=[],this.offsets=[],this.indices=[],this.edgeIndices=[]}}const Me=o.math.mat4(),Pe=o.math.mat4(),Ee=o.math.vec4([0,0,0,1]),Se=o.math.vec4([0,0,0,1]),Ce=o.math.vec4([0,0,0,1]),ke=o.math.OBB3();class Oe{constructor(e,t){this.layerIndex=t.layerIndex,this._batchingRenderers=function(e){const t=e.id;let i=_e[t];return i||(i=new be(e),_e[t]=i,i._compile(),e.on("compile",()=>{i._compile()}),e.on("destroyed",()=>{delete _e[t],i._destroy()})),i}(e.scene),this.model=e,this._buffer=new we,this._scratchMemory=t.scratchMemory;var i,r=t.primitive||"triangles";const n=e.scene.canvas.gl;switch(r){case"points":i=n.POINTS;break;case"lines":i=n.LINES;break;case"line-loop":i=n.LINE_LOOP;break;case"line-strip":i=n.LINE_STRIP;break;case"triangles":i=n.TRIANGLES;break;case"triangle-strip":i=n.TRIANGLE_STRIP;break;case"triangle-fan":i=n.TRIANGLE_FAN;break;default:e.error(`Unsupported value for 'primitive': '${r}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`),i=n.TRIANGLES,r="triangles"}this._state=new L.a({primitiveName:r,primitive:i,positionsBuf:null,offsetsBuf:null,normalsBuf:null,colorsBuf:null,flagsBuf:null,flags2Buf:null,indicesBuf:null,edgeIndicesBuf:null,positionsDecodeMatrix:o.math.mat4(),rtcCenter:null}),this._numPortions=0,this._numVisibleLayerPortions=0,this._numTransparentLayerPortions=0,this._numXRayedLayerPortions=0,this._numSelectedLayerPortions=0,this._numHighlightedLayerPortions=0,this._numClippableLayerPortions=0,this._numEdgesLayerPortions=0,this._numPickableLayerPortions=0,this._numCulledLayerPortions=0,this._modelAABB=o.math.collapseAABB3(),this._portions=[],this._finalized=!1,this._positionsDecodeMatrix=t.positionsDecodeMatrix,this._preCompressed=!!this._positionsDecodeMatrix,t.rtcCenter&&(this._state.rtcCenter=o.math.vec3(t.rtcCenter)),this.aabb=o.math.collapseAABB3()}canCreatePortion(e,t){if(this._finalized)throw"Already finalized";return this._buffer.positions.length+e<3*this._buffer.maxVerts&&this._buffer.indices.length+t<this._buffer.maxIndices}createPortion(e,t,i,r,n,s,a,l,c,u){if(this._finalized)throw"Already finalized";const h=this._buffer,d=h.positions.length/3,p=e.length/3,f=e.length;if(this._preCompressed){for(let t=0,i=e.length;t<i;t++)h.positions.push(e[t]);const t=I.a.getPositionsBounds(e),i=I.a.decompressPosition(t.min,this._positionsDecodeMatrix,[]),r=I.a.decompressPosition(t.max,this._positionsDecodeMatrix,[]);c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=r[0],c[4]=r[1],c[5]=r[2],l&&(o.math.AABB3ToOBB3(c,ke),o.math.transformOBB3(l,ke),o.math.OBB3ToAABB3(ke,c))}else{const t=h.positions.length;for(let t=0,i=e.length;t<i;t++)h.positions.push(e[t]);if(a)for(let e=t,i=t+f;e<i;e+=3)Ee[0]=h.positions[e+0],Ee[1]=h.positions[e+1],Ee[2]=h.positions[e+2],o.math.transformPoint4(a,Ee,Se),h.positions[e+0]=Se[0],h.positions[e+1]=Se[1],h.positions[e+2]=Se[2],o.math.expandAABB3Point3(this._modelAABB,Se),l?(o.math.transformPoint4(l,Se,Ce),o.math.expandAABB3Point3(c,Ce)):o.math.expandAABB3Point3(c,Se);else for(let e=t,i=t+f;e<i;e+=3)Ee[0]=h.positions[e+0],Ee[1]=h.positions[e+1],Ee[2]=h.positions[e+2],o.math.expandAABB3Point3(this._modelAABB,Ee),l?(o.math.transformPoint4(l,Ee,Se),o.math.expandAABB3Point3(c,Se)):o.math.expandAABB3Point3(c,Ee)}if(this._state.rtcCenter){const e=this._state.rtcCenter;c[0]+=e[0],c[1]+=e[1],c[2]+=e[2],c[3]+=e[0],c[4]+=e[1],c[5]+=e[2]}if(o.math.expandAABB3(this.aabb,c),t)if(this._preCompressed)for(let e=0,i=t.length;e<i;e++)h.normals.push(t[e]);else{const e=Me;a?o.math.inverseMat4(o.math.transposeMat4(a,Pe),e):o.math.identityMat4(e,e),function(e,t,i,r,n){let s,a,l,c,u,h,d=new Float32Array([0,0,0,0]),p=new Float32Array([0,0,0,0]);for(h=0;h<i;h+=3)d[0]=t[h],d[1]=t[h+1],d[2]=t[h+2],o.math.transformVec3(e,d,p),o.math.normalizeVec3(p,p),l=s=Te(p,"floor","floor"),a=De(s),c=u=Re(p,a),s=Te(p,"ceil","floor"),a=De(s),(c=Re(p,a))>u&&(l=s,u=c),s=Te(p,"floor","ceil"),a=De(s),(c=Re(p,a))>u&&(l=s,u=c),s=Te(p,"ceil","ceil"),a=De(s),(c=Re(p,a))>u&&(l=s,u=c),r[n+h+0]=l[0],r[n+h+1]=l[1],r[n+h+2]=0;n+=i}(e,t,t.length,h.normals,h.normals.length)}if(n){const e=n[0],t=n[1],i=n[2],r=s;for(let n=0;n<p;n++)h.colors.push(e),h.colors.push(t),h.colors.push(i),h.colors.push(r)}if(i)for(let e=0,t=i.length;e<t;e++)h.indices.push(i[e]+d);if(r)for(let e=0,t=r.length;e<t;e++)h.edgeIndices.push(r[e]+d);{const e=h.pickColors.length;for(let t=e,i=e+4*p;t<i;t+=4)h.pickColors.push(u[0]),h.pickColors.push(u[1]),h.pickColors.push(u[2]),h.pickColors.push(u[3])}if(this.model.scene.entityOffsetsEnabled)for(let e=0;e<p;e++)h.offsets.push(0),h.offsets.push(0),h.offsets.push(0);const m=this._portions.length/2;return this._portions.push(d),this._portions.push(p),this._numPortions++,this.model.numPortions++,m}finalize(){if(this._finalized)return void this.model.error("Already finalized");const e=this._state,t=this.model.scene.canvas.gl,i=this._buffer;if(i.positions.length>0)if(this._preCompressed){e.positionsDecodeMatrix=this._positionsDecodeMatrix;const r=new Uint16Array(i.positions);e.positionsBuf=new B.a(t,t.ARRAY_BUFFER,r,i.positions.length,3,t.STATIC_DRAW)}else{const r=new Float32Array(i.positions),n=new Uint16Array(r.length);Ae(r,i.positions.length,this._modelAABB,n,e.positionsDecodeMatrix),e.positionsBuf=new B.a(t,t.ARRAY_BUFFER,n,i.positions.length,3,t.STATIC_DRAW)}if(i.normals.length>0){const r=new Int8Array(i.normals);let n=!0;e.normalsBuf=new B.a(t,t.ARRAY_BUFFER,r,i.normals.length,3,t.STATIC_DRAW,n)}if(i.colors.length>0){const r=new Uint8Array(i.colors);let n=!1;e.colorsBuf=new B.a(t,t.ARRAY_BUFFER,r,i.colors.length,4,t.DYNAMIC_DRAW,n)}if(i.colors.length>0){const r=i.colors.length,n=new Uint8Array(r),o=new Uint8Array(r);let s=!1,a=!0;e.flagsBuf=new B.a(t,t.ARRAY_BUFFER,n,n.length,4,t.DYNAMIC_DRAW,s),e.flags2Buf=new B.a(t,t.ARRAY_BUFFER,o,o.length,4,t.DYNAMIC_DRAW,a)}if(i.pickColors.length>0){const r=new Uint8Array(i.pickColors);let n=!1;e.pickColorsBuf=new B.a(t,t.ARRAY_BUFFER,r,i.pickColors.length,4,t.STATIC_DRAW,n)}if(this.model.scene.entityOffsetsEnabled&&i.offsets.length>0){const r=new Float32Array(i.offsets);e.offsetsBuf=new B.a(t,t.ARRAY_BUFFER,r,i.offsets.length,3,t.DYNAMIC_DRAW)}const r=a.a.SUPPORTED_EXTENSIONS.OES_element_index_uint;if(i.indices.length>0){const n=r?new Uint32Array(i.indices):new Uint16Array(i.indices);e.indicesBuf=new B.a(t,t.ELEMENT_ARRAY_BUFFER,n,i.indices.length,1,t.STATIC_DRAW)}if(i.edgeIndices.length>0){const n=r?new Uint32Array(i.edgeIndices):new Uint16Array(i.edgeIndices);e.edgeIndicesBuf=new B.a(t,t.ELEMENT_ARRAY_BUFFER,n,i.edgeIndices.length,1,t.STATIC_DRAW)}this._buffer=null,this._finalized=!0}initFlags(e,t,i){t&c&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),t&m&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),t&f&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),t&g&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),t&d&&(this._numClippableLayerPortions++,this.model.numClippableLayerPortions++),t&v&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),t&h&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++),t&u&&(this._numCulledLayerPortions++,this.model.numCulledLayerPortions++),i&&(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++),this._setFlags(e,t,i),this._setFlags2(e,t)}setVisible(e,t,i){if(!this._finalized)throw"Not finalized";t&c?(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++):(this._numVisibleLayerPortions--,this.model.numVisibleLayerPortions--),this._setFlags(e,t,i)}setHighlighted(e,t,i){if(!this._finalized)throw"Not finalized";t&m?(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++):(this._numHighlightedLayerPortions--,this.model.numHighlightedLayerPortions--),this._setFlags(e,t,i)}setXRayed(e,t,i){if(!this._finalized)throw"Not finalized";t&f?(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++):(this._numXRayedLayerPortions--,this.model.numXRayedLayerPortions--),this._setFlags(e,t,i)}setSelected(e,t,i){if(!this._finalized)throw"Not finalized";t&g?(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++):(this._numSelectedLayerPortions--,this.model.numSelectedLayerPortions--),this._setFlags(e,t,i)}setEdges(e,t,i){if(!this._finalized)throw"Not finalized";t&v?(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++):(this._numEdgesLayerPortions--,this.model.numEdgesLayerPortions--),this._setFlags(e,t,i)}setClippable(e,t){if(!this._finalized)throw"Not finalized";t&d?(this._numClippableLayerPortions++,this.model.numClippableLayerPortions++):(this._numClippableLayerPortions--,this.model.numClippableLayerPortions--),this._setFlags2(e,t)}setCulled(e,t,i){if(!this._finalized)throw"Not finalized";t&u?(this._numCulledLayerPortions++,this.model.numCulledLayerPortions++):(this._numCulledLayerPortions--,this.model.numCulledLayerPortions--),this._setFlags(e,t,i)}setCollidable(e,t){if(!this._finalized)throw"Not finalized"}setPickable(e,t,i){if(!this._finalized)throw"Not finalized";t&h?(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++):(this._numPickableLayerPortions--,this.model.numPickableLayerPortions--),this._setFlags(e,t,i)}setColor(e,t){if(!this._finalized)throw"Not finalized";const i=2*e,r=4*this._portions[i],n=4*this._portions[i+1],o=this._scratchMemory.getUInt8Array(n),s=t[0],a=t[1],l=t[2],c=t[3];for(let e=0;e<n;e+=4)o[e+0]=s,o[e+1]=a,o[e+2]=l,o[e+3]=c;this._state.colorsBuf.setData(o,r,n)}setTransparent(e,t,i){i?(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++):(this._numTransparentLayerPortions--,this.model.numTransparentLayerPortions--),this._setFlags(e,t,i)}_setFlags(e,t,i){if(!this._finalized)throw"Not finalized";const r=2*e,n=4*this._portions[r],o=4*this._portions[r+1],s=this._scratchMemory.getUInt8Array(o),a=!!(t&c),l=!!(t&f),d=!!(t&m),p=!!(t&g),b=!!(t&u);let _,y;_=!a||b||l?w:i?P:M,y=!a||b?w:p?S:d?E:l?C:w;let x=0;x=!a||b?w:p?T:d?A:l?D:!!(t&v)?i?O:k:w;let L=a&&!b&&!!(t&h)?R:w;for(let e=0;e<o;e+=4)s[e+0]=_,s[e+1]=y,s[e+2]=x,s[e+3]=L;this._state.flagsBuf.setData(s,n,o)}_setFlags2(e,t){if(!this._finalized)throw"Not finalized";const i=2*e,r=4*this._portions[i],n=4*this._portions[i+1],o=this._scratchMemory.getUInt8Array(n),s=t&d?255:0;for(let e=0;e<n;e+=4)o[e+0]=s;this._state.flags2Buf.setData(o,r,n)}setOffset(e,t){if(!this._finalized)throw"Not finalized";if(!this.model.scene.entityOffsetsEnabled)return void this.model.error("Entity#offset not enabled for this Viewer");const i=2*e,r=3*this._portions[i],n=3*this._portions[i+1],o=this._scratchMemory.getFloat32Array(n),s=t[0],a=t[1],l=t[2];for(let e=0;e<n;e+=3)o[e+0]=s,o[e+1]=a,o[e+2]=l;this._state.offsetsBuf.setData(o,r,n)}drawNormalOpaqueFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&(e.withSAO?this._batchingRenderers.drawRendererWithSAO&&this._batchingRenderers.drawRendererWithSAO.drawLayer(e,this,M):this._batchingRenderers.drawRenderer&&this._batchingRenderers.drawRenderer.drawLayer(e,this,M))}drawNormalTransparentFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numTransparentLayerPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._batchingRenderers.drawRenderer&&this._batchingRenderers.drawRenderer.drawLayer(e,this,P)}drawDepth(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._batchingRenderers.depthRenderer&&this._batchingRenderers.depthRenderer.drawLayer(e,this,M)}drawNormals(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._batchingRenderers.normalsRenderer&&this._batchingRenderers.normalsRenderer.drawLayer(e,this,M)}drawXRayedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._batchingRenderers.fillRenderer&&this._batchingRenderers.fillRenderer.drawLayer(e,this,C)}drawHighlightedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._batchingRenderers.fillRenderer&&this._batchingRenderers.fillRenderer.drawLayer(e,this,E)}drawSelectedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._batchingRenderers.fillRenderer&&this._batchingRenderers.fillRenderer.drawLayer(e,this,S)}drawNormalOpaqueEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&this._batchingRenderers.edgesRenderer&&this._batchingRenderers.edgesRenderer.drawLayer(e,this,k)}drawNormalTransparentEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&0!==this._numTransparentLayerPortions&&this._batchingRenderers.edgesRenderer&&this._batchingRenderers.edgesRenderer.drawLayer(e,this,O)}drawHighlightedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._batchingRenderers.edgesRenderer&&this._batchingRenderers.edgesRenderer.drawLayer(e,this,A)}drawSelectedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._batchingRenderers.edgesRenderer&&this._batchingRenderers.edgesRenderer.drawLayer(e,this,T)}drawXRayedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._batchingRenderers.edgesRenderer&&this._batchingRenderers.edgesRenderer.drawLayer(e,this,D)}drawPickMesh(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._batchingRenderers.pickMeshRenderer&&this._batchingRenderers.pickMeshRenderer.drawLayer(e,this,R)}drawPickDepths(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._batchingRenderers.pickDepthRenderer&&this._batchingRenderers.pickDepthRenderer.drawLayer(e,this,R)}drawPickNormals(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._batchingRenderers.pickNormalsRenderer&&this._batchingRenderers.pickNormalsRenderer.drawLayer(e,this,R)}drawOcclusion(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._batchingRenderers.occlusionRenderer&&this._batchingRenderers.occlusionRenderer.drawLayer(e,this,M)}drawShadow(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._batchingRenderers.shadowRenderer&&this._batchingRenderers.shadowRenderer.drawLayer(e,this,M)}destroy(){const e=this._state;e.positionsBuf&&(e.positionsBuf.destroy(),e.positionsBuf=null),e.offsetsBuf&&(e.offsetsBuf.destroy(),e.offsetsBuf=null),e.normalsBuf&&(e.normalsBuf.destroy(),e.normalsBuf=null),e.colorsBuf&&(e.colorsBuf.destroy(),e.colorsBuf=null),e.flagsBuf&&(e.flagsBuf.destroy(),e.flagsBuf=null),e.flags2Buf&&(e.flags2Buf.destroy(),e.flags2Buf=null),e.pickColorsBuf&&(e.pickColorsBuf.destroy(),e.pickColorsBuf=null),e.indicesBuf&&(e.indicesBuf.destroy(),e.indicessBuf=null),e.edgeIndicesBuf&&(e.edgeIndicesBuf.destroy(),e.edgeIndicessBuf=null),e.destroy()}}var Ae=function(){const e=o.math.mat4(),t=o.math.mat4();return function(i,r,n,s,a){const l=n[0],c=n[1],u=n[2],h=n[3]-l,d=n[4]-c,p=n[5]-u,f=65525/h,m=65525/d,g=65525/p;for(let e=0;e<r;e+=3)s[e+0]=Math.floor((i[e+0]-l)*f),s[e+1]=Math.floor((i[e+1]-c)*m),s[e+2]=Math.floor((i[e+2]-u)*g);o.math.identityMat4(e),o.math.translationMat4v(n,e),o.math.identityMat4(t),o.math.scalingMat4v([h/65525,d/65525,p/65525],t),o.math.mulMat4(e,t,a)}}();function Te(e,t,i){let r=e[0]/(Math.abs(e[0])+Math.abs(e[1])+Math.abs(e[2])),n=e[1]/(Math.abs(e[0])+Math.abs(e[1])+Math.abs(e[2]));if(e[2]<0){let e=r,t=n;e=(1-Math.abs(n))*(r>=0?1:-1),t=(1-Math.abs(r))*(n>=0?1:-1),r=e,n=t}return new Int8Array([Math[t](127.5*r+(r<0?-1:0)),Math[i](127.5*n+(n<0?-1:0))])}function De(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const n=Math.sqrt(t*t+i*i+r*r);return[t/n,i/n,r/n]}function Re(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}const Le=function(e,t){this.vertex=function(e){const t=e._sectionPlanesState,i=e._lightsState,r=t.sectionPlanes.length>0;let n,o,s;const l=[];for(l.push("// Instancing geometry drawing vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("#extension GL_EXT_frag_depth : enable"),l.push("uniform int renderPass;"),l.push("attribute vec3 position;"),l.push("attribute vec2 normal;"),l.push("attribute vec4 color;"),l.push("attribute vec4 flags;"),l.push("attribute vec4 flags2;"),e.entityOffsetsEnabled&&l.push("attribute vec3 offset;"),l.push("attribute vec4 modelMatrixCol0;"),l.push("attribute vec4 modelMatrixCol1;"),l.push("attribute vec4 modelMatrixCol2;"),l.push("attribute vec4 modelNormalMatrixCol0;"),l.push("attribute vec4 modelNormalMatrixCol1;"),l.push("attribute vec4 modelNormalMatrixCol2;"),l.push("uniform mat4 worldMatrix;"),l.push("uniform mat4 worldNormalMatrix;"),l.push("uniform mat4 viewMatrix;"),l.push("uniform mat4 viewNormalMatrix;"),l.push("uniform mat4 projMatrix;"),l.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(l.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&l.push("varying float vFragDepth;")),l.push("uniform vec4 lightAmbient;"),n=0,o=i.lights.length;n<o;n++)"ambient"!==(s=i.lights[n]).type&&(l.push("uniform vec4 lightColor"+n+";"),"dir"===s.type&&l.push("uniform vec3 lightDir"+n+";"),"point"===s.type&&l.push("uniform vec3 lightPos"+n+";"),"spot"===s.type&&(l.push("uniform vec3 lightPos"+n+";"),l.push("uniform vec3 lightDir"+n+";")));for(l.push("vec3 octDecode(vec2 oct) {"),l.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),l.push("    if (v.z < 0.0) {"),l.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),l.push("    }"),l.push("    return normalize(v);"),l.push("}"),r&&(l.push("varying vec4 vWorldPosition;"),l.push("varying vec4 vFlags2;")),l.push("varying vec4 vColor;"),l.push("void main(void) {"),l.push("if (int(flags.x) != renderPass) {"),l.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),l.push("} else {"),l.push("vec4 worldPosition =  positionsDecodeMatrix * vec4(position, 1.0); "),l.push("worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&l.push("      worldPosition.xyz = worldPosition.xyz + offset;"),l.push("vec4 viewPosition  = viewMatrix * worldPosition; "),l.push("vec4 modelNormal = vec4(octDecode(normal.xy), 0.0); "),l.push("vec4 worldNormal = worldNormalMatrix * vec4(dot(modelNormal, modelNormalMatrixCol0), dot(modelNormal, modelNormalMatrixCol1), dot(modelNormal, modelNormalMatrixCol2), 0.0);"),l.push("vec3 viewNormal = normalize(vec4(viewNormalMatrix * worldNormal).xyz);"),l.push("vec3 reflectedColor = vec3(0.0, 0.0, 0.0);"),l.push("vec3 viewLightDir = vec3(0.0, 0.0, -1.0);"),l.push("float lambertian = 1.0;"),n=0,o=i.lights.length;n<o;n++)if("ambient"!==(s=i.lights[n]).type){if("dir"===s.type)"view"===s.space?l.push("viewLightDir = normalize(lightDir"+n+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+n+", 0.0)).xyz);");else if("point"===s.type)"view"===s.space?l.push("viewLightDir = normalize(lightPos"+n+" - viewPosition.xyz);"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightPos"+n+", 0.0)).xyz);");else{if("spot"!==s.type)continue;"view"===s.space?l.push("viewLightDir = normalize(lightDir"+n+");"):l.push("viewLightDir = normalize((viewMatrix * vec4(lightDir"+n+", 0.0)).xyz);")}l.push("lambertian = max(dot(-viewNormal, viewLightDir), 0.0);"),l.push("reflectedColor += lambertian * (lightColor"+n+".rgb * lightColor"+n+".a);")}return l.push("vec3 rgb = (vec3(float(color.r) / 255.0, float(color.g) / 255.0, float(color.b) / 255.0));"),l.push("vColor =  vec4((lightAmbient.rgb * lightAmbient.a * rgb) + (reflectedColor * rgb), float(color.a) / 255.0);"),r&&(l.push("vWorldPosition = worldPosition;"),l.push("vFlags2 = flags2;")),l.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?l.push("vFragDepth = 1.0 + clipPos.w;"):(l.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),l.push("clipPos.z *= clipPos.w;"))),l.push("gl_Position = clipPos;"),l.push("}"),l.push("}"),l}(e),this.fragment=function(e,t){const i=e._sectionPlanesState;let r,n;const o=i.sectionPlanes.length>0,s=[];if(s.push("// Instancing geometry drawing fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("#extension GL_EXT_frag_depth : enable"),s.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),s.push("precision highp float;"),s.push("precision highp int;"),s.push("#else"),s.push("precision mediump float;"),s.push("precision mediump int;"),s.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(s.push("uniform float logDepthBufFC;"),s.push("varying float vFragDepth;")),t&&(s.push("uniform sampler2D uOcclusionTexture;"),s.push("uniform vec4      uSAOParams;"),s.push("const float       packUpscale = 256. / 255.;"),s.push("const float       unpackDownScale = 255. / 256.;"),s.push("const vec3        packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );"),s.push("const vec4        unPackFactors = unpackDownScale / vec4( packFactors, 1. );"),s.push("float unpackRGBAToDepth( const in vec4 v ) {"),s.push("    return dot( v, unPackFactors );"),s.push("}")),o)for(s.push("varying vec4 vWorldPosition;"),s.push("varying vec4 vFlags2;"),r=0,n=i.sectionPlanes.length;r<n;r++)s.push("uniform bool sectionPlaneActive"+r+";"),s.push("uniform vec3 sectionPlanePos"+r+";"),s.push("uniform vec3 sectionPlaneDir"+r+";");if(s.push("varying vec4 vColor;"),s.push("void main(void) {"),o){for(s.push("  bool clippable = (float(vFlags2.x) > 0.0);"),s.push("  if (clippable) {"),s.push("  float dist = 0.0;"),r=0,n=i.sectionPlanes.length;r<n;r++)s.push("if (sectionPlaneActive"+r+") {"),s.push("   dist += clamp(dot(-sectionPlaneDir"+r+".xyz, vWorldPosition.xyz - sectionPlanePos"+r+".xyz), 0.0, 1000.0);"),s.push("}");s.push("if (dist > 0.0) { discard; }"),s.push("}")}return t?(s.push("   float viewportWidth     = uSAOParams[0];"),s.push("   float viewportHeight    = uSAOParams[1];"),s.push("   float blendCutoff       = uSAOParams[2];"),s.push("   float blendFactor       = uSAOParams[3];"),s.push("   vec2 uv                 = vec2(gl_FragCoord.x / viewportWidth, gl_FragCoord.y / viewportHeight);"),s.push("   float ambient           = smoothstep(blendCutoff, 1.0, unpackRGBAToDepth(texture2D(uOcclusionTexture, uv))) * blendFactor;"),s.push("   gl_FragColor            = vec4(vColor.rgb * ambient, vColor.a);")):s.push("    gl_FragColor           = vColor;"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&s.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),s.push("}"),s}(e,t)},Be=o.math.vec4(),Ie=o.math.vec3();class Ne{constructor(e,t){this._scene=e,this._withSAO=t,this._hash=this._getHash(),this._shaderSource=new Le(this._scene,this._withSAO),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){const e=this._scene;return[e._lightsState.getHash(),e._sectionPlanesState.getHash(),this._withSAO?"sao":"nosao"].join(";")}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,c?Object(F.a)(o.viewMatrix,c):o.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,o.viewNormalMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uWorldNormalMatrix,!1,r.worldNormalMatrix);const u=n._sectionPlanesState.sectionPlanes.length;if(u>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*u,o=r.renderFlags;for(let t=0;t<u;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,Ie);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aModelNormalMatrixCol0.bindArrayBuffer(a.modelNormalMatrixCol0Buf),this._aModelNormalMatrixCol1.bindArrayBuffer(a.modelNormalMatrixCol1Buf),this._aModelNormalMatrixCol2.bindArrayBuffer(a.modelNormalMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,1),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aNormal.bindArrayBuffer(a.normalsBuf),this._aColor.bindArrayBuffer(a.colorsBuf),l.vertexAttribDivisorANGLE(this._aColor.location,1),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),a.indicesBuf.bind(),l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aColor.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._lightsState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uWorldNormalMatrix=r.getLocation("worldNormalMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uViewNormalMatrix=r.getLocation("viewNormalMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uLightAmbient=r.getLocation("lightAmbient"),this._uLightColor=[],this._uLightDir=[],this._uLightPos=[],this._uLightAttenuation=[];const n=i.lights;let o;for(var s=0,a=n.length;s<a;s++)switch((o=n[s]).type){case"dir":this._uLightColor[s]=r.getLocation("lightColor"+s),this._uLightPos[s]=null,this._uLightDir[s]=r.getLocation("lightDir"+s);break;case"point":this._uLightColor[s]=r.getLocation("lightColor"+s),this._uLightPos[s]=r.getLocation("lightPos"+s),this._uLightDir[s]=null,this._uLightAttenuation[s]=r.getLocation("lightAttenuation"+s);break;case"spot":this._uLightColor[s]=r.getLocation("lightColor"+s),this._uLightPos[s]=r.getLocation("lightPos"+s),this._uLightDir[s]=r.getLocation("lightDir"+s),this._uLightAttenuation[s]=r.getLocation("lightAttenuation"+s)}this._uSectionPlanes=[];for(let t=0,i=e._sectionPlanesState.sectionPlanes.length;t<i;t++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+t),pos:r.getLocation("sectionPlanePos"+t),dir:r.getLocation("sectionPlaneDir"+t)});this._aPosition=r.getAttribute("position"),this._aNormal=r.getAttribute("normal"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aOffset=r.getAttribute("offset"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),this._aModelNormalMatrixCol0=r.getAttribute("modelNormalMatrixCol0"),this._aModelNormalMatrixCol1=r.getAttribute("modelNormalMatrixCol1"),this._aModelNormalMatrixCol2=r.getAttribute("modelNormalMatrixCol2"),this._uOcclusionTexture="uOcclusionTexture",this._uSAOParams=r.getLocation("uSAOParams"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(e){const t=this._scene,i=t.canvas.gl,r=t._lightsState.lights,n=t.camera.project;if(this._program.bind(),i.uniformMatrix4fv(this._uProjMatrix,!1,n.matrix),this._uLightAmbient){const e=t._lightsState.getAmbientColor();i.uniform4f(this._uLightAmbient,e[0],e[1],e[2],1)}for(let e=0,t=r.length;e<t;e++){const t=r[e];this._uLightColor[e]&&i.uniform4f(this._uLightColor[e],t.color[0],t.color[1],t.color[2],t.intensity),this._uLightPos[e]&&(i.uniform3fv(this._uLightPos[e],t.pos),this._uLightAttenuation[e]&&i.uniform1f(this._uLightAttenuation[e],t.attenuation)),this._uLightDir[e]&&i.uniform3fv(this._uLightDir[e],t.dir)}if(this._withSAO){const r=t.sao;if(r.possible){const t=i.drawingBufferWidth,n=i.drawingBufferHeight;Be[0]=t,Be[1]=n,Be[2]=r.blendCutoff,Be[3]=r.blendFactor,i.uniform4fv(this._uSAOParams,Be),this._program.bindTexture(this._uOcclusionTexture,e.occlusionTexture,0)}}if(t.logarithmicDepthBufferEnabled){const e=2/(Math.log(n.far+1)/Math.LN2);i.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const je=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing fill vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),i.push("uniform vec4 color;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.y) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Instancing fill fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("uniform vec4 color;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("if (sectionPlaneActive"+e+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("gl_FragColor = color;"),r.push("}"),r}(e)},Fe=o.math.vec3();class ze{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new je(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,s=n.camera,a=n.canvas.gl,l=t._state,c=this._instanceExt,u=t._state.rtcCenter;if(!this._program&&(this._allocate(t.model.scene),this.errors))return;if(e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),a.uniform1i(this._uRenderPass,i),i===C){const e=n.xrayMaterial._state,t=e.fillColor,i=e.fillAlpha;a.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===E){const e=n.highlightMaterial._state,t=e.fillColor,i=e.fillAlpha;a.uniform4f(this._uColor,t[0],t[1],t[2],i)}else if(i===S){const e=n.selectedMaterial._state,t=e.fillColor,i=e.fillAlpha;a.uniform4f(this._uColor,t[0],t[1],t[2],i)}else a.uniform4fv(this._uColor,o.math.vec3([1,1,1]));a.uniformMatrix4fv(this._uViewMatrix,!1,u?Object(F.a)(s.viewMatrix,u):s.viewMatrix),a.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const h=n._sectionPlanesState.sectionPlanes.length;if(h>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*h,o=r.renderFlags;for(let t=0;t<h;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(a.uniform1i(r.active,n?1:0),n){const i=e[t];if(u){const e=Object(F.b)(i.dist,i.dir,u,Fe);a.uniform3fv(r.pos,e)}else a.uniform3fv(r.pos,i.pos);a.uniform3fv(r.dir,i.dir)}}}a.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(l.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(l.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(l.modelMatrixCol2Buf),c.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),c.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),c.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPosition.bindArrayBuffer(l.positionsBuf),this._aFlags.bindArrayBuffer(l.flagsBuf,a.UNSIGNED_BYTE,!0),c.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(l.flags2Buf,a.UNSIGNED_BYTE,!0),c.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(l.offsetsBuf),c.vertexAttribDivisorANGLE(this._aOffset.location,1)),l.indicesBuf.bind(),c.drawElementsInstancedANGLE(l.primitive,l.indicesBuf.numItems,l.indicesBuf.itemType,0,l.numInstances),c.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),c.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),c.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),c.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&c.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&c.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uColor=r.getLocation("color"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const Ve=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing edges vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("uniform vec4 color;"),i.push("void main(void) {"),i.push("if (int(flags.z) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0;let r,n;const o=[];if(o.push("// Instancing edges fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("#extension GL_EXT_frag_depth : enable"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(o.push("uniform float logDepthBufFC;"),o.push("varying float vFragDepth;")),o.push("uniform vec4 color;"),i)for(o.push("varying vec4 vWorldPosition;"),o.push("varying vec4 vFlags2;"),r=0,n=t.sectionPlanes.length;r<n;r++)o.push("uniform bool sectionPlaneActive"+r+";"),o.push("uniform vec3 sectionPlanePos"+r+";"),o.push("uniform vec3 sectionPlaneDir"+r+";");if(o.push("void main(void) {"),i){for(o.push("  bool clippable = (float(vFlags2.x) > 0.0);"),o.push("  if (clippable) {"),o.push("  float dist = 0.0;"),r=0,n=t.sectionPlanes.length;r<n;r++)o.push("if (sectionPlaneActive"+r+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+r+".xyz, vWorldPosition.xyz - sectionPlanePos"+r+".xyz), 0.0, 1000.0);"),o.push("}");o.push("if (dist > 0.0) { discard; }"),o.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),o.push("gl_FragColor = color;"),o.push("}"),o}(e)},Ue=o.math.vec3();class We{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new Ve(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;let u;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),u=i===D?n.xrayMaterial._state:i===A?n.highlightMaterial._state:i===T?n.selectedMaterial._state:n.edgeMaterial._state,s.uniformMatrix4fv(this._uViewMatrix,!1,c?Object(F.a)(o.viewMatrix,c):o.viewMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const h=n._sectionPlanesState.sectionPlanes.length;if(h>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*h,o=r.renderFlags;for(let t=0;t<h;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,Ue);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}const d=u.edgeColor,p=u.edgeAlpha;s.uniform4f(this._uColor,d[0],d[1],d[2],p),e.lineWidth!==u.edgeWidth&&(s.lineWidth(u.edgeWidth),e.lineWidth=u.edgeWidth),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aFlags&&(this._aFlags.bindArrayBuffer(a.flagsBuf,s.UNSIGNED_BYTE,!0),l.vertexAttribDivisorANGLE(this._aFlags.location,1)),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf,s.UNSIGNED_BYTE,!0),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),a.edgeIndicesBuf.bind(),l.drawElementsInstancedANGLE(s.LINES,a.edgeIndicesBuf.numItems,a.edgeIndicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0),this._aFlags&&l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uColor=r.getLocation("color"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const He=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry picking vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 pickColor;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec4 vPickColor;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("  vPickColor = vec4(float(pickColor.r) / 255.0, float(pickColor.g) / 255.0, float(pickColor.b) / 255.0, float(pickColor.a) / 255.0);"),t&&(i.push("  vWorldPosition = worldPosition;"),i.push("  vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry picking fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("varying vec4 vPickColor;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("if (sectionPlaneActive"+n+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("gl_FragColor = vPickColor; "),r.push("}"),r}(e)},Ge=o.math.vec3();class Xe{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new He(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e)),s.uniform1i(this._uRenderPass,i);const u=e.pickViewMatrix||o.viewMatrix,h=c?Object(F.a)(u,c):u;if(s.uniformMatrix4fv(this._uViewMatrix,!1,h),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),n.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.project.far+1)/Math.LN2);s.uniform1f(this._uLogDepthBufFC,e)}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPickColor.bindArrayBuffer(a.pickColorsBuf),l.vertexAttribDivisorANGLE(this._aPickColor.location,1),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),a.indicesBuf.bind();const d=n._sectionPlanesState.sectionPlanes.length;if(d>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*d,o=r.renderFlags;for(let t=0;t<d;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,Ge);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aPickColor.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uPickInvisible=r.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._uRenderPass=r.getLocation("renderPass"),this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aPickColor=r.getAttribute("pickColor"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(e){const t=this._scene.canvas.gl;this._program.bind(),t.uniform1i(this._uPickInvisible,e.pickInvisible)}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const Ye=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry depth vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec4 vViewPosition;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("  vWorldPosition = worldPosition;"),i.push("  vFlags2 = flags2;")),i.push("  vViewPosition = viewPosition;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry depth fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),r.push("uniform float pickZNear;"),r.push("uniform float pickZFar;"),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("varying vec4 vViewPosition;"),r.push("vec4 packDepth(const in float depth) {"),r.push("  const vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);"),r.push("  const vec4 bitMask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);"),r.push("  vec4 res = fract(depth * bitShift);"),r.push("  res -= res.xxyz * bitMask;"),r.push("  return res;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("if (sectionPlaneActive"+n+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    float zNormalizedDepth = abs((pickZNear + vViewPosition.z) / (pickZFar - pickZNear));"),r.push("    gl_FragColor = packDepth(zNormalizedDepth); "),r.push("}"),r}(e)},$e=o.math.vec3();class qe{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new Ye(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.canvas.gl,s=t._state,a=this._instanceExt,l=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram());const c=n.camera;o.uniform1i(this._uRenderPass,i),o.uniform1i(this._uPickInvisible,e.pickInvisible);const u=e.pickViewMatrix||c.viewMatrix,h=l?Object(F.a)(u,l):u;if(o.uniformMatrix4fv(this._uViewMatrix,!1,h),o.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),o.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),o.uniform1f(this._uPickZNear,e.pickZNear),o.uniform1f(this._uPickZFar,e.pickZFar),n.logarithmicDepthBufferEnabled){const t=2/(Math.log(e.pickZFar+1)/Math.LN2);o.uniform1f(this._uLogDepthBufFC,t)}const d=n._sectionPlanesState.sectionPlanes.length;if(d>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*d,s=r.renderFlags;for(let t=0;t<d;t++){const r=this._uSectionPlanes[t],n=s.sectionPlanesActivePerLayer[i+t];if(o.uniform1i(r.active,n?1:0),n){const i=e[t];if(l){const e=Object(F.b)(i.dist,i.dir,l,$e);o.uniform3fv(r.pos,e)}else o.uniform3fv(r.pos,i.pos);o.uniform3fv(r.dir,i.dir)}}}o.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(s.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(s.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(s.modelMatrixCol2Buf),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPosition.bindArrayBuffer(s.positionsBuf),this._aFlags.bindArrayBuffer(s.flagsBuf),a.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(s.flags2Buf),a.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(s.offsetsBuf),a.vertexAttribDivisorANGLE(this._aOffset.location,1)),s.indicesBuf.bind(),a.drawElementsInstancedANGLE(s.primitive,s.indicesBuf.numItems,s.indicesBuf.itemType,0,s.numInstances),a.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),a.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),a.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&a.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&a.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPickInvisible=i.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),this._aModelMatrixCol0=i.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=i.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=i.getAttribute("modelMatrixCol2"),this._uPickZNear=i.getLocation("pickZNear"),this._uPickZFar=i.getLocation("pickZFar"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){this._program.bind()}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const Ke=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry normals vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec2 normal;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("attribute vec4 modelNormalMatrixCol0;"),i.push("attribute vec4 modelNormalMatrixCol1;"),i.push("attribute vec4 modelNormalMatrixCol2;"),i.push("uniform bool pickInvisible;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec3 vWorldNormal;"),i.push("void main(void) {"),i.push("if (int(flags.w) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("  vec4 modelNormal = vec4(octDecode(normal.xy), 0.0); "),i.push("  vec3 worldNormal = vec3(dot(modelNormal, modelNormalMatrixCol0), dot(modelNormal, modelNormalMatrixCol1), dot(modelNormal, modelNormalMatrixCol2));"),i.push("  vWorldNormal = worldNormal;"),t&&i.push("  vWorldPosition = worldPosition;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Batched geometry normals fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0;e<t.sectionPlanes.length;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("varying vec3 vWorldNormal;"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("if (sectionPlaneActive"+n+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    gl_FragColor = vec4((vWorldNormal * 0.5) + 0.5, 1.0);"),r.push("}"),r}(e)},Ze=o.math.vec3();class Qe{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new Ke(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniform1i(this._uPickInvisible,e.pickInvisible);const u=e.pickViewMatrix||o.viewMatrix,h=c?Object(F.a)(u,c):u;if(s.uniformMatrix4fv(this._uViewMatrix,!1,h),s.uniformMatrix4fv(this._uProjMatrix,!1,e.pickProjMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uWorldNormalMatrix,!1,r.worldNormalMatrix),n.logarithmicDepthBufferEnabled){const e=2/(Math.log(o.project.far+1)/Math.LN2);s.uniform1f(this._uLogDepthBufFC,e)}const d=n._sectionPlanesState.sectionPlanes.length;if(d>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*d,o=r.renderFlags;for(let t=0;t<d;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,Ze);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aModelNormalMatrixCol0.bindArrayBuffer(a.modelNormalMatrixCol0Buf),this._aModelNormalMatrixCol1.bindArrayBuffer(a.modelNormalMatrixCol1Buf),this._aModelNormalMatrixCol2.bindArrayBuffer(a.modelNormalMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,1),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aNormal.bindArrayBuffer(a.normalsBuf),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),a.indicesBuf.bind(),l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelNormalMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPickInvisible=r.getLocation("pickInvisible"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uWorldNormalMatrix=r.getLocation("worldNormalMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uViewNormalMatrix=r.getLocation("viewNormalMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aNormal=r.getAttribute("normal"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),this._aModelNormalMatrixCol0=r.getAttribute("modelNormalMatrixCol0"),this._aModelNormalMatrixCol1=r.getAttribute("modelNormalMatrixCol1"),this._aModelNormalMatrixCol2=r.getAttribute("modelNormalMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(){this._program.bind()}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const Je=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing occlusion vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&i.push("  vWorldPosition = worldPosition;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Instancing occlusion fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(var n=0;n<t.sectionPlanes.length;n++)r.push("uniform bool sectionPlaneActive"+n+";"),r.push("uniform vec3 sectionPlanePos"+n+";"),r.push("uniform vec3 sectionPlaneDir"+n+";")}if(r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(n=0;n<t.sectionPlanes.length;n++)r.push("if (sectionPlaneActive"+n+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+n+".xyz, vWorldPosition.xyz - sectionPlanePos"+n+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return r.push("   gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); "),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("}"),r}(e)},et=o.math.vec3();class tt{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new Je(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,c?Object(F.a)(o.viewMatrix,c):o.viewMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix);const u=n._sectionPlanesState.sectionPlanes.length;if(u>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*u,o=r.renderFlags;for(let t=0;t<u;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,et);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aColor&&(this._aColor.bindArrayBuffer(a.colorsBuf),l.vertexAttribDivisorANGLE(this._aColor.location,1)),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),a.indicesBuf.bind(),l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),this._aColor&&l.vertexAttribDivisorANGLE(this._aColor.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const it=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry depth drawing vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState;let i,r;const n=t.sectionPlanes.length>0,o=[];if(o.push("// Instancing geometry depth drawing fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("#extension GL_EXT_frag_depth : enable"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(o.push("uniform float logDepthBufFC;"),o.push("varying float vFragDepth;")),n)for(o.push("varying vec4 vWorldPosition;"),o.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("uniform bool sectionPlaneActive"+i+";"),o.push("uniform vec3 sectionPlanePos"+i+";"),o.push("uniform vec3 sectionPlaneDir"+i+";");if(o.push("const float   packUpScale = 256. / 255.;"),o.push("const float   unpackDownscale = 255. / 256.;"),o.push("const vec3    packFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );"),o.push("const vec4    unpackFactors = unpackDownscale / vec4( packFactors, 1. );"),o.push("const float   shiftRight8 = 1.0 / 256.;"),o.push("vec4 packDepthToRGBA( const in float v ) {"),o.push("    vec4 r = vec4( fract( v * packFactors ), v );"),o.push("    r.yzw -= r.xyz * shiftRight8;"),o.push("    return r * packUpScale;"),o.push("}"),o.push("void main(void) {"),n){for(o.push("  bool clippable = (float(vFlags2.x) > 0.0);"),o.push("  if (clippable) {"),o.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("if (sectionPlaneActive"+i+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),o.push("}");o.push("if (dist > 0.0) { discard; }"),o.push("}")}return o.push("    gl_FragColor = packDepthToRGBA( gl_FragCoord.z); "),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&o.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),o.push("}"),o}(e)},rt=o.math.vec3();class nt{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new it(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uViewMatrix,!1,c?Object(F.a)(o.viewMatrix,c):o.viewMatrix);const u=n._sectionPlanesState.sectionPlanes.length;if(u>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*u,o=r.renderFlags;for(let t=0;t<u;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,rt);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),a.indicesBuf.bind(),l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const i=this._program;this._uRenderPass=i.getLocation("renderPass"),this._uPositionsDecodeMatrix=i.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=i.getLocation("worldMatrix"),this._uViewMatrix=i.getLocation("viewMatrix"),this._uProjMatrix=i.getLocation("projMatrix"),this._uSectionPlanes=[];for(let t=0,r=e._sectionPlanesState.sectionPlanes.length;t<r;t++)this._uSectionPlanes.push({active:i.getLocation("sectionPlaneActive"+t),pos:i.getLocation("sectionPlanePos"+t),dir:i.getLocation("sectionPlaneDir"+t)});this._aPosition=i.getAttribute("position"),this._aOffset=i.getAttribute("offset"),this._aFlags=i.getAttribute("flags"),this._aFlags2=i.getAttribute("flags2"),this._aModelMatrixCol0=i.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=i.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=i.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=i.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const ot=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry normals drawing vertex shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("#extension GL_EXT_frag_depth : enable"),i.push("uniform int renderPass;"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec3 normal;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 worldMatrix;"),i.push("uniform mat4 worldNormalMatrix;"),i.push("uniform mat4 viewMatrix;"),i.push("uniform mat4 projMatrix;"),i.push("uniform mat4 viewNormalMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),e.logarithmicDepthBufferEnabled&&(i.push("uniform float logDepthBufFC;"),a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&i.push("varying float vFragDepth;")),i.push("vec3 octDecode(vec2 oct) {"),i.push("    vec3 v = vec3(oct.xy, 1.0 - abs(oct.x) - abs(oct.y));"),i.push("    if (v.z < 0.0) {"),i.push("        v.xy = (1.0 - abs(v.yx)) * vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);"),i.push("    }"),i.push("    return normalize(v);"),i.push("}"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("varying vec3 vViewNormal;"),i.push("void main(void) {"),i.push("if (int(flags.x) != renderPass) {"),i.push("      gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = worldMatrix * vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = viewMatrix * worldPosition; "),i.push("  vec4 worldNormal    = worldNormalMatrix * vec4(octDecode(normal.xy), 0.0); "),i.push("  vec3 viewNormal     = normalize((viewNormalMatrix * worldNormal).xyz);"),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("  vViewNormal = viewNormal;"),i.push("vec4 clipPos = projMatrix * viewPosition;"),e.logarithmicDepthBufferEnabled&&(a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth?i.push("vFragDepth = 1.0 + clipPos.w;"):(i.push("clipPos.z = log2( max( 1e-6, clipPos.w + 1.0 ) ) * logDepthBufFC - 1.0;"),i.push("clipPos.z *= clipPos.w;"))),i.push("gl_Position = clipPos;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState,i=t.sectionPlanes.length>0,r=[];if(r.push("// Instancing geometry depth drawing fragment shader"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("#extension GL_EXT_frag_depth : enable"),r.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),r.push("precision highp float;"),r.push("precision highp int;"),r.push("#else"),r.push("precision mediump float;"),r.push("precision mediump int;"),r.push("#endif"),e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&(r.push("uniform float logDepthBufFC;"),r.push("varying float vFragDepth;")),i){r.push("varying vec4 vWorldPosition;"),r.push("varying vec4 vFlags2;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("uniform bool sectionPlaneActive"+e+";"),r.push("uniform vec3 sectionPlanePos"+e+";"),r.push("uniform vec3 sectionPlaneDir"+e+";")}if(r.push("varying vec3 vViewNormal;"),r.push("vec3 packNormalToRGB( const in vec3 normal ) {"),r.push("    return normalize( normal ) * 0.5 + 0.5;"),r.push("}"),r.push("void main(void) {"),i){r.push("  bool clippable = (float(vFlags2.x) > 0.0);"),r.push("  if (clippable) {"),r.push("  float dist = 0.0;");for(let e=0,i=t.sectionPlanes.length;e<i;e++)r.push("if (sectionPlaneActive"+e+") {"),r.push("   dist += clamp(dot(-sectionPlaneDir"+e+".xyz, vWorldPosition.xyz - sectionPlanePos"+e+".xyz), 0.0, 1000.0);"),r.push("}");r.push("if (dist > 0.0) { discard; }"),r.push("}")}return e.logarithmicDepthBufferEnabled&&a.a.SUPPORTED_EXTENSIONS.EXT_frag_depth&&r.push("gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;"),r.push("    gl_FragColor = vec4(packNormalToRGB(vViewNormal), 1.0); "),r.push("}"),r}(e)},st=o.math.vec3();class at{constructor(e){this._scene=e,this._hash=this._getHash(),this._shaderSource=new ot(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t,i){const r=t.model,n=r.scene,o=n.camera,s=n.canvas.gl,a=t._state,l=this._instanceExt,c=t._state.rtcCenter;if(!this._program&&(this._allocate(t),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram()),s.uniform1i(this._uRenderPass,i),s.uniformMatrix4fv(this._uViewMatrix,!1,c?Object(F.a)(o.viewMatrix,c):o.viewMatrix),s.uniformMatrix4fv(this._uViewNormalMatrix,!1,o.viewNormalMatrix),s.uniformMatrix4fv(this._uWorldMatrix,!1,r.worldMatrix),s.uniformMatrix4fv(this._uWorldNormalMatrix,!1,r.worldNormalMatrix);const u=n._sectionPlanesState.sectionPlanes.length;if(u>0){const e=n._sectionPlanesState.sectionPlanes,i=t.layerIndex*u,o=r.renderFlags;for(let t=0;t<u;t++){const r=this._uSectionPlanes[t],n=o.sectionPlanesActivePerLayer[i+t];if(s.uniform1i(r.active,n?1:0),n){const i=e[t];if(c){const e=Object(F.b)(i.dist,i.dir,c,st);s.uniform3fv(r.pos,e)}else s.uniform3fv(r.pos,i.pos);s.uniform3fv(r.dir,i.dir)}}}s.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(a.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(a.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(a.modelMatrixCol2Buf),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPosition.bindArrayBuffer(a.positionsBuf),this._aNormal.bindArrayBuffer(a.normalsBuf),this._aOffset&&(this._aOffset.bindArrayBuffer(a.offsetsBuf),l.vertexAttribDivisorANGLE(this._aOffset.location,1)),this._aColor.bindArrayBuffer(a.colorsBuf),l.vertexAttribDivisorANGLE(this._aColor.location,1),this._aFlags.bindArrayBuffer(a.flagsBuf),l.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(a.flags2Buf),l.vertexAttribDivisorANGLE(this._aFlags2.location,1)),a.indicesBuf.bind(),l.drawElementsInstancedANGLE(a.primitive,a.indicesBuf.numItems,a.indicesBuf.itemType,0,a.numInstances),l.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),l.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),l.vertexAttribDivisorANGLE(this._aColor.location,0),l.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&l.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&l.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uRenderPass=r.getLocation("renderPass"),this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uWorldMatrix=r.getLocation("worldMatrix"),this._uWorldNormalMatrix=r.getLocation("worldNormalMatrix"),this._uViewMatrix=r.getLocation("viewMatrix"),this._uViewNormalMatrix=r.getLocation("viewNormalMatrix"),this._uProjMatrix=r.getLocation("projMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aNormal=r.getAttribute("normal"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2&&(this._aFlags2=r.getAttribute("flags2")),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2"),e.logarithmicDepthBufferEnabled&&(this._uLogDepthBufFC=r.getLocation("logDepthBufFC"))}_bindProgram(){const e=this._scene,t=e.canvas.gl,i=e.camera.project;if(this._program.bind(),t.uniformMatrix4fv(this._uProjMatrix,!1,i.matrix),e.logarithmicDepthBufferEnabled){const e=2/(Math.log(i.far+1)/Math.LN2);t.uniform1f(this._uLogDepthBufFC,e)}}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}const lt=function(e){this.vertex=function(e){const t=e._sectionPlanesState.sectionPlanes.length>0,i=[];return i.push("// Instancing geometry shadow drawing vertex shader"),i.push("attribute vec3 position;"),e.entityOffsetsEnabled&&i.push("attribute vec3 offset;"),i.push("attribute vec4 color;"),i.push("attribute vec4 flags;"),i.push("attribute vec4 flags2;"),i.push("attribute vec4 modelMatrixCol0;"),i.push("attribute vec4 modelMatrixCol1;"),i.push("attribute vec4 modelMatrixCol2;"),i.push("uniform mat4 shadowViewMatrix;"),i.push("uniform mat4 shadowProjMatrix;"),i.push("uniform mat4 positionsDecodeMatrix;"),t&&(i.push("varying vec4 vWorldPosition;"),i.push("varying vec4 vFlags2;")),i.push("void main(void) {"),i.push("bool visible      = (float(flags.x) > 0.0);"),i.push("bool transparent  = ((float(color.a) / 255.0) < 1.0);"),i.push("if (!visible || transparent) {"),i.push("   gl_Position = vec4(0.0, 0.0, 0.0, 0.0);"),i.push("} else {"),i.push("  vec4 worldPosition = positionsDecodeMatrix * vec4(position, 1.0); "),i.push("  worldPosition = vec4(dot(worldPosition, modelMatrixCol0), dot(worldPosition, modelMatrixCol1), dot(worldPosition, modelMatrixCol2), 1.0);"),e.entityOffsetsEnabled&&i.push("      worldPosition.xyz = worldPosition.xyz + offset;"),i.push("  vec4 viewPosition  = shadowViewMatrix * worldPosition; "),t&&(i.push("vWorldPosition = worldPosition;"),i.push("vFlags2 = flags2;")),i.push("  gl_Position = shadowProjMatrix * viewPosition;"),i.push("}"),i.push("}"),i}(e),this.fragment=function(e){const t=e._sectionPlanesState;let i,r;const n=t.sectionPlanes.length>0,o=[];if(o.push("// Instancing geometry shadow drawing fragment shader"),o.push("#ifdef GL_FRAGMENT_PRECISION_HIGH"),o.push("precision highp float;"),o.push("precision highp int;"),o.push("#else"),o.push("precision mediump float;"),o.push("precision mediump int;"),o.push("#endif"),n)for(o.push("varying vec4 vWorldPosition;"),o.push("varying vec4 vFlags2;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("uniform bool sectionPlaneActive"+i+";"),o.push("uniform vec3 sectionPlanePos"+i+";"),o.push("uniform vec3 sectionPlaneDir"+i+";");if(o.push("vec4 encodeFloat( const in float v ) {"),o.push("  const vec4 bitShift = vec4(256 * 256 * 256, 256 * 256, 256, 1.0);"),o.push("  const vec4 bitMask = vec4(0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);"),o.push("  vec4 comp = fract(v * bitShift);"),o.push("  comp -= comp.xxyz * bitMask;"),o.push("  return comp;"),o.push("}"),o.push("void main(void) {"),n){for(o.push("  bool clippable = (float(vFlags2.x) > 0.0);"),o.push("  if (clippable) {"),o.push("  float dist = 0.0;"),i=0,r=t.sectionPlanes.length;i<r;i++)o.push("if (sectionPlaneActive"+i+") {"),o.push("   dist += clamp(dot(-sectionPlaneDir"+i+".xyz, vWorldPosition.xyz - sectionPlanePos"+i+".xyz), 0.0, 1000.0);"),o.push("}");o.push("if (dist > 0.0) { discard; }"),o.push("}")}return o.push("    gl_FragColor = encodeFloat( gl_FragCoord.z); "),o.push("}"),o}(e)},ct=o.math.vec3();class ut{constructor(e){this._scene=e,this._hash=this._getHash(),this._lastLightId=null,this._shaderSource=new lt(this._scene),this._allocate()}getValid(){return this._hash===this._getHash()}_getHash(){return this._scene._sectionPlanesState.getHash()}drawLayer(e,t){const i=t.model,r=i.scene,n=r.canvas.gl,o=t._state,s=this._instanceExt;if(!this._program&&(this._allocate(),this.errors))return;e.lastProgramId!==this._program.id&&(e.lastProgramId=this._program.id,this._bindProgram(e,t)),n.uniformMatrix4fv(this._uPositionsDecodeMatrix,!1,t._state.positionsDecodeMatrix),this._aModelMatrixCol0.bindArrayBuffer(o.modelMatrixCol0Buf),this._aModelMatrixCol1.bindArrayBuffer(o.modelMatrixCol1Buf),this._aModelMatrixCol2.bindArrayBuffer(o.modelMatrixCol2Buf),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,1),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,1),this._aPosition.bindArrayBuffer(o.positionsBuf),this._aOffset&&(this._aOffset.bindArrayBuffer(o.offsetsBuf),s.vertexAttribDivisorANGLE(this._aOffset.location,1)),this._aColor.bindArrayBuffer(o.colorsBuf),s.vertexAttribDivisorANGLE(this._aColor.location,1),this._aFlags.bindArrayBuffer(o.flagsBuf),s.vertexAttribDivisorANGLE(this._aFlags.location,1),this._aFlags2&&(this._aFlags2.bindArrayBuffer(o.flags2Buf),s.vertexAttribDivisorANGLE(this._aFlags2.location,1));const a=r._sectionPlanesState.sectionPlanes.length;if(a>0){const e=r._sectionPlanesState.sectionPlanes,o=t.layerIndex*a,s=i.renderFlags,l=t._state.rtcCenter;for(let t=0;t<a;t++){const i=this._uSectionPlanes[t],r=s.sectionPlanesActivePerLayer[o+t];if(n.uniform1i(i.active,r?1:0),r){const r=e[t];if(l){const e=Object(F.b)(r.dist,r.dir,l,ct);n.uniform3fv(i.pos,e)}else n.uniform3fv(i.pos,r.pos);n.uniform3fv(i.dir,r.dir)}}}o.indicesBuf.bind(),s.drawElementsInstancedANGLE(o.primitive,o.indicesBuf.numItems,o.indicesBuf.itemType,0,o.numInstances),s.vertexAttribDivisorANGLE(this._aModelMatrixCol0.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol1.location,0),s.vertexAttribDivisorANGLE(this._aModelMatrixCol2.location,0),s.vertexAttribDivisorANGLE(this._aColor.location,0),s.vertexAttribDivisorANGLE(this._aFlags.location,0),this._aFlags2&&s.vertexAttribDivisorANGLE(this._aFlags2.location,0),this._aOffset&&s.vertexAttribDivisorANGLE(this._aOffset.location,0)}_allocate(){const e=this._scene,t=e.canvas.gl,i=e._sectionPlanesState;if(this._program=new N.a(t,this._shaderSource),this._program.errors)return void(this.errors=this._program.errors);this._instanceExt=t.getExtension("ANGLE_instanced_arrays");const r=this._program;this._uPositionsDecodeMatrix=r.getLocation("positionsDecodeMatrix"),this._uShadowViewMatrix=r.getLocation("shadowViewMatrix"),this._uShadowProjMatrix=r.getLocation("shadowProjMatrix"),this._uSectionPlanes=[];for(let e=0,t=i.sectionPlanes.length;e<t;e++)this._uSectionPlanes.push({active:r.getLocation("sectionPlaneActive"+e),pos:r.getLocation("sectionPlanePos"+e),dir:r.getLocation("sectionPlaneDir"+e)});this._aPosition=r.getAttribute("position"),this._aOffset=r.getAttribute("offset"),this._aColor=r.getAttribute("color"),this._aFlags=r.getAttribute("flags"),this._aFlags2=r.getAttribute("flags2"),this._aModelMatrixCol0=r.getAttribute("modelMatrixCol0"),this._aModelMatrixCol1=r.getAttribute("modelMatrixCol1"),this._aModelMatrixCol2=r.getAttribute("modelMatrixCol2")}_bindProgram(e,t){const i=this._scene.canvas.gl;this._program.bind(),i.uniformMatrix4fv(this._uShadowViewMatrix,!1,e.shadowViewMatrix),i.uniformMatrix4fv(this._uShadowProjMatrix,!1,e.shadowProjMatrix),this._lastLightId=null}webglContextRestored(){this._program=null}destroy(){this._program&&this._program.destroy(),this._program=null}}class ht{constructor(e){this._scene=e}_compile(){this.drawRenderer&&!this.drawRenderer.getValid()&&(this.drawRenderer.destroy(),this.drawRenderer=null),this.drawRendererWithSAO&&!this.drawRendererWithSAO.getValid()&&(this.drawRendererWithSAO.destroy(),this.drawRendererWithSAO=null),this.depthRenderer&&!this.depthRenderer.getValid()&&(this.depthRenderer.destroy(),this.depthRenderer=null),this.normalsRenderer&&!this.normalsRenderer.getValid()&&(this.normalsRenderer.destroy(),this.normalsRenderer=null),this.fillRenderer&&!this.fillRenderer.getValid()&&(this.fillRenderer.destroy(),this.fillRenderer=null),this.edgesRenderer&&!this.edgesRenderer.getValid()&&(this.edgesRenderer.destroy(),this.edgesRenderer=null),this.pickMeshRenderer&&!this.pickMeshRenderer.getValid()&&(this.pickMeshRenderer.destroy(),this.pickMeshRenderer=null),this.pickDepthRenderer&&!this.pickDepthRenderer.getValid()&&(this.pickDepthRenderer.destroy(),this.pickDepthRenderer=null),this.pickNormalsRenderer&&!this.pickNormalsRenderer.getValid()&&(this.pickNormalsRenderer.destroy(),this.pickNormalsRenderer=null),this.occlusionRenderer&&!this.occlusionRenderer.getValid()&&(this.occlusionRenderer.destroy(),this.occlusionRenderer=null),this.shadowRenderer&&!this.shadowRenderer.getValid()&&(this.shadowRenderer.destroy(),this.shadowRenderer=null),this._createRenderers()}_createRenderers(){if(this.drawRenderer||(this.drawRenderer=new Ne(this._scene)),!this.drawRendererWithSAO){const e=!0;this.drawRendererWithSAO=new Ne(this._scene,e)}this.fillRenderer||(this.fillRenderer=new ze(this._scene)),this.edgesRenderer||(this.edgesRenderer=new We(this._scene)),this.pickMeshRenderer||(this.pickMeshRenderer=new Xe(this._scene)),this.pickDepthRenderer||(this.pickDepthRenderer=new qe(this._scene)),this.pickNormalsRenderer||(this.pickNormalsRenderer=new Qe(this._scene)),this.occlusionRenderer||(this.occlusionRenderer=new tt(this._scene)),this.depthRenderer||(this.depthRenderer=new nt(this._scene)),this.normalsRenderer||(this.normalsRenderer=new at(this._scene)),this.shadowRenderer||(this.shadowRenderer=new ut(this._scene))}_destroy(){this.drawRenderer&&this.drawRenderer.destroy(),this.drawRendererWithSAO&&this.drawRendererWithSAO.destroy(),this.depthRenderer&&this.depthRenderer.destroy(),this.normalsRenderer&&this.normalsRenderer.destroy(),this.fillRenderer&&this.fillRenderer.destroy(),this.edgesRenderer&&this.edgesRenderer.destroy(),this.pickMeshRenderer&&this.pickMeshRenderer.destroy(),this.pickDepthRenderer&&this.pickDepthRenderer.destroy(),this.pickNormalsRenderer&&this.pickNormalsRenderer.destroy(),this.occlusionRenderer&&this.occlusionRenderer.destroy(),this.shadowRenderer&&this.shadowRenderer.destroy()}}const dt={},pt=a.a.SUPPORTED_EXTENSIONS.OES_element_index_uint,ft=pt?5e6:65530,mt=new Uint16Array(3*ft),gt=new Int8Array(3*ft),vt=new Uint8Array(4),bt=o.math.vec4([0,0,0,1]),_t=o.math.vec4([0,0,0,1]),yt=o.math.vec4([0,0,0,1]),xt=new Float32Array(3);class wt{constructor(e,t){this.layerIndex=t.layerIndex,this._instancingRenderers=function(e){const t=e.id;let i=dt[t];return i||(i=new ht(e),dt[t]=i,i._compile(),e.on("compile",()=>{i._compile()}),e.on("destroyed",()=>{delete dt[t],i._destroy()})),i}(e.scene),this.model=e,this._aabb=o.math.collapseAABB3();let i,r=t.primitive||"triangles";const n=e.scene.canvas.gl;switch(r){case"points":i=n.POINTS;break;case"lines":i=n.LINES;break;case"line-loop":i=n.LINE_LOOP;break;case"line-strip":i=n.LINE_STRIP;break;case"triangles":i=n.TRIANGLES;break;case"triangle-strip":i=n.TRIANGLE_STRIP;break;case"triangle-fan":i=n.TRIANGLE_FAN;break;default:e.error(`Unsupported value for 'primitive': '${r}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`),i=n.TRIANGLES,r="triangles"}const a={primitiveName:r,primitive:i,positionsDecodeMatrix:o.math.mat4(),numInstances:0,obb:o.math.OBB3(),rtcCenter:null},l=!!t.positionsDecodeMatrix;if(t.positions)if(l){let e=!1;a.positionsBuf=new B.a(n,n.ARRAY_BUFFER,t.positions,t.positions.length,3,n.STATIC_DRAW,e),a.positionsDecodeMatrix.set(t.positionsDecodeMatrix);let i=o.math.collapseAABB3();o.math.expandAABB3Points3(i,t.positions),I.a.decompressAABB(i,a.positionsDecodeMatrix),o.math.AABB3ToOBB3(i,a.obb)}else{let e=t.positions.length,i=o.math.collapseAABB3();o.math.expandAABB3Points3(i,t.positions),o.math.AABB3ToOBB3(i,a.obb),Mt(t.positions,e,i,mt,a.positionsDecodeMatrix);let r=!1;a.positionsBuf=new B.a(n,n.ARRAY_BUFFER,mt,e,3,n.STATIC_DRAW,r)}if(t.normals)if(l){const e=!0;a.normalsBuf=new B.a(n,n.ARRAY_BUFFER,t.normals,t.normals.length,3,n.STATIC_DRAW,e)}else{const e=function(e,t,i,r){let n,o,s,a,l;for(let c=0;c<t;c+=3)s=n=Pt(e,c,"floor","floor"),o=Et(n),a=l=St(e,c,o),n=Pt(e,c,"ceil","floor"),o=Et(n),(a=St(e,c,o))>l&&(s=n,l=a),n=Pt(e,c,"floor","ceil"),o=Et(n),(a=St(e,c,o))>l&&(s=n,l=a),n=Pt(e,c,"ceil","ceil"),o=Et(n),(a=St(e,c,o))>l&&(s=n,l=a),i[r+c+0]=s[0],i[r+c+1]=s[1],i[r+c+2]=0;return r+t}(t.normals,t.normals.length,gt,0),i=!0;a.normalsBuf=new B.a(n,n.ARRAY_BUFFER,gt,e,3,n.STATIC_DRAW,i)}t.indices&&(a.indicesBuf=new B.a(n,n.ELEMENT_ARRAY_BUFFER,pt?new Uint32Array(t.indices):new Uint16Array(t.indices),t.indices.length,1,n.STATIC_DRAW));let c=t.edgeIndices;c||(c=Object(s.a)(t.positions,t.indices,null,t.edgeThreshold||10)),a.edgeIndicesBuf=new B.a(n,n.ELEMENT_ARRAY_BUFFER,pt?new Uint32Array(c):new Uint16Array(c),c.length,1,n.STATIC_DRAW),this._state=new L.a(a),this._numPortions=0,this._numVisibleLayerPortions=0,this._numTransparentLayerPortions=0,this._numXRayedLayerPortions=0,this._numHighlightedLayerPortions=0,this._numSelectedLayerPortions=0,this._numClippableLayerPortions=0,this._numEdgesLayerPortions=0,this._numPickableLayerPortions=0,this._numCulledLayerPortions=0,this.numIndices=t.indices?t.indices.length/3:0,this._colors=[],this._pickColors=[],this._offsets=[],this._modelMatrixCol0=[],this._modelMatrixCol1=[],this._modelMatrixCol2=[],this._modelNormalMatrixCol0=[],this._modelNormalMatrixCol1=[],this._modelNormalMatrixCol2=[],this._portions=[],t.rtcCenter&&(this._state.rtcCenter=o.math.vec3(t.rtcCenter)),this._finalized=!1,this.aabb=o.math.collapseAABB3()}createPortion(e,t,i,r,n,s){if(this._finalized)throw"Already finalized";const a=e[0],l=e[1],c=e[2];e[3],this._colors.push(a),this._colors.push(l),this._colors.push(c),this._colors.push(t),this.model.scene.entityOffsetsEnabled&&(this._offsets.push(0),this._offsets.push(0),this._offsets.push(0)),this._modelMatrixCol0.push(i[0]),this._modelMatrixCol0.push(i[4]),this._modelMatrixCol0.push(i[8]),this._modelMatrixCol0.push(i[12]),this._modelMatrixCol1.push(i[1]),this._modelMatrixCol1.push(i[5]),this._modelMatrixCol1.push(i[9]),this._modelMatrixCol1.push(i[13]),this._modelMatrixCol2.push(i[2]),this._modelMatrixCol2.push(i[6]),this._modelMatrixCol2.push(i[10]),this._modelMatrixCol2.push(i[14]);let u=o.math.transposeMat4(i,o.math.mat4()),h=o.math.inverseMat4(u);this._modelNormalMatrixCol0.push(h[0]),this._modelNormalMatrixCol0.push(h[4]),this._modelNormalMatrixCol0.push(h[8]),this._modelNormalMatrixCol0.push(h[12]),this._modelNormalMatrixCol1.push(h[1]),this._modelNormalMatrixCol1.push(h[5]),this._modelNormalMatrixCol1.push(h[9]),this._modelNormalMatrixCol1.push(h[13]),this._modelNormalMatrixCol2.push(h[2]),this._modelNormalMatrixCol2.push(h[6]),this._modelNormalMatrixCol2.push(h[10]),this._modelNormalMatrixCol2.push(h[14]),this._pickColors.push(s[0]),this._pickColors.push(s[1]),this._pickColors.push(s[2]),this._pickColors.push(s[3]),o.math.collapseAABB3(n);const d=this._state.obb,p=d.length;for(let e=0;e<p;e+=4)bt[0]=d[e+0],bt[1]=d[e+1],bt[2]=d[e+2],o.math.transformPoint4(i,bt,_t),r?(o.math.transformPoint4(r,_t,yt),o.math.expandAABB3Point3(n,yt)):o.math.expandAABB3Point3(n,_t);if(this._state.rtcCenter){const e=this._state.rtcCenter;n[0]+=e[0],n[1]+=e[1],n[2]+=e[2],n[3]+=e[0],n[4]+=e[1],n[5]+=e[2]}o.math.expandAABB3(this.aabb,n),this._state.numInstances++;const f=this._portions.length;return this._portions.push({}),this._numPortions++,this.model.numPortions++,f}finalize(){if(this._finalized)throw"Already finalized";const e=this.model.scene.canvas.gl,t=this._colors.length,i=t;if(t>0){let t=!1;this._state.colorsBuf=new B.a(e,e.ARRAY_BUFFER,new Uint8Array(this._colors),this._colors.length,4,e.DYNAMIC_DRAW,t),this._colors=[]}if(i>0){let t=!1,r=!0;this._state.flagsBuf=new B.a(e,e.ARRAY_BUFFER,new Uint8Array(i),i,4,e.DYNAMIC_DRAW,t),this._state.flags2Buf=new B.a(e,e.ARRAY_BUFFER,new Uint8Array(i),i,4,e.DYNAMIC_DRAW,r)}if(this.model.scene.entityOffsetsEnabled&&this._offsets.length>0){const t=!1;this._state.offsetsBuf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._offsets),this._offsets.length,3,e.DYNAMIC_DRAW,t),this._offsets=[]}if(this._modelMatrixCol0.length>0){const t=!1;this._state.modelMatrixCol0Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol0),this._modelMatrixCol0.length,4,e.STATIC_DRAW,t),this._state.modelMatrixCol1Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol1),this._modelMatrixCol1.length,4,e.STATIC_DRAW,t),this._state.modelMatrixCol2Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelMatrixCol2),this._modelMatrixCol2.length,4,e.STATIC_DRAW,t),this._modelMatrixCol0=[],this._modelMatrixCol1=[],this._modelMatrixCol2=[],this._state.modelNormalMatrixCol0Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol0),this._modelNormalMatrixCol0.length,4,e.STATIC_DRAW,t),this._state.modelNormalMatrixCol1Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol1),this._modelNormalMatrixCol1.length,4,e.STATIC_DRAW,t),this._state.modelNormalMatrixCol2Buf=new B.a(e,e.ARRAY_BUFFER,new Float32Array(this._modelNormalMatrixCol2),this._modelNormalMatrixCol2.length,4,e.STATIC_DRAW,t),this._modelNormalMatrixCol0=[],this._modelNormalMatrixCol1=[],this._modelNormalMatrixCol2=[]}if(this._pickColors.length>0){const t=!1;this._state.pickColorsBuf=new B.a(e,e.ARRAY_BUFFER,new Uint8Array(this._pickColors),this._pickColors.length,4,e.STATIC_DRAW,t),this._pickColors=[]}this._finalized=!0}initFlags(e,t,i){t&c&&(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++),t&m&&(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++),t&f&&(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++),t&g&&(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++),t&d&&(this._numClippableLayerPortions++,this.model.numClippableLayerPortions++),t&v&&(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++),t&h&&(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++),t&u&&(this._numCulledLayerPortions++,this.model.numCulledLayerPortions++),i&&(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++),this._setFlags(e,t,i),this._setFlags2(e,t)}setVisible(e,t,i){if(!this._finalized)throw"Not finalized";t&c?(this._numVisibleLayerPortions++,this.model.numVisibleLayerPortions++):(this._numVisibleLayerPortions--,this.model.numVisibleLayerPortions--),this._setFlags(e,t,i)}setHighlighted(e,t,i){if(!this._finalized)throw"Not finalized";t&m?(this._numHighlightedLayerPortions++,this.model.numHighlightedLayerPortions++):(this._numHighlightedLayerPortions--,this.model.numHighlightedLayerPortions--),this._setFlags(e,t,i)}setXRayed(e,t,i){if(!this._finalized)throw"Not finalized";t&f?(this._numXRayedLayerPortions++,this.model.numXRayedLayerPortions++):(this._numXRayedLayerPortions--,this.model.numXRayedLayerPortions--),this._setFlags(e,t,i)}setSelected(e,t,i){if(!this._finalized)throw"Not finalized";t&g?(this._numSelectedLayerPortions++,this.model.numSelectedLayerPortions++):(this._numSelectedLayerPortions--,this.model.numSelectedLayerPortions--),this._setFlags(e,t,i)}setEdges(e,t,i){if(!this._finalized)throw"Not finalized";t&v?(this._numEdgesLayerPortions++,this.model.numEdgesLayerPortions++):(this._numEdgesLayerPortions--,this.model.numEdgesLayerPortions--),this._setFlags(e,t,i)}setClippable(e,t){if(!this._finalized)throw"Not finalized";t&d?(this._numClippableLayerPortions++,this.model.numClippableLayerPortions++):(this._numClippableLayerPortions--,this.model.numClippableLayerPortions--),this._setFlags2(e,t)}setCollidable(e,t){if(!this._finalized)throw"Not finalized"}setPickable(e,t,i){if(!this._finalized)throw"Not finalized";t&h?(this._numPickableLayerPortions++,this.model.numPickableLayerPortions++):(this._numPickableLayerPortions--,this.model.numPickableLayerPortions--),this._setFlags2(e,t,i)}setCulled(e,t,i){if(!this._finalized)throw"Not finalized";t&u?(this._numCulledLayerPortions++,this.model.numCulledLayerPortions++):(this._numCulledLayerPortions--,this.model.numCulledLayerPortions--),this._setFlags(e,t,i)}setColor(e,t){if(!this._finalized)throw"Not finalized";vt[0]=t[0],vt[1]=t[1],vt[2]=t[2],vt[3]=t[3],this._state.colorsBuf.setData(vt,4*e,4)}setTransparent(e,t,i){i?(this._numTransparentLayerPortions++,this.model.numTransparentLayerPortions++):(this._numTransparentLayerPortions--,this.model.numTransparentLayerPortions--),this._setFlags(e,t,i)}_setFlags(e,t,i){if(!this._finalized)throw"Not finalized";const r=!!(t&c),n=!!(t&f),o=!!(t&m),s=!!(t&g),a=!!(t&u);let l,d;l=!r||a||n?w:i?P:M,d=!r||a?w:s?S:o?E:n?C:w;let p=0;p=!r||a?w:s?T:o?A:n?D:!!(t&v)?i?O:k:w;let b=r&&!a&&!!(t&h)?R:w;vt[0]=l,vt[1]=d,vt[2]=p,vt[3]=b,this._state.flagsBuf.setData(vt,4*e,4)}_setFlags2(e,t){if(!this._finalized)throw"Not finalized";const i=t&d?255:0;vt[0]=i,this._state.flags2Buf.setData(vt,4*e,4)}setOffset(e,t){if(!this._finalized)throw"Not finalized";this.model.scene.entityOffsetsEnabled?(xt[0]=t[0],xt[1]=t[1],xt[2]=t[2],this._state.offsetsBuf.setData(xt,3*e,3)):this.model.error("Entity#offset not enabled for this Viewer")}drawNormalOpaqueFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&(e.withSAO?this._instancingRenderers.drawRendererWithSAO&&this._instancingRenderers.drawRendererWithSAO.drawLayer(e,this,M):this._instancingRenderers.drawRenderer&&this._instancingRenderers.drawRenderer.drawLayer(e,this,M))}drawNormalTransparentFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numTransparentLayerPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._instancingRenderers.drawRenderer&&this._instancingRenderers.drawRenderer.drawLayer(e,this,P)}drawDepth(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._instancingRenderers.depthRenderer&&this._instancingRenderers.depthRenderer.drawLayer(e,this,M)}drawNormals(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._numTransparentLayerPortions!==this._numPortions&&this._numXRayedLayerPortions!==this._numPortions&&this._instancingRenderers.normalsRenderer&&this._instancingRenderers.normalsRenderer.drawLayer(e,this,M)}drawXRayedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._instancingRenderers.fillRenderer&&this._instancingRenderers.fillRenderer.drawLayer(e,this,C)}drawHighlightedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._instancingRenderers.fillRenderer&&this._instancingRenderers.fillRenderer.drawLayer(e,this,E)}drawSelectedFill(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._instancingRenderers.fillRenderer&&this._instancingRenderers.fillRenderer.drawLayer(e,this,S)}drawNormalOpaqueEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&this._instancingRenderers.edgesRenderer&&this._instancingRenderers.edgesRenderer.drawLayer(e,this,k)}drawNormalTransparentEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numEdgesLayerPortions&&this._instancingRenderers.edgesRenderer&&this._instancingRenderers.edgesRenderer.drawLayer(e,this,O)}drawXRayedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numXRayedLayerPortions&&this._instancingRenderers.edgesRenderer&&this._instancingRenderers.edgesRenderer.drawLayer(e,this,D)}drawHighlightedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numHighlightedLayerPortions&&this._instancingRenderers.edgesRenderer&&this._instancingRenderers.edgesRenderer.drawLayer(e,this,A)}drawSelectedEdges(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&0!==this._numSelectedLayerPortions&&this._instancingRenderers.edgesRenderer&&this._instancingRenderers.edgesRenderer.drawLayer(e,this,T)}drawOcclusion(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._instancingRenderers.occlusionRenderer&&this._instancingRenderers.occlusionRenderer.drawLayer(e,this,M)}drawShadow(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._instancingRenderers.shadowRenderer&&this._instancingRenderers.shadowRenderer.drawLayer(e,this,M)}drawPickMesh(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._instancingRenderers.pickMeshRenderer&&this._instancingRenderers.pickMeshRenderer.drawLayer(e,this,R)}drawPickDepths(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._instancingRenderers.pickDepthRenderer&&this._instancingRenderers.pickDepthRenderer.drawLayer(e,this,R)}drawPickNormals(e){this._numCulledLayerPortions!==this._numPortions&&0!==this._numVisibleLayerPortions&&this._instancingRenderers.pickNormalsRenderer&&this._instancingRenderers.pickNormalsRenderer.drawLayer(e,this,R)}destroy(){const e=this._state;e.positionsBuf&&(e.positionsBuf.destroy(),e.positionsBuf=null),e.normalsBuf&&(e.normalsBuf.destroy(),e.normalsBuf=null),e.colorsBuf&&(e.colorsBuf.destroy(),e.colorsBuf=null),e.flagsBuf&&(e.flagsBuf.destroy(),e.flagsBuf=null),e.flags2Buf&&(e.flags2Buf.destroy(),e.flags2Buf=null),e.offsetsBuf&&(e.offsetsBuf.destroy(),e.offsetsBuf=null),e.modelMatrixCol0Buf&&(e.modelMatrixCol0Buf.destroy(),e.modelMatrixCol0Buf=null),e.modelMatrixCol1Buf&&(e.modelMatrixCol1Buf.destroy(),e.modelMatrixCol1Buf=null),e.modelMatrixCol2Buf&&(e.modelMatrixCol2Buf.destroy(),e.modelMatrixCol2Buf=null),e.modelNormalMatrixCol0Buf&&(e.modelNormalMatrixCol0Buf.destroy(),e.modelNormalMatrixCol0Buf=null),e.modelNormalMatrixCol1Buf&&(e.modelNormalMatrixCol1Buf.destroy(),e.modelNormalMatrixCol1Buf=null),e.modelNormalMatrixCol2Buf&&(e.modelNormalMatrixCol2Buf.destroy(),e.modelNormalMatrixCol2Buf=null),e.indicesBuf&&(e.indicesBuf.destroy(),e.indicessBuf=null),e.edgeIndicesBuf&&(e.edgeIndicesBuf.destroy(),e.edgeIndicessBuf=null),e.pickColorsBuf&&(e.pickColorsBuf.destroy(),e.pickColorsBuf=null),e.destroy()}}const Mt=function(){const e=o.math.mat4(),t=o.math.mat4(),i=o.math.vec3();return function(r,n,s,a,l){const c=s[0],u=s[1],h=s[2],d=s[3],p=s[4],f=s[5],m=s[3]-c,g=s[4]-u,v=s[5]-h,b=d!==c?65535/(d-c):0,_=p!==u?65535/(p-u):0,y=f!==h?65535/(f-h):0;for(let e=0;e<n;e+=3)a[e+0]=Math.floor((r[e+0]-c)*b),a[e+1]=Math.floor((r[e+1]-u)*_),a[e+2]=Math.floor((r[e+2]-h)*y);o.math.identityMat4(e),o.math.translationMat4v(s,e),o.math.identityMat4(t),i[0]=m/65535,i[1]=g/65535,i[2]=v/65535,o.math.scalingMat4v(i,t),o.math.mulMat4(e,t,l)}}();function Pt(e,t,i,r){let n=e[t]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2])),o=e[t+1]/(Math.abs(e[t])+Math.abs(e[t+1])+Math.abs(e[t+2]));if(e[t+2]<0){let e=n,t=o;e=(1-Math.abs(o))*(n>=0?1:-1),t=(1-Math.abs(n))*(o>=0?1:-1),n=e,o=t}return new Int8Array([Math[i](127.5*n+(n<0?-1:0)),Math[r](127.5*o+(o<0?-1:0))])}function Et(e){let t=e[0],i=e[1];t/=t<0?127:128,i/=i<0?127:128;const r=1-Math.abs(t)-Math.abs(i);r<0&&(t=(1-Math.abs(i))*(t>=0?1:-1),i=(1-Math.abs(t))*(i>=0?1:-1));const n=Math.sqrt(t*t+i*i+r*r);return[t/n,i/n,r/n]}function St(e,t,i){return e[t]*i[0]+e[t+1]*i[1]+e[t+2]*i[2]}var Ct=i(97);const kt=a.a.SUPPORTED_EXTENSIONS.ANGLE_instanced_arrays,Ot=o.math.mat4(),At=o.math.vec3([1,1,1]),Tt=o.math.vec3([0,0,0]),Dt=o.math.vec3([0,0,0]),Rt=o.math.identityQuaternion();class Lt extends n.a{constructor(e,t={}){super(e,t),this._aabb=o.math.collapseAABB3(),this._aabbDirty=!1,this._layerList=[],this._nodeList=[],this._lastDecodeMatrix=null,this._instancingLayers={},this._currentBatchingLayer=null,this._batchingScratchMemory=function(e){return e.once("destroyed",()=>{x._clear()}),x}(this),this._meshes={},this._nodes={},this.renderFlags=new Ct.a,this.numGeometries=0,this.numPortions=0,this.numVisibleLayerPortions=0,this.numTransparentLayerPortions=0,this.numXRayedLayerPortions=0,this.numHighlightedLayerPortions=0,this.numSelectedLayerPortions=0,this.numEdgesLayerPortions=0,this.numPickableLayerPortions=0,this.numClippableLayerPortions=0,this.numCulledLayerPortions=0,this.numEntities=0,this._numTriangles=0,this._edgeThreshold=t.edgeThreshold||10,this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.colorize=t.colorize,this.opacity=t.opacity,this.backfaces=t.backfaces,this._position=new Float32Array(t.position||[0,0,0]),this._rotation=new Float32Array(t.rotation||[0,0,0]),this._quaternion=new Float32Array(t.quaternion||[0,0,0,1]),t.rotation&&o.math.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._scale=new Float32Array(t.scale||[1,1,1]),this._worldMatrix=o.math.mat4(),o.math.composeMat4(this._position,this._quaternion,this._scale,this._worldMatrix),this._worldNormalMatrix=o.math.mat4(),o.math.inverseMat4(this._worldMatrix,this._worldNormalMatrix),o.math.transposeMat4(this._worldNormalMatrix),(t.matrix||t.position||t.rotation||t.scale||t.quaternion)&&(this._viewMatrix=o.math.mat4(),this._viewNormalMatrix=o.math.mat4(),this._viewMatrixDirty=!0,this._worldMatrixNonIdentity=!0),this._opacity=1,this._colorize=[1,1,1],this._saoEnabled=!1!==t.saoEnabled,this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this._onCameraViewMatrix=this.scene.camera.on("matrix",()=>{this._viewMatrixDirty=!0})}get isPerformanceModel(){return!0}get position(){return this._position}get rotation(){return this._rotation}get quaternion(){return this._quaternion}get scale(){return this._scale}get matrix(){return this._worldMatrix}get worldMatrix(){return this._worldMatrix}get worldNormalMatrix(){return this._worldNormalMatrix}get viewMatrix(){return this._viewMatrix?(this._viewMatrixDirty&&(o.math.mulMat4(this.scene.camera.viewMatrix,this._worldMatrix,this._viewMatrix),o.math.inverseMat4(this._viewMatrix,this._viewNormalMatrix),o.math.transposeMat4(this._viewNormalMatrix),this._viewMatrixDirty=!1),this._viewMatrix):this.scene.camera.viewMatrix}getPickViewMatrix(e){return this._viewMatrix?this._viewMatrix:e}get viewNormalMatrix(){return this._viewNormalMatrix?(this._viewMatrixDirty&&(o.math.mulMat4(this.scene.camera.viewMatrix,this._worldMatrix,this._viewMatrix),o.math.inverseMat4(this._viewMatrix,this._viewNormalMatrix),o.math.transposeMat4(this._viewNormalMatrix),this._viewMatrixDirty=!1),this._viewNormalMatrix):this.scene.camera.viewNormalMatrix}createGeometry(e){if(!kt)return void this.error("WebGL instanced arrays not supported");const t=e.id;if(null==t)return void this.error("Config missing: id");if(this._instancingLayers[t])return void this.error("Geometry already created: "+t);const i=new wt(this,r.utils.apply({layerIndex:0,edgeThreshold:this._edgeThreshold},e));this._instancingLayers[t]=i,this._layerList.push(i),this.numGeometries++,this._numTriangles+=e.indices?Math.round(e.indices.length/3):0}createMesh(e){let t=e.id;if(null==t)return void this.error("Config missing: id");if(this._meshes[t])return void this.error("PerformanceModel already has a Mesh with this ID: "+t);const i=e.geometryId,r=void 0!==i;if(r){if(!kt)return void this.error("WebGL instanced arrays not supported");if(!this._instancingLayers[i])return void this.error("Geometry not found: "+i+" - ensure that you create it first with createGeometry()")}let n,a;const c=e.color?new Uint8Array([Math.floor(255*e.color[0]),Math.floor(255*e.color[1]),Math.floor(255*e.color[2])]):[255,255,255],u=void 0!==e.opacity&&null!==e.opacity?Math.floor(255*e.opacity):255;u<255&&this.numTransparentLayerPortions++;const h=new l(this,t,c,u),d=h.pickId,p=new Uint8Array([255&d,d>>8&255,d>>16&255,d>>24&255]),f=o.math.collapseAABB3();if(r){let t,r=this._worldMatrixNonIdentity?this._worldMatrix:null;if(e.matrix)t=e.matrix;else{const i=e.scale||At,r=e.position||Tt,n=e.rotation||Dt;o.math.eulerToQuaternion(n,"XYZ",Rt),t=o.math.composeMat4(r,Rt,i,Ot)}const s=this._instancingLayers[i];n=s,a=s.createPortion(c,u,t,r,f,p),o.math.expandAABB3(this._aabb,f);const l=Math.round(s.numIndices/3);this._numTriangles+=l,h.numTriangles=l,h.rtcCenter=s.rtcCenter}else{let t=e.primitive||"triangles";"points"!==t&&"lines"!==t&&"line-loop"!==t&&"line-strip"!==t&&"triangles"!==t&&"triangle-strip"!==t&&"triangle-fan"!==t&&(this.error(`Unsupported value for 'primitive': '${t}' - supported values are 'points', 'lines', 'line-loop', 'line-strip', 'triangles', 'triangle-strip' and 'triangle-fan'. Defaulting to 'triangles'.`),t="triangles");let i=e.indices,r=e.edgeIndices,l=e.positions;if(!l)return this.error("Config missing: positions (no meshIds provided, so expecting geometry arrays instead)"),null;let d=e.normals;if(!d)return this.error("Config missing: normals (no meshIds provided, so expecting geometry arrays instead)"),null;if(!r&&!i)return this.error("Config missing: must have one or both of indices and edgeIndices  (no meshIds provided, so expecting geometry arrays instead)"),null;let m,g=!1;e.rtcCenter&&(this._lastRTCCenter?o.math.compareVec3(this._lastRTCCenter,e.rtcCenter)||(g=!0,this._lastRTCCenter.set(e.rtcCenter)):(g=!0,this._lastRTCCenter=o.math.vec3(e.rtcCenter))),e.positionsDecodeMatrix&&(this._lastDecodeMatrix?o.math.compareMat4(this._lastDecodeMatrix,e.positionsDecodeMatrix)||(g=!0,this._lastDecodeMatrix.set(e.positionsDecodeMatrix)):(g=!0,this._lastDecodeMatrix=o.math.mat4(e.positionsDecodeMatrix))),g&&this._currentBatchingLayer&&(this._currentBatchingLayer.finalize(),this._currentBatchingLayer=null),this._currentBatchingLayer&&(this._currentBatchingLayer.canCreatePortion(l.length,i.length)||(this._currentBatchingLayer.finalize(),this._currentBatchingLayer=null)),this._currentBatchingLayer||(this._currentBatchingLayer=new Oe(this,{layerIndex:0,primitive:"triangles",scratchMemory:this._batchingScratchMemory,positionsDecodeMatrix:e.positionsDecodeMatrix,rtcCenter:e.rtcCenter}),this._layerList.push(this._currentBatchingLayer)),n=this._currentBatchingLayer,!r&&i&&(r=Object(s.a)(l,i,null,this._edgeThreshold));let v=this._worldMatrixNonIdentity?this._worldMatrix:null;if(!e.positionsDecodeMatrix)if(e.matrix)m=e.matrix;else{const t=e.scale||At,i=e.position||Tt,r=e.rotation||Dt;o.math.eulerToQuaternion(r,"XYZ",Rt),m=o.math.composeMat4(i,Rt,t,Ot)}a=this._currentBatchingLayer.createPortion(l,d,i,r,c,u,m,v,f,p),o.math.expandAABB3(this._aabb,f),this.numGeometries++;const b=Math.round(i.length/3);this._numTriangles+=b,h.numTriangles=b,h.rtcCenter=e.rtcCenter}h.parent=null,h._layer=n,h._portionId=a,h.aabb=f,this._meshes[t]=h}createEntity(e){let t=e.id;void 0===t?t=o.math.createUUID():this.scene.components[t]&&(this.error("Scene already has a Component with this ID: "+t+" - will assign random ID"),t=o.math.createUUID());const i=e.meshIds;if(void 0===i)return void this.error("Config missing: meshIds");let r=[];for(let e=0,t=i.length;e<t;e++){const t=i[e],n=this._meshes[t];n?n.parent?this.error("Mesh with ID "+t+" already belongs to object with ID "+n.parent.id+" - ignoring this mesh"):r.push(n):this.error("Mesh with this ID not found: "+t+" - ignoring this mesh")}let n,s=0;if(this._visible&&!1!==e.visible&&(s|=c),this._pickable&&!1!==e.pickable&&(s|=h),this._culled&&!1!==e.culled&&(s|=u),this._clippable&&!1!==e.clippable&&(s|=d),this._collidable&&!1!==e.collidable&&(s|=p),this._edges&&!1!==e.edges&&(s|=v),this._xrayed&&!1!==e.xrayed&&(s|=f),this._highlighted&&!1!==e.highlighted&&(s|=m),this._selected&&!1!==e.selected&&(s|=g),1===r.length)n=r[0].aabb;else{n=o.math.collapseAABB3();for(let e=0,t=r.length;e<t;e++)o.math.expandAABB3(n,r[e].aabb)}const a=new y(this,e.isObject,t,r,s,n);return this._nodeList.push(a),this._nodes[t]=a,this.numEntities++,a}finalize(){this._currentBatchingLayer&&(this._currentBatchingLayer.finalize(),this._currentBatchingLayer=null);for(const e in this._instancingLayers)this._instancingLayers.hasOwnProperty(e)&&this._instancingLayers[e].finalize();for(let e=0,t=this._nodeList.length;e<t;e++)this._nodeList[e]._finalize();const e=[];for(let t=0,i=this._layerList.length;t<i;t++){const i=this._layerList[t];i instanceof Oe?e.push(i):e.unshift(i)}for(let t=0,i=e.length;t<i;t++){const i=e[t];this._layerList[t]=i,i.layerIndex=t}this.glRedraw(),this.scene._aabbDirty=!0}set backfaces(e){e=!!e,this._backfaces=e,this.glRedraw()}get backfaces(){return this._backfaces}get entityList(){return this._nodeList}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return!1}get aabb(){return this._aabbDirty&&this._rebuildAABB(),this._aabb}_rebuildAABB(){o.math.collapseAABB3(this._aabb);for(let e=0,t=this._nodeList.length;e<t;e++){const t=this._nodeList[e];o.math.expandAABB3(this._aabb,t.aabb)}this._aabbDirty=!1}get numTriangles(){return this._numTriangles}set visible(e){e=!1!==e,this._visible=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].visible=e;this.glRedraw()}get visible(){return this.numVisibleLayerPortions>0}set xrayed(e){e=!!e,this._xrayed=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].xrayed=e;this.glRedraw()}get xrayed(){return this.numXRayedLayerPortions>0}set highlighted(e){e=!!e,this._highlighted=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].highlighted=e;this.glRedraw()}get highlighted(){return this.numHighlightedLayerPortions>0}set selected(e){e=!!e,this._selected=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].selected=e;this.glRedraw()}get selected(){return this.numSelectedLayerPortions>0}set edges(e){e=!!e,this._edges=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].edges=e;this.glRedraw()}get edges(){return this.numEdgesLayerPortions>0}set culled(e){e=!!e,this._culled=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].culled=e;this.glRedraw()}get culled(){return this._culled}set clippable(e){e=!1!==e,this._clippable=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].clippable=e;this.glRedraw()}get clippable(){return this._clippable}set collidable(e){e=!1!==e,this._collidable=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].collidable=e}get collidable(){return this._collidable}set pickable(e){e=!1!==e,this._pickable=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].pickable=e}get pickable(){return this.numPickableLayerPortions>0}set colorize(e){this._colorize=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].colorize=e}get colorize(){return this._colorize}set opacity(e){this._opacity=e;for(let t=0,i=this._nodeList.length;t<i;t++)this._nodeList[t].opacity=e}get opacity(){return this._opacity}set castsShadow(e){(e=!1!==e)!==this._castsShadow&&(this._castsShadow=e,this.glRedraw())}get castsShadow(){return this._castsShadow}set receivesShadow(e){(e=!1!==e)!==this._receivesShadow&&(this._receivesShadow=e,this.glRedraw())}get receivesShadow(){return this._receivesShadow}get saoEnabled(){return this._saoEnabled}get isDrawable(){return!0}get isStateSortable(){return!1}stateSortCompare(e,t){}rebuildRenderFlags(){this.renderFlags.reset(),this._updateRenderFlagsVisibleLayers(),this.renderFlags.numLayers>0&&0===this.renderFlags.numVisibleLayers?this.renderFlags.culled=!0:this._updateRenderFlags()}_updateRenderFlagsVisibleLayers(){const e=this.renderFlags;e.numLayers=this._layerList.length,e.numVisibleLayers=0;for(let t=0,i=this._layerList.length;t<i;t++){const i=this._layerList[t];this._getActiveSectionPlanesForLayer(i)&&(e.visibleLayers[e.numVisibleLayers++]=t)}}_getActiveSectionPlanesForLayer(e){const t=this.renderFlags,i=this.scene._sectionPlanesState.sectionPlanes,r=i.length,n=e.layerIndex*r;if(r>0)for(let e=0;e<r;e++)i[e].active?t.sectionPlanesActivePerLayer[n+e]=!0:t.sectionPlanesActivePerLayer[n+e]=!1;return!0}_updateRenderFlags(){if(0===this.numVisibleLayerPortions)return;if(this.numCulledLayerPortions===this.numPortions)return;const e=this.renderFlags;if(e.normalFillOpaque=this.numTransparentLayerPortions<this.numPortions,this.numTransparentLayerPortions>0&&(e.normalFillTransparent=!0),this.numXRayedLayerPortions>0){const t=this.scene.xrayMaterial._state;t.fill&&(t.fillAlpha<1?e.xrayedFillTransparent=!0:e.xrayedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.xrayedEdgesTransparent=!0:e.xrayedEdgesOpaque=!0)}if(this.numEdgesLayerPortions>0&&this.scene.edgeMaterial._state.edges&&(e.normalEdgesOpaque=this.numTransparentLayerPortions<this.numPortions,this.numTransparentLayerPortions>0&&(e.normalEdgesTransparent=!0)),this.numSelectedLayerPortions>0){const t=this.scene.selectedMaterial._state;t.fill&&(t.fillAlpha<1?e.selectedFillTransparent=!0:e.selectedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.selectedEdgesTransparent=!0:e.selectedEdgesOpaque=!0)}if(this.numHighlightedLayerPortions>0){const t=this.scene.highlightMaterial._state;t.fill&&(t.fillAlpha<1?e.highlightedFillTransparent=!0:e.highlightedFillOpaque=!0),t.edges&&(t.edgeAlpha<1?e.highlightedEdgesTransparent=!0:e.highlightedEdgesOpaque=!0)}}get xrayMaterial(){return this.scene.xrayMaterial}get highlightMaterial(){return this.scene.highlightMaterial}get selectedMaterial(){return this.scene.selectedMaterial}get edgeMaterial(){return this.scene.edgeMaterial}drawNormalOpaqueFill(e){if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawNormalOpaqueFill(e)}}drawNormalTransparentFill(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawNormalTransparentFill(e)}}drawDepth(e){if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawDepth(e)}}drawNormals(e){if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawNormals(e)}}drawXRayedFill(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawXRayedFill(e)}}drawHighlightedFill(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawHighlightedFill(e)}}drawSelectedFill(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawSelectedFill(e)}}drawNormalOpaqueEdges(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawNormalOpaqueEdges(e)}}drawNormalTransparentEdges(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawNormalTransparentEdges(e)}}drawXRayedEdges(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawXRayedEdges(e)}}drawHighlightedEdges(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawHighlightedEdges(e)}}drawSelectedEdges(e){const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawSelectedEdges(e)}}drawOcclusion(e){if(0===this.numVisibleLayerPortions)return;if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawOcclusion(e)}}drawShadow(e){if(0===this.numVisibleLayerPortions)return;if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawShadow(e)}}drawPickMesh(e){if(0===this.numVisibleLayerPortions)return;if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawPickMesh(e)}}drawPickDepths(e){if(0===this.numVisibleLayerPortions)return;if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawPickDepths(e)}}drawPickNormals(e){if(0===this.numVisibleLayerPortions)return;if(e.backfaces!==this.backfaces){const t=this.scene.canvas.gl;this.backfaces?t.disable(t.CULL_FACE):t.enable(t.CULL_FACE),e.backfaces=this.backfaces}const t=this.renderFlags;for(let i=0,r=t.visibleLayers.length;i<r;i++){const r=t.visibleLayers[i];this._layerList[r].drawPickNormals(e)}}destroy(){this._currentBatchingLayer&&(this._currentBatchingLayer.destroy(),this._currentBatchingLayer=null),this.scene.camera.off(this._onCameraViewMatrix);for(let e=0,t=this._layerList.length;e<t;e++)this._layerList[e].destroy();for(let e=0,t=this._nodeList.length;e<t;e++)this._nodeList[e]._destroy();this.scene._aabbDirty=!0,this._isModel&&this.scene._deregisterModel(this),super.destroy()}}var Bt=i(34);class It{constructor(){}getMetaModel(e,t,i){r.utils.loadJSON(e,e=>{t(e)},(function(e){i(e)}))}getXKT(e,t,i){var r=()=>{};t=t||r,i=i||r;const n=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(n){const r=!!n[2];var o=n[3];o=window.decodeURIComponent(o),r&&(o=window.atob(o));try{const e=new ArrayBuffer(o.length),i=new Uint8Array(e);for(var s=0;s<o.length;s++)i[s]=o.charCodeAt(s);t(e)}catch(e){i(e)}}else{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.response):i("getXKT error : "+r.response))},r.send(null)}}}const Nt={IfcRoof:{colorize:[.837255,.203922,.270588]},IfcSlab:{colorize:[.637255,.603922,.670588]},IfcWall:{colorize:[.537255,.337255,.237255]},IfcWallStandardCase:{colorize:[.537255,.337255,.237255]},IfcCovering:{colorize:[.8470588235,.427450980392,0]},IfcDoor:{colorize:[.637255,.603922,.670588]},IfcStair:{colorize:[.637255,.603922,.670588]},IfcStairFlight:{colorize:[.637255,.603922,.670588]},IfcProxy:{colorize:[.137255,.403922,.870588]},IfcRamp:{colorize:[.8470588235,.427450980392,0]},IfcColumn:{colorize:[.137255,.403922,.870588]},IfcBeam:{colorize:[.137255,.403922,.870588]},IfcCurtainWall:{colorize:[.137255,.403922,.870588]},IfcPlate:{colorize:[.8470588235,.427450980392,0,.5],opacity:.3},IfcTransportElement:{colorize:[.8470588235,.427450980392,0]},IfcFooting:{colorize:[.8470588235,.427450980392,0]},IfcRailing:{colorize:[.137255,.403922,.870588]},IfcFurnishingElement:{colorize:[.137255,.403922,.870588]},IfcFurniture:{colorize:[.8470588235,.427450980392,0]},IfcSystemFurnitureElement:{colorize:[.8470588235,.427450980392,0]},IfcFlowSegment:{colorize:[.137255,.403922,.870588]},IfcFlowitting:{colorize:[.137255,.403922,.870588]},IfcFlowTerminal:{colorize:[.137255,.403922,.870588]},IfcFlowController:{colorize:[.8470588235,.427450980392,0]},IfcFlowFitting:{colorize:[.8470588235,.427450980392,0]},IfcDuctSegment:{colorize:[.8470588235,.427450980392,0]},IfcDistributionFlowElement:{colorize:[.8470588235,.427450980392,0]},IfcDuctFitting:{colorize:[.8470588235,.427450980392,0]},IfcLightFixture:{colorize:[.8470588235,.8470588235,.870588]},IfcAirTerminal:{colorize:[.8470588235,.427450980392,0]},IfcOpeningElement:{colorize:[.137255,.403922,.870588],pickable:!1,visible:!1},IfcSpace:{colorize:[.137255,.403922,.870588],pickable:!1,visible:!1,opacity:.5},IfcWindow:{colorize:[.137255,.403922,.870588],pickable:!0,opacity:.1},IfcBuildingElementProxy:{colorize:[.5,.5,.5]},IfcSite:{colorize:[.137255,.403922,.870588]},IfcMember:{colorize:[.8470588235,.427450980392,0]},DEFAULT:{colorize:[.5,.5,.5]}};var jt=i(35);let Ft=window.pako||jt;Ft.inflate||(Ft=Ft.default);const zt=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),Vt={version:1,parse:function(e,t,i,n){!function(e,t,i,n){n.positionsCompression="precompressed",n.normalsCompression="precompressed";const s=i.positions,a=i.normals,l=i.indices,c=i.edgeIndices,u=i.meshPositions,h=i.meshIndices,d=i.meshEdgesIndices,p=i.meshColors,f=JSON.parse(i.entityIDs),m=i.entityMeshes,g=i.entityIsObjects,v=u.length,b=m.length;for(let _=0;_<b;_++){const y=f[_],x=t.globalizeObjectIds?o.math.globalizeObjectId(n.id,y):y,w=e.metaScene.metaObjects[x],M={},P={};if(w){if(t.excludeTypesMap&&w.type&&t.excludeTypesMap[w.type])continue;if(t.includeTypesMap&&w.type&&!t.includeTypesMap[w.type])continue;const e=t.objectDefaults?t.objectDefaults[w.type]||t.objectDefaults.DEFAULT:null;e&&(!1===e.visible&&(M.visible=!1),!1===e.pickable&&(M.pickable=!1),e.colorize&&(P.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(P.opacity=e.opacity))}else if(t.excludeUnclassifiedObjects)continue;const E=_===b-1,S=[];for(let e=m[_],t=E?m.length:m[_+1];e<t;e++){const t=e===v-1,o=x+".mesh."+e,f=zt(p.subarray(4*e,4*e+3)),m=p[4*e+3]/255;n.createMesh(r.utils.apply(P,{id:o,primitive:"triangles",positions:s.subarray(u[e],t?s.length:u[e+1]),normals:a.subarray(u[e],t?s.length:u[e+1]),indices:l.subarray(h[e],t?l.length:h[e+1]),edgeIndices:c.subarray(d[e],t?c.length:d[e+1]),positionsDecodeMatrix:i.positionsDecodeMatrix,color:f,opacity:m})),S.push(o)}n.createEntity(r.utils.apply(M,{id:x,isObject:1===g[_],meshIds:S}))}}(e,t,function(e){return{positions:new Uint16Array(Ft.inflate(e.positions).buffer),normals:new Int8Array(Ft.inflate(e.normals).buffer),indices:new Uint32Array(Ft.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Ft.inflate(e.edgeIndices).buffer),meshPositions:new Uint32Array(Ft.inflate(e.meshPositions).buffer),meshIndices:new Uint32Array(Ft.inflate(e.meshIndices).buffer),meshEdgesIndices:new Uint32Array(Ft.inflate(e.meshEdgesIndices).buffer),meshColors:new Uint8Array(Ft.inflate(e.meshColors).buffer),entityIDs:Ft.inflate(e.entityIDs,{to:"string"}),entityMeshes:new Uint32Array(Ft.inflate(e.entityMeshes).buffer),entityIsObjects:new Uint8Array(Ft.inflate(e.entityIsObjects).buffer),positionsDecodeMatrix:new Float32Array(Ft.inflate(e.positionsDecodeMatrix).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],meshPositions:e[4],meshIndices:e[5],meshEdgesIndices:e[6],meshColors:e[7],entityIDs:e[8],entityMeshes:e[9],entityIsObjects:e[10],positionsDecodeMatrix:e[11]}}(i)),n)}};let Ut=window.pako||jt;Ut.inflate||(Ut=Ut.default);const Wt=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),Ht={version:2,parse:function(e,t,i,n){!function(e,t,i,n){n.positionsCompression="precompressed",n.normalsCompression="precompressed";const s=i.positions,a=i.normals,l=i.indices,c=i.edgeIndices,u=i.meshPositions,h=i.meshIndices,d=i.meshEdgesIndices,p=i.meshColors,f=JSON.parse(i.entityIDs),m=i.entityMeshes,g=i.entityIsObjects,v=i.entityMeshIds,b=i.entityMatrices,_=i.entityUsesInstancing,y=u.length,x=m.length,w={};for(let M=0;M<x;M++){const P=f[M],E=t.globalizeObjectIds?o.math.globalizeObjectId(n.id,P):P,S=e.metaScene.metaObjects[E],C={},k={},O=b.subarray(16*M,16*M+16);if(S){if(t.excludeTypesMap&&S.type&&t.excludeTypesMap[S.type])continue;if(t.includeTypesMap&&S.type&&!t.includeTypesMap[S.type])continue;const e=t.objectDefaults?t.objectDefaults[S.type]||t.objectDefaults.DEFAULT:null;e&&(!1===e.visible&&(C.visible=!1),!1===e.pickable&&(C.pickable=!1),e.colorize&&(k.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(k.opacity=e.opacity))}else if(t.excludeUnclassifiedObjects)continue;const A=M===x-1,T=[];for(let e=m[M],t=A?v.length:m[M+1];e<t;e++){const t=v[e],o=t===y-1,f=E+".mesh."+t,m=Wt(p.subarray(4*t,4*t+3)),g=p[4*t+3]/255,b=s.subarray(u[t],o?s.length:u[t+1]),x=a.subarray(u[t],o?s.length:u[t+1]),P=l.subarray(h[t],o?l.length:h[t+1]),S=c.subarray(d[t],o?c.length:d[t+1]);if(1===_[M]){const e="geometry."+t;e in w||(n.createGeometry({id:e,positions:b,normals:x,indices:P,edgeIndices:S,primitive:"triangles",positionsDecodeMatrix:i.positionsDecodeMatrix}),w[e]=!0),n.createMesh(r.utils.apply(k,{id:f,color:m,opacity:g,matrix:O,geometryId:e})),T.push(f)}else n.createMesh(r.utils.apply(k,{id:f,primitive:"triangles",positions:b,normals:x,indices:P,edgeIndices:S,positionsDecodeMatrix:i.positionsDecodeMatrix,color:m,opacity:g})),T.push(f)}T.length&&n.createEntity(r.utils.apply(C,{id:E,isObject:1===g[M],meshIds:T}))}}(e,t,function(e){return{positions:new Uint16Array(Ut.inflate(e.positions).buffer),normals:new Int8Array(Ut.inflate(e.normals).buffer),indices:new Uint32Array(Ut.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Ut.inflate(e.edgeIndices).buffer),meshPositions:new Uint32Array(Ut.inflate(e.meshPositions).buffer),meshIndices:new Uint32Array(Ut.inflate(e.meshIndices).buffer),meshEdgesIndices:new Uint32Array(Ut.inflate(e.meshEdgesIndices).buffer),meshColors:new Uint8Array(Ut.inflate(e.meshColors).buffer),entityIDs:Ut.inflate(e.entityIDs,{to:"string"}),entityMeshes:new Uint32Array(Ut.inflate(e.entityMeshes).buffer),entityIsObjects:new Uint8Array(Ut.inflate(e.entityIsObjects).buffer),positionsDecodeMatrix:new Float32Array(Ut.inflate(e.positionsDecodeMatrix).buffer),entityMeshIds:new Uint32Array(Ut.inflate(e.entityMeshIds).buffer),entityMatrices:new Float32Array(Ut.inflate(e.entityMatrices).buffer),entityUsesInstancing:new Uint8Array(Ut.inflate(e.entityUsesInstancing).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],meshPositions:e[4],meshIndices:e[5],meshEdgesIndices:e[6],meshColors:e[7],entityIDs:e[8],entityMeshes:e[9],entityIsObjects:e[10],positionsDecodeMatrix:e[11],entityMeshIds:e[12],entityMatrices:e[13],entityUsesInstancing:e[14]}}(i)),n)}};let Gt=window.pako||jt;Gt.inflate||(Gt=Gt.default);const Xt=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),Yt={version:3,parse:function(e,t,i,n){!function(e,t,i,n){n.positionsCompression="precompressed",n.normalsCompression="precompressed";const s=i.positions,a=i.normals,l=i.indices,c=i.edgeIndices,u=i.meshPositions,h=i.meshIndices,d=i.meshEdgesIndices,p=i.meshColors,f=JSON.parse(i.entityIDs),m=i.entityMeshes,g=i.entityIsObjects,v=i.entityMeshIds,b=i.entityMatrices,_=i.entityUsesInstancing,y=u.length,x=m.length,w={};for(let O=0;O<x;O++){const A=f[O],T=t.globalizeObjectIds?o.math.globalizeObjectId(n.id,A):A,D=e.metaScene.metaObjects[T],R={},L={},B=b.subarray(16*O,16*O+16);if(D){if(t.excludeTypesMap&&D.type&&t.excludeTypesMap[D.type])continue;if(t.includeTypesMap&&D.type&&!t.includeTypesMap[D.type])continue;const e=t.objectDefaults?t.objectDefaults[D.type]||t.objectDefaults.DEFAULT:null;e&&(!1===e.visible&&(R.visible=!1),!1===e.pickable&&(R.pickable=!1),e.colorize&&(L.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(L.opacity=e.opacity))}else if(t.excludeUnclassifiedObjects)continue;const I=O===x-1,N=[];for(let e=m[O],t=I?v.length:m[O+1];e<t;e++){var M=v[e];const t=M===y-1,o=T+".mesh."+M,f=Xt(p.subarray(4*M,4*M+3)),m=p[4*M+3]/255;var P=s.subarray(u[M],t?s.length:u[M+1]),E=a.subarray(u[M],t?s.length:u[M+1]),S=l.subarray(h[M],t?l.length:h[M+1]),C=c.subarray(d[M],t?c.length:d[M+1]);if(1===_[O]){var k="geometry."+M;k in w||(n.createGeometry({id:k,positions:P,normals:E,indices:S,edgeIndices:C,primitive:"triangles",positionsDecodeMatrix:i.instancedPositionsDecodeMatrix}),w[k]=!0),n.createMesh(r.utils.apply(L,{id:o,color:f,opacity:m,matrix:B,geometryId:k})),N.push(o)}else n.createMesh(r.utils.apply(L,{id:o,primitive:"triangles",positions:P,normals:E,indices:S,edgeIndices:C,positionsDecodeMatrix:i.batchedPositionsDecodeMatrix,color:f,opacity:m})),N.push(o)}N.length&&n.createEntity(r.utils.apply(R,{id:T,isObject:1===g[O],meshIds:N}))}}(e,t,function(e){return{positions:new Uint16Array(Gt.inflate(e.positions).buffer),normals:new Int8Array(Gt.inflate(e.normals).buffer),indices:new Uint32Array(Gt.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Gt.inflate(e.edgeIndices).buffer),meshPositions:new Uint32Array(Gt.inflate(e.meshPositions).buffer),meshIndices:new Uint32Array(Gt.inflate(e.meshIndices).buffer),meshEdgesIndices:new Uint32Array(Gt.inflate(e.meshEdgesIndices).buffer),meshColors:new Uint8Array(Gt.inflate(e.meshColors).buffer),entityIDs:Gt.inflate(e.entityIDs,{to:"string"}),entityMeshes:new Uint32Array(Gt.inflate(e.entityMeshes).buffer),entityIsObjects:new Uint8Array(Gt.inflate(e.entityIsObjects).buffer),instancedPositionsDecodeMatrix:new Float32Array(Gt.inflate(e.instancedPositionsDecodeMatrix).buffer),batchedPositionsDecodeMatrix:new Float32Array(Gt.inflate(e.batchedPositionsDecodeMatrix).buffer),entityMeshIds:new Uint32Array(Gt.inflate(e.entityMeshIds).buffer),entityMatrices:new Float32Array(Gt.inflate(e.entityMatrices).buffer),entityUsesInstancing:new Uint8Array(Gt.inflate(e.entityUsesInstancing).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],meshPositions:e[4],meshIndices:e[5],meshEdgesIndices:e[6],meshColors:e[7],entityIDs:e[8],entityMeshes:e[9],entityIsObjects:e[10],instancedPositionsDecodeMatrix:e[11],batchedPositionsDecodeMatrix:e[12],entityMeshIds:e[13],entityMatrices:e[14],entityUsesInstancing:e[15]}}(i)),n)}};let $t=window.pako||jt;$t.inflate||($t=$t.default);const qt=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),Kt={version:4,parse:function(e,t,i,n){!function(e,t,i,n){n.positionsCompression="precompressed",n.normalsCompression="precompressed";const o=i.positions,s=i.normals,a=i.indices,l=i.edgeIndices,c=i.decodeMatrices,u=i.matrices,h=i.eachPrimitivePositionsAndNormalsPortion,d=i.eachPrimitiveIndicesPortion,p=i.eachPrimitiveEdgeIndicesPortion,f=i.eachPrimitiveDecodeMatricesPortion,m=i.eachPrimitiveColor,g=i.primitiveInstances,v=JSON.parse(i.eachEntityId),b=i.eachEntityPrimitiveInstancesPortion,_=i.eachEntityMatricesPortion,y=h.length,x=g.length,w=new Uint8Array(y),M=new Uint32Array(y),P=v.length;for(let e=0;e<y;e++)M[e]=e;M.sort((e,t)=>f[e]<f[t]?-1:f[e]>f[t]?1:0);for(let e=0;e<x;e++)w[g[e]]++;const E={};for(let e=0;e<P;e++){const t=P-1,i=e===t,r=b[e],n=i?b[t]:b[e+1];for(let t=r;t<n;t++){const i=g[t];w[i]>1||(E[i]=e)}}for(let e=0;e<y;e++){const t=M[e],i=t===y-1,u=w[t]>1,g=qt(m.subarray(4*t,4*t+3)),b=m[4*t+3]/255,_=o.subarray(h[t],i?o.length:h[t+1]),x=s.subarray(h[t],i?s.length:h[t+1]),P=a.subarray(d[t],i?a.length:d[t+1]),C=l.subarray(p[t],i?l.length:p[t+1]),k=c.subarray(f[t],f[t]+16);if(u){var S="geometry"+t;n.createGeometry({id:S,primitive:"triangles",positions:_,normals:x,indices:P,edgeIndices:C,positionsDecodeMatrix:k})}else{const e=t,i=(v[E[t]],{});n.createMesh(r.utils.apply(i,{id:e,primitive:"triangles",positions:_,normals:x,indices:P,edgeIndices:C,positionsDecodeMatrix:k,color:g,opacity:b}))}}let C=0;for(let e=0;e<P;e++){const t=P-1,i=e===t,o=v[e],s=b[e],a=i?b[t]:b[e+1],l=[];for(let t=s;t<a;t++){const i=g[t];if(w[i]>1){const t={},o="instance."+C++,s="geometry"+i,a=16*_[e],c=u.subarray(a,a+16);n.createMesh(r.utils.apply(t,{id:o,geometryId:s,matrix:c})),l.push(o)}else l.push(i)}if(l.length>0){const e={};n.createEntity(r.utils.apply(e,{id:o,isObject:!0,meshIds:l}))}}}(0,0,function(e){return{positions:new Uint16Array($t.inflate(e.positions).buffer),normals:new Int8Array($t.inflate(e.normals).buffer),indices:new Uint32Array($t.inflate(e.indices).buffer),edgeIndices:new Uint32Array($t.inflate(e.edgeIndices).buffer),decodeMatrices:new Float32Array($t.inflate(e.decodeMatrices).buffer),matrices:new Float32Array($t.inflate(e.matrices).buffer),eachPrimitivePositionsAndNormalsPortion:new Uint32Array($t.inflate(e.eachPrimitivePositionsAndNormalsPortion).buffer),eachPrimitiveIndicesPortion:new Uint32Array($t.inflate(e.eachPrimitiveIndicesPortion).buffer),eachPrimitiveEdgeIndicesPortion:new Uint32Array($t.inflate(e.eachPrimitiveEdgeIndicesPortion).buffer),eachPrimitiveDecodeMatricesPortion:new Uint32Array($t.inflate(e.eachPrimitiveDecodeMatricesPortion).buffer),eachPrimitiveColor:new Uint8Array($t.inflate(e.eachPrimitiveColor).buffer),primitiveInstances:new Uint32Array($t.inflate(e.primitiveInstances).buffer),eachEntityId:$t.inflate(e.eachEntityId,{to:"string"}),eachEntityPrimitiveInstancesPortion:new Uint32Array($t.inflate(e.eachEntityPrimitiveInstancesPortion).buffer),eachEntityMatricesPortion:new Uint32Array($t.inflate(e.eachEntityMatricesPortion).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],decodeMatrices:e[4],matrices:e[5],eachPrimitivePositionsAndNormalsPortion:e[6],eachPrimitiveIndicesPortion:e[7],eachPrimitiveEdgeIndicesPortion:e[8],eachPrimitiveDecodeMatricesPortion:e[9],eachPrimitiveColor:e[10],primitiveInstances:e[11],eachEntityId:e[12],eachEntityPrimitiveInstancesPortion:e[13],eachEntityMatricesPortion:e[14],eachEntityMatrix:e[15]}}(i)),n)}};let Zt=window.pako||jt;Zt.inflate||(Zt=Zt.default);const Qt=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),Jt={version:5,parse:function(e,t,i,n){!function(e,t,i,n){n.positionsCompression="disabled",n.normalsCompression="precompressed";const o=i.positions,s=i.normals,a=i.indices,l=i.edgeIndices,c=i.matrices,u=i.eachPrimitivePositionsAndNormalsPortion,h=i.eachPrimitiveIndicesPortion,d=i.eachPrimitiveEdgeIndicesPortion,p=i.eachPrimitiveColor,f=i.primitiveInstances,m=JSON.parse(i.eachEntityId),g=i.eachEntityPrimitiveInstancesPortion,v=i.eachEntityMatricesPortion,b=u.length,_=f.length,y=new Uint8Array(b),x=m.length;for(let e=0;e<_;e++)y[f[e]]++;const w={};for(let e=0;e<x;e++){const t=x-1,i=e===t,r=g[e],n=i?g[t]:g[e+1];for(let t=r;t<n;t++){const i=f[t];y[i]>1||(w[i]=e)}}for(let e=0;e<b;e++){const t=e===b-1,i=y[e]>1,c=Qt(p.subarray(4*e,4*e+3)),f=p[4*e+3]/255,g=o.subarray(u[e],t?o.length:u[e+1]),v=s.subarray(u[e],t?s.length:u[e+1]),_=a.subarray(h[e],t?a.length:h[e+1]),x=l.subarray(d[e],t?l.length:d[e+1]);if(i){var M="geometry"+e;n.createGeometry({id:M,primitive:"triangles",positions:g,normals:v,indices:_,edgeIndices:x})}else{const t=e,i=(m[w[e]],{});n.createMesh(r.utils.apply(i,{id:t,primitive:"triangles",positions:g,normals:v,indices:_,edgeIndices:x,color:c,opacity:f}))}}let P=0;for(let e=0;e<x;e++){const t=x-1,i=e===t,o=m[e],s=g[e],a=i?g[t]:g[e+1],l=[];for(let t=s;t<a;t++){const i=f[t];if(y[i]>1){const t={},o="instance."+P++,s="geometry"+i,a=16*v[e],u=c.subarray(a,a+16);n.createMesh(r.utils.apply(t,{id:o,geometryId:s,matrix:u})),l.push(o)}else l.push(i)}if(l.length>0){const e={};n.createEntity(r.utils.apply(e,{id:o,isObject:!0,meshIds:l}))}}}(0,0,function(e){return{positions:new Float32Array(Zt.inflate(e.positions).buffer),normals:new Int8Array(Zt.inflate(e.normals).buffer),indices:new Uint32Array(Zt.inflate(e.indices).buffer),edgeIndices:new Uint32Array(Zt.inflate(e.edgeIndices).buffer),matrices:new Float32Array(Zt.inflate(e.matrices).buffer),eachPrimitivePositionsAndNormalsPortion:new Uint32Array(Zt.inflate(e.eachPrimitivePositionsAndNormalsPortion).buffer),eachPrimitiveIndicesPortion:new Uint32Array(Zt.inflate(e.eachPrimitiveIndicesPortion).buffer),eachPrimitiveEdgeIndicesPortion:new Uint32Array(Zt.inflate(e.eachPrimitiveEdgeIndicesPortion).buffer),eachPrimitiveColor:new Uint8Array(Zt.inflate(e.eachPrimitiveColor).buffer),primitiveInstances:new Uint32Array(Zt.inflate(e.primitiveInstances).buffer),eachEntityId:Zt.inflate(e.eachEntityId,{to:"string"}),eachEntityPrimitiveInstancesPortion:new Uint32Array(Zt.inflate(e.eachEntityPrimitiveInstancesPortion).buffer),eachEntityMatricesPortion:new Uint32Array(Zt.inflate(e.eachEntityMatricesPortion).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],matrices:e[4],eachPrimitivePositionsAndNormalsPortion:e[5],eachPrimitiveIndicesPortion:e[6],eachPrimitiveEdgeIndicesPortion:e[7],eachPrimitiveColor:e[8],primitiveInstances:e[9],eachEntityId:e[10],eachEntityPrimitiveInstancesPortion:e[11],eachEntityMatricesPortion:e[12]}}(i)),n)}};let ei=window.pako||jt;ei.inflate||(ei=ei.default);const ti=function(){const e=new Float32Array(3);return function(t){return e[0]=t[0]/255,e[1]=t[1]/255,e[2]=t[2]/255,e}}(),ii={version:6,parse:function(e,t,i,n){!function(e,t,i,n){const s=i.positions,a=i.normals,l=i.indices,c=i.edgeIndices,u=i.matrices,h=i.reusedPrimitivesDecodeMatrix,d=i.eachPrimitivePositionsAndNormalsPortion,p=i.eachPrimitiveIndicesPortion,f=i.eachPrimitiveEdgeIndicesPortion,m=i.eachPrimitiveColorAndOpacity,g=i.primitiveInstances,v=JSON.parse(i.eachEntityId),b=i.eachEntityPrimitiveInstancesPortion,_=i.eachEntityMatricesPortion,y=i.eachTileAABB,x=i.eachTileEntitiesPortion,w=d.length,M=g.length,P=v.length,E=x.length;let S=0;const C=new Uint32Array(w);for(let e=0;e<M;e++){const t=g[e];void 0!==C[t]?C[t]++:C[t]=1}const k=o.math.vec3(),O=o.math.AABB3();for(let i=0;i<E;i++){const M=i===E-1,A=x[i],T=M?P:x[i+1],D=6*i,R=y.subarray(D,D+6);o.math.getAABB3Center(R,k),O[0]=R[0]-k[0],O[1]=R[1]-k[1],O[2]=R[2]-k[2],O[3]=R[3]-k[0],O[4]=R[4]-k[1],O[5]=R[5]-k[2];const L=I.a.createPositionsDecodeMatrix(O),B={};for(let y=A;y<T;y++){const x=v[y],M=t.globalizeObjectIds?o.math.globalizeObjectId(n.id,x):x,E=_[y],O=u.slice(E,E+16),A=y===P-1,T=b[y],D=A?g.length:b[y+1],R=[],I=e.metaScene.metaObjects[M],N={},j={};if(I){if(t.excludeTypesMap&&I.type&&t.excludeTypesMap[I.type])continue;if(t.includeTypesMap&&I.type&&!t.includeTypesMap[I.type])continue;const e=t.objectDefaults?t.objectDefaults[I.type]||t.objectDefaults.DEFAULT:null;e&&(!1===e.visible&&(N.visible=!1),!1===e.pickable&&(N.pickable=!1),e.colorize&&(j.color=e.colorize),void 0!==e.opacity&&null!==e.opacity&&(j.opacity=e.opacity))}else if(t.excludeUnclassifiedObjects)continue;for(let e=T;e<D;e++){const t=g[e],o=C[t]>1,u=t===w-1,v=s.subarray(d[t],u?s.length:d[t+1]),b=a.subarray(d[t],u?a.length:d[t+1]),_=l.subarray(p[t],u?l.length:p[t+1]),y=c.subarray(f[t],u?c.length:f[t+1]),x=ti(m.subarray(4*t,4*t+3)),M=m[4*t+3]/255,P=S++;if(o){const e="geometry."+i+"."+t;B[e]||(n.createGeometry({id:e,rtcCenter:k,primitive:"triangles",positions:v,normals:b,indices:_,edgeIndices:y,positionsDecodeMatrix:h}),B[e]=!0),n.createMesh(r.utils.apply(j,{id:P,geometryId:e,matrix:O,color:x,opacity:M})),R.push(P)}else n.createMesh(r.utils.apply(j,{id:P,rtcCenter:k,primitive:"triangles",positions:v,normals:b,indices:_,edgeIndices:y,positionsDecodeMatrix:L,color:x,opacity:M})),R.push(P)}R.length>0&&n.createEntity(r.utils.apply(N,{id:M,isObject:!0,meshIds:R}))}}}(e,t,function(e){return{positions:new Uint16Array(ei.inflate(e.positions).buffer),normals:new Int8Array(ei.inflate(e.normals).buffer),indices:new Uint32Array(ei.inflate(e.indices).buffer),edgeIndices:new Uint32Array(ei.inflate(e.edgeIndices).buffer),matrices:new Float32Array(ei.inflate(e.matrices).buffer),reusedPrimitivesDecodeMatrix:new Float32Array(ei.inflate(e.reusedPrimitivesDecodeMatrix).buffer),eachPrimitivePositionsAndNormalsPortion:new Uint32Array(ei.inflate(e.eachPrimitivePositionsAndNormalsPortion).buffer),eachPrimitiveIndicesPortion:new Uint32Array(ei.inflate(e.eachPrimitiveIndicesPortion).buffer),eachPrimitiveEdgeIndicesPortion:new Uint32Array(ei.inflate(e.eachPrimitiveEdgeIndicesPortion).buffer),eachPrimitiveColorAndOpacity:new Uint8Array(ei.inflate(e.eachPrimitiveColorAndOpacity).buffer),primitiveInstances:new Uint32Array(ei.inflate(e.primitiveInstances).buffer),eachEntityId:ei.inflate(e.eachEntityId,{to:"string"}),eachEntityPrimitiveInstancesPortion:new Uint32Array(ei.inflate(e.eachEntityPrimitiveInstancesPortion).buffer),eachEntityMatricesPortion:new Uint32Array(ei.inflate(e.eachEntityMatricesPortion).buffer),eachTileAABB:new Float64Array(ei.inflate(e.eachTileAABB).buffer),eachTileEntitiesPortion:new Uint32Array(ei.inflate(e.eachTileEntitiesPortion).buffer)}}(function(e){return{positions:e[0],normals:e[1],indices:e[2],edgeIndices:e[3],matrices:e[4],reusedPrimitivesDecodeMatrix:e[5],eachPrimitivePositionsAndNormalsPortion:e[6],eachPrimitiveIndicesPortion:e[7],eachPrimitiveEdgeIndicesPortion:e[8],eachPrimitiveColorAndOpacity:e[9],primitiveInstances:e[10],eachEntityId:e[11],eachEntityPrimitiveInstancesPortion:e[12],eachEntityMatricesPortion:e[13],eachTileAABB:e[14],eachTileEntitiesPortion:e[15]}}(i)),n)}},ri={};ri[Vt.version]=Vt,ri[Ht.version]=Ht,ri[Yt.version]=Yt,ri[Kt.version]=Kt,ri[Jt.version]=Jt,ri[ii.version]=ii;class ni extends Bt.a{constructor(e,t={}){super("XKTLoader",e,t),this.dataSource=t.dataSource,this.objectDefaults=t.objectDefaults,this.includeTypes=t.includeTypes,this.excludeTypes=t.excludeTypes,this.excludeUnclassifiedObjects=t.excludeUnclassifiedObjects}get supportedVersions(){return Object.keys(ri)}set dataSource(e){this._dataSource=e||new It}get dataSource(){return this._dataSource}set objectDefaults(e){this._objectDefaults=e||Nt}get objectDefaults(){return this._objectDefaults}set includeTypes(e){this._includeTypes=e}get includeTypes(){return this._includeTypes}set excludeTypes(e){this._excludeTypes=e}get excludeTypes(){return this._excludeTypes}set excludeUnclassifiedObjects(e){this._excludeUnclassifiedObjects=!!e}get excludeUnclassifiedObjects(){return this._excludeUnclassifiedObjects}set globalizeObjectIds(e){this._globalizeObjectIds=!!e}get globalizeObjectIds(){return this._globalizeObjectIds}load(e={}){e.id&&this.viewer.scene.components[e.id]&&(this.error("Component with this ID already exists in viewer: "+e.id+" - will autogenerate this ID"),delete e.id);const t=new Lt(this.viewer.scene,r.utils.apply(e,{isModel:!0})),i=t.id;if(!e.src&&!e.xkt)return this.error("load() param expected: src or xkt"),t;const n={};if(e.metaModelSrc||e.metaModelData){const r=e.includeTypes||this._includeTypes,o=e.excludeTypes||this._excludeTypes,s=e.objectDefaults||this._objectDefaults;if(r){n.includeTypesMap={};for(let e=0,t=r.length;e<t;e++)n.includeTypesMap[r[e]]=!0}if(o){n.excludeTypesMap={};for(let e=0,t=o.length;e<t;e++)n.excludeTypesMap[o[e]]=!0}s&&(n.objectDefaults=s),n.excludeUnclassifiedObjects=void 0!==e.excludeUnclassifiedObjects?!!e.excludeUnclassifiedObjects:this._excludeUnclassifiedObjects,n.globalizeObjectIds=void 0!==e.globalizeObjectIds?!!e.globalizeObjectIds:this._globalizeObjectIds;const a=s=>{this.viewer.metaScene.createMetaModel(i,s,{includeTypes:r,excludeTypes:o,globalizeObjectIds:this.globalizeObjectIds}),this.viewer.scene.canvas.spinner.processes--,e.src?this._loadModel(e.src,e,n,t):this._parseModel(e.xkt,e,n,t),t.once("destroyed",()=>{this.viewer.metaScene.destroyMetaModel(t.id)})};if(e.metaModelSrc){const t=e.metaModelSrc;this.viewer.scene.canvas.spinner.processes++,this._dataSource.getMetaModel(t,e=>{this.viewer.scene.canvas.spinner.processes--,a(e)},e=>{this.error(`load(): Failed to load model metadata for model '${i} from  '${t}' - ${e}`),this.viewer.scene.canvas.spinner.processes--})}else e.metaModelData&&a(e.metaModelData)}else e.src?this._loadModel(e.src,e,n,t):this._parseModel(e.xkt,e,n,t);return t}_loadModel(e,t,i,r){const n=this.viewer.scene.canvas.spinner;n.processes++,this._dataSource.getXKT(t.src,e=>{this._parseModel(e,t,i,r),n.processes--},e=>{n.processes--,this.error(e),r.fire("error",e)})}_parseModel(e,t,i,r){const n=new DataView(e),o=new Uint8Array(e),s=n.getUint32(0,!0),a=ri[s];if(!a)return void this.error("Unsupported .XKT file version: "+s+" - this XKTLoaderPlugin supports versions "+Object.keys(ri));this.log("Loading .xkt V"+s);const l=n.getUint32(4,!0),c=[];let u=4*(l+2);for(let e=0;e<l;e++){const t=n.getUint32(4*(e+2),!0);c.push(o.subarray(u,u+t)),u+=t}a.parse(this.viewer,i,c,r),r.finalize(),r.scene.once("tick",()=>{r.scene.fire("modelLoaded",r.id),r.fire("loaded",!0,!1)})}}},function(e,t,i){"use strict";i.r(t),i.d(t,"Viewer",(function(){return J}));var r=i(69),n=i(0),o=i(8),s=i(36),a=i(16);const l=n.math.vec3(),c=n.math.vec3(),u=n.math.vec3(),h=n.math.vec3(),d=n.math.vec3();class p extends a.a{get type(){return"CameraFlightAnimation"}constructor(e,t={}){super(e,t),this._look1=n.math.vec3(),this._eye1=n.math.vec3(),this._up1=n.math.vec3(),this._look2=n.math.vec3(),this._eye2=n.math.vec3(),this._up2=n.math.vec3(),this._orthoScale1=1,this._orthoScale2=1,this._flying=!1,this._flyEyeLookUp=!1,this._flyingEye=!1,this._flyingLook=!1,this._callback=null,this._callbackScope=null,this._time1=null,this._time2=null,this.easing=!1!==t.easing,this.duration=t.duration,this.fit=t.fit,this.fitFOV=t.fitFOV,this.trail=t.trail}flyTo(e,t,i){e=e||this.scene,this._flying&&this.stop(),this._flying=!1,this._flyingEye=!1,this._flyingLook=!1,this._flyingEyeLookUp=!1,this._callback=t,this._callbackScope=i;const r=this.scene.camera,a=!!e.projection&&e.projection!==r.projection;let c,u,h,d,p;if(this._eye1[0]=r.eye[0],this._eye1[1]=r.eye[1],this._eye1[2]=r.eye[2],this._look1[0]=r.look[0],this._look1[1]=r.look[1],this._look1[2]=r.look[2],this._up1[0]=r.up[0],this._up1[1]=r.up[1],this._up1[2]=r.up[2],this._orthoScale1=r.ortho.scale,this._orthoScale2=e.orthoScale||this._orthoScale1,e.aabb)c=e.aabb;else if(6===e.length)c=e;else if(e.eye&&e.look||e.up)u=e.eye,h=e.look,d=e.up;else if(e.eye)u=e.eye;else if(e.look)h=e.look;else{let r=e;if((o.utils.isNumeric(r)||o.utils.isString(r))&&(p=r,!(r=this.scene.components[p])))return this.error("Component not found: "+o.utils.inQuotes(p)),void(t&&(i?t.call(i):t()));a||(c=r.aabb||this.scene.aabb)}const f=e.poi;if(c){if(c[3]<c[0]||c[4]<c[1]||c[5]<c[2])return;if(c[3]===c[0]&&c[4]===c[1]&&c[5]===c[2])return;c=c.slice();const t=n.math.getAABB3Center(c);this._look2=f||t;const i=n.math.subVec3(this._eye1,this._look1,l),r=n.math.normalizeVec3(i),o=f?n.math.getAABB3DiagPoint(c,f):n.math.getAABB3Diag(c),s=e.fitFOV||this._fitFOV,a=Math.abs(o/Math.tan(s*n.math.DEGTORAD));this._orthoScale2=1.1*o,this._eye2[0]=this._look2[0]+r[0]*a,this._eye2[1]=this._look2[1]+r[1]*a,this._eye2[2]=this._look2[2]+r[2]*a,this._up2[0]=this._up1[0],this._up2[1]=this._up1[1],this._up2[2]=this._up1[2],this._flyingEyeLookUp=!0}else(u||h||d)&&(this._flyingEyeLookUp=!!u&&!!h&&!!d,this._flyingEye=!!u&&!h,this._flyingLook=!!h&&!u,u&&(this._eye2[0]=u[0],this._eye2[1]=u[1],this._eye2[2]=u[2]),h&&(this._look2[0]=h[0],this._look2[1]=h[1],this._look2[2]=h[2]),d&&(this._up2[0]=d[0],this._up2[1]=d[1],this._up2[2]=d[2]));a?("ortho"===e.projection&&"ortho"!==r.projection&&(this._projection2="ortho",this._projMatrix1=r.projMatrix.slice(),r.ortho.scale=this._orthoScale2,this._projMatrix2=r.ortho.matrix.slice(),r.projection="customProjection"),"perspective"===e.projection&&"perspective"!==r.projection&&(this._projection2="perspective",this._projMatrix1=r.projMatrix.slice(),this._projMatrix2=r.perspective.matrix.slice(),r.projection="customProjection")):this._projection2=null,this.fire("started",e,!0),this._time1=Date.now(),this._time2=this._time1+(e.duration?1e3*e.duration:this._duration),this._flying=!0,s.a.scheduleTask(this._update,this)}jumpTo(e){this._jumpTo(e)}_jumpTo(e){this._flying&&this.stop();const t=this.scene.camera;var i,r,s,a,c;if(e.aabb)i=e.aabb;else if(6===e.length)i=e;else if(e.eye||e.look||e.up)s=e.eye,a=e.look,c=e.up;else{let t=e;if((o.utils.isNumeric(t)||o.utils.isString(t))&&(r=t,!(t=this.scene.components[r])))return void this.error("Component not found: "+o.utils.inQuotes(r));i=t.aabb||this.scene.aabb}const u=e.poi;if(i){if(i[3]<=i[0]||i[4]<=i[1]||i[5]<=i[2])return;var h=u?n.math.getAABB3DiagPoint(i,u):n.math.getAABB3Diag(i);let r;a=u||n.math.getAABB3Center(i,a),this._trail?n.math.subVec3(t.look,a,d):n.math.subVec3(t.eye,t.look,d),n.math.normalizeVec3(d),r=(void 0!==e.fit?e.fit:this._fit)?Math.abs(h/Math.tan((e.fitFOV||this._fitFOV)*n.math.DEGTORAD)):n.math.lenVec3(n.math.subVec3(t.eye,t.look,l)),n.math.mulVec3Scalar(d,r),t.eye=n.math.addVec3(a,d,l),t.look=a,this.scene.camera.ortho.scale=1.1*h}else(s||a||c)&&(s&&(t.eye=s),a&&(t.look=a),c&&(t.up=c));e.projection&&(t.projection=e.projection)}_update(){if(!this._flying)return;let e=(Date.now()-this._time1)/(this._time2-this._time1);const t=e>=1;e>1&&(e=1);const i=this.easing?p._ease(e,0,1,1):e,r=this.scene.camera;if(this._flyingEye||this._flyingLook?this._flyingEye?(n.math.subVec3(r.eye,r.look,d),r.eye=n.math.lerpVec3(i,0,1,this._eye1,this._eye2,u),r.look=n.math.subVec3(u,d,c)):this._flyingLook&&(r.look=n.math.lerpVec3(i,0,1,this._look1,this._look2,c),r.up=n.math.lerpVec3(i,0,1,this._up1,this._up2,h)):this._flyingEyeLookUp&&(r.eye=n.math.lerpVec3(i,0,1,this._eye1,this._eye2,u),r.look=n.math.lerpVec3(i,0,1,this._look1,this._look2,c),r.up=n.math.lerpVec3(i,0,1,this._up1,this._up2,h)),this._projection2){const t="ortho"===this._projection2?p._easeOutExpo(e,0,1,1):p._easeInCubic(e,0,1,1);r.customProjection.matrix=n.math.lerpMat4(t,0,1,this._projMatrix1,this._projMatrix2)}else r.ortho.scale=this._orthoScale1+e*(this._orthoScale2-this._orthoScale1);t?this.stop():s.a.scheduleTask(this._update,this)}static _ease(e,t,i,r){return-i*(e/=r)*(e-2)+t}static _easeInCubic(e,t,i,r){return i*(e/=r)*e*e+t}static _easeOutExpo(e,t,i,r){return i*(1-Math.pow(2,-10*e/r))+t}stop(){if(!this._flying)return;this._flying=!1,this._time1=null,this._time2=null,this._projection2&&(this.scene.camera.projection=this._projection2);const e=this._callback;e&&(this._callback=null,this._callbackScope?e.call(this._callbackScope):e()),this.fire("stopped",!0,!0)}cancel(){this._flying&&(this._flying=!1,this._time1=null,this._time2=null,this._callback&&(this._callback=null),this.fire("canceled",!0,!0))}set duration(e){this._duration=e?1e3*e:500,this.stop()}get duration(){return this._duration/1e3}set fit(e){this._fit=!1!==e}get fit(){return this._fit}set fitFOV(e){this._fitFOV=e||45}get fitFOV(){return this._fitFOV}set trail(e){this._trail=!!e}get trail(){return this._trail}destroy(){this.stop(),super.destroy()}}const f=n.math.vec4(),m=n.math.vec4(),g=n.math.vec3(),v=n.math.vec3(),b=n.math.vec3(),_=n.math.vec4(),y=n.math.vec4(),x=n.math.vec4();class w{constructor(e){this._scene=e}dollyToCanvasPos(e,t,i){let r=!1;const o=this._scene.camera;if(e){const t=n.math.subVec3(e,o.eye,g);r=n.math.lenVec3(t)<i}if("perspective"===o.projection){o.ortho.scale=o.ortho.scale-i;const r=this._unproject(t,_),s=n.math.subVec3(r,o.eye,x),a=n.math.mulVec3Scalar(n.math.normalizeVec3(s),-i,[]);if(o.eye=[o.eye[0]-a[0],o.eye[1]-a[1],o.eye[2]-a[2]],o.look=[o.look[0]-a[0],o.look[1]-a[1],o.look[2]-a[2]],e){const t=n.math.subVec3(e,o.eye,g),i=n.math.lenVec3(t),r=n.math.mulVec3Scalar(n.math.normalizeVec3(n.math.subVec3(o.look,o.eye,v)),i);o.look=[o.eye[0]+r[0],o.eye[1]+r[1],o.eye[2]+r[2]]}}else if("ortho"===o.projection){const e=this._unproject(t,_);o.ortho.scale=o.ortho.scale-i,o.ortho._update();const r=this._unproject(t,y),s=n.math.subVec3(r,e,x),a=n.math.mulVec3Scalar(n.math.normalizeVec3(n.math.subVec3(o.look,o.eye,g)),-i,v),l=n.math.addVec3(s,a,b);o.eye=[o.eye[0]-l[0],o.eye[1]-l[1],o.eye[2]-l[2]],o.look=[o.look[0]-l[0],o.look[1]-l[1],o.look[2]-l[2]]}return r}_unproject(e,t){const i=this._scene.camera,r=i.project.transposedMatrix,o=r.subarray(8,12),s=r.subarray(12),a=[0,0,-1,1],l=n.math.dotVec4(a,o)/n.math.dotVec4(a,s);return i.project.unproject(e,l,f,m,t),t}destroy(){}}const M=n.math.vec3(),P=n.math.vec3(),E=n.math.vec3(),S=n.math.vec4(),C=n.math.vec4(),k=n.math.vec4();class O{constructor(e,t){this._scene=e,this._configs=t,this._pivotWorldPos=n.math.vec3(),this._cameraOffset=n.math.vec3(),this._azimuth=0,this._polar=0,this._radius=0,this._pivotPosSet=!1,this._pivoting=!1,this._shown=!1,this._pivotViewPos=n.math.vec4(),this._pivotProjPos=n.math.vec4(),this._pivotCanvasPos=n.math.vec2(),this._cameraDirty=!0,this._onViewMatrix=this._scene.camera.on("viewMatrix",()=>{this._cameraDirty=!0}),this._onProjMatrix=this._scene.camera.on("projMatrix",()=>{this._cameraDirty=!0}),this._onTick=this._scene.on("tick",()=>{this.updatePivotElement()})}updatePivotElement(){const e=this._scene.camera,t=this._scene.canvas;if(this._pivoting&&this._cameraDirty){n.math.transformPoint3(e.viewMatrix,this.getPivotPos(),this._pivotViewPos),this._pivotViewPos[3]=1,n.math.transformPoint4(e.projMatrix,this._pivotViewPos,this._pivotProjPos);const i=t.boundary,r=i[2],o=i[3];this._pivotCanvasPos[0]=Math.floor((1+this._pivotProjPos[0]/this._pivotProjPos[3])*r/2),this._pivotCanvasPos[1]=Math.floor((1-this._pivotProjPos[1]/this._pivotProjPos[3])*o/2);const s=t.canvas.getBoundingClientRect();this._pivotElement&&(this._pivotElement.style.left=Math.floor(s.left+this._pivotCanvasPos[0])-this._pivotElement.clientWidth/2+"px",this._pivotElement.style.top=Math.floor(s.top+this._pivotCanvasPos[1])-this._pivotElement.clientHeight/2+"px"),this._cameraDirty=!1}}setPivotElement(e){this._pivotElement=e}startPivot(){if(this._cameraLookingDownwards())return this._pivoting=!1,!1;const e=this._scene.camera;let t=n.math.lookAtMat4v(e.eye,e.look,e.worldUp);n.math.transformPoint3(t,this.getPivotPos(),this._cameraOffset);const i=this.getPivotPos();this._cameraOffset[2]+=n.math.distVec3(e.eye,i),t=n.math.inverseMat4(t);const r=n.math.transformVec3(t,this._cameraOffset),o=n.math.vec3();if(n.math.subVec3(e.eye,i,o),n.math.addVec3(o,r),e.zUp){const e=o[1];o[1]=o[2],o[2]=e}this._radius=n.math.lenVec3(o),this._polar=Math.acos(o[1]/this._radius),this._azimuth=Math.atan2(o[0],o[2]),this._pivoting=!0}_cameraLookingDownwards(){const e=this._scene.camera,t=n.math.normalizeVec3(n.math.subVec3(e.look,e.eye,M)),i=n.math.cross3Vec3(t,e.worldUp,P);return n.math.sqLenVec3(i)<=1e-4}getPivoting(){return this._pivoting}setPivotPos(e){this._pivotWorldPos.set(e),this._pivotPosSet=!0}setCanvasPivotPos(e){const t=this._scene.camera,i=Math.abs(n.math.distVec3(this._scene.center,t.eye)),r=t.project.transposedMatrix,o=r.subarray(8,12),s=r.subarray(12),a=[0,0,-1,1],l=n.math.dotVec4(a,o)/n.math.dotVec4(a,s),c=S;t.project.unproject(e,l,C,k,c);const u=n.math.normalizeVec3(n.math.subVec3(c,t.eye,M)),h=n.math.addVec3(t.eye,n.math.mulVec3Scalar(u,i,P),E);this.setPivotPos(h)}getPivotPos(){return this._pivotPosSet?this._pivotWorldPos:this._scene.camera.look}continuePivot(e,t){if(!this._pivoting)return;if(0===e&&0===t)return;const i=this._scene.camera;var r=-e;const o=-t;1===i.worldUp[2]&&(r=-r),this._azimuth+=.01*-r,this._polar+=.01*o,this._polar=n.math.clamp(this._polar,.001,Math.PI-.001);const s=[this._radius*Math.sin(this._polar)*Math.sin(this._azimuth),this._radius*Math.cos(this._polar),this._radius*Math.sin(this._polar)*Math.cos(this._azimuth)];if(1===i.worldUp[2]){const e=s[1];s[1]=s[2],s[2]=e}const a=n.math.lenVec3(n.math.subVec3(i.look,i.eye,n.math.vec3())),l=this.getPivotPos();n.math.addVec3(s,l);let c=n.math.lookAtMat4v(s,l,i.worldUp);c=n.math.inverseMat4(c);const u=n.math.transformVec3(c,this._cameraOffset);c[12]-=u[0],c[13]-=u[1],c[14]-=u[2];const h=[c[8],c[9],c[10]];i.eye=[c[12],c[13],c[14]],n.math.subVec3(i.eye,n.math.mulVec3Scalar(h,a),i.look),i.up=[c[4],c[5],c[6]],this.showPivot()}showPivot(){this._shown||(null!==this._hideTimeout&&(window.clearTimeout(this._hideTimeout),this._hideTimeout=null),this._pivotElement&&(this.updatePivotElement(),this._pivotElement.style.visibility="visible",this._shown=!0,this._hideTimeout=window.setTimeout(()=>{this.hidePivot()},1e3)))}hidePivot(){this._shown&&(null!==this._hideTimeout&&(window.clearTimeout(this._hideTimeout),this._hideTimeout=null),this._pivotElement&&(this._pivotElement.style.visibility="hidden"),this._shown=!1)}endPivot(){this._pivoting=!1}destroy(){this._scene.camera.off(this._onViewMatrix),this._scene.camera.off(this._onProjMatrix),this._scene.off(this._onTick)}}i(128);class A{constructor(e,t){this._scene=e.scene,this._cameraControl=e,this._scene.canvas.canvas.oncontextmenu=function(e){e.preventDefault()},this._configs=t,this.schedulePickEntity=!1,this.schedulePickSurface=!1,this.pickCursorPos=n.math.vec2(),this.picked=!1,this.pickedSurface=!1,this.pickResult=null,this._lastPickedEntityId=null,this._needFireEvents=!1}update(){if(!this._configs.pointerEnabled)return;if(!this.schedulePickEntity&&!this.schedulePickSurface)return;this.picked=!1,this.pickedSurface=!1,this._needFireEvents=!1;const e=this._cameraControl.hasSubs("hoverSurface");if(this.schedulePickSurface&&this.pickResult&&this.pickResult.worldPos){const t=this.pickResult.canvasPos;if(t[0]===this.pickCursorPos[0]&&t[1]===this.pickCursorPos[1])return this.picked=!0,this.pickedSurface=!0,this._needFireEvents=e,this.schedulePickEntity=!1,void(this.schedulePickSurface=!1)}if(this.schedulePickEntity&&this.pickResult){const e=this.pickResult.canvasPos;if(e[0]===this.pickCursorPos[0]&&e[1]===this.pickCursorPos[1])return this.picked=!0,this.pickedSurface=!1,this._needFireEvents=!1,this.schedulePickEntity=!1,void(this.schedulePickSurface=!1)}this.schedulePickSurface?(this.pickResult=this._scene.pick({pickSurface:!0,pickSurfaceNormal:!1,canvasPos:this.pickCursorPos}),this.pickResult&&(this.picked=!0,this.pickedSurface=!0,this._needFireEvents=!0)):(this.pickResult=this._scene.pick({canvasPos:this.pickCursorPos}),this.pickResult&&(this.picked=!0,this.pickedSurface=!1,this._needFireEvents=!0)),this.schedulePickEntity=!1,this.schedulePickSurface=!1}fireEvents(){if(this._needFireEvents){if(this.picked&&this.pickResult&&this.pickResult.entity){const e=this.pickResult.entity.id;this._lastPickedEntityId!==e&&(void 0!==this._lastPickedEntityId&&this._cameraControl.fire("hoverOut",{entity:this._scene.objects[this._lastPickedEntityId]},!0),this._cameraControl.fire("hoverEnter",this.pickResult,!0),this._lastPickedEntityId=e),this._cameraControl.fire("hover",this.pickResult,!0),this.pickResult.worldPos&&(this.pickedSurface=!0,this._cameraControl.fire("hoverSurface",this.pickResult,!0))}else void 0!==this._lastPickedEntityId&&(this._cameraControl.fire("hoverOut",{entity:this._scene.objects[this._lastPickedEntityId]},!0),this._lastPickedEntityId=void 0),this._cameraControl.fire("hoverOff",{canvasPos:this.pickCursorPos},!0);this.pickResult=null,this._needFireEvents=!1}}destroy(){this._scene.off(this._onTick)}}const T=n.math.vec2();class D{constructor(e,t,i,r,o){this._scene=e;const s=t.pickController;let a,l,c,u=0,h=0,d=0,p=0,f=0,m=0;this._down=!1;let g=!1;const v=n.math.vec3();let b=!0;const _=this._scene.canvas.canvas,y=[];function x(e=!0){_.style.cursor="move",f=0,m=0,u=r.pointerCanvasPos[0],h=r.pointerCanvasPos[1],d=r.pointerCanvasPos[0],p=r.pointerCanvasPos[1],e&&(s.pickCursorPos=r.pointerCanvasPos,s.schedulePickSurface=!0,s.update(),s.picked&&s.pickedSurface&&s.pickResult&&s.pickResult.worldPos?(g=!0,v.set(s.pickResult.worldPos)):g=!1)}document.addEventListener("keydown",this._documentKeyDownHandler=t=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;const r=t.keyCode;y[r]=!0}),document.addEventListener("keyup",this._documentKeyUpHandler=t=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;const r=t.keyCode;y[r]=!1}),_.addEventListener("mousedown",this._mouseDownHandler=t=>{if(i.active&&i.pointerEnabled){switch(this._down=!0,t.which){case 1:y[e.input.KEY_SHIFT]||i.planView?x():(a=!0,x(!1));break;case 2:l=!0,i.panRightClick||x();break;case 3:c=!0,i.panRightClick&&x()}document.addEventListener("mousemove",this._documentMouseMoveHandler=()=>{const t=e.canvas.boundary,s=t[2]-t[0],a=t[3]-t[1],d=r.pointerCanvasPos[0],p=r.pointerCanvasPos[1];if(y[e.input.KEY_SHIFT]||i.planView||!i.panRightClick&&l||i.panRightClick&&c){const t=d-u,i=p-h,r=e.camera;if("perspective"===r.projection){const s=Math.abs(g?n.math.lenVec3(n.math.subVec3(v,e.camera.eye,[])):e.camera.eyeLookDist)*Math.tan(r.perspective.fov/2*Math.PI/180);o.panDeltaX+=1.5*t*s/a,o.panDeltaY+=1.5*i*s/a}else o.panDeltaX+=.5*r.ortho.scale*(t/a),o.panDeltaY+=.5*r.ortho.scale*(i/a)}else l||c||i.planView||(i.firstPerson?(o.rotateDeltaY-=(d-u)/s*i.dragRotationRate/2,o.rotateDeltaX+=(p-h)/a*(i.dragRotationRate/4)):(o.rotateDeltaY-=(d-u)/s*i.dragRotationRate,o.rotateDeltaX+=(p-h)/a*i.dragRotationRate));u=d,h=p})}}),_.addEventListener("mousemove",this._canvasMouseMoveHandler=e=>{i.active&&i.pointerEnabled&&r.mouseover&&(o.inputFromMouse=!0,b=!0)}),document.addEventListener("mouseup",this._documentMouseUpHandler=e=>{if(i.active&&i.pointerEnabled){switch(e.which){case 1:a=!1;break;case 2:l=!1;break;case 3:c=!1}f=0,m=0,this._down=!1,document.removeEventListener("mousemove",this._documentMouseMoveHandler)}}),_.addEventListener("mouseup",this._mouseUpHandler=e=>{if(i.active&&i.pointerEnabled){switch(e.which){case 3:!function(e,t){if(e){let i=e.target,r=0,n=0;for(;i.offsetParent;)r+=i.offsetLeft,n+=i.offsetTop,i=i.offsetParent;t[0]=e.pageX-r,t[1]=e.pageY-n}else e=window.event,t[0]=e.x,t[1]=e.y}(e,T);const i=T[0],r=T[1];Math.abs(i-d)<3&&Math.abs(r-p)<3&&t.cameraControl.fire("rightClick",{canvasPos:T,event:e},!0)}_.style.removeProperty("cursor")}}),_.addEventListener("mouseenter",this._mouseEnterHandler=()=>{i.active&&i.pointerEnabled&&(f=0,m=0,this._down=!1)});let w=null;_.addEventListener("wheel",this._mouseWheelHandler=e=>{if(!i.active||!i.pointerEnabled)return;const t=performance.now()/1e3;var n=null!==w?t-w:0;w=t,n>.05&&(n=.05),n<1/60&&(n=1/60);const s=Math.max(-1,Math.min(1,40*-e.deltaY));if(0===s)return;const a=s/Math.abs(s);o.dollyDelta+=-a*n*i.mouseWheelDollyRate,b&&(r.followPointerDirty=!0,b=!1),e.preventDefault()})}reset(){this._down=!1}destroy(){const e=this._scene.canvas.canvas;document.removeEventListener("keydown",this._documentKeyDownHandler),document.removeEventListener("keyup",this._documentKeyUpHandler),e.removeEventListener("mousedown",this._mouseDownHandler),document.removeEventListener("mousemove",this._documentMouseMoveHandler),e.removeEventListener("mousemove",this._canvasMouseMoveHandler),document.removeEventListener("mouseup",this._documentMouseUpHandler),e.removeEventListener("mouseup",this._mouseUpHandler),e.removeEventListener("mouseenter",this._mouseEnterHandler),e.removeEventListener("wheel",this._mouseWheelHandler)}}const R=n.math.vec3(),L=n.math.vec3(),B=n.math.vec3(),I=n.math.vec3(),N=n.math.vec3(),j={eye:n.math.vec3(),look:n.math.vec3(),up:n.math.vec3()};class F{constructor(e,t,i,r,o){this._scene=e;const s=t.cameraControl,a=e.camera;e.input.on("keydown",this._documentKeyDownHandler=o=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;if(!r.mouseover)return;const l=s._isKeyDownForAction(s.AXIS_VIEW_RIGHT),c=s._isKeyDownForAction(s.AXIS_VIEW_BACK),u=s._isKeyDownForAction(s.AXIS_VIEW_LEFT),h=s._isKeyDownForAction(s.AXIS_VIEW_FRONT),d=s._isKeyDownForAction(s.AXIS_VIEW_TOP),p=s._isKeyDownForAction(s.AXIS_VIEW_BOTTOM);if(!(l||c||u||h||d||p))return;const f=e.aabb,m=n.math.getAABB3Diag(f);n.math.getAABB3Center(f,R);const g=Math.abs(m/Math.tan(t.cameraFlight.fitFOV*n.math.DEGTORAD)),v=1.1*m;j.orthoScale=v,l?(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldRight,g,L),N)),j.look.set(R),j.up.set(a.worldUp)):c?(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldForward,g,L),N)),j.look.set(R),j.up.set(a.worldUp)):u?(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldRight,-g,L),N)),j.look.set(R),j.up.set(a.worldUp)):h?(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldForward,-g,L),N)),j.look.set(R),j.up.set(a.worldUp)):d?(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldUp,g,L),N)),j.look.set(R),j.up.set(n.math.normalizeVec3(n.math.mulVec3Scalar(a.worldForward,1,B),I))):p&&(j.eye.set(n.math.addVec3(R,n.math.mulVec3Scalar(a.worldUp,-g,L),N)),j.look.set(R),j.up.set(n.math.normalizeVec3(n.math.mulVec3Scalar(a.worldForward,-1,B)))),!i.firstPerson&&i.followPointer&&t.pivotController.setPivotPos(R),t.cameraFlight.duration>0?t.cameraFlight.flyTo(j,()=>{t.pivotController.getPivoting()&&i.followPointer&&t.pivotController.showPivot()}):(t.cameraFlight.jumpTo(j),t.pivotController.getPivoting()&&i.followPointer&&t.pivotController.showPivot())})}reset(){}destroy(){document.removeEventListener("keydown",this._documentKeyDownHandler)}}class z{constructor(e,t,i,r,o){this._scene=e;const s=t.pickController,a=t.pivotController,l=t.cameraControl;this._clicks=0,this._timeout=null,this._lastPickedEntityId=null;let c=!1,u=!1;const h=this._scene.canvas.canvas,d=i=>{let r;i&&i.worldPos&&(r=i.worldPos);const o=i?i.entity.aabb:e.aabb;if(r){const i=e.camera;n.math.subVec3(i.eye,i.look,[]),t.cameraFlight.flyTo({aabb:o})}else t.cameraFlight.flyTo({aabb:o})};h.addEventListener("mousemove",this._canvasMouseMoveHandler=t=>{if(!i.active||!i.pointerEnabled)return;if(c||u)return;const n=l.hasSubs("hover"),o=l.hasSubs("hoverOut"),a=l.hasSubs("hoverOff"),h=l.hasSubs("hoverSurface");if(n||o||a||h)if(s.pickCursorPos=r.pointerCanvasPos,s.schedulePickEntity=!0,s.schedulePickSurface=h,s.update(),s.pickResult){const t=s.pickResult.entity.id;this._lastPickedEntityId!==t&&(void 0!==this._lastPickedEntityId&&l.fire("hoverOut",{entity:e.objects[this._lastPickedEntityId]},!0),l.fire("hoverEnter",s.pickResult,!0),this._lastPickedEntityId=t),l.fire("hover",s.pickResult,!0),s.pickResult.worldPos&&l.fire("hoverSurface",s.pickResult,!0)}else void 0!==this._lastPickedEntityId&&(l.fire("hoverOut",{entity:e.objects[this._lastPickedEntityId]},!0),this._lastPickedEntityId=void 0),l.fire("hoverOff",{canvasPos:s.pickCursorPos},!0)}),h.addEventListener("mousedown",this._canvasMouseDownHandler=t=>{if(1===t.which&&(c=!0),3===t.which&&(u=!0),1===t.which&&i.active&&i.pointerEnabled&&(r.mouseDownClientX=t.clientX,r.mouseDownClientY=t.clientY,r.mouseDownCursorX=r.pointerCanvasPos[0],r.mouseDownCursorY=r.pointerCanvasPos[1],!i.firstPerson&&i.followPointer&&(s.pickCursorPos=r.pointerCanvasPos,s.schedulePickSurface=!0,s.update(),1===t.which))){const t=s.pickResult;t&&t.worldPos?(a.setPivotPos(t.worldPos),a.startPivot()):(i.smartPivot?a.setCanvasPivotPos(r.pointerCanvasPos):a.setPivotPos(e.camera.look),a.startPivot())}}),document.addEventListener("mouseup",this._documentMouseUpHandler=e=>{1===e.which&&(c=!1),3===e.which&&(u=!1)}),h.addEventListener("mouseup",this._canvasMouseUpHandler=o=>{if(!i.active||!i.pointerEnabled)return;if(1!==o.which)return;if(a.hidePivot(),Math.abs(o.clientX-r.mouseDownClientX)>3||Math.abs(o.clientY-r.mouseDownClientY)>3)return;const c=l.hasSubs("picked"),u=l.hasSubs("pickedNothing"),h=l.hasSubs("pickedSurface"),p=l.hasSubs("doublePicked"),f=l.hasSubs("doublePickedSurface"),m=l.hasSubs("doublePickedNothing");if(!(i.doublePickFlyTo||p||f||m))return(c||u||h)&&(s.pickCursorPos=r.pointerCanvasPos,s.schedulePickEntity=!0,s.schedulePickSurface=h,s.update(),s.pickResult?(l.fire("picked",s.pickResult,!0),s.pickedSurface&&l.fire("pickedSurface",s.pickResult,!0)):l.fire("pickedNothing",{canvasPos:r.pointerCanvasPos},!0)),void(this._clicks=0);if(this._clicks++,1===this._clicks)this._timeout=setTimeout(()=>{s.pickCursorPos=r.pointerCanvasPos,s.schedulePickEntity=i.doublePickFlyTo,s.schedulePickSurface=h,s.update(),s.pickResult?(l.fire("picked",s.pickResult,!0),s.pickedSurface&&(l.fire("pickedSurface",s.pickResult,!0),!i.firstPerson&&i.followPointer&&(t.pivotController.setPivotPos(s.pickResult.worldPos),t.pivotController.startPivot()&&t.pivotController.showPivot()))):l.fire("pickedNothing",{canvasPos:r.pointerCanvasPos},!0),this._clicks=0},250);else{if(null!==this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),s.pickCursorPos=r.pointerCanvasPos,s.schedulePickEntity=i.doublePickFlyTo,s.schedulePickSurface=s.schedulePickEntity&&f,s.update(),s.pickResult){if(l.fire("doublePicked",s.pickResult,!0),s.pickedSurface&&l.fire("doublePickedSurface",s.pickResult,!0),i.doublePickFlyTo&&(d(s.pickResult),!i.firstPerson&&i.followPointer)){const e=s.pickResult.entity.aabb,i=n.math.getAABB3Center(e);t.pivotController.setPivotPos(i),t.pivotController.startPivot()&&t.pivotController.showPivot()}}else if(l.fire("doublePickedNothing",{canvasPos:r.pointerCanvasPos},!0),i.doublePickFlyTo&&(d(),!i.firstPerson&&i.followPointer)){const i=e.aabb,r=n.math.getAABB3Center(i);t.pivotController.setPivotPos(r),t.pivotController.startPivot()&&t.pivotController.showPivot()}this._clicks=0}},!1)}reset(){this._clicks=0,this._lastPickedEntityId=null,this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null)}destroy(){const e=this._scene.canvas.canvas;e.removeEventListener("mousemove",this._canvasMouseMoveHandler),e.removeEventListener("mousedown",this._canvasMouseDownHandler),document.removeEventListener("mouseup",this._documentMouseUpHandler),e.removeEventListener("mouseup",this._canvasMouseUpHandler),this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null)}}class V{constructor(e,t,i,r,n){this._scene=e;const o=e.input,s=[],a=e.canvas.canvas;t.pickController;let l=!0;document.addEventListener("mousemove",this._documentMouseMoveHandler=()=>{l=!0}),document.addEventListener("keydown",this._documentKeyDownHandler=t=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;if(!r.mouseover)return;const n=t.keyCode;s[n]=!0,n===o.KEY_SHIFT&&(a.style.cursor="move")}),document.addEventListener("keyup",this._documentKeyUpHandler=t=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;if(!r.mouseover)return;const n=t.keyCode;s[n]=!1,n===o.KEY_SHIFT&&(a.style.cursor=null)}),this._onTick=e.on("tick",a=>{if(!i.active||!i.pointerEnabled||!e.input.keyboardEnabled)return;if(!r.mouseover)return;const c=t.cameraControl,u=a.deltaTime/1e3;if(!i.planView){const e=c._isKeyDownForAction(c.ROTATE_Y_POS,s),r=c._isKeyDownForAction(c.ROTATE_Y_NEG,s),o=c._isKeyDownForAction(c.ROTATE_X_POS,s),a=c._isKeyDownForAction(c.ROTATE_X_NEG,s),l=u*i.keyboardRotationRate;(e||r||o||a)&&(!i.firstPerson&&i.followPointer&&t.pivotController.startPivot(),e?n.rotateDeltaY+=l:r&&(n.rotateDeltaY-=l),o?n.rotateDeltaX+=l:a&&(n.rotateDeltaX-=l),!i.firstPerson&&i.followPointer&&t.pivotController.startPivot())}if(!s[o.KEY_CTRL]&&!s[o.KEY_ALT]){const e=c._isKeyDownForAction(c.DOLLY_BACKWARDS,s),o=c._isKeyDownForAction(c.DOLLY_FORWARDS,s);if(e||o){const s=u*i.keyboardDollyRate;!i.firstPerson&&i.followPointer&&t.pivotController.startPivot(),o?n.dollyDelta-=s:e&&(n.dollyDelta+=s),l&&(r.followPointerDirty=!0,l=!1)}}const h=c._isKeyDownForAction(c.PAN_FORWARDS,s),d=c._isKeyDownForAction(c.PAN_BACKWARDS,s),p=c._isKeyDownForAction(c.PAN_LEFT,s),f=c._isKeyDownForAction(c.PAN_RIGHT,s),m=c._isKeyDownForAction(c.PAN_UP,s),g=c._isKeyDownForAction(c.PAN_DOWN,s),v=(s[o.KEY_ALT]?.3:1)*u*i.keyboardPanRate;(h||d||p||f||m||g)&&(!i.firstPerson&&i.followPointer&&t.pivotController.startPivot(),g?n.panDeltaY+=v:m&&(n.panDeltaY+=-v),f?n.panDeltaX+=-v:p&&(n.panDeltaX+=v),d?n.panDeltaZ+=v:h&&(n.panDeltaZ+=-v))})}reset(){}destroy(){this._scene.off(this._onTick),document.removeEventListener("mousemove",this._documentMouseMoveHandler),document.removeEventListener("keydown",this._documentKeyDownHandler),document.removeEventListener("keyup",this._documentKeyUpHandler)}}const U=.001,W=n.math.vec3();class H{constructor(e,t,i,r,o){this._scene=e;const s=e.camera,a=t.pickController,l=t.pivotController,c=t.panController;let u=1,h=1,d=null;this._onTick=e.on("tick",()=>{if(!i.active||!i.pointerEnabled)return;let t="default";if(Math.abs(o.dollyDelta)<U&&(o.dollyDelta=0),Math.abs(o.rotateDeltaX)<U&&(o.rotateDeltaX=0),Math.abs(o.rotateDeltaY)<U&&(o.rotateDeltaY=0),0===o.rotateDeltaX&&0===o.rotateDeltaY||(o.dollyDelta=0),i.followPointer&&--u<=0&&(u=1,0!==o.dollyDelta)){if(0===o.rotateDeltaY&&0===o.rotateDeltaX&&i.followPointer&&r.followPointerDirty&&(a.pickCursorPos=r.pointerCanvasPos,a.schedulePickSurface=!0,a.update(),a.pickResult&&a.pickResult.worldPos?d=a.pickResult.worldPos:(h=1,d=null),r.followPointerDirty=!1),d){const t=Math.abs(n.math.lenVec3(n.math.subVec3(d,e.camera.eye,W)));h=t/i.dollyProximityThreshold}h<i.dollyMinSpeed&&(h=i.dollyMinSpeed)}const p=o.dollyDelta*h;if(0===o.rotateDeltaY&&0===o.rotateDeltaX||(!i.firstPerson&&i.followPointer&&l.getPivoting()?(l.continuePivot(o.rotateDeltaY,o.rotateDeltaX),l.showPivot()):(0!==o.rotateDeltaX&&(i.firstPerson?s.pitch(-o.rotateDeltaX):s.orbitPitch(o.rotateDeltaX)),0!==o.rotateDeltaY&&(i.firstPerson?s.yaw(o.rotateDeltaY):s.orbitYaw(o.rotateDeltaY))),o.rotateDeltaX*=i.rotationInertia,o.rotateDeltaY*=i.rotationInertia,t="grabbing"),Math.abs(o.panDeltaX)<U&&(o.panDeltaX=0),Math.abs(o.panDeltaY)<U&&(o.panDeltaY=0),Math.abs(o.panDeltaZ)<U&&(o.panDeltaZ=0),0!==o.panDeltaX||0!==o.panDeltaY||0!==o.panDeltaZ){const e=n.math.vec3();let r,a;if(e[0]=o.panDeltaX,e[1]=o.panDeltaY,e[2]=o.panDeltaZ,i.constrainVertical){s.xUp?(r=s.eye[0],a=s.look[0]):s.yUp?(r=s.eye[1],a=s.look[1]):s.zUp&&(r=s.eye[2],a=s.look[2]),s.pan(e);const t=s.eye,i=s.look;s.xUp?(t[0]=r,i[0]=a):s.yUp?(t[1]=r,i[1]=a):s.zUp&&(t[2]=r,i[2]=a),s.eye=t,s.look=i}else s.pan(e);t="grabbing"}if(o.panDeltaX*=i.panInertia,o.panDeltaY*=i.panInertia,o.panDeltaZ*=i.panInertia,0!==p){if(t=p<0?"zoom-in":"zoom-out",i.firstPerson){let e,t;if(i.constrainVertical&&(s.xUp?(e=s.eye[0],t=s.look[0]):s.yUp?(e=s.eye[1],t=s.look[1]):s.zUp&&(e=s.eye[2],t=s.look[2])),i.followPointer?c.dollyToCanvasPos(d,r.pointerCanvasPos,-p)&&(r.followPointerDirty=!0):(s.pan([0,0,p]),s.ortho.scale=s.ortho.scale-p),i.constrainVertical){const i=s.eye,r=s.look;s.xUp?(i[0]=e,r[0]=t):s.yUp?(i[1]=e,r[1]=t):s.zUp&&(i[2]=e,r[2]=t),s.eye=i,s.look=r}}else i.planView,i.followPointer?c.dollyToCanvasPos(d,r.pointerCanvasPos,-p)&&(r.followPointerDirty=!0):(s.ortho.scale=s.ortho.scale+p,s.zoom(p));o.dollyDelta*=i.dollyInertia}a.fireEvents(),o.inputFromMouse=!1,document.body.style.cursor=t})}destroy(){this._scene.off(this._onTick)}}class G{constructor(e,t,i,r,n){this._scene=e;const o=this._scene.canvas.canvas;o.addEventListener("mouseenter",this._mouseEnterHandler=()=>{r.mouseover=!0}),o.addEventListener("mouseleave",this._mouseLeaveHandler=()=>{r.mouseover=!1,o.style.cursor=null}),document.addEventListener("mousemove",this._mouseMoveHandler=e=>{X(e,o,r.pointerCanvasPos)}),o.addEventListener("mousedown",this._mouseDownHandler=e=>{i.active&&i.pointerEnabled&&(X(e,o,r.pointerCanvasPos),r.mouseover=!0)}),o.addEventListener("mouseup",this._mouseUpHandler=e=>{i.active&&i.pointerEnabled})}reset(){}destroy(){const e=this._scene.canvas.canvas;document.removeEventListener("mousemove",this._mouseMoveHandler),e.removeEventListener("mouseenter",this._mouseEnterHandler),e.removeEventListener("mouseleave",this._mouseLeaveHandler),e.removeEventListener("mousedown",this._mouseDownHandler),e.removeEventListener("mouseup",this._mouseUpHandler)}}function X(e,t,i){if(e){const{x:r,y:n}=t.getBoundingClientRect();i[0]=e.clientX-r,i[1]=e.clientY-n}else e=window.event,i[0]=e.x,i[1]=e.y;return i}class Y{constructor(e,t,i,r,o){this._scene=e;const s=t.pickController,a=t.pivotController,l=n.math.vec2();let c=-1;const u=[];let h=0;const d=n.math.vec2(),p=(n.math.vec2(),this._scene.canvas.canvas);let f=!1;this._onTick=e.on("tick",()=>{f=!1}),p.addEventListener("touchstart",this._canvasTouchStartHandler=t=>{if(!i.active||!i.pointerEnabled)return;t.stopPropagation(),t.preventDefault();const o=t.touches,d=t.changedTouches;for(r.touchStartTime=Date.now(),1===o.length&&1===d.length?(c=r.touchStartTime,l[0]=o[0].pageX,l[1]=o[0].pageY,i.followPointer&&(s.pickCursorPos=l,s.schedulePickSurface=!0,s.update(),i.planView||(s.picked&&s.pickedSurface&&s.pickResult&&s.pickResult.worldPos?(a.setPivotPos(s.pickResult.worldPos),!i.firstPerson&&a.startPivot()&&a.showPivot()):(i.smartPivot?a.setCanvasPivotPos(r.pointerCanvasPos):a.setPivotPos(e.camera.look),!i.firstPerson&&a.startPivot()&&a.showPivot())))):c=-1;u.length<o.length;)u.push(n.math.vec2());for(let e=0,t=o.length;e<t;++e)u[e][0]=o[e].pageX,u[e][1]=o[e].pageY;h=o.length}),p.addEventListener("touchmove",this._canvasTouchMoveHandler=t=>{if(!i.active||!i.pointerEnabled)return;if(t.stopPropagation(),t.preventDefault(),f)return;f=!0;const a=e.canvas.boundary,l=a[2]-a[0],c=a[3]-a[1],p=t.touches;if(t.touches.length===h){if(1===h){const t=p[0];if(i.planView){n.math.subVec2([t.pageX,t.pageY],u[0],d);const r=d[0],s=d[1],a=e.camera;if("perspective"===a.projection){const t=!1,l=[0,0,0],u=Math.abs(t?n.math.lenVec3(n.math.subVec3(l,e.camera.eye,[])):e.camera.eyeLookDist)*Math.tan(a.perspective.fov/2*Math.PI/180);o.panDeltaX+=r*u/c*i.touchPanRate,o.panDeltaY+=s*u/c*i.touchPanRate}else o.panDeltaX+=.5*a.ortho.scale*(r/c)*i.touchPanRate,o.panDeltaY+=.5*a.ortho.scale*(s/c)*i.touchPanRate}else o.rotateDeltaY-=(t.pageX-u[0][0])/l*i.dragRotationRate/2,o.rotateDeltaX+=(t.pageY-u[0][1])/c*(i.dragRotationRate/4)}else if(2===h){const t=p[0],a=p[1],l=n.math.geometricMeanVec2(u[0],u[1]),h=n.math.geometricMeanVec2([t.pageX,t.pageY],[a.pageX,a.pageY]),d=n.math.vec2();n.math.subVec2(l,h,d);const f=d[0],m=d[1],g=e.camera;if("perspective"===g.projection){const t=s.pickResult?s.pickResult.worldPos:e.center,r=Math.abs(n.math.lenVec3(n.math.subVec3(t,e.camera.eye,[])))*Math.tan(g.perspective.fov/2*Math.PI/180);o.panDeltaX-=f*r/c*i.touchPanRate,o.panDeltaY-=m*r/c*i.touchPanRate}else o.panDeltaX-=.5*g.ortho.scale*(f/c)*i.touchPanRate,o.panDeltaY-=.5*g.ortho.scale*(m/c)*i.touchPanRate;const v=n.math.distVec2([t.pageX,t.pageY],[a.pageX,a.pageY]),b=n.math.distVec2(u[0],u[1]);o.dollyDelta=(b-v)*i.touchDollyRate,r.pointerCanvasPos=h}for(let e=0;e<h;++e)u[e][0]=p[e].pageX,u[e][1]=p[e].pageY}})}reset(){}destroy(){const e=this._scene.canvas.canvas;e.removeEventListener("touchstart",this._canvasTouchStartHandler),e.removeEventListener("touchmove",this._canvasTouchMoveHandler),this._scene.off(this._onTick)}}class $ extends a.a{constructor(e,t={}){super(e,t),this.PAN_LEFT=0,this.PAN_RIGHT=1,this.PAN_UP=2,this.PAN_DOWN=3,this.PAN_FORWARDS=4,this.PAN_BACKWARDS=5,this.ROTATE_X_POS=6,this.ROTATE_X_NEG=7,this.ROTATE_Y_POS=8,this.ROTATE_Y_NEG=9,this.DOLLY_FORWARDS=10,this.DOLLY_BACKWARDS=11,this.AXIS_VIEW_RIGHT=12,this.AXIS_VIEW_BACK=13,this.AXIS_VIEW_LEFT=14,this.AXIS_VIEW_FRONT=15,this.AXIS_VIEW_TOP=16,this.AXIS_VIEW_BOTTOM=17,this._keyMap={},this.scene.canvas.canvas.oncontextmenu=e=>{e.preventDefault()},this._configs={tapInterval:150,doubleTapInterval:325,tapDistanceThreshold:4,active:!0,keyboardLayout:"qwerty",navMode:"orbit",planView:!1,firstPerson:!1,followPointer:!1,doublePickFlyTo:!0,panRightClick:!0,showPivot:!1,pointerEnabled:!0,constrainVertical:!1,smartPivot:!1,dragRotationRate:360,keyboardRotationRate:90,rotationInertia:0,keyboardPanRate:1,touchPanRate:1,panInertia:.5,keyboardDollyRate:10,mouseWheelDollyRate:100,touchDollyRate:.05,dollyInertia:0,dollyProximityThreshold:30,dollyMinSpeed:.04},this._states={pointerCanvasPos:n.math.vec2(),mouseover:!1,inputFromMouse:!1,followPointerDirty:!0,mouseDownClientX:0,mouseDownClientY:0,mouseDownCursorX:0,mouseDownCursorY:0,touchStartTime:null,activeTouches:[],tapStartPos:n.math.vec2(),tapStartTime:-1,lastTapTime:-1},this._updates={rotateDeltaX:0,rotateDeltaY:0,panDeltaX:0,panDeltaY:0,panDeltaZ:0,dollyDelta:0};const i=this.scene;this._controllers={cameraControl:this,pickController:new A(this,this._configs),pivotController:new O(i,this._configs),panController:new w(i),cameraFlight:new p(this,{duration:.5})},this._handlers=[new G(this.scene,this._controllers,this._configs,this._states,this._updates),new Y(this.scene,this._controllers,this._configs,this._states,this._updates),new D(this.scene,this._controllers,this._configs,this._states,this._updates),new F(this.scene,this._controllers,this._configs,this._states,this._updates),new z(this.scene,this._controllers,this._configs,this._states,this._updates),new V(this.scene,this._controllers,this._configs,this._states,this._updates)],this._cameraUpdater=new H(this.scene,this._controllers,this._configs,this._states,this._updates),this.navMode=t.navMode,t.planView&&(this.planView=t.planView),this.constrainVertical=t.constrainVertical,t.keyboardLayout?this.keyboardLayout=t.keyboardLayout:this.keyMap=t.keyMap,this.doublePickFlyTo=t.doublePickFlyTo,this.panRightClick=t.panRightClick,this.active=t.active,this.followPointer=t.followPointer,this.rotationInertia=t.rotationInertia,this.keyboardPanRate=t.keyboardPanRate,this.touchPanRate=t.touchPanRate,this.keyboardRotationRate=t.keyboardRotationRate,this.dragRotationRate=t.dragRotationRate,this.touchDollyRate=t.touchDollyRate,this.dollyInertia=t.dollyInertia,this.dollyProximityThreshold=t.dollyProximityThreshold,this.dollyMinSpeed=t.dollyMinSpeed,this.panInertia=t.panInertia,this.pointerEnabled=!0,this.keyboardDollyRate=t.keyboardDollyRate,this.mouseWheelDollyRate=t.mouseWheelDollyRate}set keyMap(e){if(e=e||"qwerty",o.utils.isString(e)){const t=this.scene.input,i={};switch(e){default:this.error("Unsupported value for 'keyMap': "+e+" defaulting to 'qwerty'");case"qwerty":i[this.PAN_LEFT]=[t.KEY_A],i[this.PAN_RIGHT]=[t.KEY_D],i[this.PAN_UP]=[t.KEY_Z],i[this.PAN_DOWN]=[t.KEY_X],i[this.PAN_BACKWARDS]=[],i[this.PAN_FORWARDS]=[],i[this.DOLLY_FORWARDS]=[t.KEY_W,t.KEY_ADD],i[this.DOLLY_BACKWARDS]=[t.KEY_S,t.KEY_SUBTRACT],i[this.ROTATE_X_POS]=[t.KEY_DOWN_ARROW],i[this.ROTATE_X_NEG]=[t.KEY_UP_ARROW],i[this.ROTATE_Y_POS]=[t.KEY_Q,t.KEY_LEFT_ARROW],i[this.ROTATE_Y_NEG]=[t.KEY_E,t.KEY_RIGHT_ARROW],i[this.AXIS_VIEW_RIGHT]=[t.KEY_NUM_1],i[this.AXIS_VIEW_BACK]=[t.KEY_NUM_2],i[this.AXIS_VIEW_LEFT]=[t.KEY_NUM_3],i[this.AXIS_VIEW_FRONT]=[t.KEY_NUM_4],i[this.AXIS_VIEW_TOP]=[t.KEY_NUM_5],i[this.AXIS_VIEW_BOTTOM]=[t.KEY_NUM_6];break;case"azerty":i[this.PAN_LEFT]=[t.KEY_Q],i[this.PAN_RIGHT]=[t.KEY_D],i[this.PAN_UP]=[t.KEY_W],i[this.PAN_DOWN]=[t.KEY_X],i[this.PAN_BACKWARDS]=[],i[this.PAN_FORWARDS]=[],i[this.DOLLY_FORWARDS]=[t.KEY_Z,t.KEY_ADD],i[this.DOLLY_BACKWARDS]=[t.KEY_S,t.KEY_SUBTRACT],i[this.ROTATE_X_POS]=[t.KEY_DOWN_ARROW],i[this.ROTATE_X_NEG]=[t.KEY_UP_ARROW],i[this.ROTATE_Y_POS]=[t.KEY_A,t.KEY_LEFT_ARROW],i[this.ROTATE_Y_NEG]=[t.KEY_E,t.KEY_RIGHT_ARROW],i[this.AXIS_VIEW_RIGHT]=[t.KEY_NUM_1],i[this.AXIS_VIEW_BACK]=[t.KEY_NUM_2],i[this.AXIS_VIEW_LEFT]=[t.KEY_NUM_3],i[this.AXIS_VIEW_FRONT]=[t.KEY_NUM_4],i[this.AXIS_VIEW_TOP]=[t.KEY_NUM_5],i[this.AXIS_VIEW_BOTTOM]=[t.KEY_NUM_6]}this._keyMap=i}else{const t=e;this._keyMap=t}}get keyMap(){return this._keyMap}_isKeyDownForAction(e,t){const i=this._keyMap[e];if(!i)return!1;t||(t=this.scene.input.keyDown);for(let e=0,r=i.length;e<r;e++)if(t[i[e]])return!0;return!1}set pivotElement(e){this._controllers.pivotController.setPivotElement(e)}set active(e){this._configs.active=!1!==e}get active(){return this._configs.active}set navMode(e){"firstPerson"!==(e=e||"orbit")&&"orbit"!==e&&"planView"!==e&&(this.error("Unsupported value for navMode: "+e+" - supported values are 'orbit', 'firstPerson' and 'planView' - defaulting to 'orbit'"),e="orbit"),this._configs.firstPerson="firstPerson"===e,this._configs.planView="planView"===e,(this._configs.firstPerson||this._configs.planView)&&(this._controllers.pivotController.hidePivot(),this._controllers.pivotController.endPivot()),this._configs.navMode=e}get navMode(){return this._configs.navMode}set pointerEnabled(e){this._reset(),this._configs.pointerEnabled=!!e}_reset(){for(let e=0,t=this._handlers.length;e<t;e++){const t=this._handlers[e];t.reset&&t.reset()}this._updates.panDeltaX=0,this._updates.panDeltaY=0,this._updates.rotateDeltaX=0,this._updates.rotateDeltaY=0,this._updates.dolyDelta=0}get pointerEnabled(){return this._configs.pointerEnabled}set followPointer(e){this._configs.followPointer=!!e}get followPointer(){return this._configs.followPointer}set pivotPos(e){this._controllers.pivotController.setPivotPos(e)}get pivotPos(){return this._controllers.pivotController.getPivotPos()}set dollyToPointer(e){this.warn("dollyToPointer property is deprecated - replaced with followPointer"),this.followPointer=e}get dollyToPointer(){return this.warn("dollyToPointer property is deprecated - replaced with followPointer"),this.followPointer=value}set panToPointer(e){this.warn("panToPointer property is deprecated - replaced with followPointer")}get panToPointer(){return this.warn("panToPointer property is deprecated - replaced with followPointer"),!1}set planView(e){this._configs.planView=!!e,this._configs.firstPerson=!1,this._configs.planView&&(this._controllers.pivotController.hidePivot(),this._controllers.pivotController.endPivot()),this.warn("planView property is deprecated - replaced with navMode")}get planView(){return this.warn("planView property is deprecated - replaced with navMode"),this._configs.planView}set firstPerson(e){this.warn("firstPerson property is deprecated - replaced with navMode"),this._configs.firstPerson=!!e,this._configs.planView=!1,this._configs.firstPerson&&(this._controllers.pivotController.hidePivot(),this._controllers.pivotController.endPivot())}get firstPerson(){return this.warn("firstPerson property is deprecated - replaced with navMode"),this._configs.firstPerson}set constrainVertical(e){this._configs.constrainVertical=!!e}get constrainVertical(){return this._configs.constrainVertical}set doublePickFlyTo(e){this._configs.doublePickFlyTo=!1!==e}get doublePickFlyTo(){return this._configs.doublePickFlyTo}set panRightClick(e){this._configs.panRightClick=!1!==e}get panRightClick(){return this._configs.panRightClick}set rotationInertia(e){this._configs.rotationInertia=null!=e?e:0}get rotationInertia(){return this._configs.rotationInertia}set keyboardPanRate(e){this._configs.keyboardPanRate=null!=e?e:5}set touchPanRate(e){this._configs.touchPanRate=null!=e?e:1}get touchPanRate(){return this._configs.touchPanRate}get keyboardPanRate(){return this._configs.keyboardPanRate}set keyboardRotationRate(e){this._configs.keyboardRotationRate=null!=e?e:90}get keyboardRotationRate(){return this._configs.keyboardRotationRate}set dragRotationRate(e){this._configs.dragRotationRate=null!=e?e:360}get dragRotationRate(){return this._configs.dragRotationRate}set keyboardDollyRate(e){this._configs.keyboardDollyRate=null!=e?e:15}get keyboardDollyRate(){return this._configs.keyboardDollyRate}set touchDollyRate(e){this._configs.touchDollyRate=null!=e?e:.05}get touchDollyRate(){return this._configs.touchDollyRate}set mouseWheelDollyRate(e){this._configs.mouseWheelDollyRate=null!=e?e:100}get mouseWheelDollyRate(){return this._configs.mouseWheelDollyRate}set dollyInertia(e){this._configs.dollyInertia=null!=e?e:0}get dollyInertia(){return this._configs.dollyInertia}set dollyProximityThreshold(e){this._configs.dollyProximityThreshold=null!=e?e:35}get dollyProximityThreshold(){return this._configs.dollyProximityThreshold}set dollyMinSpeed(e){this._configs.dollyMinSpeed=null!=e?e:.04}get dollyMinSpeed(){return this._configs.dollyMinSpeed}set panInertia(e){this._configs.panInertia=null!=e?e:.5}get panInertia(){return this._configs.panInertia}set keyboardLayout(e){"qwerty"!==(e=e||"qwerty")&&"azerty"!==e&&(this.error("Unsupported value for keyboardLayout - defaulting to 'qwerty'"),e="qwerty"),this._configs.keyboardLayout=e,this.keyMap=this._configs.keyboardLayout}get keyboardLayout(){return this._configs.keyboardLayout}set smartPivot(e){this._configs.smartPivot=!1!==e}get smartPivot(){return this._configs.smartPivot}destroy(){this._destroyHandlers(),this._destroyControllers(),this._cameraUpdater.destroy(),super.destroy()}_destroyHandlers(){for(let e=0,t=this._handlers.length;e<t;e++){const t=this._handlers[e];t.destroy&&t.destroy()}}_destroyControllers(){for(let e=0,t=this._controllers.length;e<t;e++){const t=this._controllers[e];t.destroy&&t.destroy()}}}class q{constructor(e,t,i,r,n,o,s,a,l){this.id=t,this.projectId=i,this.revisionId=r,this.author=n,this.createdAt=o,this.creatingApplication=s,this.schema=a,this.metaScene=e,this.rootMetaObject=l}getJSON(){var e=[];return function t(i){var r={id:i.id,extId:i.extId,type:i.type,name:i.name};i.parent&&(r.parent=i.parent.id),e.push(r);var n=i.children;if(n)for(var o=0,s=n.length;o<s;o++)t(n[o])}(this.rootMetaObject),{id:this.id,projectId:this.projectId,revisionId:this.revisionId,metaObjects:e}}}class K{constructor(e,t,i,r,n,o,s,a,l){this.metaModel=e,this.id=t,this.originalSystemId=i,this.name=r,this.type=n,o&&(this.properties=o),null!=s&&(this.parent=s),null!=a&&(this.children=a),null!=l&&(this.external=l)}getObjectIDsInSubtree(){const e=[];return function t(i){if(!i)return;e.push(i.id);const r=i.children;if(r)for(var n=0,o=r.length;n<o;n++)t(r[n])}(this),e}withMetaObjectsInSubtree(e){!function t(i){if(!i)return;e(i);const r=i.children;if(r)for(var n=0,o=r.length;n<o;n++)t(r[n])}(this)}getObjectIDsInSubtreeByType(e){const t={};for(var i=0,r=e.length;i<r;i++)t[e[i]]=e[i];const n=[];return function e(i){if(!i)return;t[i.type]&&n.push(i.id);const r=i.children;if(r)for(var o=0,s=r.length;o<s;o++)e(r[o])}(this),n}getJSON(){var e={id:this.id,type:this.type,name:this.name};return this.parent&&(e.parent=this.parent.id),e}}class Z{constructor(e,t){this.viewer=e,this.scene=t,this.metaModels={},this.metaObjects={},this.metaObjectsByType={},this._typeCounts={},this._eventSubs={}}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}off(e){}createMetaModel(e,t,i={}){const r=t.projectId||"none",o=t.revisionId||"none",s=t.metaObjects,a=t.author,l=t.createdAt,c=t.creatingApplication,u=t.schema,h=new q(this,e,r,o,a,l,c,u,null);this.metaModels[e]=h;for(let t=0,r=s.length;t<r;t++){const r=s[t],o=r.type,a=i.globalizeObjectIds?n.math.globalizeObjectId(e,r.id):r.id,l=r.id,c=r.name,u=r.properties,d=null,p=null,f=r.external,m=new K(h,a,l,c,o,u,d,p,f);this.metaObjects[a]=m,(this.metaObjectsByType[o]||(this.metaObjectsByType[o]={}))[a]=m,void 0===this._typeCounts[o]?this._typeCounts[o]=1:this._typeCounts[o]++}for(let t=0,r=s.length;t<r;t++){const r=s[t],o=i.globalizeObjectIds?n.math.globalizeObjectId(e,r.id):r.id,a=this.metaObjects[o];if(a)if(void 0===r.parent||null===r.parent)h.rootMetaObject=a;else if(r.parent){const t=i.globalizeObjectIds?n.math.globalizeObjectId(e,r.parent):r.parent;let o=this.metaObjects[t];o&&(a.parent=o,o.children=o.children||[],o.children.push(a))}}return this.fire("metaModelCreated",e),h}destroyMetaModel(e){const t=this.metaModels[e];if(!t)return;const i=this.metaObjects,r=this.metaObjectsByType;let n=e=>{delete i[e.id];const t=r[e.type];t&&t[e.id]&&(delete t[e.id],0==--this._typeCounts[e.type]&&(delete this._typeCounts[e.type],delete r[e.type]));const o=e.children;if(o)for(let e=0,t=o.length;e<t;e++){const t=o[e];n(t)}};n(t.rootMetaObject),delete this.metaModels[e],this.fire("metaModelDestroyed",e)}getObjectIDsByType(e){const t=this.metaObjectsByType[e];return t?Object.keys(t):[]}getObjectIDsInSubtree(e,t,i){const r=[],n=this.metaObjects[e],o=t&&t.length>0?Q(t):null,s=i&&i.length>0?Q(i):null;return function e(t){if(!t)return;var i=!0;(s&&s[t.type]||o&&!o[t.type])&&(i=!1),i&&r.push(t.id);const n=t.children;if(n)for(var a=0,l=n.length;a<l;a++)e(n[a])}(n),r}withMetaObjectsInSubtree(e,t){const i=this.metaObjects[e];i&&i.withMetaObjectsInSubtree(t)}}function Q(e){const t={};for(var i=0,r=e.length;i<r;i++)t[e[i]]=!0;return t}i(7);class J{constructor(e){this.language="en",this.scene=new r.a(this,{canvasId:e.canvasId,canvasElement:e.canvasElement,webgl2:!1,contextAttr:{preserveDrawingBuffer:!1!==e.preserveDrawingBuffer,premultipliedAlpha:!!e.premultipliedAlpha,antialias:!1!==e.antialias},spinnerElementId:e.spinnerElementId,transparent:!1!==e.transparent,gammaInput:!0,gammaOutput:!0,clearColorAmbient:e.clearColorAmbient,ticksPerRender:1,ticksPerOcclusionTest:20,units:e.units,scale:e.scale,origin:e.origin,saoEnabled:e.saoEnabled,alphaDepthMask:!1!==e.alphaDepthMask,entityOffsetsEnabled:!!e.entityOffsetsEnabled,logarithmicDepthBufferEnabled:!!e.logarithmicDepthBufferEnabled}),this.metaScene=new Z(this,this.scene),this.id=e.id||this.scene.id,this.camera=this.scene.camera,this.cameraFlight=new p(this.scene,{duration:.5}),this.cameraControl=new $(this.scene,{doublePickFlyTo:!0}),this._plugins=[],this._eventSubs={}}on(e,t){let i=this._eventSubs[e];i||(i=[],this._eventSubs[e]=i),i.push(t)}fire(e,t){const i=this._eventSubs[e];if(i)for(let e=0,r=i.length;e<r;e++)i[e](t)}off(e){}log(e){console.log(`[xeokit viewer ${this.id}]: ${e}`)}error(e){console.error(`[xeokit viewer ${this.id}]: ${e}`)}addPlugin(e){this._plugins.push(e)}removePlugin(e){for(let t=0,i=this._plugins.length;t<i;t++){const i=this._plugins[t];if(i===e)return i.clear&&i.clear(),void this._plugins.splice(t,1)}}sendToPlugins(e,t){for(let i=0,r=this._plugins.length;i<r;i++){const r=this._plugins[i];r.send&&r.send(e,t)}}clear(){throw'Viewer#clear() no longer implemented - use \'#sendToPlugins("clear") instead'}resetView(){throw"Viewer#resetView() no longer implemented - use CameraMemento & ObjectsMemento classes instead"}beginSnapshot(){this._snapshotBegun||(this.scene._renderer.beginSnapshot(),this._snapshotBegun=!0)}getSnapshot(e={}){const t=!this._snapshotBegun;this._snapshotBegun||this.beginSnapshot(),this.sendToPlugins("snapshotStarting");const i=void 0!==e.width&&void 0!==e.height,r=this.scene.canvas.canvas,n=r.clientWidth,o=r.clientHeight,s=r.style.width,a=r.style.height,l=e.width?Math.floor(e.width):r.width,c=e.height?Math.floor(e.height):r.height;i&&(r.style.width=l+"px",r.style.height=c+"px"),this.scene._renderer.renderSnapshot();const u=this.scene._renderer.readSnapshot(e);return i&&(r.style.width=s,r.style.height=a,r.width=n,r.height=o,this.scene.glRedraw()),this.sendToPlugins("snapshotFinished"),t&&this.endSnapshot(),u}endSnapshot(){this._snapshotBegun&&(this.scene._renderer.endSnapshot(),this.scene._renderer.render({force:!0}),this._snapshotBegun=!1)}destroy(){const e=this._plugins.slice();for(let t=0,i=e.length;t<i;t++)e[t].destroy();this.scene.destroy()}}},function(e,t,i){"use strict";i.r(t),i.d(t,"SectionPlanesPlugin",(function(){return I}));var r=i(0),n=i(34),o=i(98),s=i(49),a=i(8);function l(e={}){let t=e.radius||1;t<0&&(console.error("negative radius not allowed - will invert"),t*=-1),t*=.5;let i=e.tube||.3;i<0&&(console.error("negative tube not allowed - will invert"),i*=-1);let n=e.radialSegments||32;n<0&&(console.error("negative radialSegments not allowed - will invert"),n*=-1),n<4&&(n=4);let o=e.tubeSegments||24;o<0&&(console.error("negative tubeSegments not allowed - will invert"),o*=-1),o<4&&(o=4);let s=e.arc||2*Math.PI;s<0&&(console.warn("negative arc not allowed - will invert"),s*=-1),s>360&&(s=360);const l=e.center;let c=l?l[0]:0,u=l?l[1]:0;const h=l?l[2]:0,d=[],p=[],f=[],m=[];let g,v,b,_,y,x,w,M,P,E,S,C;for(M=0;M<=o;M++)for(w=0;w<=n;w++)g=w/n*s,v=.785398+M/o*Math.PI*2,c=t*Math.cos(g),u=t*Math.sin(g),b=(t+i*Math.cos(v))*Math.cos(g),_=(t+i*Math.cos(v))*Math.sin(g),y=i*Math.sin(v),d.push(b+c),d.push(_+u),d.push(y+h),f.push(1-w/n),f.push(M/o),x=r.math.normalizeVec3(r.math.subVec3([b,_,y],[c,u,h],[]),[]),p.push(x[0]),p.push(x[1]),p.push(x[2]);for(M=1;M<=o;M++)for(w=1;w<=n;w++)P=(n+1)*M+w-1,E=(n+1)*(M-1)+w-1,S=(n+1)*(M-1)+w,C=(n+1)*M+w,m.push(P),m.push(E),m.push(S),m.push(S),m.push(C),m.push(P);return a.utils.apply(e,{positions:d,normals:p,uv:f,indices:m})}var c=i(26),u=i(29),h=i(30),d=i(16);const p=r.math.vec4(4),f=r.math.vec4(),m=r.math.vec4(),g=r.math.vec3([1,0,0]),v=r.math.vec3([0,1,0]),b=r.math.vec3([0,0,1]),_=r.math.vec3(3),y=r.math.vec3(3),x=r.math.identityMat4();class w extends d.a{constructor(e,t={}){if(super(e,t),this._parentNode=null,this._children=[],this._aabb=null,this._aabbDirty=!0,this.scene._aabbDirty=!0,this._numTriangles=0,this._scale=r.math.vec3(),this._quaternion=r.math.identityQuaternion(),this._rotation=r.math.vec3(),this._position=r.math.vec3(),this._offset=r.math.vec3(),this._localMatrix=r.math.identityMat4(),this._worldMatrix=r.math.identityMat4(),this._localMatrixDirty=!0,this._worldMatrixDirty=!0,t.matrix?this.matrix=t.matrix:(this.scale=t.scale,this.position=t.position,t.quaternion||(this.rotation=t.rotation)),this._isModel=t.isModel,this._isModel&&this.scene._registerModel(this),this._isObject=t.isObject,this._isObject&&this.scene._registerObject(this),this.rtcCenter=t.rtcCenter,this.visible=t.visible,this.culled=t.culled,this.pickable=t.pickable,this.clippable=t.clippable,this.collidable=t.collidable,this.castsShadow=t.castsShadow,this.receivesShadow=t.receivesShadow,this.xrayed=t.xrayed,this.highlighted=t.highlighted,this.selected=t.selected,this.edges=t.edges,this.colorize=t.colorize,this.opacity=t.opacity,this.offset=t.offset,t.children){const e=t.children;for(let i=0,r=e.length;i<r;i++)this.addChild(e[i],t.inheritStates)}if(t.parentId){const e=this.scene.components[t.parentId];e?e.isNode?e.addChild(this):this.error("Parent is not a Node: '"+t.parentId+"'"):this.error("Parent not found: '"+t.parentId+"'")}else t.parent&&(t.parent.isNode||this.error("Parent is not a Node"),t.parent.addChild(this))}get isEntity(){return!0}get isModel(){return this._isModel}get isObject(){return this._isObject}get aabb(){return this._aabbDirty&&this._updateAABB(),this._aabb}set rtcCenter(e){e?(this._rtcCenter||(this._rtcCenter=r.math.vec3()),this._rtcCenter.set(e)):this._rtcCenter&&(this._rtcCenter=null);for(let t=0,i=this._children.length;t<i;t++)this._children[t].rtcCenter=e}get rtcCenter(){return this._rtcCenter}get numTriangles(){return this._numTriangles}set visible(e){e=!1!==e,this._visible=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].visible=e;this._isObject&&this.scene._objectVisibilityUpdated(this,e)}get visible(){return this._visible}set xrayed(e){e=!!e,this._xrayed=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].xrayed=e;this._isObject&&this.scene._objectXRayedUpdated(this,e)}get xrayed(){return this._xrayed}set highlighted(e){e=!!e,this._highlighted=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].highlighted=e;this._isObject&&this.scene._objectHighlightedUpdated(this,e)}get highlighted(){return this._highlighted}set selected(e){e=!!e,this._selected=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].selected=e;this._isObject&&this.scene._objectSelectedUpdated(this,e)}get selected(){return this._selected}set edges(e){e=!!e,this._edges=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].edges=e}get edges(){return this._edges}set culled(e){e=!!e,this._culled=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].culled=e}get culled(){return this._culled}set clippable(e){e=!1!==e,this._clippable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].clippable=e}get clippable(){return this._clippable}set collidable(e){e=!1!==e,this._collidable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].collidable=e}get collidable(){return this._collidable}set pickable(e){e=!1!==e,this._pickable=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].pickable=e}get pickable(){return this._pickable}set colorize(e){let t=this._colorize;t||((t=this._colorize=new Float32Array(4))[3]=1),e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):(t[0]=1,t[1]=1,t[2]=1);for(let e=0,i=this._children.length;e<i;e++)this._children[e].colorize=t;if(this._isObject){const t=!!e;this.scene._objectColorizeUpdated(this,t)}}get colorize(){return this._colorize.slice(0,3)}set opacity(e){let t=this._colorize;t||((t=this._colorize=new Float32Array(4))[0]=1,t[1]=1,t[2]=1),t[3]=null!=e?e:1;for(let t=0,i=this._children.length;t<i;t++)this._children[t].opacity=e;if(this._isObject){const t=null!=e;this.scene._objectOpacityUpdated(this,t)}}get opacity(){return this._colorize[3]}set castsShadow(e){e=!!e,this._castsShadow=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].castsShadow=e}get castsShadow(){return this._castsShadow}set receivesShadow(e){e=!!e,this._receivesShadow=e;for(let t=0,i=this._children.length;t<i;t++)this._children[t].receivesShadow=e}get receivesShadow(){return this._receivesShadow}get saoEnabled(){return!1}set offset(e){e?(this._offset[0]=e[0],this._offset[1]=e[1],this._offset[2]=e[2]):(this._offset[0]=0,this._offset[1]=0,this._offset[2]=0);for(let e=0,t=this._children.length;e<t;e++)this._children[e].offset=this._offset;this._isObject&&this.scene._objectOffsetUpdated(this,e)}get offset(){return this._offset}get isNode(){return!0}_setLocalMatrixDirty(){this._localMatrixDirty=!0,this._setWorldMatrixDirty()}_setWorldMatrixDirty(){this._worldMatrixDirty=!0;for(let e=0,t=this._children.length;e<t;e++)this._children[e]._setWorldMatrixDirty()}_buildWorldMatrix(){const e=this.matrix;if(this._parentNode)r.math.mulMat4(this._parentNode.worldMatrix,e,this._worldMatrix);else for(let t=0,i=e.length;t<i;t++)this._worldMatrix[t]=e[t];this._worldMatrixDirty=!1}_setSubtreeAABBsDirty(e){if(e._aabbDirty=!0,e._children)for(let t=0,i=e._children.length;t<i;t++)this._setSubtreeAABBsDirty(e._children[t])}_setAABBDirty(){if(this._setSubtreeAABBsDirty(this),this.collidable)for(let e=this;e;e=e._parentNode)e._aabbDirty=!0}_updateAABB(){if(this.scene._aabbDirty=!0,this._aabb||(this._aabb=r.math.AABB3()),this._buildAABB)this._buildAABB(this.worldMatrix,this._aabb);else{let e;r.math.collapseAABB3(this._aabb);for(let t=0,i=this._children.length;t<i;t++)(e=this._children[t]).collidable&&r.math.expandAABB3(this._aabb,e.aabb)}this._aabbDirty=!1}addChild(e,t){if(a.utils.isNumeric(e)||a.utils.isString(e)){const t=e;if(!(e=this.scene.component[t]))return void this.warn("Component not found: "+a.utils.inQuotes(t));if(!e.isNode&&!e.isMesh)return void this.error("Not a Node or Mesh: "+t)}else{if(!e.isNode&&!e.isMesh)return void this.error("Not a Node or Mesh: "+e.id);if(e._parentNode){if(e._parentNode.id===this.id)return void this.warn("Already a child: "+e.id);e._parentNode.removeChild(e)}}if(e.id,e.scene.id===this.scene.id)return this._children.push(e),e._parentNode=this,t&&(e.visible=this.visible,e.culled=this.culled,e.xrayed=this.xrayed,e.highlited=this.highlighted,e.selected=this.selected,e.edges=this.edges,e.clippable=this.clippable,e.pickable=this.pickable,e.collidable=this.collidable,e.castsShadow=this.castsShadow,e.receivesShadow=this.receivesShadow,e.colorize=this.colorize,e.opacity=this.opacity,e.offset=this.offset),e._setWorldMatrixDirty(),e._setAABBDirty(),this._numTriangles+=e.numTriangles,e;this.error("Child not in same Scene: "+e.id)}removeChild(e){for(let t=0,i=this._children.length;t<i;t++)if(this._children[t].id===e.id)return e._parentNode=null,this._children=this._children.splice(t,1),e._setWorldMatrixDirty(),e._setAABBDirty(),this._setAABBDirty(),void(this._numTriangles-=e.numTriangles)}removeChildren(){let e;for(let t=0,i=this._children.length;t<i;t++)(e=this._children[t])._parentNode=null,e._setWorldMatrixDirty(),e._setAABBDirty(),this._numTriangles-=e.numTriangles;this._children=[],this._setAABBDirty()}get numChildren(){return this._children.length}get children(){return this._children}set parent(e){if(a.utils.isNumeric(e)||a.utils.isString(e)){const t=e;if(!(e=this.scene.components[t]))return void this.warn("Node not found: "+a.utils.inQuotes(t));if(!e.isNode)return void this.error("Not a Node: "+e.id)}e.scene.id===this.scene.id?this._parentNode&&this._parentNode.id===e.id?this.warn("Already a child of Node: "+e.id):e.addChild(this):this.error("Node not in same Scene: "+e.id)}get parent(){return this._parentNode}set position(e){this._position.set(e||[0,0,0]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get position(){return this._position}set rotation(e){this._rotation.set(e||[0,0,0]),r.math.eulerToQuaternion(this._rotation,"XYZ",this._quaternion),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get rotation(){return this._rotation}set quaternion(e){this._quaternion.set(e||[0,0,0,1]),r.math.quaternionToEuler(this._quaternion,"XYZ",this._rotation),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get quaternion(){return this._quaternion}set scale(e){this._scale.set(e||[1,1,1]),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get scale(){return this._scale}set matrix(e){this._localMatrix||(this._localMatrix=r.math.identityMat4()),this._localMatrix.set(e||x),r.math.decomposeMat4(this._localMatrix,this._position,this._quaternion,this._scale),this._localMatrixDirty=!1,this._setWorldMatrixDirty(),this._setAABBDirty(),this.glRedraw()}get matrix(){return this._localMatrixDirty&&(this._localMatrix||(this._localMatrix=r.math.identityMat4()),r.math.composeMat4(this._position,this._quaternion,this._scale,this._localMatrix),this._localMatrixDirty=!1),this._localMatrix}get worldMatrix(){return this._worldMatrixDirty&&this._buildWorldMatrix(),this._worldMatrix}rotate(e,t){return p[0]=e[0],p[1]=e[1],p[2]=e[2],p[3]=t*r.math.DEGTORAD,r.math.angleAxisToQuaternion(p,f),r.math.mulQuaternions(this.quaternion,f,m),this.quaternion=m,this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}rotateOnWorldAxis(e,t){return p[0]=e[0],p[1]=e[1],p[2]=e[2],p[3]=t*r.math.DEGTORAD,r.math.angleAxisToQuaternion(p,f),r.math.mulQuaternions(f,this.quaternion,f),this}rotateX(e){return this.rotate(g,e)}rotateY(e){return this.rotate(v,e)}rotateZ(e){return this.rotate(b,e)}translate(e,t){return r.math.vec3ApplyQuaternion(this.quaternion,e,_),r.math.mulVec3Scalar(_,t,y),r.math.addVec3(this.position,y,this.position),this._setLocalMatrixDirty(),this._setAABBDirty(),this.glRedraw(),this}translateX(e){return this.translate(g,e)}translateY(e){return this.translate(v,e)}translateZ(e){return this.translate(b,e)}get type(){return"Node"}destroy(){if(super.destroy(),this._parentNode&&this._parentNode.removeChild(this),this._isObject&&(this.scene._deregisterObject(this),this._visible&&this.scene._objectVisibilityUpdated(this,!1),this._xrayed&&this.scene._objectXRayedUpdated(this,!1),this._selected&&this.scene._objectSelectedUpdated(this,!1),this._highlighted&&this.scene._objectHighlightedUpdated(this,!1),this.scene._objectColorizeUpdated(this,!1),this.scene._objectOpacityUpdated(this,!1),this.scene._objectOffsetUpdated(this,!1)),this._isModel&&this.scene._deregisterModel(this),this._children.length){const e=this._children.splice();let t;for(let i=0,r=e.length;i<r;i++)(t=e[i]).destroy()}this._children=[],this._setAABBDirty(),this.scene._aabbDirty=!0}}var M=i(17),P=i(9);const E=new Float64Array([0,0,1]),S=new Float64Array(4);class C{constructor(e){this.id=null,this._viewer=e.viewer,this._visible=!1,this._pos=r.math.vec3(),this._rtcCenter=r.math.vec3(),this._rtcPos=r.math.vec3(),this._baseDir=r.math.vec3(),this._rootNode=null,this._displayMeshes=null,this._affordanceMeshes=null,this._ignoreNextSectionPlaneDirUpdate=!1,this._createNodes(),this._bindEvents()}_setSectionPlane(e){this._sectionPlane&&(this._sectionPlane.off(this._onSectionPlanePos),this._sectionPlane.off(this._onSectionPlaneDir),this._onSectionPlanePos=null,this._onSectionPlaneDir=null,this._sectionPlane=null),e&&(this.id=e.id,this._setPos(e.pos),this._setDir(e.dir),this._sectionPlane=e,this._onSectionPlanePos=e.on("pos",()=>{this._setPos(this._sectionPlane.pos)}),this._onSectionPlaneDir=e.on("dir",()=>{this._ignoreNextSectionPlaneDirUpdate?this._ignoreNextSectionPlaneDirUpdate=!1:this._setDir(this._sectionPlane.dir)}))}get sectionPlane(){return this._sectionPlane}_setPos(e){this._pos.set(e),Object(P.c)(this._pos,this._rtcCenter,this._rtcPos),this._rootNode.rtcCenter=this._rtcCenter,this._rootNode.position=this._rtcPos}_setDir(e){this._baseDir.set(e),this._rootNode.quaternion=r.math.vec3PairToQuaternion(E,e,S)}_setSectionPlaneDir(e){this._sectionPlane&&(this._ignoreNextSectionPlaneDirUpdate=!0,this._sectionPlane.dir=e)}setVisible(e=!0){if(this._visible!==e){var t;for(t in this._visible=e,this._displayMeshes)this._displayMeshes.hasOwnProperty(t)&&(this._displayMeshes[t].visible=e);if(!e)for(t in this._affordanceMeshes)this._affordanceMeshes.hasOwnProperty(t)&&(this._affordanceMeshes[t].visible=e)}}getVisible(){return this._visible}setCulled(e){var t;for(t in this._displayMeshes)this._displayMeshes.hasOwnProperty(t)&&(this._displayMeshes[t].culled=e);if(!e)for(t in this._affordanceMeshes)this._affordanceMeshes.hasOwnProperty(t)&&(this._affordanceMeshes[t].culled=e)}_createNodes(){const e=this._viewer.scene;this._rootNode=new w(e,{position:[0,0,0],scale:[5,5,5]});const t=this._rootNode,i={arrowHead:new c.a(t,Object(s.a)({radiusTop:.001,radiusBottom:.07,radialSegments:32,heightSegments:1,height:.2,openEnded:!1})),arrowHeadBig:new c.a(t,Object(s.a)({radiusTop:.001,radiusBottom:.09,radialSegments:32,heightSegments:1,height:.25,openEnded:!1})),arrowHeadHandle:new c.a(t,Object(s.a)({radiusTop:.09,radiusBottom:.09,radialSegments:8,heightSegments:1,height:.37,openEnded:!1})),curve:new c.a(t,l({radius:.8,tube:.01,radialSegments:64,tubeSegments:14,arc:2*Math.PI/4})),curveHandle:new c.a(t,l({radius:.8,tube:.06,radialSegments:64,tubeSegments:14,arc:2*Math.PI/4})),hoop:new c.a(t,l({radius:.8,tube:.01,radialSegments:64,tubeSegments:8,arc:2*Math.PI})),axis:new c.a(t,Object(s.a)({radiusTop:.01,radiusBottom:.01,radialSegments:20,heightSegments:1,height:1,openEnded:!1})),axisHandle:new c.a(t,Object(s.a)({radiusTop:.08,radiusBottom:.08,radialSegments:20,heightSegments:1,height:1,openEnded:!1}))},n={pickable:new u.a(t,{diffuse:[1,1,0],alpha:0,alphaMode:"blend"}),red:new u.a(t,{diffuse:[1,0,0],emissive:[1,0,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightRed:new h.a(t,{edges:!1,fill:!0,fillColor:[1,0,0],fillAlpha:.6}),green:new u.a(t,{diffuse:[0,1,0],emissive:[0,1,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightGreen:new h.a(t,{edges:!1,fill:!0,fillColor:[0,1,0],fillAlpha:.6}),blue:new u.a(t,{diffuse:[0,0,1],emissive:[0,0,1],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80,lineWidth:2}),highlightBlue:new h.a(t,{edges:!1,fill:!0,fillColor:[0,0,1],fillAlpha:.2}),center:new u.a(t,{diffuse:[0,0,0],emissive:[0,0,0],ambient:[0,0,0],specular:[.6,.6,.3],shininess:80}),highlightBall:new h.a(t,{edges:!1,fill:!0,fillColor:[.5,.5,.5],fillAlpha:.5,vertices:!1}),highlightPlane:new h.a(t,{edges:!0,edgeWidth:3,fill:!1,fillColor:[.5,.5,.5],fillAlpha:.5,vertices:!1})};this._displayMeshes={plane:t.addChild(new M.a(t,{geometry:new c.a(t,{primitive:"triangles",positions:[.5,.5,0,.5,-.5,0,-.5,-.5,0,-.5,.5,0,.5,.5,-0,.5,-.5,-0,-.5,-.5,-0,-.5,.5,-0],indices:[0,1,2,2,3,0]}),material:new u.a(t,{emissive:[0,0,0],diffuse:[0,0,0],backfaces:!0}),opacity:.6,ghosted:!0,ghostMaterial:new h.a(t,{edges:!1,filled:!0,fillColor:[1,1,0],edgeColor:[0,0,0],fillAlpha:.1,backfaces:!0}),pickable:!1,collidable:!0,clippable:!1,visible:!1,scale:[2.4,2.4,1]}),!1),planeFrame:t.addChild(new M.a(t,{geometry:new c.a(t,l({center:[0,0,0],radius:1.7,tube:.02,radialSegments:4,tubeSegments:4,arc:2*Math.PI})),material:new u.a(t,{emissive:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],shininess:0}),highlightMaterial:new h.a(t,{edges:!1,edgeColor:[0,0,0],filled:!0,fillColor:[.8,.8,.8],fillAlpha:1}),pickable:!1,collidable:!1,clippable:!1,visible:!1,scale:[1,1,.1],rotation:[0,0,45]}),!1),xCurve:t.addChild(new M.a(t,{geometry:i.curve,material:n.red,matrix:function(){const e=r.math.rotationMat4v(90*r.math.DEGTORAD,[0,1,0],r.math.identityMat4()),t=r.math.rotationMat4v(270*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xCurveHandle:t.addChild(new M.a(t,{geometry:i.curveHandle,material:n.pickable,matrix:function(){const e=r.math.rotationMat4v(90*r.math.DEGTORAD,[0,1,0],r.math.identityMat4()),t=r.math.rotationMat4v(270*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xCurveArrow1:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.red,matrix:function(){const e=r.math.translateMat4c(0,-.07,-.8,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4()),i=r.math.rotationMat4v(0*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(r.math.mulMat4(e,t,r.math.identityMat4()),i,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),xCurveArrow2:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.red,matrix:function(){const e=r.math.translateMat4c(0,-.8,-.07,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4()),i=r.math.rotationMat4v(90*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(r.math.mulMat4(e,t,r.math.identityMat4()),i,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yCurve:t.addChild(new M.a(t,{geometry:i.curve,material:n.green,rotation:[-90,0,0],pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),yCurveHandle:t.addChild(new M.a(t,{geometry:i.curveHandle,material:n.pickable,rotation:[-90,0,0],pickable:!0,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),yCurveArrow1:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.green,matrix:function(){const e=r.math.translateMat4c(.07,0,-.8,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4()),i=r.math.rotationMat4v(90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(r.math.mulMat4(e,t,r.math.identityMat4()),i,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yCurveArrow2:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.green,matrix:function(){const e=r.math.translateMat4c(.8,0,-.07,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4()),i=r.math.rotationMat4v(90*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(r.math.mulMat4(e,t,r.math.identityMat4()),i,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurve:t.addChild(new M.a(t,{geometry:i.curve,material:n.blue,matrix:r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4()),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zCurveHandle:t.addChild(new M.a(t,{geometry:i.curveHandle,material:n.pickable,matrix:r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4()),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurveCurveArrow1:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.blue,matrix:function(){const e=r.math.translateMat4c(.8,-.07,0,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4());return r.math.mulMat4(e,t,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zCurveArrow2:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.blue,matrix:function(){const e=r.math.translateMat4c(.05,-.8,0,r.math.identityMat4()),t=r.math.scaleMat4v([.6,.6,.6],r.math.identityMat4()),i=r.math.rotationMat4v(90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(r.math.mulMat4(e,t,r.math.identityMat4()),i,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),center:t.addChild(new M.a(t,{geometry:new c.a(t,function(e={}){const t=e.lod||1,i=e.center?e.center[0]:0,r=e.center?e.center[1]:0,n=e.center?e.center[2]:0;let o=e.radius||1;o<0&&(console.error("negative radius not allowed - will invert"),o*=-1);let s=e.heightSegments||18;s<0&&(console.error("negative heightSegments not allowed - will invert"),s*=-1),(s=Math.floor(t*s))<18&&(s=18);let l=e.widthSegments||18;l<0&&(console.error("negative widthSegments not allowed - will invert"),l*=-1),(l=Math.floor(t*l))<18&&(l=18);const c=[],u=[],h=[],d=[];let p,f,m,g,v,b,_,y,x,w,M,P,E,S,C;for(p=0;p<=s;p++)for(m=p*Math.PI/s,g=Math.sin(m),v=Math.cos(m),f=0;f<=l;f++)b=2*f*Math.PI/l,_=Math.sin(b),x=(y=Math.cos(b))*g,w=v,M=_*g,P=1-f/l,E=p/s,u.push(x),u.push(w),u.push(M),h.push(P),h.push(E),c.push(i+o*x),c.push(r+o*w),c.push(n+o*M);for(p=0;p<s;p++)for(f=0;f<l;f++)C=(S=p*(l+1)+f)+l+1,d.push(S+1),d.push(C+1),d.push(C),d.push(S+1),d.push(C),d.push(S);return a.utils.apply(e,{positions:c,normals:u,uv:h,indices:d})}({radius:.05})),material:n.center,pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.red,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisArrowHandle:t.addChild(new M.a(t,{geometry:i.arrowHeadHandle,material:n.pickable,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),xAxis:t.addChild(new M.a(t,{geometry:i.axis,material:n.red,matrix:function(){const e=r.math.translateMat4c(0,.5,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),xAxisHandle:t.addChild(new M.a(t,{geometry:i.axisHandle,material:n.pickable,matrix:function(){const e=r.math.translateMat4c(0,.5,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.green,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrowHandle:t.addChild(new M.a(t,{geometry:i.arrowHeadHandle,material:n.pickable,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1,opacity:.2}),!1),yShaft:t.addChild(new M.a(t,{geometry:i.axis,material:n.green,position:[0,-.5,0],pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yShaftHandle:t.addChild(new M.a(t,{geometry:i.axisHandle,material:n.pickable,position:[0,-.5,0],pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHead,material:n.blue,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[.8,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrowHandle:t.addChild(new M.a(t,{geometry:i.arrowHeadHandle,material:n.pickable,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[.8,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!0,collidable:!0,clippable:!1,visible:!1}),!1),zShaft:t.addChild(new M.a(t,{geometry:i.axis,material:n.blue,matrix:function(){const e=r.math.translateMat4c(0,.5,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),clippable:!1,pickable:!1,collidable:!0,visible:!1}),!1),zAxisHandle:t.addChild(new M.a(t,{geometry:i.axisHandle,material:n.pickable,matrix:function(){const e=r.math.translateMat4c(0,.5,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),clippable:!1,pickable:!0,collidable:!0,visible:!1}),!1)},this._affordanceMeshes={planeFrame:t.addChild(new M.a(t,{geometry:new c.a(t,l({center:[0,0,0],radius:2,tube:.01,radialSegments:4,tubeSegments:4,arc:2*Math.PI})),material:new u.a(t,{ambient:[1,1,1],diffuse:[0,0,0],emissive:[1,1,0]}),highlighted:!0,highlightMaterial:new h.a(t,{edges:!1,filled:!0,fillColor:[1,1,0],fillAlpha:1}),pickable:!1,collidable:!1,clippable:!1,visible:!1,scale:[1,1,1],rotation:[0,0,45]}),!1),xHoop:t.addChild(new M.a(t,{geometry:i.hoop,material:n.red,highlighted:!0,highlightMaterial:n.highlightRed,matrix:function(){const e=r.math.rotationMat4v(90*r.math.DEGTORAD,[0,1,0],r.math.identityMat4()),t=r.math.rotationMat4v(270*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yHoop:t.addChild(new M.a(t,{geometry:i.hoop,material:n.green,highlighted:!0,highlightMaterial:n.highlightGreen,rotation:[-90,0,0],pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zHoop:t.addChild(new M.a(t,{geometry:i.hoop,material:n.blue,highlighted:!0,highlightMaterial:n.highlightBlue,matrix:r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4()),pickable:!1,collidable:!0,clippable:!1,backfaces:!0,visible:!1}),!1),xAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHeadBig,material:n.red,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[0,0,1],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),yAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHeadBig,material:n.green,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(180*r.math.DEGTORAD,[1,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1),zAxisArrow:t.addChild(new M.a(t,{geometry:i.arrowHeadBig,material:n.blue,matrix:function(){const e=r.math.translateMat4c(0,1.1,0,r.math.identityMat4()),t=r.math.rotationMat4v(-90*r.math.DEGTORAD,[.8,0,0],r.math.identityMat4());return r.math.mulMat4(t,e,r.math.identityMat4())}(),pickable:!1,collidable:!0,clippable:!1,visible:!1}),!1)}}_bindEvents(){const e=this;var t=!1;const i=this._rootNode;var n=null,o=null;const s=r.math.vec2(),a=r.math.vec3([1,0,0]),l=r.math.vec3([0,1,0]),c=r.math.vec3([0,0,1]),u=this._viewer.scene.canvas.canvas,h=this._viewer.camera,d=this._viewer.scene;{const e=r.math.vec3([0,0,0]);let t=!0,n=-1;this._onCameraViewMatrix=d.camera.on("viewMatrix",()=>{t=!0}),this._onCameraProjMatrix=d.camera.on("projMatrix",()=>{t=!0}),this._onSceneTick=d.on("tick",()=>{const t=Math.abs(r.math.lenVec3(r.math.subVec3(d.camera.eye,this._pos,e)));if(t!==n&&"perspective"===h.projection){const e=Math.tan(h.perspective.fov*r.math.DEGTORAD)*t*.07;i.scale=[e,e,e],n=t}if("ortho"===h.projection){const e=h.ortho.scale/10;i.scale=[e,e,e],n=t}})}const p=function(){const e=new Float64Array(2);return function(t){if(t){for(var i=t.target,r=0,n=0;i.offsetParent;)r+=i.offsetLeft,n+=i.offsetTop,i=i.offsetParent;e[0]=t.pageX-r,e[1]=t.pageY-n}else t=window.event,e[0]=t.x,e[1]=t.y;return e}}(),f=function(){const t=r.math.mat4();return function(i,n){return r.math.quaternionToMat4(e._rootNode.quaternion,t),r.math.transformVec3(t,i,n),r.math.normalizeVec3(n),n}}();var m=function(){const e=r.math.vec3();return function(t){const i=Math.abs(t[0]);return i>Math.abs(t[1])&&i>Math.abs(t[2])?r.math.cross3Vec3(t,[0,1,0],e):r.math.cross3Vec3(t,[1,0,0],e),r.math.cross3Vec3(e,t,e),r.math.normalizeVec3(e),e}}();const g=function(){const t=r.math.vec3(),i=r.math.vec3(),n=r.math.vec4();return function(o,s,a){f(o,n);const l=m(n,s,a);b(s,l,t),b(a,l,i),r.math.subVec3(i,t);const c=r.math.dotVec3(i,n);e._pos[0]+=n[0]*c,e._pos[1]+=n[1]*c,e._pos[2]+=n[2]*c,e._rootNode.position=e._pos,e._sectionPlane&&(e._sectionPlane.pos=e._pos)}}();var v=function(){const t=r.math.vec4(),i=r.math.vec4(),n=r.math.vec4(),o=r.math.vec4();return function(s,a,l){if(f(s,o),!b(a,o,t)||!b(l,o,i)){const e=m(o,a,l);b(a,e,t,1),b(l,e,i,1);var c=r.math.dotVec3(t,o);t[0]-=c*o[0],t[1]-=c*o[1],t[2]-=c*o[2],c=r.math.dotVec3(i,o),i[0]-=c*o[0],i[1]-=c*o[1],i[2]-=c*o[2]}r.math.normalizeVec3(t),r.math.normalizeVec3(i),c=r.math.dotVec3(t,i),c=r.math.clamp(c,-1,1);var u=Math.acos(c)*r.math.RADTODEG;r.math.cross3Vec3(t,i,n),r.math.dotVec3(n,o)<0&&(u=-u),e._rootNode.rotate(s,u),_()}}(),b=function(){const t=r.math.vec4([0,0,0,1]),i=r.math.mat4();return function(n,o,s,a){a=a||0,t[0]=n[0]/u.width*2-1,t[1]=-(n[1]/u.height*2-1),t[2]=0,t[3]=1,r.math.mulMat4(h.projMatrix,h.viewMatrix,i),r.math.inverseMat4(i),r.math.transformVec4(i,t,t),r.math.mulVec4Scalar(t,1/t[3]);var l=h.eye;r.math.subVec4(t,l,t);const c=e._sectionPlane.pos;var d=-r.math.dotVec3(c,o)-a,p=r.math.dotVec3(o,t);if(Math.abs(p)>.005){var f=-(r.math.dotVec3(o,l)+d)/p;return r.math.mulVec3Scalar(t,f,s),r.math.addVec3(s,l),r.math.subVec3(s,c,s),!0}return!1}}();const _=function(){const t=r.math.vec3(),n=r.math.mat4();return function(){e.sectionPlane&&(r.math.quaternionToMat4(i.quaternion,n),r.math.transformVec3(n,[0,0,1],t),e._setSectionPlaneDir(t))}}();var y,x=!1;this._onCameraControlHover=this._viewer.cameraControl.on("hoverEnter",e=>{if(this._visible&&!x){var i;switch(t=!1,y&&(y.visible=!1),e.entity.id){case this._displayMeshes.xAxisArrowHandle.id:case this._displayMeshes.xAxisHandle.id:i=this._affordanceMeshes.xAxisArrow,n=0;break;case this._displayMeshes.yAxisArrowHandle.id:case this._displayMeshes.yShaftHandle.id:i=this._affordanceMeshes.yAxisArrow,n=1;break;case this._displayMeshes.zAxisArrowHandle.id:case this._displayMeshes.zAxisHandle.id:i=this._affordanceMeshes.zAxisArrow,n=2;break;case this._displayMeshes.xCurveHandle.id:i=this._affordanceMeshes.xHoop,n=3;break;case this._displayMeshes.yCurveHandle.id:i=this._affordanceMeshes.yHoop,n=4;break;case this._displayMeshes.zCurveHandle.id:i=this._affordanceMeshes.zHoop,n=5;break;default:return void(n=-1)}i&&(i.visible=!0),y=i,t=!0}}),this._onCameraControlHoverLeave=this._viewer.cameraControl.on("hoverOut",e=>{this._visible&&(y&&(y.visible=!1),y=null,n=-1)}),u.addEventListener("mousedown",this._canvasMouseDownListener=e=>{if(e.preventDefault(),this._visible&&t)switch(this._viewer.cameraControl.pointerEnabled=!1,e.which){case 1:x=!0;var i=p(e);o=n,s[0]=i[0],s[1]=i[1]}}),u.addEventListener("mousemove",this._canvasMouseMoveListener=e=>{if(!this._visible)return;if(!x)return;var t=p(e);const i=t[0],r=t[1];switch(o){case 0:g(a,s,t);break;case 1:g(l,s,t);break;case 2:g(c,s,t);break;case 3:v(a,s,t);break;case 4:v(l,s,t);break;case 5:v(c,s,t)}s[0]=i,s[1]=r}),u.addEventListener("mouseup",this._canvasMouseUpListener=e=>{this._visible&&(this._viewer.cameraControl.pointerEnabled=!0,x)&&(e.which,x=!1,t=!1)}),u.addEventListener("wheel",this._canvasWheelListener=e=>{this._visible&&Math.max(-1,Math.min(1,40*-e.deltaY))})}_destroy(){this._unbindEvents(),this._destroyNodes()}_unbindEvents(){const e=this._viewer,t=e.scene,i=t.canvas.canvas,r=e.camera,n=e.cameraControl;t.off(this._onSceneTick),i.removeEventListener("mousedown",this._canvasMouseDownListener),i.removeEventListener("mousemove",this._canvasMouseMoveListener),i.removeEventListener("mouseup",this._canvasMouseUpListener),i.removeEventListener("wheel",this._canvasWheelListener),r.off(this._onCameraViewMatrix),r.off(this._onCameraProjMatrix),n.off(this._onCameraControlHover),n.off(this._onCameraControlHoverLeave)}_destroyNodes(){this._setSectionPlane(null),this._rootNode.destroy(),this._displayMeshes={},this._affordanceMeshes={}}}var k=i(69),O=i(38),A=i(95),T=i(96);class D{constructor(e,t,i){this.id=i.id,this._sectionPlane=i,this._mesh=new M.a(t,{id:i.id,geometry:new c.a(t,Object(A.a)({xSize:.5,ySize:.5,zSize:.001})),material:new u.a(t,{emissive:[1,1,1],diffuse:[0,0,0],backfaces:!1}),edgeMaterial:new T.a(t,{edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1}),highlightMaterial:new h.a(t,{fill:!0,fillColor:[.5,1,.5],fillAlpha:.7,edges:!0,edgeColor:[0,0,0],edgeAlpha:1,edgeWidth:1}),selectedMaterial:new h.a(t,{fill:!0,fillColor:[0,0,1],fillAlpha:.7,edges:!0,edgeColor:[1,0,0],edgeAlpha:1,edgeWidth:1}),highlighted:!0,scale:[3,3,3],position:[0,0,0],rotation:[0,0,0],opacity:.3,edges:!0});{const e=r.math.vec3([0,0,0]),t=r.math.vec3(),i=r.math.vec3([0,0,1]),n=r.math.vec4(4),o=r.math.vec3(),s=()=>{const s=this._sectionPlane.scene.center,a=[-this._sectionPlane.dir[0],-this._sectionPlane.dir[1],-this._sectionPlane.dir[2]];r.math.subVec3(s,this._sectionPlane.pos,e);const l=-r.math.dotVec3(a,e);r.math.normalizeVec3(a),r.math.mulVec3Scalar(a,l,t);const c=r.math.vec3PairToQuaternion(i,this._sectionPlane.dir,n);o[0]=.1*t[0],o[1]=.1*t[1],o[2]=.1*t[2],this._mesh.quaternion=c,this._mesh.position=o};this._onSectionPlanePos=this._sectionPlane.on("pos",s),this._onSectionPlaneDir=this._sectionPlane.on("dir",s)}this._highlighted=!1,this._selected=!1}setHighlighted(e){this._highlighted=!!e,this._mesh.highlighted=this._highlighted,this._mesh.highlightMaterial.fillColor=e?[0,.7,0]:[0,0,0]}getHighlighted(){return this._highlighted}setSelected(e){this._selected=!!e,this._mesh.edgeMaterial.edgeWidth=e?3:1,this._mesh.highlightMaterial.edgeWidth=e?3:1}getSelected(){return this._selected}destroy(){this._sectionPlane.off(this._onSectionPlanePos),this._sectionPlane.off(this._onSectionPlaneDir),this._mesh.destroy()}}class R{constructor(e,t){if(!(t.onHoverEnterPlane&&t.onHoverLeavePlane&&t.onClickedNothing&&t.onClickedPlane))throw"Missing config(s): onHoverEnterPlane, onHoverLeavePlane, onClickedNothing || onClickedPlane";this.plugin=e,this._viewer=e.viewer,this._onHoverEnterPlane=t.onHoverEnterPlane,this._onHoverLeavePlane=t.onHoverLeavePlane,this._onClickedNothing=t.onClickedNothing,this._onClickedPlane=t.onClickedPlane,this._visible=!0,this._planes={},this._canvas=t.overviewCanvas,this._scene=new k.a(this._viewer,{canvasId:this._canvas.id,transparent:!0}),this._scene.clearLights(),new O.DirLight(this._scene,{dir:[.4,-.4,.8],color:[.8,1,1],intensity:1,space:"view"}),new O.DirLight(this._scene,{dir:[-.8,-.3,-.4],color:[.8,.8,.8],intensity:1,space:"view"}),new O.DirLight(this._scene,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"view"}),this._scene.camera,this._scene.camera.perspective.fov=70,this._zUp=!1;{const e=this._scene.camera,t=r.math.rotationMat4c(-90*r.math.DEGTORAD,1,0,0),i=r.math.vec3(),n=r.math.vec3(),o=r.math.vec3();this._synchCamera=()=>{const s=this._viewer.camera.eye,a=this._viewer.camera.look,l=this._viewer.camera.up;r.math.mulVec3Scalar(r.math.normalizeVec3(r.math.subVec3(s,a,i)),7),this._zUp?(r.math.transformVec3(t,i,n),r.math.transformVec3(t,l,o),e.look=[0,0,0],e.eye=r.math.transformVec3(t,i,n),e.up=r.math.transformPoint3(t,l,o)):(e.look=[0,0,0],e.eye=i,e.up=l)}}this._onViewerCameraMatrix=this._viewer.camera.on("matrix",this._synchCamera),this._onViewerCameraWorldAxis=this._viewer.camera.on("worldAxis",this._synchCamera),this._onViewerCameraFOV=this._viewer.camera.perspective.on("fov",e=>{this._scene.camera.perspective.fov=e});var i=null;this._onInputMouseMove=this._scene.input.on("mousemove",e=>{const t=this._scene.pick({canvasPos:e});t?i&&t.entity.id===i.id||(i&&this._planes[i.id]&&this._onHoverLeavePlane(i.id),i=t.entity,this._planes[i.id]&&this._onHoverEnterPlane(i.id)):i&&(this._onHoverLeavePlane(i.id),i=null)}),this._scene.canvas.canvas.addEventListener("mouseup",this._onCanvasMouseUp=()=>{i?this._planes[i.id]&&this._onClickedPlane(i.id):this._onClickedNothing()}),this._scene.canvas.canvas.addEventListener("mouseout",this._onCanvasMouseOut=()=>{i&&(this._onHoverLeavePlane(i.id),i=null)}),this.setVisible(t.overviewVisible)}addSectionPlane(e){this._planes[e.id]=new D(this,this._scene,e)}setPlaneHighlighted(e,t){const i=this._planes[e];i&&i.setHighlighted(t)}setPlaneSelected(e,t){const i=this._planes[e];i&&i.setSelected(t)}removeSectionPlane(e){const t=this._planes[e.id];t&&(t.destroy(),delete this._planes[e.id])}setVisible(e=!0){this._visible=e,this._canvas.style.visibility=e?"visible":"hidden"}getVisible(){return this._visible}destroy(){this._viewer.camera.off(this._onViewerCameraMatrix),this._viewer.camera.off(this._onViewerCameraWorldAxis),this._viewer.camera.perspective.off(this._onViewerCameraFOV),this._scene.input.off(this._onInputMouseMove),this._scene.canvas.canvas.removeEventListener("mouseup",this._onCanvasMouseUp),this._scene.canvas.canvas.removeEventListener("mouseout",this._onCanvasMouseOut),this._scene.destroy()}}const L=r.math.AABB3(),B=r.math.vec3();class I extends n.a{constructor(e,t={}){if(super("SectionPlanes",e),this._freeControls=[],this._sectionPlanes=e.scene.sectionPlanes,this._controls={},this._shownControlId=null,t.overviewCanvasId){const e=document.getElementById(t.overviewCanvasId);e?this._overview=new R(this,{overviewCanvas:e,visible:t.overviewVisible,onHoverEnterPlane:e=>{this._overview.setPlaneHighlighted(e,!0)},onHoverLeavePlane:e=>{this._overview.setPlaneHighlighted(e,!1)},onClickedPlane:e=>{if(this.getShownControl()===e)return void this.hideControl();this.showControl(e);const t=this.sectionPlanes[e].pos;L.set(this.viewer.scene.aabb),r.math.getAABB3Center(L,B),L[0]+=t[0]-B[0],L[1]+=t[1]-B[1],L[2]+=t[2]-B[2],L[3]+=t[0]-B[0],L[4]+=t[1]-B[1],L[5]+=t[2]-B[2],this.viewer.cameraFlight.flyTo({aabb:L,fitFOV:65})},onClickedNothing:()=>{this.hideControl()}}):this.error("Can't find overview canvas: '"+t.overviewCanvasId+"' - will create plugin without overview")}this._onSceneSectionPlaneCreated=e.scene.on("sectionPlaneCreated",e=>{this._sectionPlaneCreated(e)})}setOverviewVisible(e){this._overview&&this._overview.setVisible(e)}getOverviewVisible(){if(this._overview)return this._overview.getVisible()}get sectionPlanes(){return this._sectionPlanes}createSectionPlane(e={}){return void 0!==e.id&&null!==e.id&&this.viewer.scene.components[e.id]&&(this.error("Viewer component with this ID already exists: "+e.id),delete e.id),new o.a(this.viewer.scene,{id:e.id,pos:e.pos,dir:e.dir,active:!0})}_sectionPlaneCreated(e){const t=this._freeControls.length>0?this._freeControls.pop():new C(this);t._setSectionPlane(e),t.setVisible(!1),this._controls[e.id]=t,this._overview&&this._overview.addSectionPlane(e),e.once("destroyed",()=>{this._sectionPlaneDestroyed(e)})}flipSectionPlanes(){const e=this.viewer.scene.sectionPlanes;for(let t in e)e[t].flipDir()}showControl(e){const t=this._controls[e];t?(this.hideControl(),t.setVisible(!0),this._overview&&this._overview.setPlaneSelected(e,!0),this._shownControlId=e):this.error("Control not found: "+e)}getShownControl(){return this._shownControlId}hideControl(){for(var e in this._controls)this._controls.hasOwnProperty(e)&&(this._controls[e].setVisible(!1),this._overview&&this._overview.setPlaneSelected(e,!1));this._shownControlId=null}destroySectionPlane(e){var t=this.viewer.scene.sectionPlanes[e];t?(this._sectionPlaneDestroyed(t),t.destroy(),e===this._shownControlId&&(this._shownControlId=null)):this.error("SectionPlane not found: "+e)}_sectionPlaneDestroyed(e){this._overview&&this._overview.removeSectionPlane(e);const t=this._controls[e.id];t&&(t.setVisible(!1),t._setSectionPlane(null),delete this._controls[e.id],this._freeControls.push(t))}clear(){const e=Object.keys(this._sectionPlanes);for(var t=0,i=e.length;t<i;t++)this.destroySectionPlane(e[t])}send(e,t){switch(e){case"snapshotStarting":for(let e in this._controls)this._controls.hasOwnProperty(e)&&this._controls[e].setCulled(!0);break;case"snapshotFinished":for(let e in this._controls)this._controls.hasOwnProperty(e)&&this._controls[e].setCulled(!1);break;case"clearSectionPlanes":this.clear()}}destroy(){this.clear(),this._overview&&this._overview.destroy(),this._destroyFreeControls(),super.destroy()}_destroyFreeControls(){for(var e=this._freeControls.pop();e;)e._destroy(),e=this._freeControls.pop();this.viewer.scene.off(this._onSceneSectionPlaneCreated)}}},function(e,t,i){"use strict";i.r(t),i.d(t,"StoreyViewsPlugin",(function(){return f}));var r=i(34);class n{constructor(e,t,i,r,n){this.plugin=e,this.storeyId=r,this.modelId=i,this.aabb=t.slice(),this.numObjects=n}}const o={IfcSlab:{visible:!0,edges:!1,colorize:[1,1,1,1]},IfcWall:{visible:!0,edges:!1,colorize:[.1,.1,.1,1]},IfcWallStandardCase:{visible:!0,edges:!1,colorize:[.1,.1,.1,1]},IfcDoor:{visible:!0,edges:!1,colorize:[.5,.5,.5,1]},IfcWindow:{visible:!0,edges:!1,colorize:[.5,.5,.5,1]},IfcColumn:{visible:!0,edges:!1,colorize:[.5,.5,.5,1]},IfcCurtainWall:{visible:!0,edges:!1,colorize:[.5,.5,.5,1]},IfcStair:{visible:!0,edges:!1,colorize:[.7,.7,.7,1]},IfcStairFlight:{visible:!0,edges:!1,colorize:[.7,.7,.7,1]},IfcRamp:{visible:!0,edges:!1,colorize:[.7,.7,.7,1]},IfcFurniture:{visible:!0,edges:!1,colorize:[.7,.7,.7,1]},IfcFooting:{visible:!0,edges:!1,colorize:[.7,.7,.7,1]},IfcFloor:{visible:!0,edges:!1,colorize:[1,1,1,1]},DEFAULT:{visible:!1}};var s=i(0),a=i(8);const l=s.math.vec3();class c{constructor(){this.objectsVisible=[],this.objectsEdges=[],this.objectsXrayed=[],this.objectsHighlighted=[],this.objectsSelected=[],this.objectsClippable=[],this.objectsPickable=[],this.objectsColorize=[],this.objectsHasColorize=[],this.objectsOpacity=[],this.numObjects=0}saveObjects(e,t){this.numObjects=0,this._mask=t?a.utils.apply(t,{}):null;const i=e.objects,r=!t||t.visible,n=!t||t.edges,o=!t||t.xrayed,s=!t||t.highlighted,l=!t||t.selected,c=!t||t.clippable,u=!t||t.pickable,h=!t||t.colorize,d=!t||t.opacity;for(let e in i)if(i.hasOwnProperty(e)){const t=i[e],a=this.numObjects;if(r&&(this.objectsVisible[a]=t.visible),n&&(this.objectsEdges[a]=t.edges),o&&(this.objectsXrayed[a]=t.xrayed),s&&(this.objectsHighlighted[a]=t.highlighted),l&&(this.objectsSelected[a]=t.selected),c&&(this.objectsClippable[a]=t.clippable),u&&(this.objectsPickable[a]=t.pickable),h){const e=t.colorize;e?(this.objectsColorize[3*a+0]=e[0],this.objectsColorize[3*a+1]=e[1],this.objectsColorize[3*a+2]=e[2],this.objectsHasColorize[a]=!0):this.objectsHasColorize[a]=!1}d&&(this.objectsOpacity[a]=t.opacity),this.numObjects++}}restoreObjects(e){const t=this._mask,i=!t||t.visible,r=!t||t.edges,n=!t||t.xrayed,o=!t||t.highlighted,s=!t||t.selected,a=!t||t.clippable,c=!t||t.pickable,u=!t||t.colorize,h=!t||t.opacity;var d=0;const p=e.objects;for(let e in p)if(p.hasOwnProperty(e)){const t=p[e];i&&(t.visible=this.objectsVisible[d]),r&&(t.edges=this.objectsEdges[d]),n&&(t.xrayed=this.objectsXrayed[d]),o&&(t.highlighted=this.objectsHighlighted[d]),s&&(t.selected=this.objectsSelected[d]),a&&(t.clippable=this.objectsClippable[d]),c&&(t.pickable=this.objectsPickable[d]),u&&(this.objectsHasColorize[d]?(l[0]=this.objectsColorize[3*d+0],l[1]=this.objectsColorize[3*d+1],l[2]=this.objectsColorize[3*d+2],t.colorize=l):t.colorize=null),h&&(t.opacity=this.objectsOpacity[d]),d++}}}class u{constructor(e){this._eye=s.math.vec3(),this._look=s.math.vec3(),this._up=s.math.vec3(),this._projection={},e&&this.saveCamera(e)}saveCamera(e){const t=e.camera,i=t.project;switch(this._eye.set(t.eye),this._look.set(t.look),this._up.set(t.up),t.projection){case"perspective":this._projection={projection:"perspective",fov:i.fov,fovAxis:i.fovAxis,near:i.near,far:i.far};break;case"ortho":this._projection={projection:"ortho",scale:i.scale,near:i.near,far:i.far};break;case"frustum":this._projection={projection:"frustum",left:i.left,right:i.right,top:i.top,bottom:i.bottom,near:i.near,far:i.far};break;case"custom":this._projection={projection:"custom",matrix:i.matrix.slice()}}}restoreCamera(e,t){const i=e.camera,r=this._projection;function n(){switch(r.type){case"perspective":i.perspective.fov=r.fov,i.perspective.fovAxis=r.fovAxis,i.perspective.near=r.near,i.perspective.far=r.far;break;case"ortho":i.ortho.scale=r.scale,i.ortho.near=r.near,i.ortho.far=r.far;break;case"frustum":i.frustum.left=r.left,i.frustum.right=r.right,i.frustum.top=r.top,i.frustum.bottom=r.bottom,i.frustum.near=r.near,i.frustum.far=r.far;break;case"custom":i.customProjection.matrix=r.matrix}}t?e.viewer.cameraFlight.flyTo({eye:this._eye,look:this._look,up:this._up,orthoScale:r.scale,projection:r.projection},()=>{n(),t()}):(i.eye=this._eye,i.look=this._look,i.up=this._up,n(),i.projection=r.projection)}}class h{constructor(e,t,i,r,n,o){this.storeyId=e,this.imageData=t,this.format=i,this.width=r,this.height=n}}const d=s.math.vec3(),p=s.math.mat4();class f extends r.a{constructor(e,t={}){super("StoreyViews",e),this._objectsMemento=new c,this._cameraMemento=new u,this.storeys={},this.modelStoreys={},this.objectStates=t.objectStates,this._onModelLoaded=this.viewer.scene.on("modelLoaded",e=>{this._registerModelStoreys(e),this.fire("storeys",this.storeys)})}_registerModelStoreys(e){const t=this.viewer,i=t.scene,r=t.metaScene,o=r.metaModels[e],s=i.models[e];if(!o||!o.rootMetaObject)return;const a=o.rootMetaObject.getObjectIDsInSubtreeByType(["IfcBuildingStorey"]);for(let t=0,o=a.length;t<o;t++){const o=a[t],l=r.metaObjects[o].getObjectIDsInSubtree(),c=i.getAABB(l),u=Math.random()>.5?l.length:0,h=new n(this,c,e,o,u);h._onModelDestroyed=s.once("destroyed",()=>{this._deregisterModelStoreys(e),this.fire("storeys",this.storeys)}),this.storeys[o]=h,this.modelStoreys[e]||(this.modelStoreys[e]={}),this.modelStoreys[e][o]=h}}_deregisterModelStoreys(e){const t=this.modelStoreys[e];if(t){const i=this.viewer.scene;for(let e in t)if(t.hasOwnProperty(e)){const r=t[e],n=i.models[r.modelId];n&&n.off(r._onModelDestroyed),delete this.storeys[e]}delete this.modelStoreys[e]}}set objectStates(e){this._objectStates=e||o}get objectStates(){return this._objectStates}gotoStoreyCamera(e,t={}){const i=this.storeys[e];if(!i)return this.error("IfcBuildingStorey not found with this ID: "+e),void(t.done&&t.done());const r=this.viewer,n=r.scene.camera,o=i.aabb;if(o[3]<o[0]||o[4]<o[1]||o[5]<o[2])return void(t.done&&t.done());if(o[3]===o[0]&&o[4]===o[1]&&o[5]===o[2])return void(t.done&&t.done());const l=s.math.getAABB3Center(o),c=s.math.getAABB3Diag(o),u=Math.abs(c/Math.tan(45*s.math.DEGTORAD)),h=1.3*c,p=d;p[0]=l[0]+n.worldUp[0]*u,p[1]=l[1]+n.worldUp[1]*u,p[2]=l[2]+n.worldUp[2]*u;const f=n.worldForward;t.done?r.cameraFlight.flyTo(a.utils.apply(t,{eye:p,look:l,up:f,orthoScale:h}),()=>{t.done()}):(r.cameraFlight.jumpTo(a.utils.apply(t,{eye:p,look:l,up:f,orthoScale:h})),r.camera.ortho.scale=h)}showStoreyObjects(e,t={}){if(!this.storeys[e])return void this.error("IfcBuildingStorey not found with this ID: "+e);const i=this.viewer,r=i.scene;i.metaScene.metaObjects[e]&&(t.hideOthers&&r.setObjectsVisible(i.scene.visibleObjectIds,!1),this.withStoreyObjects(e,(e,i)=>{if(e)if(t.useObjectStates){const t=this._objectStates[i.type]||this._objectStates.DEFAULT;t&&(e.visible=t.visible,e.edges=t.edges,t.colorize&&(e.colorize=t.colorize),null!==t.opacity&&void 0!==t.opacity&&(e.opacity=t.opacity))}else e.visible=!0}))}withStoreyObjects(e,t){const i=this.viewer,r=i.scene,n=i.metaScene,o=n.metaObjects[e];if(!o)return;const s=o.getObjectIDsInSubtree();for(var a=0,l=s.length;a<l;a++){const e=s[a],i=n.metaObjects[e],o=r.objects[e];o&&t(o,i)}}createStoreyMap(e,t={}){const i=this.storeys[e];if(!i)return this.error("IfcBuildingStorey not found with this ID: "+e),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==";const r=this.viewer,n=r.scene,o=t.format||"png",s=i.aabb,l=(s[5]-s[2])/(s[3]-s[0]),c=t.padding||0;let u,d;t.width&&t.height?(u=t.width,d=t.height):t.height?u=(d=t.height)/l:d=t.width?(u=t.width)*l:(u=300)*l,this._objectsMemento.saveObjects(n),this._cameraMemento.saveCamera(n),r.beginSnapshot(),this.showStoreyObjects(e,a.utils.apply(t,{useObjectStates:!0,hideOthers:!0})),this._arrangeStoreyMapCamera(i);const p=r.getSnapshot({width:u,height:d,format:o});return this._objectsMemento.restoreObjects(n),this._cameraMemento.restoreCamera(n),r.endSnapshot(),new h(e,p,o,u,d,c)}_arrangeStoreyMapCamera(e){const t=this.viewer,i=t.scene.camera,r=e.aabb,n=s.math.getAABB3Center(r),o=d;o[0]=n[0]+.5*i.worldUp[0],o[1]=n[1]+.5*i.worldUp[1],o[2]=n[2]+.5*i.worldUp[2];const a=i.worldForward;t.cameraFlight.jumpTo({eye:o,look:n,up:a});const l=(r[3]-r[0])/2,c=(r[4]-r[1])/2,u=(r[5]-r[2])/2,h=-l,f=+l,m=-c,g=+c,v=-u,b=+u;t.camera.customProjection.matrix=s.math.orthoMat4c(h,f,v,b,m,g,p),t.camera.projection="customProjection"}pickStoreyMap(e,t,i={}){const r=e.storeyId,n=this.storeys[r];if(!n)return this.error("IfcBuildingStorey not found with this ID: "+r),null;const o=1-t[0]/e.width,a=1-t[1]/e.height,l=n.aabb,c=l[0],u=l[1],h=l[2],f=l[3]-c,m=l[4]-u,g=l[5]-h,v=s.math.vec3([c+f*o,u+.5*m,h+g*a]),b=s.math.vec3([0,-1,0]),_=s.math.addVec3(v,b,d),y=this.viewer.camera.worldForward,x=s.math.lookAtMat4v(v,_,y,p),w=this.viewer.scene.pick({pickSurface:i.pickSurface,pickInvisible:!0,matrix:x});if(w){const e=this.viewer.metaScene.metaObjects[w.entity.id],t=this.objectStates[e.type];if(!t||!t.visible)return null}return w}getStoreyContainingWorldPos(e){for(var t in this.storeys){const i=this.storeys[t];if(s.math.point3AABB3Intersect(i.aabb,e))return t}return null}worldPosToStoreyMap(e,t,i){const r=e.storeyId,n=this.storeys[r];if(!n)return this.error("IfcBuildingStorey not found with this ID: "+r),!1;const o=n.aabb,s=o[0],a=o[1],l=o[2],c=o[3]-s,u=o[4]-a,h=o[5]-l,d=this.viewer.camera.worldUp,p=d[0]>d[1]&&d[0]>d[2],f=!p&&d[1]>d[0]&&d[1]>d[2],m=(!p&&!f&&d[2]>d[0]&&(d[2],d[1]),e.width/c),g=f?e.height/h:e.height/u;return i[0]=Math.floor(e.width-(t[0]-s)*m),i[1]=Math.floor(e.height-(t[2]-l)*g),i[0]>=0&&i[0]<e.width&&i[1]>=0&&i[1]<=e.height}worldDirToStoreyMap(e,t,i){const r=this.viewer.camera,n=r.eye,o=r.look,a=s.math.subVec3(o,n,d),l=r.worldUp,c=l[0]>l[1]&&l[0]>l[2],u=!c&&l[1]>l[0]&&l[1]>l[2];!c&&!u&&l[2]>l[0]&&(l[2],l[1]),c?(i[0]=a[1],i[1]=a[2]):u?(i[0]=a[0],i[1]=a[2]):(i[0]=a[0],i[1]=a[1]),s.math.normalizeVec2(i)}destroy(){this.viewer.scene.off(this._onModelLoaded),super.destroy()}}},function(e,t,i){"use strict";i.r(t),i.d(t,"NavCubePlugin",(function(){return M}));var r=i(34),n=i(0),o=i(69),s=i(38),a=i(17),l=i(26),c=i(29),u=i(16),h=i(20),d=i(8);const p={funcAdd:"FUNC_ADD",funcSubtract:"FUNC_SUBTRACT",funcReverseSubtract:"FUNC_REVERSE_SUBTRACT",zero:"ZERO",one:"ONE",srcColor:"SRC_COLOR",oneMinusSrcColor:"ONE_MINUS_SRC_COLOR",dstColor:"DST_COLOR",oneMinusDstColor:"ONE_MINUS_DST_COLOR",srcAlpha:"SRC_ALPHA",oneMinusSrcAlpha:"ONE_MINUS_SRC_ALPHA",dstAlpha:"DST_ALPHA",oneMinusDstAlpha:"ONE_MINUS_DST_ALPHA",contantColor:"CONSTANT_COLOR",oneMinusConstantColor:"ONE_MINUS_CONSTANT_COLOR",constantAlpha:"CONSTANT_ALPHA",oneMinusConstantAlpha:"ONE_MINUS_CONSTANT_ALPHA",srcAlphaSaturate:"SRC_ALPHA_SATURATE",front:"FRONT",back:"BACK",frontAndBack:"FRONT_AND_BACK",never:"NEVER",less:"LESS",equal:"EQUAL",lequal:"LEQUAL",greater:"GREATER",notequal:"NOTEQUAL",gequal:"GEQUAL",always:"ALWAYS",cw:"CW",ccw:"CCW",linear:"LINEAR",nearest:"NEAREST",linearMipmapNearest:"LINEAR_MIPMAP_NEAREST",nearestMipmapNearest:"NEAREST_MIPMAP_NEAREST",nearestMipmapLinear:"NEAREST_MIPMAP_LINEAR",linearMipmapLinear:"LINEAR_MIPMAP_LINEAR",repeat:"REPEAT",clampToEdge:"CLAMP_TO_EDGE",mirroredRepeat:"MIRRORED_REPEAT",alpha:"ALPHA",rgb:"RGB",rgba:"RGBA",luminance:"LUMINANCE",luminanceAlpha:"LUMINANCE_ALPHA",textureBinding2D:"TEXTURE_BINDING_2D",textureBindingCubeMap:"TEXTURE_BINDING_CUBE_MAP",compareRToTexture:"COMPARE_R_TO_TEXTURE",unsignedByte:"UNSIGNED_BYTE"};function f(e,t,i){if(void 0===t)return i;const r=p[t];return void 0===r?i:e[r]}const m=new Uint8Array([0,0,0,1]);class g{constructor(e,t){this.gl=e,this.target=t||e.TEXTURE_2D,this.texture=e.createTexture(),this.setPreloadColor([0,0,0,0]),this.allocated=!0}setPreloadColor(e){e?(m[0]=Math.floor(255*e[0]),m[1]=Math.floor(255*e[1]),m[2]=Math.floor(255*e[2]),m[3]=Math.floor(255*(void 0!==e[3]?e[3]:1))):(m[0]=0,m[1]=0,m[2]=0,m[3]=255);const t=this.gl;if(t.bindTexture(this.target,this.texture),t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,t.NEAREST),this.target===t.TEXTURE_CUBE_MAP){const e=[t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(let i=0,r=e.length;i<r;i++)t.texImage2D(e[i],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,m)}else t.texImage2D(this.target,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,m);t.bindTexture(this.target,null)}setTarget(e){this.target=e||this.gl.TEXTURE_2D}setImage(e,t){const i=this.gl;if(i.bindTexture(this.target,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t.flipY),this.target===i.TEXTURE_CUBE_MAP){if(d.utils.isArray(e)){const t=e,r=[i.TEXTURE_CUBE_MAP_POSITIVE_X,i.TEXTURE_CUBE_MAP_NEGATIVE_X,i.TEXTURE_CUBE_MAP_POSITIVE_Y,i.TEXTURE_CUBE_MAP_NEGATIVE_Y,i.TEXTURE_CUBE_MAP_POSITIVE_Z,i.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(let e=0,n=r.length;e<n;e++)i.texImage2D(r[e],0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t[e])}}else i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e);i.bindTexture(this.target,null)}setProps(e){const t=this.gl;if(t.bindTexture(this.target,this.texture),e.minFilter){const i=f(t,e.minFilter);i&&(t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,i),i!==t.NEAREST_MIPMAP_NEAREST&&i!==t.LINEAR_MIPMAP_NEAREST&&i!==t.NEAREST_MIPMAP_LINEAR&&i!==t.LINEAR_MIPMAP_LINEAR||t.generateMipmap(this.target))}if(e.magFilter){const i=f(t,e.magFilter);i&&t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,i)}if(e.wrapS){const i=f(t,e.wrapS);i&&t.texParameteri(this.target,t.TEXTURE_WRAP_S,i)}if(e.wrapT){const i=f(t,e.wrapT);i&&t.texParameteri(this.target,t.TEXTURE_WRAP_T,i)}t.bindTexture(this.target,null)}bind(e){if(this.allocated){if(this.texture){const t=this.gl;return t.activeTexture(t["TEXTURE"+e]),t.bindTexture(this.target,this.texture),!0}return!1}}unbind(e){if(this.allocated&&this.texture){const t=this.gl;t.activeTexture(t["TEXTURE"+e]),t.bindTexture(this.target,null)}}destroy(){this.allocated&&this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}var v=i(15);function b(e){if(!_(e.width)||!_(e.height)){const t=document.createElement("canvas");t.width=y(e.width),t.height=y(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}return e}function _(e){return 0==(e&e-1)}function y(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}class x extends u.a{get type(){return"Texture"}constructor(e,t={}){super(e,t),this._state=new h.a({texture:new g(this.scene.canvas.gl),matrix:n.math.identityMat4(),hasMatrix:t.translate&&(0!==t.translate[0]||0!==t.translate[1])||!!t.rotate||t.scale&&(0!==t.scale[0]||0!==t.scale[1]),minFilter:this._checkMinFilter(t.minFilter),magFilter:this._checkMagFilter(t.magFilter),wrapS:this._checkWrapS(t.wrapS),wrapT:this._checkWrapT(t.wrapT),flipY:this._checkFlipY(t.flipY),encoding:this._checkEncoding(t.encoding)}),this._src=null,this._image=null,this._translate=n.math.vec2([0,0]),this._scale=n.math.vec2([1,1]),this._rotate=n.math.vec2([0,0]),this._matrixDirty=!1,this.translate=t.translate,this.scale=t.scale,this.rotate=t.rotate,t.src?this.src=t.src:t.image&&(this.image=t.image),v.a.memory.textures++}_checkMinFilter(e){return"linear"!==(e=e||"linearMipmapLinear")&&"linearMipmapNearest"!==e&&"linearMipmapLinear"!==e&&"nearestMipmapLinear"!==e&&"nearestMipmapNearest"!==e&&(this.error("Unsupported value for 'minFilter': '"+e+"' - supported values are 'linear', 'linearMipmapNearest', 'nearestMipmapNearest', 'nearestMipmapLinear' and 'linearMipmapLinear'. Defaulting to 'linearMipmapLinear'."),e="linearMipmapLinear"),e}_checkMagFilter(e){return"linear"!==(e=e||"linear")&&"nearest"!==e&&(this.error("Unsupported value for 'magFilter': '"+e+"' - supported values are 'linear' and 'nearest'. Defaulting to 'linear'."),e="linear"),e}_checkFilter(e){return"linear"!==(e=e||"linear")&&"nearest"!==e&&(this.error("Unsupported value for 'magFilter': '"+e+"' - supported values are 'linear' and 'nearest'. Defaulting to 'linear'."),e="linear"),e}_checkWrapS(e){return"clampToEdge"!==(e=e||"repeat")&&"mirroredRepeat"!==e&&"repeat"!==e&&(this.error("Unsupported value for 'wrapS': '"+e+"' - supported values are 'clampToEdge', 'mirroredRepeat' and 'repeat'. Defaulting to 'repeat'."),e="repeat"),e}_checkWrapT(e){return"clampToEdge"!==(e=e||"repeat")&&"mirroredRepeat"!==e&&"repeat"!==e&&(this.error("Unsupported value for 'wrapT': '"+e+"' - supported values are 'clampToEdge', 'mirroredRepeat' and 'repeat'. Defaulting to 'repeat'."),e="repeat"),e}_checkFlipY(e){return!!e}_checkEncoding(e){return"linear"!==(e=e||"linear")&&"sRGB"!==e&&"gamma"!==e&&(this.error("Unsupported value for 'encoding': '"+e+"' - supported values are 'linear', 'sRGB', 'gamma'. Defaulting to 'linear'."),e="linear"),e}_webglContextRestored(){this._state.texture=new g(this.scene.canvas.gl),this._image?this.image=this._image:this._src&&(this.src=this._src)}_update(){const e=this._state;if(this._matrixDirty){let t,i;0===this._translate[0]&&0===this._translate[1]||(t=n.math.translationMat4v([this._translate[0],this._translate[1],0],this._state.matrix)),1===this._scale[0]&&1===this._scale[1]||(i=n.math.scalingMat4v([this._scale[0],this._scale[1],1]),t=t?n.math.mulMat4(t,i):i),0!==this._rotate&&(i=n.math.rotationMat4v(.0174532925*this._rotate,[0,0,1]),t=t?n.math.mulMat4(t,i):i),t&&(e.matrix=t),this._matrixDirty=!1}this.glRedraw()}set image(e){this._image=b(e),this._image.crossOrigin="Anonymous",this._state.texture.setImage(this._image,this._state),this._state.texture.setProps(this._state),this._src=null,this.glRedraw()}get image(){return this._image}set src(e){this.scene.loading++,this.scene.canvas.spinner.processes++;const t=this;let i=new Image;i.onload=function(){i=b(i),t._state.texture.setImage(i,t._state),t._state.texture.setProps(t._state),t.scene.loading--,t.scene.canvas.spinner.processes--,t.glRedraw()},i.src=e,this._src=e,this._image=null}get src(){return this._src}set translate(e){this._translate.set(e||[0,0]),this._matrixDirty=!0,this._needUpdate()}get translate(){return this._translate}set scale(e){this._scale.set(e||[1,1]),this._matrixDirty=!0,this._needUpdate()}get scale(){return this._scale}set rotate(e){e=e||0,this._rotate!==e&&(this._rotate=e,this._matrixDirty=!0,this._needUpdate())}get rotate(){return this._rotate}get minFilter(){return this._state.minFilter}get magFilter(){return this._state.magFilter}get wrapS(){return this._state.wrapS}get wrapT(){return this._state.wrapT}get flipY(){return this._state.flipY}get encoding(){return this._state.encoding}destroy(){super.destroy(),this._state.texture&&this._state.texture.destroy(),this._state.destroy(),v.a.memory.textures--}}var w=i(49);class M extends r.a{constructor(e,t={}){super("NavCube",e,t),e.navCube=this;try{this._navCubeScene=new o.a(e,{canvasId:t.canvasId,canvasElement:t.canvasElement,transparent:!0}),this._navCubeCanvas=this._navCubeScene.canvas.canvas,this._navCubeScene.input.keyboardEnabled=!1}catch(e){return void this.error(e)}const i=this._navCubeScene;i.clearLights(),new s.DirLight(i,{dir:[.4,-.4,.8],color:[.8,1,1],intensity:1,space:"view"}),new s.DirLight(i,{dir:[-.8,-.3,-.4],color:[.8,.8,.8],intensity:1,space:"view"}),new s.DirLight(i,{dir:[.8,-.6,-.8],color:[1,1,1],intensity:1,space:"view"}),this._navCubeCamera=i.camera,this._navCubeCamera.ortho.scale=7,this._navCubeCamera.ortho.near=.1,this._navCubeCamera.ortho.far=2e3,this._zUp=Boolean(e.camera.zUp);var r=this;this._synchCamera=function(){var t=n.math.rotationMat4c(-90*n.math.DEGTORAD,1,0,0),i=n.math.vec3(),o=n.math.vec3(),s=n.math.vec3();return function(){var a=e.camera.eye,l=e.camera.look,c=e.camera.up;i=n.math.mulVec3Scalar(n.math.normalizeVec3(n.math.subVec3(a,l,i)),5),r._zUp?(n.math.transformVec3(t,i,o),n.math.transformVec3(t,c,s),r._navCubeCamera.look=[0,0,0],r._navCubeCamera.eye=n.math.transformVec3(t,i,o),r._navCubeCamera.up=n.math.transformPoint3(t,c,s)):(r._navCubeCamera.look=[0,0,0],r._navCubeCamera.eye=i,r._navCubeCamera.up=c)}}(),this._cubeTextureCanvas=new function(e,t={}){const i="lightgrey",r=t.hoverColor||"rgba(0,0,0,0.4)";var o=500+500/3,s=o/24;const a=[{boundary:[6,6,6,6],color:t.frontColor||t.color||"#55FF55"},{boundary:[18,6,6,6],color:t.backColor||t.color||"#55FF55"},{boundary:[12,6,6,6],color:t.leftColor||t.color||"#FF5555"},{boundary:[0,6,6,6],color:t.rightColor||t.color||"#FF5555"},{boundary:[6,0,6,6],color:t.topColor||t.color||"#7777FF"},{boundary:[6,12,6,6],color:t.bottomColor||t.color||"#7777FF"}],l=[{label:"front",boundaries:[[7,7,4,4]],dir:[0,1,0],up:[0,0,1]},{label:"back",boundaries:[[19,7,4,4]],dir:[0,-1,0],up:[0,0,1]},{label:"right",boundaries:[[13,7,4,4]],dir:[-1,0,0],up:[0,0,1]},{label:"left",boundaries:[[1,7,4,4]],dir:[1,0,0],up:[0,0,1]},{label:"top",boundaries:[[7,1,4,4]],dir:[0,0,-1],up:[0,1,0]},{label:"bottom",boundaries:[[7,13,4,4]],dir:[0,0,1],up:[0,-1,0]},{boundaries:[[7,5,4,2]],dir:[0,1,-1],up:[0,1,1]},{boundaries:[[1,6,4,1],[6,1,1,4]],dir:[1,0,-1],up:[1,0,1]},{boundaries:[[7,0,4,1],[19,6,4,1]],dir:[0,-1,-1],up:[0,-1,1]},{boundaries:[[13,6,4,1],[11,1,1,4]],dir:[-1,0,-1],up:[-1,0,1]},{boundaries:[[7,11,4,2]],dir:[0,1,1],up:[0,-1,1]},{boundaries:[[1,11,4,1],[6,13,1,4]],dir:[1,0,1],up:[-1,0,1]},{boundaries:[[7,17,4,1],[19,11,4,1]],dir:[0,-1,1],up:[0,1,1]},{boundaries:[[13,11,4,1],[11,13,1,4]],dir:[-1,0,1],up:[1,0,1]},{boundaries:[[5,7,2,4]],dir:[1,1,0],up:[0,0,1]},{boundaries:[[11,7,2,4]],dir:[-1,1,0],up:[0,0,1]},{boundaries:[[17,7,2,4]],dir:[-1,-1,0],up:[0,0,1]},{boundaries:[[0,7,1,4],[23,7,1,4]],dir:[1,-1,0],up:[0,0,1]},{boundaries:[[5,11,2,2]],dir:[1,1,1],up:[-1,-1,1]},{boundaries:[[23,11,1,1],[6,17,1,1],[0,11,1,1]],dir:[1,-1,1],up:[-1,1,1]},{boundaries:[[5,5,2,2]],dir:[1,1,-1],up:[1,1,1]},{boundaries:[[11,17,1,1],[17,11,2,1]],dir:[-1,-1,1],up:[1,1,1]},{boundaries:[[17,6,2,1],[11,0,1,1]],dir:[-1,-1,-1],up:[-1,-1,1]},{boundaries:[[11,11,2,2]],dir:[-1,1,1],up:[1,-1,1]},{boundaries:[[0,6,1,1],[6,0,1,1],[23,6,1,1]],dir:[1,-1,-1],up:[1,-1,1]},{boundaries:[[11,5,2,2]],dir:[-1,1,-1],up:[-1,1,1]}],c=(t.frontColor||t.color,t.backColor||t.color,t.leftColor||t.color,t.rightColor||t.color,t.topColor||t.color,t.bottomColor||t.color,[{label:"front",boundaries:[[7,7,4,4]],dir:[0,0,-1],up:[0,1,0]},{label:"back",boundaries:[[19,7,4,4]],dir:[0,0,1],up:[0,1,0]},{label:"right",boundaries:[[13,7,4,4]],dir:[-1,0,0],up:[0,1,0]},{label:"left",boundaries:[[1,7,4,4]],dir:[1,0,0],up:[0,1,0]},{label:"top",boundaries:[[7,1,4,4]],dir:[0,-1,0],up:[0,0,-1]},{label:"bottom",boundaries:[[7,13,4,4]],dir:[0,1,0],up:[0,0,1]},{boundaries:[[7,5,4,2]],dir:[0,-1,-1],up:[0,1,-1]},{boundaries:[[1,6,4,1],[6,1,1,4]],dir:[1,-1,0],up:[1,1,0]},{boundaries:[[7,0,4,1],[19,6,4,1]],dir:[0,-1,1],up:[0,1,1]},{boundaries:[[13,6,4,1],[11,1,1,4]],dir:[-1,-1,0],up:[-1,1,0]},{boundaries:[[7,11,4,2]],dir:[0,1,-1],up:[0,1,1]},{boundaries:[[1,11,4,1],[6,13,1,4]],dir:[1,1,0],up:[-1,1,0]},{boundaries:[[7,17,4,1],[19,11,4,1]],dir:[0,1,1],up:[0,1,-1]},{boundaries:[[13,11,4,1],[11,13,1,4]],dir:[-1,1,0],up:[1,1,0]},{boundaries:[[5,7,2,4]],dir:[1,0,-1],up:[0,1,0]},{boundaries:[[11,7,2,4]],dir:[-1,0,-1],up:[0,1,0]},{boundaries:[[17,7,2,4]],dir:[-1,0,1],up:[0,1,0]},{boundaries:[[0,7,1,4],[23,7,1,4]],dir:[1,0,1],up:[0,1,0]},{boundaries:[[5,11,2,2]],dir:[1,1,-1],up:[-1,1,1]},{boundaries:[[23,11,1,1],[6,17,1,1],[0,11,1,1]],dir:[1,1,1],up:[-1,1,-1]},{boundaries:[[5,5,2,2]],dir:[1,-1,-1],up:[1,1,-1]},{boundaries:[[11,17,1,1],[17,11,2,1]],dir:[-1,1,1],up:[1,1,-1]},{boundaries:[[17,6,2,1],[11,0,1,1]],dir:[-1,-1,1],up:[-1,1,1]},{boundaries:[[11,11,2,2]],dir:[-1,1,-1],up:[1,1,1]},{boundaries:[[0,6,1,1],[6,0,1,1],[23,6,1,1]],dir:[1,-1,1],up:[1,1,1]},{boundaries:[[11,5,2,2]],dir:[-1,-1,-1],up:[-1,1,-1]}]);for(let e=0,t=l.length;e<t;e++)n.math.normalizeVec3(l[e].dir,l[e].dir),n.math.normalizeVec3(c[e].dir,c[e].dir);var u=c;this._textureCanvas=document.createElement("canvas"),this._textureCanvas.width=o,this._textureCanvas.height=500,this._textureCanvas.style.width=o+"px",this._textureCanvas.style.height="500px",this._textureCanvas.style.padding="0",this._textureCanvas.style.margin="0",this._textureCanvas.style.top="0",this._textureCanvas.style.background=i,this._textureCanvas.style.position="absolute",this._textureCanvas.style.opacity="1.0",this._textureCanvas.style.visibility="hidden",this._textureCanvas.style["z-index"]=2e6,document.getElementsByTagName("body")[0].appendChild(this._textureCanvas);const h=this._textureCanvas.getContext("2d");function d(){for(let e=0,t=a.length;e<t;e++){const t=a[e],i=t.boundary,r=Math.round(i[0]*s),n=Math.round(i[1]*s),o=Math.round(i[2]*s),l=Math.round(i[3]*s);h.fillStyle=t.color,h.fillRect(r,n,o,l)}for(let a=0,l=u.length;a<l;a++){let l,c,d,f;const m=u[a],g=m.boundaries;for(var e=0,t=g.length;e<t;e++){const t=g[e];l=Math.round(t[0]*s),c=Math.round(t[1]*s),d=Math.round(t[2]*s),f=Math.round(t[3]*s),m.highlighted&&(h.fillStyle=m.highlighted?r:m.color||i,h.fillRect(l,c,d,f))}if(m.label){h.fillStyle="black",h.font="60px sans-serif",h.textAlign="center";var n=l+.5*d,o=c+.7*f;h.fillText(p(m.label),n,o,80)}}}var p=function(){const t={yUp:{front:"+Z",back:"-Z",right:"+X",left:"-X",top:"+Y",bottom:"-Y"},en:{front:"FRONT",back:"BACK",right:"RIGHT",left:"LEFT",top:"TOP",bottom:"BOTTOM"}};return function(i){var r;return(r=t[e.language||"en"])&&r[i]||i}}();this.setZUp=function(){u=l,this.clear()},this.setYUp=function(){u=c,this.clear()},this.clear=function(){h.fillStyle=i,h.fillRect(0,0,o,500);for(var e=0,t=u.length;e<t;e++)u[e].highlighted=!1;d()},this.getArea=function(e){const t=e[0]*o,i=500-500*e[1];for(var r=0,n=u.length;r<n;r++){const e=u[r].boundaries;for(var a=0,l=e.length;a<l;a++){const n=e[a];if(t>=n[0]*s&&t<=(n[0]+n[2])*s&&i>=n[1]*s&&i<=(n[1]+n[3])*s)return r}}return-1},this.setAreaHighlighted=function(e,t){var i=u[e];if(!i)throw"Area not found: "+e;i.highlighted=!!t,d()},this.getAreaDir=function(e){var t=u[e];if(!t)throw"Unknown area: "+e;return t.dir},this.getAreaUp=function(e){var t=u[e];if(!t)throw"Unknown area: "+e;return t.up},this.getImage=function(){return this._textureCanvas},this.destroy=function(){this._textureCanvas&&(this._textureCanvas.parentNode.removeChild(this._textureCanvas),this._textureCanvas=null)},this.clear()}(e,t),this._cubeSampler=new x(i,{image:this._cubeTextureCanvas.getImage(),flipY:!0,wrapS:"clampToEdge",wrapT:"clampToEdge"}),this._cubeMesh=new a.a(i,{geometry:new l.a(i,{primitive:"triangles",normals:[0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1],positions:[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],uv:[.5,.6666,.25,.6666,.25,.3333,.5,.3333,.5,.6666,.5,.3333,.75,.3333,.75,.6666,.5,.6666,.5,1,.25,1,.25,.6666,.25,.6666,0,.6666,0,.3333,.25,.3333,.25,0,.5,0,.5,.3333,.25,.3333,.75,.3333,1,.3333,1,.6666,.75,.6666],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}),material:new c.a(i,{diffuse:[.4,.4,.4],specular:[.4,.4,.4],emissive:[.6,.6,.6],diffuseMap:this._cubeSampler,emissiveMap:this._cubeSampler}),visible:!0,edges:!0}),this._shadow=new a.a(i,{geometry:new l.a(i,Object(w.a)({center:[0,0,0],radiusTop:.001,radiusBottom:1.4,height:.01,radialSegments:20,heightSegments:1,openEnded:!0})),material:new c.a(i,{diffuse:[0,0,0],specular:[0,0,0],emissive:[0,0,0],alpha:.5}),position:[0,-1.5,0],visible:!0,pickable:!1,backfaces:!1}),this._onCameraMatrix=e.camera.on("matrix",this._synchCamera),this._onCameraWorldAxis=e.camera.on("worldAxis",()=>{e.camera.zUp?(this._zUp=!0,this._cubeTextureCanvas.setZUp(),this._repaint(),this._synchCamera()):e.camera.yUp&&(this._zUp=!1,this._cubeTextureCanvas.setYUp(),this._repaint(),this._synchCamera())}),this._onCameraFOV=e.camera.perspective.on("fov",e=>{this._synchProjection&&(this._navCubeCamera.perspective.fov=e)}),this._onCameraProjection=e.camera.on("projection",e=>{this._synchProjection&&(this._navCubeCamera.projection=e)});var u=-1;function h(e){var t=[0,0];if(e){for(var i=e.target,r=0,n=0;i.offsetParent;)r+=i.offsetLeft,n+=i.offsetTop,i=i.offsetParent;t[0]=e.pageX-r,t[1]=e.pageY-n}else e=window.event,t[0]=e.x,t[1]=e.y;return t}var d,p,f=null,m=null,g=!1,v=!1,b=0,_=null,y=null;r._navCubeCanvas.addEventListener("mouseenter",r._onMouseEnter=function(e){v=!0}),r._navCubeCanvas.addEventListener("mouseleave",r._onMouseLeave=function(e){v=!1}),r._navCubeCanvas.addEventListener("mousedown",r._onMouseDown=function(e){if(1===e.which){f=e.x,m=e.y,d=e.clientX,p=e.clientY;var t=h(e),r=i.pick({canvasPos:t});g=!!r}}),document.addEventListener("mouseup",r._onMouseUp=function(e){if(1===e.which&&(g=!1,null!==f)){var t=h(e),n=i.pick({canvasPos:t,pickSurface:!0});if(n&&n.uv){var o=r._cubeTextureCanvas.getArea(n.uv);if(o>=0&&(document.body.style.cursor="pointer",u>=0&&(r._cubeTextureCanvas.setAreaHighlighted(u,!1),r._repaint(),u=-1),o>=0)){if(r._cubeTextureCanvas.setAreaHighlighted(o,!0),u=o,r._repaint(),e.x<f-3||e.x>f+3||e.y<m-3||e.y>m+3)return;var s=r._cubeTextureCanvas.getAreaDir(o);if(s){var a=r._cubeTextureCanvas.getAreaUp(o);M(s,a,(function(){u>=0&&(r._cubeTextureCanvas.setAreaHighlighted(u,!1),r._repaint(),u=-1);var e=i.pick({canvasPos:t,pickSurface:!0});if(e&&e.uv){var n=r._cubeTextureCanvas.getArea(e.uv);void 0!==n&&(document.body.style.cursor="pointer",u>=0&&(r._cubeTextureCanvas.setAreaHighlighted(u,!1),r._repaint(),u=-1),n>=0&&(r._cubeTextureCanvas.setAreaHighlighted(n,!0),u=n,r._repaint()))}}))}}}}}),document.addEventListener("mousemove",r._onMouseMove=function(t){if(u>=0&&(r._cubeTextureCanvas.setAreaHighlighted(u,!1),r._repaint(),u=-1),1!==t.buttons||g){if(g){var n=t.clientX,o=t.clientY;return document.body.style.cursor="move",void function(t,i){var r=-.5*(t-d),n=-.5*(i-p);(b-=n)<_&&(b=_),b>y&&(b=y),e.camera.orbitYaw(r),e.camera.orbitPitch(-n),d=t,p=i}(n,o)}if(v){var s=h(t),a=i.pick({canvasPos:s,pickSurface:!0});if(a){if(a.uv){document.body.style.cursor="pointer";var l=r._cubeTextureCanvas.getArea(a.uv);if(l===u)return;u>=0&&r._cubeTextureCanvas.setAreaHighlighted(u,!1),l>=0&&(r._cubeTextureCanvas.setAreaHighlighted(l,!0),r._repaint(),u=l)}}else document.body.style.cursor="default",u>=0&&(r._cubeTextureCanvas.setAreaHighlighted(u,!1),r._repaint(),u=-1)}}});var M=function(){var t=n.math.vec3();return function(i,o,s){var a=r._fitVisible?e.scene.getAABB(e.scene.visibleObjectIds):e.scene.aabb,l=n.math.getAABB3Diag(a);n.math.getAABB3Center(a,t);var c=Math.abs(l/Math.tan(27.5));e.cameraControl.pivotPos=t,r._cameraFly?e.cameraFlight.flyTo({look:t,eye:[t[0]-c*i[0],t[1]-c*i[1],t[2]-c*i[2]],up:o||[0,1,0],orthoScale:1.3*l,fitFOV:r._cameraFitFOV,duration:r._cameraFlyDuration},s):e.cameraFlight.jumpTo({look:t,eye:[t[0]-c*i[0],t[1]-c*i[1],t[2]-c*i[2]],up:o||[0,1,0],orthoScale:1.3*l,fitFOV:r._cameraFitFOV},s)}}();this.setVisible(t.visible),this.setCameraFitFOV(t.cameraFitFOV),this.setCameraFly(t.cameraFly),this.setCameraFlyDuration(t.cameraFlyDuration),this.setFitVisible(t.fitVisible),this.setSynchProjection(t.synchProjection)}send(e,t){switch(e){case"language":this._cubeTextureCanvas.clear(),this._repaint()}}_repaint(){const e=this._cubeTextureCanvas.getImage();this._cubeMesh.material.diffuseMap.image=e,this._cubeMesh.material.emissiveMap.image=e}setVisible(e=!0){this._navCubeCanvas&&(this._cubeMesh.visible=e,this._shadow.visible=e,this._navCubeCanvas.style.visibility=e?"visible":"hidden")}getVisible(){return!!this._navCubeCanvas&&this._cubeMesh.visible}setFitVisible(e=!1){this._fitVisible=e}getFitVisible(){return this._fitVisible}setCameraFly(e=!0){this._cameraFly=e}getCameraFly(){return this._cameraFly}setCameraFitFOV(e=45){this._cameraFitFOV=e}getCameraFitFOV(){return this._cameraFitFOV}setCameraFlyDuration(e=.5){this._cameraFlyDuration=e}getCameraFlyDuration(){return this._cameraFlyDuration}setSynchProjection(e=!1){this._synchProjection=e}getSynchProjection(){return this._synchProjection}destroy(){this._navCubeCanvas&&(this.viewer.camera.off(this._onCameraMatrix),this.viewer.camera.off(this._onCameraWorldAxis),this.viewer.camera.perspective.off(this._onCameraFOV),this.viewer.camera.off(this._onCameraProjection),this._navCubeCanvas.removeEventListener("mouseenter",this._onMouseEnter),this._navCubeCanvas.removeEventListener("mouseleave",this._onMouseLeave),this._navCubeCanvas.removeEventListener("mousedown",this._onMouseDown),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),this._navCubeCanvas=null,this._cubeTextureCanvas.destroy(),this._cubeTextureCanvas=null,this._onMouseEnter=null,this._onMouseLeave=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null),this._navCubeScene.destroy(),this._navCubeScene=null,this._cubeMesh=null,this._shadow=null,super.destroy()}}},function(e,t,i){"use strict";i.r(t),i.d(t,"Pane",(function(){return w}));var r=i(1),n=i.n(r),o=i(6),s=i.n(o),a=i(50),l=i.n(a);function c(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function u(e){this.setState(function(t){var i=this.constructor.getDerivedStateFromProps(e,t);return null!=i?i:null}.bind(this))}function h(e,t){try{var i=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(i,r)}finally{this.props=i,this.state=r}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,i){return t&&p(e.prototype,t),i&&p(e,i),e}function m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){m(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return function(){var t,i=_(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=_(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?y(e):t}(this,t)}}c.__suppressDeprecationWarning=!0,u.__suppressDeprecationWarning=!0,h.__suppressDeprecationWarning=!0;var w=function(e){b(i,n.a.PureComponent);var t=x(i);function i(){return d(this,i),t.apply(this,arguments)}return f(i,[{key:"render",value:function(){var e=this.props,t=e.children,i=e.className,r=e.split,o=e.style,s=e.size,a=e.eleRef,l=["Pane",r,i],c={flex:1,position:"relative",outline:"none"};return void 0!==s&&("vertical"===r?c.width=s:(c.height=s,c.display="flex"),c.flex="none"),c=Object.assign({},c,o||{}),n.a.createElement("div",{ref:a,className:l.join(" "),style:c},t)}}]),i}();w.propTypes={className:s.a.string.isRequired,children:s.a.node.isRequired,size:s.a.oneOfType([s.a.string,s.a.number]),split:s.a.oneOf(["vertical","horizontal"]),style:l.a,eleRef:s.a.func},w.defaultProps={};var M=function(e){b(i,n.a.Component);var t=x(i);function i(){return d(this,i),t.apply(this,arguments)}return f(i,[{key:"render",value:function(){var e=this.props,t=e.className,i=e.onClick,r=e.onDoubleClick,o=e.onMouseDown,s=e.onTouchEnd,a=e.onTouchStart,l=e.resizerClassName,c=e.split,u=e.style,h=[l,c,t];return n.a.createElement("span",{role:"presentation",className:h.join(" "),style:u,onMouseDown:function(e){return o(e)},onTouchStart:function(e){e.preventDefault(),a(e)},onTouchEnd:function(e){e.preventDefault(),s(e)},onClick:function(e){i&&(e.preventDefault(),i(e))},onDoubleClick:function(e){r&&(e.preventDefault(),r(e))}})}}]),i}();function P(e,t){if(e.selection)e.selection.empty();else try{t.getSelection().removeAllRanges()}catch(e){}}function E(e,t,i,r){if("number"==typeof r){var n="number"==typeof t?t:0,o="number"==typeof i&&i>=0?i:1/0;return Math.max(n,Math.min(o,r))}return void 0!==e?e:t}M.propTypes={className:s.a.string.isRequired,onClick:s.a.func,onDoubleClick:s.a.func,onMouseDown:s.a.func.isRequired,onTouchStart:s.a.func.isRequired,onTouchEnd:s.a.func.isRequired,split:s.a.oneOf(["vertical","horizontal"]),style:l.a,resizerClassName:s.a.string.isRequired},M.defaultProps={resizerClassName:"Resizer"};var S=function(e){b(i,n.a.Component);var t=x(i);function i(e){var r;d(this,i),(r=t.call(this,e)).onMouseDown=r.onMouseDown.bind(y(r)),r.onTouchStart=r.onTouchStart.bind(y(r)),r.onMouseMove=r.onMouseMove.bind(y(r)),r.onTouchMove=r.onTouchMove.bind(y(r)),r.onMouseUp=r.onMouseUp.bind(y(r));var n=e.size,o=e.defaultSize,s=e.minSize,a=e.maxSize,l=e.primary,c=void 0!==n?n:E(o,s,a,null);return r.state={active:!1,resized:!1,pane1Size:"first"===l?c:void 0,pane2Size:"second"===l?c:void 0,instanceProps:{size:n}},r}return f(i,[{key:"componentDidMount",value:function(){document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),this.setState(i.getSizeUpdate(this.props,this.state))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchmove",this.onTouchMove)}},{key:"onMouseDown",value:function(e){var t=Object.assign({},e,{touches:[{clientX:e.clientX,clientY:e.clientY}]});this.onTouchStart(t)}},{key:"onTouchStart",value:function(e){var t=this.props,i=t.allowResize,r=t.onDragStarted,n=t.split;if(i){P(document,window);var o="vertical"===n?e.touches[0].clientX:e.touches[0].clientY;"function"==typeof r&&r(),this.setState({active:!0,position:o})}}},{key:"onMouseMove",value:function(e){var t=Object.assign({},e,{touches:[{clientX:e.clientX,clientY:e.clientY}]});this.onTouchMove(t)}},{key:"onTouchMove",value:function(e){var t=this.props,i=t.allowResize,r=t.maxSize,n=t.minSize,o=t.onChange,s=t.split,a=t.step,l=this.state,c=l.active,u=l.position;if(i&&c){P(document,window);var h="first"===this.props.primary,d=h?this.pane1:this.pane2,p=h?this.pane2:this.pane1;if(d){var f=d,g=p;if(f.getBoundingClientRect){var v=f.getBoundingClientRect().width,b=f.getBoundingClientRect().height,_="vertical"===s?v:b,y=u-("vertical"===s?e.touches[0].clientX:e.touches[0].clientY);if(a){if(Math.abs(y)<a)return;y=~~(y/a)*a}var x=h?y:-y;parseInt(window.getComputedStyle(f).order)>parseInt(window.getComputedStyle(g).order)&&(x=-x);var w=r;if(void 0!==r&&r<=0){var M=this.splitPane;w="vertical"===s?M.getBoundingClientRect().width+r:M.getBoundingClientRect().height+r}var E=_-x,S=u-y;E<n?E=n:void 0!==r&&E>w?E=w:this.setState({position:S,resized:!0}),o&&o(E),this.setState(m({draggedSize:E},h?"pane1Size":"pane2Size",E))}}}}},{key:"onMouseUp",value:function(){var e=this.props,t=e.allowResize,i=e.onDragFinished,r=this.state,n=r.active,o=r.draggedSize;t&&n&&("function"==typeof i&&i(o),this.setState({active:!1}))}},{key:"render",value:function(){var e=this,t=this.props,i=t.allowResize,r=t.children,o=t.className,s=t.onResizerClick,a=t.onResizerDoubleClick,l=t.paneClassName,c=t.pane1ClassName,u=t.pane2ClassName,h=t.paneStyle,d=t.pane1Style,p=t.pane2Style,f=t.resizerClassName,m=t.resizerStyle,g=t.split,b=t.style,_=this.state,y=_.pane1Size,x=_.pane2Size,P=i?"":"disabled",E=f?"".concat(f," ").concat("Resizer"):f,S=function(e){return n.a.Children.toArray(e).filter((function(e){return e}))}(r),C=v({display:"flex",flex:1,height:"100%",position:"absolute",outline:"none",overflow:"hidden",MozUserSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",userSelect:"text"},b);"vertical"===g?Object.assign(C,{flexDirection:"row",left:0,right:0}):Object.assign(C,{bottom:0,flexDirection:"column",minHeight:"100%",top:0,width:"100%"});var k=["SplitPane",o,g,P],O=v({},h,{},d),A=v({},h,{},p),T=["Pane1",l,c].join(" "),D=["Pane2",l,u].join(" ");return n.a.createElement("div",{className:k.join(" "),ref:function(t){e.splitPane=t},style:C},n.a.createElement(w,{className:T,key:"pane1",eleRef:function(t){e.pane1=t},size:y,split:g,style:O},S[0]),n.a.createElement(M,{className:P,onClick:s,onDoubleClick:a,onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onTouchEnd:this.onMouseUp,key:"resizer",resizerClassName:E,split:g,style:m||{}}),n.a.createElement(w,{className:D,key:"pane2",eleRef:function(t){e.pane2=t},size:x,split:g,style:A},S[1]))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return i.getSizeUpdate(e,t)}},{key:"getSizeUpdate",value:function(e,t){var i={};if(t.instanceProps.size===e.size&&void 0!==e.size)return{};var r=void 0!==e.size?e.size:E(e.defaultSize,e.minSize,e.maxSize,t.draggedSize);void 0!==e.size&&(i.draggedSize=r);var n="first"===e.primary;return i[n?"pane1Size":"pane2Size"]=r,i[n?"pane2Size":"pane1Size"]=void 0,i.instanceProps={size:e.size},i}}]),i}();S.propTypes={allowResize:s.a.bool,children:s.a.arrayOf(s.a.node).isRequired,className:s.a.string,primary:s.a.oneOf(["first","second"]),minSize:s.a.oneOfType([s.a.string,s.a.number]),maxSize:s.a.oneOfType([s.a.string,s.a.number]),defaultSize:s.a.oneOfType([s.a.string,s.a.number]),size:s.a.oneOfType([s.a.string,s.a.number]),split:s.a.oneOf(["vertical","horizontal"]),onDragStarted:s.a.func,onDragFinished:s.a.func,onChange:s.a.func,onResizerClick:s.a.func,onResizerDoubleClick:s.a.func,style:l.a,resizerStyle:l.a,paneClassName:s.a.string,pane1ClassName:s.a.string,pane2ClassName:s.a.string,paneStyle:l.a,pane1Style:l.a,pane2Style:l.a,resizerClassName:s.a.string,step:s.a.number},S.defaultProps={allowResize:!0,minSize:50,primary:"first",split:"vertical",paneClassName:"",pane1ClassName:"",pane2ClassName:""},function(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var i=null,r=null,n=null;if("function"==typeof t.componentWillMount?i="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(i="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?r="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(r="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?n="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(n="UNSAFE_componentWillUpdate"),null!==i||null!==r||null!==n){var o=e.displayName||e.name,s="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+o+" uses "+s+" but also contains the following legacy lifecycles:"+(null!==i?"\n  "+i:"")+(null!==r?"\n  "+r:"")+(null!==n?"\n  "+n:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=c,t.componentWillReceiveProps=u),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=h;var a=t.componentDidUpdate;t.componentDidUpdate=function(e,t,i){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:i;a.call(this,e,t,r)}}}(S),t.default=S},function(e,t,i){"use strict";i.r(t),i.d(t,"createTippyWithPlugins",(function(){return me})),i.d(t,"default",(function(){return pe})),i.d(t,"hideAll",(function(){return fe})),i.d(t,"roundArrow",(function(){return j})),i.d(t,"animateFill",(function(){return _e})),i.d(t,"createSingleton",(function(){return ge})),i.d(t,"delegate",(function(){return be})),i.d(t,"followCursor",(function(){return ye})),i.d(t,"inlinePositioning",(function(){return xe})),i.d(t,"sticky",(function(){return we}));var r=i(127);
/**!
* tippy.js v5.2.1
* (c) 2017-2020 atomiks
* MIT License
*/function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var o="5.2.1";function s(e,t){e.innerHTML=t}function a(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function l(e,t){return{}.hasOwnProperty.call(e,t)}function c(e,t,i){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(i)?i[t]:i:r}return e}function u(e,t){return e&&e.modifiers&&e.modifiers[t]}function h(e,t){var i={}.toString.call(e);return 0===i.indexOf("[object")&&i.indexOf(t+"]")>-1}function d(e){return h(e,"Element")}function p(e){return h(e,"MouseEvent")}function f(e,t){return"function"==typeof e?e.apply(void 0,t):e}function m(e,t,i,r){e.filter((function(e){return e.name===t}))[0][i]=r}function g(){return document.createElement("div")}function v(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function b(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function _(e,t){return 0===t?e:function(r){clearTimeout(i),i=setTimeout((function(){e(r)}),t)};var i}function y(e,t,i){e&&e!==t&&e.apply(void 0,i)}function x(e){return[].slice.call(e)}function w(e,t){for(;e;){if(t(e))return e;e=e.parentElement}return null}function M(e,t){return e.indexOf(t)>-1}function P(e){return e.split(/\s+/).filter(Boolean)}function E(e,t){return void 0!==e?e:t}function S(e){return[].concat(e)}function C(e){var t=S(e)[0];return t&&t.ownerDocument||document}function k(e,t){-1===e.indexOf(t)&&e.push(t)}function O(e){return"number"==typeof e?e:parseFloat(e)}function A(e,t,i){void 0===t&&(t=5);var r={top:0,right:0,bottom:0,left:0};return Object.keys(r).reduce((function(r,n){return r[n]="number"==typeof t?t:t[n],e===n&&(r[n]="number"==typeof t?t+i:t[e]+i),r}),r)}var T=n({allowHTML:!0,animation:"fade",appendTo:function(){return document.body},aria:"describedby",arrow:!0,boundary:"scrollParent",content:"",delay:0,distance:10,duration:[300,250],flip:!0,flipBehavior:"flip",flipOnUpdate:!1,hideOnClick:!0,ignoreAttributes:!1,inertia:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,lazy:!0,maxWidth:350,multiple:!1,offset:0,onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},placement:"top",plugins:[],popperOptions:{},role:"tooltip",showOnCreate:!1,theme:"",touch:!0,trigger:"mouseenter focus",triggerTarget:null,updateDuration:0,zIndex:9999},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1}),D=Object.keys(T),R=["arrow","boundary","distance","flip","flipBehavior","flipOnUpdate","offset","placement","popperOptions"],L=function(e){Object.keys(e).forEach((function(t){T[t]=e[t]}))};function B(e){var t=(e.plugins||[]).reduce((function(t,i){var r=i.name,n=i.defaultValue;return r&&(t[r]=void 0!==e[r]?e[r]:n),t}),{});return n({},e,{},t)}function I(e,t){var i=n({},t,{content:f(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(B(n({},T,{plugins:t}))):D).reduce((function(t,i){var r=(e.getAttribute("data-tippy-"+i)||"").trim();if(!r)return t;if("content"===i)t[i]=r;else try{t[i]=JSON.parse(r)}catch(e){t[i]=r}return t}),{})}(e,t.plugins));return i.interactive&&(i.aria=null),i}var N={passive:!0},j='<svg viewBox="0 0 18 7" xmlns="http://www.w3.org/2000/svg"><path d="M0 7s2.021-.015 5.253-4.218C6.584 1.051 7.797.007 9 0c1.203-.007 2.416 1.035 3.761 2.782C16.012 7.005 18 7 18 7H0z"/></svg>',F="tippy-popper",z="tippy-tooltip",V="tippy-content",U="tippy-arrow",W="tippy-svg-arrow",H={isTouch:!1},G=0;function X(){H.isTouch||(H.isTouch=!0,window.performance&&document.addEventListener("mousemove",Y))}function Y(){var e=performance.now();e-G<20&&(H.isTouch=!1,document.removeEventListener("mousemove",Y)),G=e}function $(){var e=document.activeElement;if(a(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var q="undefined"!=typeof window&&"undefined"!=typeof document,K=q?navigator.userAgent:"",Z=/MSIE |Trident\//.test(K),Q=q&&/iPhone|iPad|iPod/.test(navigator.platform);function J(e){var t=e&&Q&&H.isTouch;document.body.classList[t?"add":"remove"]("tippy-iOS")}function ee(e){return e.split("-")[0]}function te(e){e.setAttribute("data-inertia","")}function ie(e){e.setAttribute("data-interactive","")}function re(e,t){d(t.content)?(s(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(e[t.allowHTML?"innerHTML":"textContent"]=t.content)}function ne(e){return{tooltip:e.querySelector(".tippy-tooltip"),content:e.querySelector(".tippy-content"),arrow:e.querySelector(".tippy-arrow")||e.querySelector(".tippy-svg-arrow")}}function oe(e){var t=g();return!0===e?t.className=U:(t.className=W,d(e)?t.appendChild(e):s(t,e)),t}function se(e,t,i){var r=ne(e),n=r.tooltip,o=r.content,s=r.arrow;e.style.zIndex=""+i.zIndex,n.setAttribute("data-animation",i.animation),n.style.maxWidth=function(e){return"number"==typeof e?e+"px":e}(i.maxWidth),i.role?n.setAttribute("role",i.role):n.removeAttribute("role"),t.content!==i.content&&re(o,i),!t.arrow&&i.arrow?(n.appendChild(oe(i.arrow)),n.setAttribute("data-arrow","")):t.arrow&&!i.arrow?(n.removeChild(s),n.removeAttribute("data-arrow")):t.arrow!==i.arrow&&(n.removeChild(s),n.appendChild(oe(i.arrow))),!t.interactive&&i.interactive?ie(n):t.interactive&&!i.interactive&&function(e){e.removeAttribute("data-interactive")}(n),!t.inertia&&i.inertia?te(n):t.inertia&&!i.inertia&&function(e){e.removeAttribute("data-inertia")}(n),t.theme!==i.theme&&(le(n,"remove",t.theme),le(n,"add",i.theme))}function ae(e,t,i){["transitionend","webkitTransitionEnd"].forEach((function(r){e[t+"EventListener"](r,i)}))}function le(e,t,i){P(i).forEach((function(i){e.classList[t](i+"-theme")}))}var ce=1,ue=[],he=[];function de(e,t){var i,o,s,a=I(e,n({},T,{},B(t)));if(!a.multiple&&e._tippy)return null;var h,d,D,L,j=!1,U=!1,W=!1,G=0,X=[],Y=_(Be,a.interactiveDebounce),$=C(a.triggerTarget||e),q=ce++,K=function(e,t){var i=g();i.className=F,i.style.position="absolute",i.style.top="0",i.style.left="0";var r=g();r.className=z,r.id="tippy-"+e,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1"),le(r,"add",t.theme);var n=g();return n.className=V,n.setAttribute("data-state","hidden"),t.interactive&&ie(r),t.arrow&&(r.setAttribute("data-arrow",""),r.appendChild(oe(t.arrow))),t.inertia&&te(r),re(n,t),r.appendChild(n),i.appendChild(r),se(i,t,t),i}(q,a),Q=ne(K),de=function(e){return e.filter((function(t,i){return e.indexOf(t)===i}))}(a.plugins),pe=Q.tooltip,fe=Q.content,me=[pe,fe],ge={id:q,reference:e,popper:K,popperChildren:Q,popperInstance:null,props:a,state:{currentPlacement:null,isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:de,clearDelayTimeouts:function(){clearTimeout(i),clearTimeout(o),cancelAnimationFrame(s)},setProps:function(t){if(!ge.state.isDestroyed){Me("onBeforeUpdate",[ge,t]),Re();var i=ge.props,r=I(e,n({},ge.props,{},t,{ignoreAttributes:!0}));if(r.ignoreAttributes=E(t.ignoreAttributes,i.ignoreAttributes),ge.props=r,De(),i.interactiveDebounce!==r.interactiveDebounce&&(Se(),Y=_(Be,r.interactiveDebounce)),se(K,i,r),ge.popperChildren=ne(K),i.triggerTarget&&!r.triggerTarget?S(i.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):r.triggerTarget&&e.removeAttribute("aria-expanded"),Ee(),ge.popperInstance)if(R.some((function(e){return l(t,e)&&t[e]!==i[e]}))){var o=ge.popperInstance.reference;ge.popperInstance.destroy(),Fe(),ge.popperInstance.reference=o,ge.state.isVisible&&ge.popperInstance.enableEventListeners()}else ge.popperInstance.update();Me("onAfterUpdate",[ge,t])}},setContent:function(e){ge.setProps({content:e})},show:function(e){void 0===e&&(e=c(ge.props.duration,0,T.duration));var t=ge.state.isVisible,i=ge.state.isDestroyed,r=!ge.state.isEnabled,n=H.isTouch&&!ge.props.touch;t||i||r||n||xe().hasAttribute("disabled")||(ge.popperInstance||Fe(),Me("onShow",[ge],!1),!1!==ge.props.onShow(ge)&&(ke(),K.style.visibility="visible",ge.state.isVisible=!0,ge.state.isMounted||v(me.concat(K),0),d=function(){ge.state.isVisible&&(v([K],ge.props.updateDuration),v(me,e),b(me,"visible"),Pe(),Ee(),k(he,ge),J(!0),ge.state.isMounted=!0,Me("onMount",[ge]),function(e,t){Ae(e,(function(){ge.state.isShown=!0,Me("onShown",[ge])}))}(e))},function(){G=0;var e,t=ge.props.appendTo,i=xe();(e=ge.props.interactive&&t===T.appendTo||"parent"===t?i.parentNode:f(t,[i])).contains(K)||e.appendChild(K),m(ge.popperInstance.modifiers,"flip","enabled",ge.props.flip),ge.popperInstance.enableEventListeners(),ge.popperInstance.update()}()))},hide:function(e){void 0===e&&(e=c(ge.props.duration,1,T.duration));var t=!ge.state.isVisible&&!j,i=ge.state.isDestroyed,r=!ge.state.isEnabled&&!j;t||i||r||(Me("onHide",[ge],!1),(!1!==ge.props.onHide(ge)||j)&&(Oe(),K.style.visibility="hidden",ge.state.isVisible=!1,ge.state.isShown=!1,v(me,e),b(me,"hidden"),Pe(),Ee(),function(e,t){Ae(e,(function(){!ge.state.isVisible&&K.parentNode&&K.parentNode.contains(K)&&(ge.popperInstance.disableEventListeners(),ge.popperInstance.options.placement=ge.props.placement,K.parentNode.removeChild(K),0===(he=he.filter((function(e){return e!==ge}))).length&&J(!1),ge.state.isMounted=!1,Me("onHidden",[ge]))}))}(e)))},enable:function(){ge.state.isEnabled=!0},disable:function(){ge.hide(),ge.state.isEnabled=!1},destroy:function(){ge.state.isDestroyed||(j=!0,ge.clearDelayTimeouts(),ge.hide(0),Re(),delete e._tippy,ge.popperInstance&&ge.popperInstance.destroy(),j=!1,ge.state.isDestroyed=!0,Me("onDestroy",[ge]))}};e._tippy=ge,K._tippy=ge;var ve=de.map((function(e){return e.fn(ge)})),be=e.hasAttribute("aria-expanded");return De(),Ee(),a.lazy||Fe(),Me("onCreate",[ge]),a.showOnCreate&&Ve(),K.addEventListener("mouseenter",(function(){ge.props.interactive&&ge.state.isVisible&&ge.clearDelayTimeouts()})),K.addEventListener("mouseleave",(function(e){ge.props.interactive&&M(ge.props.trigger,"mouseenter")&&(Y(e),$.addEventListener("mousemove",Y))})),ge;function _e(){var e=ge.props.touch;return Array.isArray(e)?e:[e,0]}function ye(){return"hold"===_e()[0]}function xe(){return L||e}function we(e){return ge.state.isMounted&&!ge.state.isVisible||H.isTouch||h&&"focus"===h.type?0:c(ge.props.delay,e?0:1,T.delay)}function Me(e,t,i){var r;void 0===i&&(i=!0),ve.forEach((function(i){l(i,e)&&i[e].apply(i,t)})),i&&(r=ge.props)[e].apply(r,t)}function Pe(){var t=ge.props.aria;if(t){var i="aria-"+t,r=pe.id;S(ge.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(i);if(ge.state.isVisible)e.setAttribute(i,t?t+" "+r:r);else{var n=t&&t.replace(r,"").trim();n?e.setAttribute(i,n):e.removeAttribute(i)}}))}}function Ee(){be||S(ge.props.triggerTarget||e).forEach((function(e){ge.props.interactive?e.setAttribute("aria-expanded",ge.state.isVisible&&e===xe()?"true":"false"):e.removeAttribute("aria-expanded")}))}function Se(){$.body.removeEventListener("mouseleave",Ue),$.removeEventListener("mousemove",Y),ue=ue.filter((function(e){return e!==Y}))}function Ce(e){if(!ge.props.interactive||!K.contains(e.target)){if(xe().contains(e.target)){if(H.isTouch)return;if(ge.state.isVisible&&M(ge.props.trigger,"click"))return}!0===ge.props.hideOnClick&&(U=!1,ge.clearDelayTimeouts(),ge.hide(),W=!0,setTimeout((function(){W=!1})),ge.state.isMounted||Oe())}}function ke(){$.addEventListener("mousedown",Ce,!0)}function Oe(){$.removeEventListener("mousedown",Ce,!0)}function Ae(e,t){function i(e){e.target===pe&&(ae(pe,"remove",i),t())}if(0===e)return t();ae(pe,"remove",D),ae(pe,"add",i),D=i}function Te(t,i,r){void 0===r&&(r=!1),S(ge.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,i,r),X.push({node:e,eventType:t,handler:i,options:r})}))}function De(){ye()&&(Te("touchstart",Le,N),Te("touchend",Ie,N)),P(ge.props.trigger).forEach((function(e){if("manual"!==e)switch(Te(e,Le),e){case"mouseenter":Te("mouseleave",Ie);break;case"focus":Te(Z?"focusout":"blur",Ne);break;case"focusin":Te("focusout",Ne)}}))}function Re(){X.forEach((function(e){var t=e.node,i=e.eventType,r=e.handler,n=e.options;t.removeEventListener(i,r,n)})),X=[]}function Le(e){var t=!1;if(ge.state.isEnabled&&!je(e)&&!W){if(h=e,L=e.currentTarget,Ee(),!ge.state.isVisible&&p(e)&&ue.forEach((function(t){return t(e)})),"click"!==e.type||M(ge.props.trigger,"mouseenter")&&!U||!1===ge.props.hideOnClick||!ge.state.isVisible){var r=_e(),n=r[0],o=r[1];H.isTouch&&"hold"===n&&o?i=setTimeout((function(){Ve(e)}),o):Ve(e)}else t=!0;"click"===e.type&&(U=!t),t&&Ue(e)}}function Be(t){var i=w(t.target,(function(t){return t===e||t===K}));"mousemove"===t.type&&i||function(e,t){var i=t.clientX,r=t.clientY;return e.every((function(e){var t=e.popperRect,n=e.tooltipRect,o=e.interactiveBorder,s=Math.min(t.top,n.top),a=Math.max(t.right,n.right),l=Math.max(t.bottom,n.bottom),c=Math.min(t.left,n.left);return s-r>o||r-l>o||c-i>o||i-a>o}))}(x(K.querySelectorAll(".tippy-popper")).concat(K).map((function(e){var t=e._tippy,i=t.popperChildren.tooltip,r=t.props.interactiveBorder;return{popperRect:e.getBoundingClientRect(),tooltipRect:i.getBoundingClientRect(),interactiveBorder:r}})),t)&&(Se(),Ue(t))}function Ie(e){if(!(je(e)||M(ge.props.trigger,"click")&&U))return ge.props.interactive?($.body.addEventListener("mouseleave",Ue),$.addEventListener("mousemove",Y),k(ue,Y),void Y(e)):void Ue(e)}function Ne(e){(M(ge.props.trigger,"focusin")||e.target===xe())&&(ge.props.interactive&&e.relatedTarget&&K.contains(e.relatedTarget)||Ue(e))}function je(e){var t="ontouchstart"in window,i=M(e.type,"touch"),r=ye();return t&&H.isTouch&&r&&!i||H.isTouch&&!r&&i}function Fe(){var t,i=ge.props.popperOptions,o=ge.popperChildren.arrow,s=u(i,"flip"),a=u(i,"preventOverflow");function l(e){var i=ge.state.currentPlacement;ge.state.currentPlacement=e.placement,ge.props.flip&&!ge.props.flipOnUpdate&&(e.flipped&&(ge.popperInstance.options.placement=e.placement),m(ge.popperInstance.modifiers,"flip","enabled",!1)),pe.setAttribute("data-placement",e.placement),!1!==e.attributes["x-out-of-boundaries"]?pe.setAttribute("data-out-of-boundaries",""):pe.removeAttribute("data-out-of-boundaries");var r=ee(e.placement),n=M(["top","bottom"],r),o=M(["bottom","right"],r);pe.style.top="0",pe.style.left="0",pe.style[n?"top":"left"]=(o?1:-1)*t+"px",i&&i!==e.placement&&ge.popperInstance.update()}var c=n({eventsEnabled:!1,placement:ge.props.placement},i,{modifiers:n({},i&&i.modifiers,{tippyDistance:{enabled:!0,order:0,fn:function(e){t=function(e,t){var i="string"==typeof t&&M(t,"rem"),r=e.documentElement;return r&&i?parseFloat(getComputedStyle(r).fontSize||String(16))*O(t):O(t)}($,ge.props.distance);var i=ee(e.placement),r=A(i,a&&a.padding,t),n=A(i,s&&s.padding,t),o=ge.popperInstance.modifiers;return m(o,"preventOverflow","padding",r),m(o,"flip","padding",n),e}},preventOverflow:n({boundariesElement:ge.props.boundary},a),flip:n({enabled:ge.props.flip,behavior:ge.props.flipBehavior},s),arrow:n({element:o,enabled:!!o},u(i,"arrow")),offset:n({offset:ge.props.offset},u(i,"offset"))}),onCreate:function(e){l(e),y(i&&i.onCreate,c.onCreate,[e]),ze()},onUpdate:function(e){l(e),y(i&&i.onUpdate,c.onUpdate,[e]),ze()}});ge.popperInstance=new r.a(e,K,c)}function ze(){0===G?(G++,ge.popperInstance.update()):d&&1===G&&(G++,function(e){e.offsetHeight}(K),d())}function Ve(e){ge.clearDelayTimeouts(),ge.popperInstance||Fe(),e&&Me("onTrigger",[ge,e]),ke();var t=we(!0);t?i=setTimeout((function(){ge.show()}),t):ge.show()}function Ue(e){if(ge.clearDelayTimeouts(),Me("onUntrigger",[ge,e]),ge.state.isVisible){if(!(M(ge.props.trigger,"mouseenter")&&M(ge.props.trigger,"click")&&M(["mouseleave","mousemove"],e.type)&&U)){var t=we(!1);t?o=setTimeout((function(){ge.state.isVisible&&ge.hide()}),t):s=requestAnimationFrame((function(){ge.hide()}))}}else Oe()}}function pe(e,t,i){void 0===t&&(t={}),void 0===i&&(i=[]),i=T.plugins.concat(t.plugins||i),document.addEventListener("touchstart",X,n({},N,{capture:!0})),window.addEventListener("blur",$);var r=n({},t,{plugins:i}),o=function(e){return d(e)?[e]:function(e){return h(e,"NodeList")}(e)?x(e):Array.isArray(e)?e:x(document.querySelectorAll(e))}(e).reduce((function(e,t){var i=t&&de(t,r);return i&&e.push(i),e}),[]);return d(e)?o[0]:o}pe.version=o,pe.defaultProps=T,pe.setDefaultProps=L,pe.currentInput=H;var fe=function(e){var t=void 0===e?{}:e,i=t.exclude,r=t.duration;he.forEach((function(e){var t=!1;i&&(t=a(i)?e.reference===i:e.popper===i.popper),t||e.hide(r)}))};function me(e){var t=function(t,i,r){return void 0===i&&(i={}),void 0===r&&(r=[]),r=i.plugins||r,pe(t,n({},i,{plugins:[].concat(e,r)}))};return t.version=o,t.defaultProps=T,t.setDefaultProps=L,t.currentInput=H,t}
/**!
* tippy.js v5.2.1
* (c) 2017-2020 atomiks
* MIT License
*/var ge=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i=[]),i=t.plugins||i,e.forEach((function(e){e.disable()}));var r,o,s=n({},T,{},t).aria,a=!1,l=e.map((function(e){return e.reference})),c={fn:function(t){function i(e){if(r){var i="aria-"+r;e&&!t.props.interactive?o.setAttribute(i,t.popperChildren.tooltip.id):o.removeAttribute(i)}}return{onAfterUpdate:function(e,i){var r=i.aria;void 0!==r&&r!==s&&(a?(a=!0,t.setProps({aria:null}),a=!1):s=r)},onDestroy:function(){e.forEach((function(e){e.enable()}))},onMount:function(){i(!0)},onUntrigger:function(){i(!1)},onTrigger:function(n,a){var c=a.currentTarget,u=l.indexOf(c);c!==o&&(o=c,r=s,t.state.isVisible&&i(!0),t.popperInstance.reference=c,t.setContent(e[u].props.content))}}}};return pe(g(),n({},t,{plugins:[c].concat(i),aria:null,triggerTarget:l}))},ve={mouseover:"mouseenter",focusin:"focus",click:"click"};function be(e,t,i){void 0===i&&(i=[]),i=t.plugins||i;var r=[],o=[],s=t.target,a=function(e,t){var i=n({},e);return t.forEach((function(e){delete i[e]})),i}(t,["target"]),l=n({},a,{plugins:i,trigger:"manual"}),c=n({},a,{plugins:i,showOnCreate:!0}),u=pe(e,l);function h(e){if(e.target){var i=e.target.closest(s);if(i&&M(i.getAttribute("data-tippy-trigger")||t.trigger||T.trigger,ve[e.type])){var r=pe(i,c);r&&(o=o.concat(r))}}}function d(e,t,i,n){void 0===n&&(n=!1),e.addEventListener(t,i,n),r.push({node:e,eventType:t,handler:i,options:n})}return S(u).forEach((function(e){var t=e.destroy;e.destroy=function(e){void 0===e&&(e=!0),e&&o.forEach((function(e){e.destroy()})),o=[],r.forEach((function(e){var t=e.node,i=e.eventType,r=e.handler,n=e.options;t.removeEventListener(i,r,n)})),r=[],t()},function(e){var t=e.reference;d(t,"mouseover",h),d(t,"focusin",h),d(t,"click",h)}(e)})),u}var _e={name:"animateFill",defaultValue:!1,fn:function(e){var t=e.popperChildren,i=t.tooltip,r=t.content,n=e.props.animateFill?function(){var e=g();return e.className="tippy-backdrop",b([e],"hidden"),e}():null;function o(){e.popperChildren.backdrop=n}return{onCreate:function(){n&&(o(),i.insertBefore(n,i.firstElementChild),i.setAttribute("data-animatefill",""),i.style.overflow="hidden",e.setProps({animation:"shift-away",arrow:!1}))},onMount:function(){if(n){var e=i.style.transitionDuration,t=Number(e.replace("ms",""));r.style.transitionDelay=Math.round(t/10)+"ms",n.style.transitionDuration=e,b([n],"visible")}},onShow:function(){n&&(n.style.transitionDuration="0ms")},onHide:function(){n&&b([n],"hidden")},onAfterUpdate:function(){o()}}}},ye={name:"followCursor",defaultValue:!1,fn:function(e){var t,i=e.reference,r=e.popper,n=null,o=C(e.props.triggerTarget||i),s=null,a=!1,l=e.props;function c(){return"manual"===e.props.trigger.trim()}function u(){var t=!!c()||null!==s&&!(0===s.clientX&&0===s.clientY);return e.props.followCursor&&t}function h(){return H.isTouch||"initial"===e.props.followCursor&&e.state.isVisible}function d(){e.popperInstance&&n&&(e.popperInstance.reference=n)}function f(){if(u()||e.props.placement!==l.placement){var t=l.placement,i=t.split("-")[1];a=!0,e.setProps({placement:u()&&i?t.replace(i,"start"===i?"end":"start"):t}),a=!1}}function m(){e.popperInstance&&u()&&h()&&e.popperInstance.disableEventListeners()}function g(){u()?o.addEventListener("mousemove",_):d()}function v(){u()&&_(t)}function b(){o.removeEventListener("mousemove",_)}function _(o){var s=t=o,a=s.clientX,l=s.clientY;if(e.popperInstance&&e.state.currentPlacement){var c=w(o.target,(function(e){return e===i})),u=e.props.followCursor,d="horizontal"===u,p="vertical"===u,f=M(["top","bottom"],ee(e.state.currentPlacement)),m=function(e,t){var i=t?e.offsetWidth:e.offsetHeight;return{size:i,x:t?i:0,y:t?0:i}}(r,f),g=m.size,v=m.x,_=m.y;!c&&e.props.interactive||(null===n&&(n=e.popperInstance.reference),e.popperInstance.reference={referenceNode:i,clientWidth:0,clientHeight:0,getBoundingClientRect:function(){var e=i.getBoundingClientRect();return{width:f?g:0,height:f?0:g,top:(d?e.top:l)-_,bottom:(d?e.bottom:l)+_,left:(p?e.left:a)-v,right:(p?e.right:a)+v}}},e.popperInstance.update()),h()&&b()}}return{onAfterUpdate:function(e,t){a||(function(e){Object.keys(e).forEach((function(t){l[t]=E(e[t],l[t])}))}(t),t.placement&&f()),t.placement&&m(),requestAnimationFrame(v)},onMount:function(){v(),m()},onShow:function(){c()&&(t=s={clientX:0,clientY:0},f(),g())},onTrigger:function(e,i){s||(p(i)&&(s={clientX:i.clientX,clientY:i.clientY},t=i),f(),g())},onUntrigger:function(){e.state.isVisible||(b(),s=null)},onHidden:function(){b(),d(),s=null}}}},xe={name:"inlinePositioning",defaultValue:!1,fn:function(e){var t=e.reference;function i(){return!!e.props.inlinePositioning}return{onHidden:function(){i()&&(e.popperInstance.reference=t)},onShow:function(){i()&&(e.popperInstance.reference={referenceNode:t,clientWidth:0,clientHeight:0,getBoundingClientRect:function(){return function(e,t,i){if(i.length<2||null===e)return t;switch(e){case"top":case"bottom":var r=i[0],n=i[i.length-1],o="top"===e,s=r.top,a=n.bottom,l=o?r.left:n.left,c=o?r.right:n.right;return{top:s,bottom:a,left:l,right:c,width:c-l,height:a-s};case"left":case"right":var u=Math.min.apply(Math,i.map((function(e){return e.left}))),h=Math.max.apply(Math,i.map((function(e){return e.right}))),d=i.filter((function(t){return"left"===e?t.left===u:t.right===h})),p=d[0].top,f=d[d.length-1].bottom;return{top:p,bottom:f,left:u,right:h,width:h-u,height:f-p};default:return t}}(e.state.currentPlacement&&ee(e.state.currentPlacement),t.getBoundingClientRect(),x(t.getClientRects()))}})}}}},we={name:"sticky",defaultValue:!1,fn:function(e){var t=e.reference,i=e.popper;function r(t){return!0===e.props.sticky||e.props.sticky===t}var n=null,o=null;function s(){var a=r("reference")?(e.popperInstance?e.popperInstance.reference:t).getBoundingClientRect():null,l=r("popper")?i.getBoundingClientRect():null;(a&&Me(n,a)||l&&Me(o,l))&&e.popperInstance.update(),n=a,o=l,e.state.isMounted&&requestAnimationFrame(s)}return{onMount:function(){e.props.sticky&&s()}}}};function Me(e,t){return!e||!t||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom||e.left!==t.left}},function(e,t,i){"use strict";function r(e){for(var t="https://material-ui.com/production-error/?code="+e,i=1;i<arguments.length;i+=1)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified Material-UI error #"+e+"; visit "+t+" for the full message."}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(2),n=i(45);function o(e){return e&&"object"===Object(n.a)(e)&&e.constructor===Object}function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},n=i.clone?Object(r.a)({},e):e;return o(e)&&o(t)&&Object.keys(t).forEach((function(r){"__proto__"!==r&&(o(t[r])&&r in e?n[r]=s(e[r],t[r],i):n[r]=t[r])})),n}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(1),n=i.n(r),o=i(92);function s(){return n.a.useContext(o.a)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(93),n=["checked","disabled","error","focused","focusVisible","required","expanded","selected"];function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disableGlobal,i=void 0!==t&&t,o=e.productionPrefix,s=void 0===o?"jss":o,a=e.seed,l=void 0===a?"":a,c=""===l?"":"".concat(l,"-"),u=0,h=function(){return u+=1};return function(e,t){var o=t.options.name;if(o&&0===o.indexOf("Mui")&&!t.options.link&&!i){if(-1!==n.indexOf(e.key))return"Mui-".concat(e.key);var a="".concat(c).concat(o,"-").concat(e.key);return t.options.theme[r.a]&&""===l?"".concat(a,"-").concat(h()):a}return"".concat(c).concat(s).concat(h())}}},,,,,,function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(2);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.baseClasses,i=e.newClasses;if(e.Component,!i)return t;var n=Object(r.a)({},t);return Object.keys(i).forEach((function(e){i[e]&&(n[e]="".concat(t[e]," ").concat(i[e]))})),n}},function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return f}));var r,n=i(2),o=i(4),s=i(1),a=i.n(s),l=(i(6),i(261)),c=i(27),u=i(209),h=Object(c.c)(Object(u.a)()),d={disableGeneration:!1,generateClassName:Object(l.a)(),jss:h,sheetsCache:null,sheetsManager:new Map,sheetsRegistry:null},p=a.a.createContext(d);function f(e){var t=e.children,i=e.injectFirst,s=void 0!==i&&i,l=e.disableGeneration,h=void 0!==l&&l,d=Object(o.a)(e,["children","injectFirst","disableGeneration"]),f=a.a.useContext(p),m=Object(n.a)({},f,{disableGeneration:h},d);if(!m.jss.options.insertionPoint&&s&&"undefined"!=typeof window){if(!r){var g=document.head;r=document.createComment("mui-inject-first"),g.insertBefore(r,g.firstChild)}m.jss=Object(c.c)({plugins:Object(u.a)().plugins,insertionPoint:r})}return a.a.createElement(p.Provider,{value:m},t)}},function(e,t,i){"use strict";function r(e){var t=e.theme,i=e.name,r=e.props;if(!t||!t.props||!t.props[i])return r;var n,o=t.props[i];for(n in o)void 0===r[n]&&(r[n]=o[n]);return r}i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var r=i(4),n=i(2),o=i(1),s=i.n(o),a=i(27),l=i(267),c=function(e,t,i,r){var n=e.get(t);n||(n=new Map,e.set(t,n)),n.set(i,r)},u=function(e,t,i){var r=e.get(t);return r?r.get(i):void 0},h=function(e,t,i){e.get(t).delete(i)},d=i(260),p=i(268),f=-1e9;i(45);var m=i(259),g={};function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.name,o=t.classNamePrefix,v=t.Component,b=t.defaultTheme,_=void 0===b?g:b,y=Object(r.a)(t,["name","classNamePrefix","Component","defaultTheme"]),x=function(e){var t="function"==typeof e;return{create:function(i,r){var o;try{o=t?e(i):e}catch(e){throw e}if(!r||!i.overrides||!i.overrides[r])return o;var s=i.overrides[r],a=Object(n.a)({},o);return Object.keys(s).forEach((function(e){a[e]=Object(m.a)(a[e],s[e])})),a},options:{}}}(e),w=i||o||"makeStyles";return x.options={index:f+=1,name:i,meta:w,classNamePrefix:w},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(d.a)()||_,r=Object(n.a)({},s.a.useContext(p.a),y),o=s.a.useRef(),f=s.a.useRef();return function(e,t){var i,r=s.a.useRef([]),n=s.a.useMemo((function(){return{}}),t);r.current!==n&&(r.current=n,i=e()),s.a.useEffect((function(){return function(){i&&i()}}),[n])}((function(){var s={name:i,state:{},stylesCreator:x,stylesOptions:r,theme:t};return function(e,t){var i=e.state,r=e.theme,o=e.stylesOptions,s=e.stylesCreator,h=e.name;if(!o.disableGeneration){var d=u(o.sheetsManager,s,r);d||(d={refs:0,staticSheet:null,dynamicStyles:null},c(o.sheetsManager,s,r,d));var p=Object(n.a)({},s.options,o,{theme:r,flip:"boolean"==typeof o.flip?o.flip:"rtl"===r.direction});p.generateId=p.serverGenerateClassName||p.generateClassName;var f=o.sheetsRegistry;if(0===d.refs){var m;o.sheetsCache&&(m=u(o.sheetsCache,s,r));var g=s.create(r,h);m||((m=o.jss.createStyleSheet(g,Object(n.a)({link:!1},p))).attach(),o.sheetsCache&&c(o.sheetsCache,s,r,m)),f&&f.add(m),d.staticSheet=m,d.dynamicStyles=Object(a.e)(g)}if(d.dynamicStyles){var v=o.jss.createStyleSheet(d.dynamicStyles,Object(n.a)({link:!0},p));v.update(t),v.attach(),i.dynamicSheet=v,i.classes=Object(l.a)({baseClasses:d.staticSheet.classes,newClasses:v.classes}),f&&f.add(v)}else i.classes=d.staticSheet.classes;d.refs+=1}}(s,e),f.current=!1,o.current=s,function(){!function(e){var t=e.state,i=e.theme,r=e.stylesOptions,n=e.stylesCreator;if(!r.disableGeneration){var o=u(r.sheetsManager,n,i);o.refs-=1;var s=r.sheetsRegistry;0===o.refs&&(h(r.sheetsManager,n,i),r.jss.removeStyleSheet(o.staticSheet),s&&s.remove(o.staticSheet)),t.dynamicSheet&&(r.jss.removeStyleSheet(t.dynamicSheet),s&&s.remove(t.dynamicSheet))}}(s)}}),[t,x]),s.a.useEffect((function(){f.current&&function(e,t){var i=e.state;i.dynamicSheet&&i.dynamicSheet.update(t)}(o.current,e),f.current=!0})),function(e,t,i){var r=e.state;if(e.stylesOptions.disableGeneration)return t||{};r.cacheClasses||(r.cacheClasses={value:null,lastProp:null,lastJSS:{}});var n=!1;return r.classes!==r.cacheClasses.lastJSS&&(r.cacheClasses.lastJSS=r.classes,n=!0),t!==r.cacheClasses.lastProp&&(r.cacheClasses.lastProp=t,n=!0),n&&(r.cacheClasses.value=Object(l.a)({baseClasses:r.cacheClasses.lastJSS,newClasses:t,Component:i})),r.cacheClasses.value}(o.current,e.classes,v)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(23),n=i(88),o=i(47),s={m:"margin",p:"padding"},a={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c=function(e){var t={};return function(e){return void 0===t[e]&&(t[e]=function(e){if(e.length>2){if(!l[e])return[e];e=l[e]}var t=e.split(""),i=Object(r.a)(t,2),n=i[0],o=i[1],c=s[n],u=a[o]||"";return Array.isArray(u)?u.map((function(e){return c+e})):[c+u]}(e)),t[e]}}(),u=["m","mt","mr","mb","ml","mx","my","p","pt","pr","pb","pl","px","py","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY"];function h(e){var t=e.spacing||8;return"number"==typeof t?function(e){return t*e}:Array.isArray(t)?function(e){return t[e]}:"function"==typeof t?t:function(){}}function d(e){var t=h(e.theme);return Object.keys(e).map((function(i){if(-1===u.indexOf(i))return null;var r=function(e,t){return function(i){return e.reduce((function(e,r){return e[r]=function(e,t){if("string"==typeof t||null==t)return t;var i=e(Math.abs(t));return t>=0?i:"number"==typeof i?-i:"-".concat(i)}(t,i),e}),{})}}(c(i),t),o=e[i];return Object(n.a)(e,o,r)})).reduce(o.a,{})}d.propTypes={},d.filterProps=u,t.b=d}]);